{"version":3,"file":"ej2-spreadsheet.umd.min.js","sources":["../src/workbook/common/address.js","../src/workbook/common/worker.js","../src/workbook/common/math.js","../src/workbook/integrations/number-format.js","../src/calculate/common/common.js","../src/calculate/common/module.js","../src/calculate/common/module-loader.js","../src/calculate/base/calculate.js","../src/workbook/common/module.js","../src/workbook/common/util.js","../src/workbook/base/cell.js","../src/workbook/base/data.js","../src/workbook/base/sheet.js","../src/workbook/base/row.js","../src/workbook/base/column.js","../src/spreadsheet/common/module.js","../src/spreadsheet/common/util.js","../src/workbook/common/event.js","../src/workbook/integrations/data-bind.js","../src/spreadsheet/common/event.js","../src/workbook/integrations/open.js","../src/workbook/workers/save-worker.js","../src/workbook/integrations/save.js","../src/calculate/common/enum.js","../src/calculate/formulas/basic.js","../src/calculate/base/parser.js","../src/workbook/integrations/formula.js","../src/workbook/integrations/sort.js","../src/workbook/integrations/filter.js","../src/workbook/integrations/image.js","../src/workbook/integrations/chart.js","../src/workbook/actions/cell-format.js","../src/workbook/actions/edit.js","../src/workbook/actions/hyperlink.js","../src/workbook/actions/insert.js","../src/workbook/actions/delete.js","../src/workbook/actions/data-validation.js","../src/workbook/actions/find-and-replace.js","../src/workbook/actions/protect-sheet.js","../src/workbook/actions/merge.js","../src/workbook/actions/conditional-formatting.js","../src/workbook/common/basic-module.js","../src/workbook/common/all-module.js","../src/workbook/common/class.js","../src/workbook/common/constant.js","../src/workbook/services/service-locator.js","../src/workbook/base/workbook.js","../src/spreadsheet/actions/clipboard.js","../src/spreadsheet/actions/edit.js","../src/spreadsheet/actions/selection.js","../src/spreadsheet/actions/scroll.js","../src/spreadsheet/actions/virtual-scroll.js","../src/spreadsheet/actions/keyboard-navigation.js","../src/spreadsheet/actions/keyboard-shortcut.js","../src/spreadsheet/actions/cell-format.js","../src/spreadsheet/actions/resize.js","../src/spreadsheet/actions/collaborative-editing.js","../src/spreadsheet/actions/show-hide.js","../src/spreadsheet/actions/hyperlink.js","../src/spreadsheet/actions/undo-redo.js","../src/spreadsheet/actions/wrap.js","../src/spreadsheet/actions/insert.js","../src/spreadsheet/actions/delete.js","../src/spreadsheet/actions/data-validation.js","../src/spreadsheet/actions/protect-sheet.js","../src/spreadsheet/actions/find-and-replace.js","../src/spreadsheet/actions/merge.js","../src/spreadsheet/actions/conditional-formatting.js","../src/ribbon/ribbon.js","../src/spreadsheet/integrations/color-picker.js","../src/spreadsheet/integrations/ribbon.js","../src/spreadsheet/integrations/formula-bar.js","../src/spreadsheet/integrations/formula.js","../src/spreadsheet/integrations/sheet-tabs.js","../src/spreadsheet/integrations/open.js","../src/spreadsheet/integrations/save.js","../src/spreadsheet/integrations/context-menu.js","../src/spreadsheet/integrations/number-format.js","../src/spreadsheet/integrations/sort.js","../src/spreadsheet/integrations/filter.js","../src/spreadsheet/integrations/image.js","../src/spreadsheet/integrations/chart.js","../src/spreadsheet/common/basic-module.js","../src/spreadsheet/common/all-module.js","../src/spreadsheet/common/class.js","../src/spreadsheet/common/constant.js","../src/spreadsheet/renderer/sheet.js","../src/spreadsheet/renderer/row.js","../src/spreadsheet/renderer/cell.js","../src/spreadsheet/renderer/render.js","../src/spreadsheet/services/dialog.js","../src/spreadsheet/services/action-events.js","../src/spreadsheet/services/overlay.js","../src/spreadsheet/base/spreadsheet.js"],"sourcesContent":["import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getSheetIndex, getSheetNameFromAddress } from '../base/index';\n/**\n * To get range indexes.\n */\nexport function getRangeIndexes(range) {\n    var cellindexes;\n    var indexes = [];\n    range = range.indexOf('!') > -1 ? range.split('!')[1] : range;\n    range = range.indexOf(':') === -1 ? range + ':' + range : range;\n    range.split(':').forEach(function (address) {\n        cellindexes = getCellIndexes(address);\n        indexes.push(cellindexes[0]);\n        indexes.push(cellindexes[1]);\n    });\n    return indexes;\n}\n/**\n * To get single cell indexes\n */\nexport function getCellIndexes(address) {\n    return [parseInt(address.match(/\\d+/)[0], 10) - 1, getColIndex(address.match(/[A-Z]+/i)[0].toUpperCase())];\n}\n/**\n * To get column index from text.\n * @hidden\n */\nexport function getColIndex(text) {\n    var colIdx = 0;\n    text = text.split('').reverse().join('');\n    for (var i = text.length - 1; i >= 0; i--) {\n        colIdx += (text[i].charCodeAt(0) - 64) * (Math.pow(26, i));\n    }\n    return colIdx - 1;\n}\n/**\n * To get cell address from given row and column index.\n */\nexport function getCellAddress(sRow, sCol) {\n    return getColumnHeaderText(sCol + 1) + (sRow + 1);\n}\n/**\n * To get range address from given range indexes.\n */\nexport function getRangeAddress(range) {\n    return getCellAddress(range[0], range[1]) + ':' + (!isNullOrUndefined(range[2]) ?\n        getCellAddress(range[2], range[3]) : getCellAddress(range[0], range[1]));\n}\n/**\n * To get column header cell text\n */\nexport function getColumnHeaderText(colIndex) {\n    var alphabet = 'Z';\n    if (colIndex / 26 > 1) {\n        return getColumnHeaderText((colIndex % 26 === 0) ? (colIndex / 26 - 1) : Math.floor(colIndex / 26))\n            + String.fromCharCode((colIndex % 26) === 0 ? alphabet.charCodeAt(0) : 64 + (colIndex % 26));\n    }\n    else {\n        return String.fromCharCode(64 + (colIndex));\n    }\n}\n/**\n * @hidden\n */\nexport function getIndexesFromAddress(address) {\n    return getRangeIndexes(getRangeFromAddress(address));\n}\n/**\n * @hidden\n */\nexport function getRangeFromAddress(address) {\n    return address.split('!')[1] || address;\n}\n/**\n * Get complete address for selected range\n * @hidden\n */\nexport function getAddressFromSelectedRange(sheet) {\n    return sheet.name + '!' + sheet.selectedRange;\n}\n/**\n * @hidden\n */\nexport function getAddressInfo(context, address) {\n    var sIdx;\n    if (address.indexOf('!') > -1) {\n        sIdx = getSheetIndex(context, getSheetNameFromAddress(address));\n    }\n    else {\n        sIdx = context.activeSheetIndex;\n    }\n    return { sheetIndex: sIdx, indices: getIndexesFromAddress(address) };\n}\n/**\n * Given range will be swapped/arranged in increasing order.\n * @hidden\n */\nexport function getSwapRange(range) {\n    var clonedRange = range.slice();\n    if (range[0] > range[2]) {\n        swap(clonedRange, 0, 2);\n    }\n    if (range[1] > range[3]) {\n        swap(clonedRange, 1, 3);\n    }\n    return clonedRange;\n}\n/**\n * Interchange values in an array\n */\nfunction swap(range, x, y) {\n    var tmp = range[x];\n    range[x] = range[y];\n    range[y] = tmp;\n}\n/**\n * @hidden\n */\nexport function isSingleCell(range) {\n    return range[0] === range[2] && range[1] === range[3];\n}\n","/**\n * Worker task.\n */\nexport function executeTaskAsync(context, taskFn, callbackFn, data, preventCallback) {\n    return new WorkerHelper(context, taskFn, callbackFn, data, preventCallback);\n}\n/**\n * @hidden\n * The `WorkerHelper` module is used to perform multiple actions using Web Worker asynchronously.\n */\nvar WorkerHelper = /** @class */ (function () {\n    /**\n     * Constructor for WorkerHelper module in Workbook library.\n     * @private\n     */\n    function WorkerHelper(context, task, defaultListener, taskData, preventCallback) {\n        this.preventCallback = false;\n        this.context = context;\n        this.workerTask = task;\n        this.defaultListener = defaultListener;\n        this.workerData = taskData;\n        if (preventCallback) {\n            this.preventCallback = true;\n        }\n        this.initWorker();\n    }\n    /**\n     * To terminate the worker task.\n     * @private\n     */\n    WorkerHelper.prototype.terminate = function () {\n        this.worker.terminate();\n        URL.revokeObjectURL(this.workerUrl);\n    };\n    /**\n     * To initiate the worker.\n     * @private\n     */\n    WorkerHelper.prototype.initWorker = function () {\n        var taskBlob = new Blob([this.getFnCode()], { type: 'text/javascript' });\n        this.workerUrl = URL.createObjectURL(taskBlob);\n        this.worker = new Worker(this.workerUrl);\n        this.worker.onmessage = this.messageFromWorker.bind(this);\n        this.worker.onerror = this.onError.bind(this);\n        this.worker.postMessage(this.workerData);\n    };\n    /**\n     * Method for getting response from worker.\n     * @private\n     */\n    WorkerHelper.prototype.messageFromWorker = function (args) {\n        this.terminate();\n        this.defaultListener.apply(this.context, [args.data]);\n    };\n    /**\n     * Method for getting error message from worker if failed.\n     * @private\n     */\n    WorkerHelper.prototype.onError = function (args) {\n        this.terminate();\n        throw args.message || args;\n    };\n    /**\n     * Construct function code for worker.\n     * @private\n     */\n    WorkerHelper.prototype.getFnCode = function () {\n        var workerCode = '';\n        var i;\n        var keys;\n        var workerFunction = '';\n        var isHaveFunction = false;\n        if (typeof this.workerTask === 'function') {\n            if (this.workerTask.toString().indexOf('function') < 0) {\n                workerFunction = 'function ' + this.workerTask.toString();\n            }\n            else {\n                workerFunction = this.workerTask.toString();\n                isHaveFunction = true;\n            }\n            workerCode += ('self.workerTask = ' + workerFunction + '; \\n');\n        }\n        else {\n            if (typeof this.workerTask === 'object') {\n                keys = Object.keys(this.workerTask);\n                for (i = 0; i < keys.length; i++) {\n                    if (this.workerTask[keys[i]].toString().indexOf('function') < 0) {\n                        workerFunction = 'function ' + this.workerTask[keys[i]].toString();\n                    }\n                    else {\n                        workerFunction = this.workerTask[keys[i]].toString();\n                        isHaveFunction = true;\n                    }\n                    workerCode += ((i === 0 ? 'self.workerTask' : keys[i]) + '= ' + workerFunction + '; \\n');\n                }\n            }\n        }\n        workerCode += 'self.onmessage = ' + (isHaveFunction ? '' : ' function ') +\n            (this.preventCallback ? this.getMessageFn.toString() : this.getCallbackMessageFn.toString()) + '; \\n';\n        return workerCode;\n    };\n    /**\n     * Get default worker task with callback.\n     * @private\n     */\n    WorkerHelper.prototype.getCallbackMessageFn = function (args) {\n        postMessage(this.workerTask.apply(this, args.data));\n    };\n    /**\n     * Get default worker task without callback.\n     * @private\n     */\n    WorkerHelper.prototype.getMessageFn = function (args) {\n        this.workerTask.apply(this, args.data);\n    };\n    return WorkerHelper;\n}());\n","import { isNullOrUndefined, getDefaultDateObject } from '@syncfusion/ej2-base';\n/**\n * @hidden\n */\nexport function toFraction(val) {\n    var strVal = val.toString();\n    if (val === parseInt(strVal, 10)) {\n        return parseInt(strVal, 10) + '  ';\n    }\n    else {\n        var top_1 = strVal.indexOf('.') > -1 ? strVal.split('.')[1] : 0;\n        var bottom = Math.pow(10, top_1.toString().replace('-', '').length);\n        var abs = Math.abs(getGcd(top_1, bottom));\n        return (top_1 / abs) + '/' + (bottom / abs);\n    }\n}\n/**\n * @hidden\n */\nexport function getGcd(a, b) {\n    a = Number(a);\n    b = Number(b);\n    return (b) ? getGcd(b, a % b) : a;\n}\n/**\n * @hidden\n */\nexport function intToDate(val) {\n    val = Number(val);\n    val = (val > 0 && val < 1) ? (1 + val) : (val === 0) ? 1 : val;\n    if (val > 60) {\n        val -= 1; // Due to leap year issue of 1900 in MSExcel.\n    }\n    return new Date(((val - 1) * (1000 * 3600 * 24)) + new Date('01/01/1900').getTime());\n}\n/**\n * @hidden\n */\n/* tslint:disable no-any */\nexport function dateToInt(val, isTime) {\n    var startDate = new Date('01/01/1900');\n    var date = isDateTime(val) ? val : new Date(val);\n    var startDateUTC = Date.UTC(startDate.getFullYear(), startDate.getMonth(), startDate.getDate(), startDate.getHours(), startDate.getMinutes(), startDate.getSeconds(), startDate.getMilliseconds());\n    var dateUTC = Date.UTC(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds());\n    var diffDays = ((dateUTC - startDateUTC) / (1000 * 3600 * 24));\n    return isTime ? diffDays : parseInt(diffDays.toString(), 10) + 2;\n}\n/**\n * @hidden\n */\nexport function isDateTime(date) {\n    return Object.prototype.toString.call(date) === '[object Date]' && !isNaN(date.valueOf());\n}\n/**\n * @hidden\n */\nexport function isNumber(val) {\n    return val - parseFloat(val) >= 0;\n}\n/**\n * @hidden\n */\nexport function toDate(text, intl, format) {\n    var defaultDateFormats = getDefaultDateObject();\n    var availabelDateTimeFormat = defaultDateFormats.dateTimeFormats.availableFormats;\n    var dObj = { dateObj: null, isCustom: false, type: '' };\n    if (typeof text === 'string') {\n        text = text.toUpperCase();\n    }\n    if (format) {\n        dObj.dateObj = intl.parseDate(text, { format: format });\n        if (dObj.dateObj) {\n            dObj.type = text.toString().indexOf(':') > -1 ? 'time' : 'datetime';\n            dObj.isCustom = true;\n        }\n    }\n    if (isNullOrUndefined(dObj.dateObj)) {\n        for (var _i = 0, _a = Object.keys(defaultDateFormats.dateFormats); _i < _a.length; _i++) {\n            var key = _a[_i];\n            dObj.dateObj = intl.parseDate(text, { format: defaultDateFormats.dateFormats[key], skeleton: key });\n            if (dObj.dateObj) {\n                dObj.type = 'date';\n                dObj.isCustom = false;\n                break;\n            }\n        }\n        if (isNullOrUndefined(dObj.dateObj)) {\n            for (var _b = 0, _c = Object.keys(availabelDateTimeFormat); _b < _c.length; _b++) {\n                var key = _c[_b];\n                dObj.dateObj = intl.parseDate(text, { format: availabelDateTimeFormat[key], skeleton: key });\n                if (dObj.dateObj) {\n                    dObj.type = text.toString().indexOf(':') > -1 ? 'time' : 'datetime';\n                    if (dObj.type === 'time') {\n                        var time = dObj.dateObj.toLocaleTimeString();\n                        dObj.dateObj = new Date('01/01/1900 ' + time);\n                    }\n                    dObj.isCustom = true;\n                    break;\n                }\n            }\n        }\n        if (isNullOrUndefined(dObj.dateObj)) {\n            for (var _d = 0, _e = Object.keys(defaultDateFormats.timeFormats); _d < _e.length; _d++) {\n                var key = _e[_d];\n                dObj.dateObj = intl.parseDate(text, { format: defaultDateFormats.timeFormats[key], skeleton: key });\n                if (dObj.dateObj) {\n                    var time = dObj.dateObj.toLocaleTimeString();\n                    dObj.dateObj = new Date('01/01/1900 ' + time);\n                    dObj.type = 'time';\n                    dObj.isCustom = false;\n                    break;\n                }\n            }\n        }\n    }\n    if (text !== '#DIV/0!' && !dObj.dateObj && new Date(text).toString() !== 'Invalid Date') {\n        dObj.dateObj = new Date(text);\n    }\n    return dObj;\n}\n/**\n * @hidden\n */\nexport function parseIntValue(value) {\n    return (value && /^\\d*\\.?\\d*$/.test(value)) ? parseFloat(value) : value;\n}\n","import { getRangeIndexes } from '../common/index';\nimport { getCell, getSheet, setCell, getSheetIndex } from '../base/index';\nimport { Internationalization, getNumberDependable, getNumericObject, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { isNumber, toFraction, intToDate, toDate, dateToInt } from '../common/math';\nimport { applyNumberFormatting, getFormattedCellObject, refreshCellElement, checkDateFormat, getFormattedBarText } from '../common/event';\n/**\n * Specifies number format.\n */\nvar WorkbookNumberFormat = /** @class */ (function () {\n    function WorkbookNumberFormat(parent) {\n        this.parent = parent;\n        this.localeObj = getNumericObject(this.parent.locale);\n        /* tslint:disable:no-any */\n        this.decimalSep = this.localeObj.decimal;\n        this.groupSep = this.localeObj.group;\n        this.addEventListener();\n    }\n    WorkbookNumberFormat.prototype.numberFormatting = function (args) {\n        var activeSheetIndex = this.parent.activeSheetIndex;\n        if (args.range && args.range.indexOf('!') > -1) {\n            activeSheetIndex = getSheetIndex(this.parent, args.range.split('!')[0]);\n        }\n        var sheet = this.parent.sheets[activeSheetIndex];\n        var formatRange = args.range ? ((args.range.indexOf('!') > -1) ?\n            args.range.split('!')[1] : args.range) : sheet.selectedRange;\n        var selectedRange = getRangeIndexes(formatRange);\n        var cell;\n        for (var i = selectedRange[0]; i <= selectedRange[2]; i++) {\n            for (var j = selectedRange[1]; j <= selectedRange[3]; j++) {\n                setCell(i, j, sheet, { format: args.format }, true);\n                cell = getCell(i, j, sheet, true);\n                this.getFormattedCell({\n                    type: getTypeFromFormat(cell.format), value: cell.value,\n                    format: cell.format, rowIndex: i, colIndex: j,\n                    sheetIndex: activeSheetIndex, cell: cell\n                });\n            }\n        }\n    };\n    /**\n     * @hidden\n     */\n    WorkbookNumberFormat.prototype.getFormattedCell = function (args) {\n        var fResult = isNullOrUndefined(args.value) ? '' : args.value;\n        var sheet = this.parent.sheets[isNullOrUndefined(args.sheetIndex) ? this.parent.activeSheetIndex :\n            args.sheetIndex];\n        var range = getRangeIndexes(sheet.activeCell);\n        var sheetIdx = Number(args.sheetIndex) ? Number(args.sheetIndex) : this.parent.activeSheetIndex;\n        var cell = args.cell ? args.cell : getCell(range[0], range[1], sheet);\n        var rightAlign = false;\n        var currencySymbol = getNumberDependable(this.parent.locale, 'USD');\n        if (args.format === '' || args.format === 'General') {\n            cell = cell ? cell : {};\n            var dateEventArgs = {\n                value: args.value, rowIndex: range[0], colIndex: range[1], sheetIndex: this.parent.activeSheetIndex,\n                updatedVal: args.value, isDate: false, isTime: false\n            };\n            this.checkDateFormat(dateEventArgs);\n            if (dateEventArgs.isDate) {\n                rightAlign = true;\n                cell.value = args.value = dateEventArgs.updatedVal;\n                cell.format = args.format = getFormatFromType('ShortDate');\n            }\n            else if (dateEventArgs.isTime) {\n                rightAlign = true;\n                cell.value = args.value = dateEventArgs.updatedVal;\n                cell.format = args.format = getFormatFromType('Time');\n            }\n        }\n        args.type = args.format ? getTypeFromFormat(args.format) : 'General';\n        var result = this.processFormats(args, fResult, rightAlign, cell);\n        if ((this.parent.getActiveSheet().id - 1 === sheetIdx)) {\n            this.parent.notify(refreshCellElement, {\n                isRightAlign: result.rightAlign, result: result.fResult || args.value,\n                rowIndex: args.rowIndex, colIndex: args.colIndex, sheetIndex: args.sheetIndex,\n                type: args.type, curSymbol: currencySymbol, value: args.value || ''\n            });\n        }\n        if (!args.onLoad && (args.rowIndex > sheet.usedRange.rowIndex || args.colIndex > sheet.usedRange.colIndex)) {\n            this.parent.setUsedRange(args.rowIndex, args.colIndex);\n        }\n        args.formattedText = result.fResult || args.value;\n        args.isRightAlign = result.rightAlign;\n        args.curSymbol = currencySymbol;\n        return args.formattedText;\n    };\n    WorkbookNumberFormat.prototype.processFormats = function (args, fResult, isRightAlign, cell) {\n        var intl = new Internationalization();\n        var currencySymbol = getNumberDependable(this.parent.locale, 'USD');\n        var result;\n        args.format = args.format ? args.format : 'General';\n        if (fResult !== '') {\n            switch (args.type) {\n                case 'General':\n                    result = this.autoDetectGeneralFormat({\n                        args: args, currencySymbol: currencySymbol, fResult: fResult, intl: intl,\n                        isRightAlign: isRightAlign, curCode: 'USD', cell: cell, rowIdx: Number(args.rowIdx),\n                        colIdx: Number(args.colIdx)\n                    });\n                    fResult = result.fResult;\n                    isRightAlign = result.isRightAlign;\n                    break;\n                case 'Number':\n                    if (isNumber(fResult)) {\n                        fResult = this.applyNumberFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Currency':\n                    if (isNumber(fResult)) {\n                        fResult = this.currencyFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Percentage':\n                    if (isNumber(fResult)) {\n                        fResult = this.percentageFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Accounting':\n                    if (isNumber(fResult)) {\n                        fResult = this.accountingFormat(args, intl);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'ShortDate':\n                    fResult = this.shortDateFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case 'LongDate':\n                    fResult = this.longDateFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case 'Time':\n                    fResult = this.timeFormat(args, intl);\n                    isRightAlign = fResult ? true : false;\n                    break;\n                case 'Fraction':\n                    if (isNumber(fResult)) {\n                        fResult = this.fractionFormat(args);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Scientific':\n                    if (isNumber(fResult)) {\n                        fResult = this.scientificFormat(args);\n                        isRightAlign = true;\n                    }\n                    break;\n                case 'Text':\n                    isRightAlign = false;\n                    break;\n            }\n        }\n        return { fResult: fResult, rightAlign: isRightAlign };\n    };\n    WorkbookNumberFormat.prototype.autoDetectGeneralFormat = function (options) {\n        if (isNumber(options.fResult)) {\n            if (options.args.format && options.args.format !== '') {\n                if (options.args.format.toString().indexOf('%') > -1) {\n                    options.fResult = this.percentageFormat(options.args, options.intl);\n                }\n                else if (options.args.format.toString().indexOf(options.currencySymbol) > -1) {\n                    options.fResult = this.currencyFormat(options.args, options.intl);\n                }\n                else {\n                    options.fResult = this.applyNumberFormat(options.args, options.intl);\n                }\n            }\n            if (options.args.format === 'General' && options.fResult && options.fResult.toString().split(this.decimalSep)[0].length > 11) {\n                options.fResult = this.scientificFormat(options.args);\n            }\n            options.isRightAlign = true;\n        }\n        if (!isNullOrUndefined(options.fResult)) {\n            var res = options.fResult.toString();\n            if (res.indexOf('%') > -1 && res.split('%')[0] !== '' && res.split('%')[1].trim() === '' &&\n                Number(res.split('%')[0].split(this.groupSep).join('')).toString() !== 'NaN' &&\n                !this.parent.isEdit) {\n                options.args.value = Number(res.split('%')[0].split(this.groupSep).join(''));\n                options.cell.format = options.args.format = getFormatFromType('Percentage');\n                options.fResult = this.percentageFormat(options.args, options.intl);\n                options.cell.value = options.args.value.toString();\n                setCell(options.rowIdx, options.colIdx, this.parent.getActiveSheet(), options.cell, true);\n                options.isRightAlign = true;\n            }\n            else if (res.indexOf(options.currencySymbol) > -1 && res.split(options.currencySymbol)[1] !== '' &&\n                Number(res.split(options.currencySymbol)[1].split(this.groupSep).join('')).toString() !== 'NaN' &&\n                !this.parent.isEdit) {\n                options.args.value = Number(res.split(options.currencySymbol)[1].split(this.groupSep).join(''));\n                options.cell.format = options.args.format = getFormatFromType('Currency');\n                options.fResult = this.currencyFormat(options.args, options.intl);\n                options.cell.value = options.args.value.toString();\n                setCell(options.rowIdx, options.colIdx, this.parent.getActiveSheet(), options.cell, true);\n                options.isRightAlign = true;\n            }\n        }\n        return { isRightAlign: options.isRightAlign, fResult: options.fResult };\n    };\n    WorkbookNumberFormat.prototype.findSuffix = function (zeros, resultSuffix) {\n        var len = zeros.length;\n        var suffixLen = len - resultSuffix.length;\n        return zeros.substr(0, suffixLen < 0 ? 0 : suffixLen) + resultSuffix;\n    };\n    WorkbookNumberFormat.prototype.applyNumberFormat = function (args, intl) {\n        args.format = this.isCustomFormat(args.format.toString());\n        var formatArr = args.format.toString().split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = !isNullOrUndefined(formatArr[1]) ? formatArr[1].split('*').join(' ') : formatArr[0];\n        }\n        return intl.formatNumber(Number(args.value), {\n            format: args.format\n        });\n    };\n    WorkbookNumberFormat.prototype.isCustomFormat = function (format) {\n        if (format === '_-* #,##0.00_-;-* #,##0.00_-;_-* \"-\"_-;_-@_-' || format === '_-* #,##0_-;-* #,##0_-;_-* \"-\"_-;_-@_-') {\n            format = '';\n        }\n        format = format === '' ? getFormatFromType('Number') : format;\n        format = format.toString().split('_)').join(' ').split('_(').join(' ').split('[Red]').join('');\n        return format;\n    };\n    WorkbookNumberFormat.prototype.currencyFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType('Currency') : args.format;\n        args.format = args.format.toString().split('_(').join(' ').split('_)').join(' ').split('[Red]').join('');\n        var formatArr = args.format.toString().split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = isNullOrUndefined(formatArr[1]) ? formatArr[0] : formatArr[1].split('*').join(' ');\n        }\n        return intl.formatNumber(Number(args.value), {\n            format: args.format,\n            currency: 'USD'\n        });\n    };\n    WorkbookNumberFormat.prototype.percentageFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType('Percentage') : args.format;\n        return intl.formatNumber(Number(args.value), {\n            format: args.format\n        });\n    };\n    WorkbookNumberFormat.prototype.accountingFormat = function (args, intl) {\n        args.format = args.format === '' ? getFormatFromType('Accounting') : args.format;\n        args.format = args.format.split('_(').join(' ').split('_)').join(' ').split('[Red]').join('').split('_').join('');\n        var currencySymbol = getNumberDependable(this.parent.locale, 'USD');\n        var formatArr = args.format.split(';');\n        if (Number(args.value) >= 0) {\n            args.format = formatArr[0];\n        }\n        else {\n            args.format = formatArr[1].split('*').join(' ');\n        }\n        if (Number(args.value) === 0) {\n            return currencySymbol + '- ';\n        }\n        else {\n            return intl.formatNumber(Number(args.value), {\n                format: args.format,\n                currency: 'USD'\n            }).split('-').join('');\n        }\n    };\n    WorkbookNumberFormat.prototype.shortDateFormat = function (args, intl) {\n        var shortDate = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType('ShortDate')\n            : args.format.toString();\n        var dateObj;\n        if (code === getFormatFromType('ShortDate')) {\n            code = 'M/d/yy';\n            dateObj = {\n                type: 'date',\n                skeleton: 'yMd'\n            };\n        }\n        else {\n            dateObj = {\n                type: 'date',\n                format: code\n            };\n        }\n        return intl.formatDate(shortDate, dateObj);\n    };\n    WorkbookNumberFormat.prototype.longDateFormat = function (args, intl) {\n        var longDate = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType('LongDate')\n            : args.format.toString();\n        if (code === getFormatFromType('LongDate')) {\n            code = 'EEEE, MMMM d, y';\n        }\n        return intl.formatDate(longDate, {\n            type: 'date',\n            format: code\n        });\n    };\n    WorkbookNumberFormat.prototype.timeFormat = function (args, intl) {\n        if (isNullOrUndefined(args.value)) {\n            return '';\n        }\n        if (!isNullOrUndefined(args.value.toString().split(this.decimalSep)[1])) {\n            args.value = parseFloat('1' + this.decimalSep + args.value.toString().split(this.decimalSep)[1]) || args.value;\n        }\n        var time = intToDate(args.value);\n        var code = (args.format === '' || args.format === 'General') ? getFormatFromType('Time')\n            : args.format.toString();\n        if (code === getFormatFromType('Time')) {\n            code = 'h:mm:ss a';\n        }\n        return intl.formatDate(time, {\n            type: 'time',\n            skeleton: 'medium',\n            format: code\n        });\n    };\n    WorkbookNumberFormat.prototype.scientificFormat = function (args) {\n        args.format = args.format === '' ? getFormatFromType('Scientific') : args.format;\n        var zeros = args.format.split('+')[1];\n        var prefix = this.findDecimalPlaces(args.format, 'Scientific');\n        var fResult = Number(args.value).toExponential(prefix);\n        if (fResult.indexOf('e+') > -1) {\n            fResult = fResult.split('e+')[0] + 'E+' + this.findSuffix(zeros, fResult.split('e+')[1]);\n        }\n        else if (fResult.indexOf('e-') > -1) {\n            fResult = fResult.split('e-')[0] + 'E-' + +this.findSuffix(zeros, fResult.split('e-')[1]);\n        }\n        return fResult;\n    };\n    WorkbookNumberFormat.prototype.fractionFormat = function (args) {\n        args.format = args.format === '' ? getFormatFromType('Fraction') : args.format;\n        var suffix = '';\n        var fractionResult;\n        if (args.value.toString().indexOf(this.decimalSep) > -1 && isNumber(args.value)) {\n            suffix = args.value.toString().split(this.decimalSep)[0];\n            fractionResult = toFraction(Number(args.value));\n            return (Number(suffix) === 0) ? ' ' + fractionResult : suffix + ' ' + fractionResult;\n        }\n        return suffix;\n    };\n    WorkbookNumberFormat.prototype.findDecimalPlaces = function (code, type) {\n        switch (type) {\n            case 'Scientific':\n                var eIndex = code.toUpperCase().indexOf('E');\n                var decIndex = code.indexOf(this.decimalSep);\n                if (eIndex > -1) {\n                    return code.substring(decIndex + 1, eIndex).length;\n                }\n        }\n        return 2;\n    };\n    WorkbookNumberFormat.prototype.checkDateFormat = function (args) {\n        var dateObj;\n        var intl = new Internationalization();\n        var value = !isNullOrUndefined(args.value) ? args.value.toString() : '';\n        var checkedDate;\n        var cell = getCell(args.rowIndex, args.colIndex, getSheet(this.parent, isNullOrUndefined(args.sheetIndex) ? this.parent.activeSheetIndex : args.sheetIndex));\n        checkedDate = this.checkCustomDateFormat(value);\n        if (value && (value.indexOf('/') > -1 || value.indexOf('-') > 0 || value.indexOf(':') > -1) && checkedDate !== 'Invalid') {\n            value = checkedDate;\n            if (value && value.indexOf('/') > -1 || value.indexOf('-') > 0 || value.indexOf(':') > -1) {\n                dateObj = toDate(value, intl, cell && cell.format);\n                if (!isNullOrUndefined(dateObj.dateObj) && dateObj.dateObj.toString() !== 'Invalid Date') {\n                    cell = cell ? cell : {};\n                    value = dateToInt(dateObj.dateObj, value.indexOf(':') > -1).toString();\n                    if (!cell.format || cell.format === '') {\n                        if (dateObj.type === 'time') {\n                            cell.format = getFormatFromType('Time');\n                        }\n                        else {\n                            cell.format = getFormatFromType('ShortDate');\n                        }\n                    }\n                    args.isDate = dateObj.type === 'date' || dateObj.type === 'datetime';\n                    args.isTime = dateObj.type === 'time';\n                    args.dateObj = dateObj.dateObj;\n                }\n            }\n            args.updatedVal = value;\n        }\n    };\n    WorkbookNumberFormat.prototype.checkCustomDateFormat = function (val) {\n        var dateArr = val.indexOf('/') > -1 ? val.split('/') : val.indexOf('-') > 0 ? val.split('-') : '';\n        var months = ['jan', 'feb', 'mar', 'apr', 'may', 'jun', 'jul', 'aug', 'sep', 'sept', 'oct', 'nov', 'dec'];\n        if (dateArr.length === 2) {\n            if (months.indexOf(dateArr[0].toLowerCase()) > -1 && Number(dateArr[1]) <= 31) {\n                return '01-' + dateArr[0] + '-' + dateArr[1];\n            }\n            else if (months.indexOf(dateArr[1].toLowerCase()) > -1 && Number(dateArr[0]) <= 31) {\n                return dateArr[0] + '-' + dateArr[1] + '-' + new Date().getFullYear();\n            }\n            else if (Number(dateArr[0]) <= 31 && Number(dateArr[1]) <= 12) {\n                return dateArr[0] + '-' + dateArr[1] + '-' + new Date().getFullYear();\n            }\n            if (Number(dateArr[1]) <= 31 && Number(dateArr[0]) <= 12) {\n                return dateArr[0] + '-' + dateArr[1] + '-' + new Date().getFullYear();\n            }\n            if (Number(dateArr[0]) <= 12 && Number(dateArr[1]) <= 9999 && Number(dateArr[1]) >= 1900) {\n                return '01-' + dateArr[0] + '-' + dateArr[1];\n            }\n            else {\n                return 'Invalid';\n            }\n        }\n        return val;\n    };\n    WorkbookNumberFormat.prototype.formattedBarText = function (args) {\n        var type = getTypeFromFormat(args.cell ? args.cell.format : '');\n        var intl = new Internationalization();\n        var beforeText = args.value;\n        var date = (type === 'ShortDate' && args.cell && args.cell.format) ?\n            args.cell.format : getFormatFromType('ShortDate');\n        var time = getFormatFromType('Time');\n        switch (type) {\n            case 'ShortDate':\n            case 'LongDate':\n                args.value = this.shortDateFormat({ type: type, value: args.value, format: date }, intl);\n                break;\n            case 'Time':\n                args.value = this.shortDateFormat({ type: type, value: args.value, format: date }, intl) + ' ' +\n                    this.timeFormat({ type: type, value: args.value, format: time }, intl);\n                break;\n        }\n        if (!args.value || (args.value && args.value.toString().indexOf('null') > -1)) {\n            args.value = beforeText;\n        }\n    };\n    /**\n     * Adding event listener for number format.\n     */\n    WorkbookNumberFormat.prototype.addEventListener = function () {\n        this.parent.on(applyNumberFormatting, this.numberFormatting, this);\n        this.parent.on(getFormattedCellObject, this.getFormattedCell, this);\n        this.parent.on(checkDateFormat, this.checkDateFormat, this);\n        this.parent.on(getFormattedBarText, this.formattedBarText, this);\n    };\n    /**\n     * Removing event listener for number format.\n     */\n    WorkbookNumberFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applyNumberFormatting, this.numberFormatting);\n            this.parent.off(getFormattedCellObject, this.getFormattedCell);\n            this.parent.off(checkDateFormat, this.checkDateFormat);\n            this.parent.off(getFormattedBarText, this.formattedBarText);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    WorkbookNumberFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook number format module name.\n     */\n    WorkbookNumberFormat.prototype.getModuleName = function () {\n        return 'workbookNumberFormat';\n    };\n    return WorkbookNumberFormat;\n}());\nexport { WorkbookNumberFormat };\n/**\n * To Get the number built-in format code from the number format type.\n * @param {string} type - Specifies the type of the number formatting.\n */\nexport function getFormatFromType(type) {\n    var code = 'General';\n    switch (type.split(' ').join('')) {\n        case 'Number':\n            code = '0.00';\n            break;\n        case 'Currency':\n            code = '$#,##0.00';\n            break;\n        case 'Accounting':\n            code = '_($* #,##0.00_);_($* (#,##0.00);_($* \"-\"??_);_(@_)';\n            break;\n        case 'ShortDate':\n            code = 'mm-dd-yyyy';\n            break;\n        case 'LongDate':\n            code = 'dddd, mmmm dd, yyyy';\n            break;\n        case 'Time':\n            code = 'h:mm:ss AM/PM';\n            break;\n        case 'Percentage':\n            code = '0.00%';\n            break;\n        case 'Fraction':\n            code = '# ?/?';\n            break;\n        case 'Scientific':\n            code = '0.00E+00';\n            break;\n        case 'Text':\n            code = '@';\n            break;\n    }\n    return code;\n}\n/**\n * @hidden\n */\nexport function getTypeFromFormat(format) {\n    var code = 'General';\n    switch (format) {\n        case '0.00':\n        case '_-* #,##0.00_-;-* #,##0.00_-;_-* \"-\"_-;_-@_-':\n        case '_-* #,##0_-;-* #,##0_-;_-* \"-\"_-;_-@_-':\n            code = 'Number';\n            break;\n        case '$#,##0.00':\n        case '$#,##0_);[Red]($#,##0)':\n        case '$#,##0.00_);[Red]($#,##0.00)':\n        case '$#,##0.00_);($#,##0.00)':\n        case '$#,##0_);($#,##0)':\n            code = 'Currency';\n            break;\n        case '_($*#,##0.00_);_($*(#,##0.00);_($*\"-\"??_);_(@_)':\n        case '_($*#,##0.00_);_($* (#,##0.00);_($*\"-\"??_);_(@_)':\n        case '_($* #,##0.00_);_($* (#,##0.00);_($* \"-\"??_);_(@_)':\n        case '_ $ * #,##0.00_ ;_ $ * -#,##0.00_ ;_ $ * \"-\"??_ ;_ @_ ':\n            code = 'Accounting';\n            break;\n        case 'mm-dd-yyyy':\n        case 'dd-mm-yyyy':\n        case 'dd-mm-yy':\n        case 'mm-dd-yy':\n        case 'dd/MM/yyyy':\n        case 'yyyy-MM-dd':\n            code = 'ShortDate';\n            break;\n        case 'dddd, mmmm dd, yyyy':\n            code = 'LongDate';\n            break;\n        case 'h:mm:ss AM/PM':\n            code = 'Time';\n            break;\n        case '0.00%':\n        case '0%':\n            code = 'Percentage';\n            break;\n        case '# ?/?':\n        case '# ??/??':\n        case '# ???/???':\n            code = 'Fraction';\n            break;\n        case '0.00E+00':\n            code = 'Scientific';\n            break;\n        case '@':\n            code = 'Text';\n            break;\n    }\n    return code;\n}\n","/**\n * Represent the common codes for calculate\n */\nvar CalculateCommon = /** @class */ (function () {\n    function CalculateCommon(parent) {\n        this.parent = parent;\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    CalculateCommon.prototype.getModuleName = function () {\n        return 'calc-common';\n    };\n    return CalculateCommon;\n}());\nexport { CalculateCommon };\n/**\n * To check whether the object is undefined.\n * @param {Object} value - To check the object is undefined\n * @return {boolean}\n * @private\n */\nexport function isUndefined(value) {\n    return ('undefined' === typeof value);\n}\n/** @hidden */\nexport function getSkeletonVal(value) {\n    switch (value) {\n        case 'dd-MMM-yyyy':\n        case 'dd MMM yyyy':\n            value = 'medium';\n            break;\n        case 'MMM-yyyy':\n        case 'MMM yyyy':\n            value = 'yMMM';\n            break;\n        case 'MM-dd-yyyy': //short\n        case 'dd-MM-yyyy':\n        case 'dd-MM-yy':\n        case 'MM/dd/yyyy':\n        case 'dd/MM/yyyy':\n        case 'dd/MM/yy':\n            value = 'short';\n            break;\n        case 'dddd MMMM dd yyyy': //long\n        case 'dd MMMM yyyy':\n            value = 'long';\n            break;\n        case 'd MMMM yyyy':\n            value = 'yMMMd';\n            break;\n        case 'yyyy':\n            value = 'y';\n            break;\n        case 'h:mm':\n            value = 'Hm';\n            break;\n        case 'h:mm tt':\n            value = 'hm';\n            break;\n        case 'h':\n            value = 'H';\n            break;\n        case 'h tt':\n            value = 'h';\n            break;\n        case 'dddd':\n            value = 'E';\n            break;\n        case 'h:mm:ss tt':\n            value = 'hms';\n            break;\n        case 'h:mm:ss':\n            value = 'Hms';\n            break;\n        case 'd':\n            value = 'd';\n            break;\n        case 'd dddd':\n            value = 'Ed';\n            break;\n        case 'M':\n            value = 'M';\n            break;\n        case 'Md':\n            value = 'Md';\n            break;\n        case 'MMM':\n            value = 'MMM';\n            break;\n        case 'ddd MMM d':\n            value = 'MMMEd';\n            break;\n        case 'MMM d':\n            value = 'MMMd';\n            break;\n        case 'M/yyyy':\n            value = 'yM';\n            break;\n        default:\n            value = '';\n            break;\n    }\n    return value;\n}\n","/**\n * Represents the getModules function.\n * @param {Calculate} context\n */\nexport function getModules(context) {\n    var modules = [];\n    if (context.includeBasicFormulas) {\n        modules.push({\n            member: 'basic-formulas',\n            args: [context]\n        });\n    }\n    return modules;\n}\n","/**\n * Module loading operations\n */\nimport { isNullOrUndefined, isUndefined } from '@syncfusion/ej2-base';\nvar MODULE_SUFFIX = 'Module';\n/**\n * To get nameSpace value from the desired object.\n * @param {string} nameSpace - String value to the get the inner object\n * @param {any} obj - Object to get the inner object value.\n * @return {any}\n * @private\n */\nexport function getValue(nameSpace, obj) {\n    /* tslint:disable no-any */\n    var value = obj;\n    var splits = nameSpace.replace(/\\[/g, '.').replace(/\\]/g, '').split('.');\n    for (var j = 0; j < splits.length && !isUndefined(value); j++) {\n        value = value[splits[j]];\n    }\n    return value;\n}\n/**\n * To set value for the nameSpace in desired object.\n * @param {string} nameSpace - String value to get the inner object\n * @param {any} value - Value that you need to set.\n * @param {any} obj - Object to get the inner object value.\n * @return {void}\n * @private\n */\nexport function setValue(nameSpace, value, obj) {\n    var keyValues = nameSpace.replace(/\\[/g, '.').replace(/\\]/g, '').split('.');\n    var start = obj || {};\n    var fromObj = start;\n    var j;\n    var length = keyValues.length;\n    var key;\n    for (j = 0; j < length; j++) {\n        key = keyValues[j];\n        if (j + 1 === length) {\n            fromObj[key] = value === undefined ? {} : value;\n        }\n        else if (isNullOrUndefined(fromObj[key])) {\n            fromObj[key] = {};\n        }\n        fromObj = fromObj[key];\n    }\n    return start;\n}\nvar ModuleLoader = /** @class */ (function () {\n    function ModuleLoader(parent) {\n        this.loadedModules = [];\n        this.parent = parent;\n    }\n    ;\n    /**\n     * Inject required modules in component library\n     * @hidden\n     */\n    ModuleLoader.prototype.inject = function (requiredModules, moduleList) {\n        var reqLengthVal = requiredModules.length;\n        if (reqLengthVal === 0) {\n            this.clean();\n            return;\n        }\n        if (this.loadedModules.length) {\n            this.clearUnusedModule(requiredModules);\n        }\n        for (var i = 0; i < reqLengthVal; i++) {\n            var modl = requiredModules[i];\n            for (var _i = 0, moduleList_1 = moduleList; _i < moduleList_1.length; _i++) {\n                var module = moduleList_1[_i];\n                var modName = modl.member;\n                if (module.prototype.getModuleName() === modl.member && !this.isModuleLoaded(modName)) {\n                    var moduleObject = this.createInstance(module, modl.args);\n                    var memberName = this.getMemberName(modName);\n                    if (modl.isProperty) {\n                        setValue(memberName, module, this.parent);\n                    }\n                    else {\n                        setValue(memberName, moduleObject, this.parent);\n                    }\n                    var loadedModule = modl;\n                    loadedModule.member = memberName;\n                    this.loadedModules.push(loadedModule);\n                }\n            }\n        }\n    };\n    /**\n     * Create Instance from constructor function with desired parameters.\n     * @param {Function} classFunction - Class function to which need to create instance\n     * @param {any[]} params - Parameters need to passed while creating instance\n     * @return {any}\n     * @private\n     */\n    ModuleLoader.prototype.createInstance = function (classFunction, params) {\n        var arrayParam = params;\n        arrayParam.unshift(undefined);\n        return new (Function.prototype.bind.apply(classFunction, arrayParam));\n    };\n    /**\n     * To remove the created object while control is destroyed\n     * @hidden\n     */\n    ModuleLoader.prototype.clean = function () {\n        for (var _i = 0, _a = this.loadedModules; _i < _a.length; _i++) {\n            var modules = _a[_i];\n            if (!modules.isProperty) {\n                getValue(modules.member, this.parent).destroy();\n            }\n        }\n        this.loadedModules = [];\n    };\n    /**\n     * Removes all unused modules\n     * @param {ModuleDeclaration[]} moduleListName\n     * @returns {void}\n     */\n    ModuleLoader.prototype.clearUnusedModule = function (moduleListName) {\n        var _this = this;\n        var usedModule = moduleListName.map(function (arg) { return _this.getMemberName(arg.member); });\n        var removeModule = this.loadedModules.filter(function (module) {\n            return usedModule.indexOf(module.member) === -1;\n        });\n        for (var _i = 0, removeModule_1 = removeModule; _i < removeModule_1.length; _i++) {\n            var moduleName = removeModule_1[_i];\n            if (!moduleName.isProperty) {\n                getValue(moduleName.member, this.parent).destroy();\n            }\n            this.loadedModules.splice(this.loadedModules.indexOf(moduleName), 1);\n            this.deleteObject(this.parent, moduleName.member);\n        }\n    };\n    /**\n     * To get the name of the member.\n     * @param {string} name\n     * @returns {string}\n     */\n    ModuleLoader.prototype.getMemberName = function (name) {\n        return name[0].toLowerCase() + name.substring(1) + MODULE_SUFFIX;\n    };\n    /**\n     * Delete an item from Object\n     * @param {any} obj - Object in which we need to delete an item.\n     * @param {string} params - String value to the get the inner object\n     * @return {void}\n     * @private\n     */\n    ModuleLoader.prototype.deleteObject = function (obj, key) {\n        delete obj[key];\n    };\n    /**\n     * Returns boolean based on whether the module specified is loaded or not\n     * @param {string} modName\n     * @returns {boolean}\n     */\n    ModuleLoader.prototype.isModuleLoaded = function (modName) {\n        for (var _i = 0, _a = this.loadedModules; _i < _a.length; _i++) {\n            var mod = _a[_i];\n            if (mod.member === this.getMemberName(modName)) {\n                return true;\n            }\n        }\n        return false;\n    };\n    return ModuleLoader;\n}());\nexport { ModuleLoader };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* tslint:disable-next-line:max-line-length */\nimport { getValue, Event, NotifyPropertyChanges, Base, Property, isNullOrUndefined, isUndefined } from '@syncfusion/ej2-base';\nimport { BasicFormulas } from './../formulas/index';\nimport { getModules, ModuleLoader } from '../common/index';\nimport { CommonErrors, FormulasErrorsStrings } from '../common/enum';\nimport { Parser } from './parser';\n/**\n * Represents the calculate library.\n */\nvar Calculate = /** @class */ (function (_super) {\n    __extends(Calculate, _super);\n    /**\n     * Base constructor for creating Calculate library.\n     */\n    function Calculate(parent) {\n        var _this = _super.call(this, null, null) || this;\n        _this.lFormulas = new Map();\n        /** @hidden */\n        _this.storedData = new Map();\n        _this.keyToRowsMap = new Map();\n        _this.rowsToKeyMap = new Map();\n        /** @hidden */\n        _this.rightBracket = String.fromCharCode(161);\n        /** @hidden */\n        _this.leftBracket = String.fromCharCode(162);\n        /** @hidden */\n        _this.sheetToken = '!';\n        _this.emptyString = '';\n        _this.leftBrace = '{';\n        _this.rightBrace = '}';\n        _this.cell = _this.emptyString;\n        _this.cellPrefix = '!0!A';\n        _this.treatEmptyStringAsZero = false;\n        /** @hidden */\n        _this.tic = '\\\"';\n        /** @hidden */\n        _this.singleTic = '\\'';\n        /** @hidden */\n        _this.trueValue = 'TRUE';\n        /** @hidden */\n        _this.falseValue = 'FALSE';\n        _this.parseDecimalSeparator = '.';\n        /** @hidden */\n        _this.arithMarker = String.fromCharCode(180);\n        /** @hidden */\n        _this.arithMarker2 = _this.arithMarker + _this.arithMarker;\n        _this.dependentCells = null;\n        _this.dependentFormulaCells = null;\n        _this.minValue = Number.MIN_SAFE_INTEGER;\n        _this.maxValue = Number.MAX_SAFE_INTEGER;\n        _this.categoryCollection = ['All'];\n        _this.dependencyLevel = 0;\n        _this.refreshedCells = new Map();\n        _this.computedValues = null;\n        /** @hidden */\n        _this.randomValues = new Map();\n        /** @hidden */\n        _this.isRandomVal = false;\n        /** @hidden */\n        _this.randCollection = [];\n        /**\n         * @hidden\n         */\n        _this.formulaErrorStrings = [\n            'binary operators cannot start an expression',\n            'cannot parse',\n            'bad library',\n            'invalid char in front of',\n            'number contains 2 decimal points',\n            'expression cannot end with an operator',\n            'invalid characters following an operator',\n            'invalid character in number',\n            'mismatched parentheses',\n            'unknown formula name',\n            'requires a single argument',\n            'requires 3 arguments',\n            'invalid Math argument',\n            'requires 2 arguments',\n            '#NAME?',\n            'too complex',\n            'circular reference: ',\n            'missing formula',\n            'improper formula',\n            'invalid expression',\n            'cell empty',\n            'bad formula',\n            'empty expression',\n            '',\n            'mismatched string quotes',\n            'wrong number of arguments',\n            'invalid arguments',\n            'iterations do not converge',\n            'Control is already registered',\n            'Calculation overflow',\n            'Missing sheet',\n            'cannot_parse',\n            'expression_cannot_end_with_an_operator'\n        ];\n        _this.errorStrings = null;\n        _this.parseArgumentSeparator = ',';\n        _this.dateTime1900 = new Date(1900, 0, 1, 0, 0, 0);\n        _this.isParseDecimalSeparatorChanged = false;\n        _this.isArgumentSeparatorChanged = false;\n        _this.sheetFamilyID = 0;\n        _this.defaultFamilyItem = null;\n        _this.sheetFamiliesList = null;\n        _this.modelToSheetID = null;\n        /** @hidden */\n        _this.tokenCount = 0;\n        _this.sortedSheetNames = null;\n        _this.tempSheetPlaceHolder = String.fromCharCode(133);\n        /** @hidden */\n        _this.namedRanges = new Map();\n        _this.formulaInfoTable = null;\n        _this.oaDate = new Date(1899, 11, 30);\n        _this.millisecondsOfaDay = 24 * 60 * 60 * 1000;\n        _this.parseDateTimeSeparator = '/';\n        var moduleLoader = new ModuleLoader(_this);\n        if (_this.includeBasicFormulas) {\n            Calculate_1.Inject(BasicFormulas);\n        }\n        if (_this.injectedModules && _this.injectedModules.length) {\n            moduleLoader.inject(_this.requiredModules(), _this.injectedModules);\n        }\n        _this.parentObject = isNullOrUndefined(parent) ? _this : parent;\n        _this.grid = _this.parentObject;\n        _this.parser = new Parser(_this);\n        return _this;\n    }\n    Calculate_1 = Calculate;\n    Object.defineProperty(Calculate.prototype, \"libraryFormulas\", {\n        /* tslint:disable-next-line:no-any */\n        get: function () {\n            return this.lFormulas;\n        },\n        /* tslint:disable-next-line:no-any */\n        set: function (formulaColl) {\n            this.lFormulas.set(formulaColl.fName, { handler: formulaColl.handler, category: formulaColl.category, description: formulaColl.description });\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * To get the argument separator to split the formula arguments.\n     * @returns string\n     */\n    Calculate.prototype.getParseArgumentSeparator = function () {\n        var seperator = ',';\n        if (!this.isArgumentSeparatorChanged && seperator !== this.parseArgumentSeparator) {\n            this.parseArgumentSeparator = seperator;\n        }\n        return this.parseArgumentSeparator;\n    };\n    /**\n     * To set the argument separator to split the formula arguments.\n     * @param {string} value - Argument separator based on the culture.\n     * @returns void\n     */\n    Calculate.prototype.setParseArgumentSeparator = function (value) {\n        this.parseArgumentSeparator = value;\n        this.isArgumentSeparatorChanged = true;\n    };\n    /**\n     * To get the date separator to split the date value.\n     * @returns string\n     */\n    Calculate.prototype.getParseDateTimeSeparator = function () {\n        return this.parseDateTimeSeparator;\n    };\n    /**\n     * To set whether the empty string is treated as zero or not.\n     * @param {boolean} value\n     * @returns boolean\n     */\n    Calculate.prototype.setTreatEmptyStringAsZero = function (value) {\n        this.treatEmptyStringAsZero = value;\n    };\n    /**\n     * To get whether the empty string is treated as zero or not.\n     * @returns boolean\n     */\n    Calculate.prototype.getTreatEmptyStringAsZero = function () {\n        return this.treatEmptyStringAsZero;\n    };\n    /**\n     * To set the date separator to split the date value.\n     * @param {string} value - Argument separator based on the culture.\n     * @returns void\n     */\n    Calculate.prototype.setParseDateTimeSeparator = function (value) {\n        this.parseDateTimeSeparator = value;\n    };\n    /**\n     * To provide the array of modules needed.\n     * @hidden\n     */\n    Calculate.prototype.requiredModules = function () {\n        return getModules(this);\n    };\n    /**\n     * Dynamically injects the required modules to the library.\n     * @hidden\n     */\n    Calculate.Inject = function () {\n        var moduleList = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            moduleList[_i] = arguments[_i];\n        }\n        if (!this.prototype.injectedModules) {\n            this.prototype.injectedModules = [];\n        }\n        for (var j = 0; j < moduleList.length; j++) {\n            if (this.prototype.injectedModules.indexOf(moduleList[j]) === -1) {\n                this.prototype.injectedModules.push(moduleList[j]);\n            }\n        }\n    };\n    /**\n     * Get injected modules\n     * @hidden\n     */\n    Calculate.prototype.getInjectedModules = function () {\n        return this.injectedModules;\n    };\n    Calculate.prototype.onPropertyChanged = function (newProp, oldProp) {\n        /** code snippets */\n    };\n    Calculate.prototype.getModuleName = function () {\n        return 'calculate';\n    };\n    /** @hidden */\n    Calculate.prototype.getFormulaCharacter = function () {\n        return '=';\n    };\n    /** @hidden */\n    Calculate.prototype.isUpperChar = function (text) {\n        var charCode = text.charCodeAt(0);\n        return ((charCode > 64) && (charCode < 91));\n    };\n    Calculate.prototype.resetKeys = function () {\n        this.storedData.clear();\n        this.keyToRowsMap.clear();\n        this.rowsToKeyMap.clear();\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.updateDependentCell = function (cellRef) {\n        var family = this.getSheetFamilyItem(this.grid);\n        var cell = this.cell;\n        if (cell !== this.emptyString) {\n            if (family.sheetNameToParentObject !== null) {\n                var token = family.parentObjectToToken.get(this.grid);\n                if (cell.indexOf(this.sheetToken) === -1) {\n                    cell = token + cell;\n                }\n                if (cellRef.indexOf(this.sheetToken) === -1) {\n                    cellRef = token + cellRef;\n                }\n            }\n            if (this.getDependentCells().has(cellRef)) {\n                var formulaCells = this.getDependentCells().get(cellRef);\n                if (formulaCells.indexOf(cell) < 0) {\n                    formulaCells.push(cell);\n                }\n            }\n            else {\n                this.getDependentCells().set(cellRef, [cell]);\n            }\n            this.addToFormulaDependentCells(cellRef);\n        }\n    };\n    Calculate.prototype.addToFormulaDependentCells = function (cellRef) {\n        var cell1 = this.cell;\n        var family = this.getSheetFamilyItem(this.grid);\n        if (family.sheetNameToParentObject != null && cell1.indexOf(this.sheetToken) === -1) {\n            var token = family.parentObjectToToken.get(this.grid);\n            cell1 = token + cell1;\n        }\n        if (!this.getDependentFormulaCells().has(cell1)) {\n            this.getDependentFormulaCells().set(cell1, new Map());\n            this.getDependentFormulaCells().get(cell1).set(cellRef, cellRef);\n        }\n        else if (!(this.getDependentFormulaCells().get(cell1)).has(cellRef)) {\n            this.getDependentFormulaCells().get(cell1).set(cellRef, cellRef);\n        }\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.getDependentCells = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetDependentCells == null) {\n                family.sheetDependentCells = new Map();\n            }\n            return family.sheetDependentCells;\n        }\n        else {\n            if (this.dependentCells == null) {\n                this.dependentCells = new Map();\n            }\n            return this.dependentCells;\n        }\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.getDependentFormulaCells = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetDependentFormulaCells == null) {\n                family.sheetDependentFormulaCells = new Map();\n            }\n            return family.sheetDependentFormulaCells;\n        }\n        else {\n            if (this.dependentFormulaCells == null) {\n                this.dependentFormulaCells = new Map();\n            }\n            return this.dependentFormulaCells;\n        }\n    };\n    /**\n     * To get library formulas collection.\n     * @returns Map<string, Function>\n     */\n    Calculate.prototype.getLibraryFormulas = function () {\n        return this.lFormulas;\n    };\n    /**\n     * To get library function.\n     * @param {string} libFormula - Library formula to get a corresponding function.\n     * @returns Function\n     */\n    Calculate.prototype.getFunction = function (libFormula) {\n        if (this.getLibraryFormulas().has(libFormula.toUpperCase())) {\n            return this.getLibraryFormulas().get(libFormula.toUpperCase()).handler;\n        }\n        else {\n            return null;\n        }\n    };\n    /** @hidden */\n    Calculate.prototype.intToDate = function (val) {\n        var dateVal = Number(val);\n        dateVal = (dateVal > 0 && dateVal < 1) ? (1 + dateVal) : (dateVal === 0) ? 1 : dateVal;\n        if (dateVal > 60) {\n            dateVal -= 1; // Due to leap year issue of 1900 in MSExcel.\n        }\n        return new Date(((dateVal - 1) * (1000 * 3600 * 24)) + new Date('01/01/1900').getTime());\n    };\n    Calculate.prototype.getFormulaInfoTable = function () {\n        if (this.isSheetMember()) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (family.sheetFormulaInfotable === null) {\n                family.sheetFormulaInfotable = new Map();\n            }\n            return family.sheetFormulaInfotable;\n        }\n        else {\n            if (this.formulaInfoTable === null) {\n                this.formulaInfoTable = new Map();\n            }\n            return this.formulaInfoTable;\n        }\n    };\n    /**\n     * To get the formula text.\n     * @private\n     */\n    Calculate.prototype.getFormula = function (key) {\n        key = key.toUpperCase();\n        if (this.storedData.has(key)) {\n            return this.storedData.get(key).getFormulaText();\n        }\n        return '';\n    };\n    /**\n     * To get the formula text.\n     * @returns void\n     */\n    Calculate.prototype.getParseDecimalSeparator = function () {\n        var seperator = '.';\n        if (!this.isParseDecimalSeparatorChanged && seperator !== this.parseDecimalSeparator) {\n            this.parseDecimalSeparator = seperator;\n        }\n        return this.parseDecimalSeparator;\n    };\n    /**\n     * To get the formula text.\n     * @param {string} value - Specifies the decimal separator value.\n     * @returns void\n     */\n    Calculate.prototype.setParseDecimalSeparator = function (value) {\n        this.parseDecimalSeparator = value;\n        this.isParseDecimalSeparatorChanged = true;\n    };\n    /** @hidden */\n    Calculate.prototype.getSheetToken = function (cellRef) {\n        var i = 0;\n        var temp = this.emptyString;\n        if (i < cellRef.length && cellRef[i] === this.sheetToken) {\n            i++;\n            while (i < cellRef.length && cellRef[i] !== this.sheetToken) {\n                i++;\n            }\n            temp = cellRef.substring(0, i + 1);\n        }\n        if (i < cellRef.length) {\n            return temp;\n        }\n        throw this.formulaErrorStrings[FormulasErrorsStrings.bad_index];\n    };\n    /** @hidden */\n    Calculate.prototype.getSheetID = function (grd) {\n        var family = this.getSheetFamilyItem(grd);\n        if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.size > 0) {\n            var token = family.parentObjectToToken.get(grd);\n            token = token.split(this.sheetToken).join(this.emptyString);\n            var id = this.parseFloat(token);\n            if (!this.isNaN(id)) {\n                return id;\n            }\n        }\n        return -1;\n    };\n    /** @hidden */\n    Calculate.prototype.parseFloat = function (value) {\n        return Number(value);\n    };\n    /**\n     * To get the row index of the given cell.\n     * @param {string} cell - Cell address for getting row index.\n     * @returns number\n     */\n    Calculate.prototype.rowIndex = function (cell) {\n        var i = 0;\n        var result;\n        var isLetter = false;\n        if (i < cell.length && cell[i] === this.sheetToken) {\n            i++;\n            while (i < cell.length && cell[i] !== this.sheetToken) {\n                i++;\n            }\n            i++;\n        }\n        while (i < cell.length && this.isChar(cell[i])) {\n            isLetter = true;\n            i++;\n        }\n        result = parseInt(cell.substring(i), 10);\n        if (i < cell.length && !this.isNaN(result)) {\n            return result;\n        }\n        if (isLetter) {\n            return -1;\n        }\n        throw this.formulaErrorStrings[FormulasErrorsStrings.bad_index];\n    };\n    /**\n     * To get the column index of the given cell.\n     * @param {string} cell - Cell address for getting column index.\n     * @returns number\n     */\n    Calculate.prototype.colIndex = function (cell) {\n        var j = 0;\n        var k = 0;\n        cell = cell.toUpperCase();\n        if (j < cell.length && cell[j] === this.sheetToken) {\n            j++;\n            while (j < cell.length && cell[j] !== this.sheetToken) {\n                j++;\n            }\n            j++;\n        }\n        while (j < cell.length && this.isChar(cell[j])) {\n            var charCode = cell[j].charCodeAt(0);\n            k = k * 26 + charCode - 64;\n            j++;\n        }\n        if (k === 0) {\n            return -1;\n        }\n        return k;\n    };\n    /**\n     * To get the valid error strings.\n     * @hidden\n     */\n    Calculate.prototype.getErrorStrings = function () {\n        if (this.errorStrings === null) {\n            this.errorStrings = ['#N/A', '#VALUE!', '#REF!', '#DIV/0!', '#NUM!', '#NAME?', '#NULL!'];\n        }\n        return this.errorStrings;\n    };\n    /** @hidden */\n    Calculate.prototype.substring = function (text, startIndex, length) {\n        return text.substring(startIndex, length + startIndex);\n    };\n    /** @hidden */\n    Calculate.prototype.isChar = function (c) {\n        if ((c.charCodeAt(0) >= 65 && c.charCodeAt(0) <= 90) || (c.charCodeAt(0) >= 97 && c.charCodeAt(0) <= 122)) {\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.getSheetFamilyItem = function (model) {\n        if (this.sheetFamilyID === 0) {\n            if (this.defaultFamilyItem == null) {\n                this.defaultFamilyItem = new CalcSheetFamilyItem();\n            }\n            return this.defaultFamilyItem;\n        }\n        if (this.sheetFamiliesList == null) {\n            this.sheetFamiliesList = new Map();\n        }\n        var i = this.modelToSheetID.get(model);\n        if (!this.sheetFamiliesList.has(i)) {\n            this.sheetFamiliesList.set(i, new CalcSheetFamilyItem());\n        }\n        return this.sheetFamiliesList.get(i);\n    };\n    /**\n     * Register a key value pair for formula.\n     * @param {string} key - Key for formula reference .\n     * @param {string | number} value - Value for the corresponding key.\n     * @returns void\n     */\n    Calculate.prototype.setKeyValue = function (key, value) {\n        key = key.toUpperCase();\n        var str = value.toString().trim();\n        if (!this.storedData.get(key) || str.indexOf(this.leftBrace) === 0) {\n            this.storedData.set(key, new FormulaInfo());\n            this.keyToRowsMap.set(key, this.keyToRowsMap.size + 1);\n            this.rowsToKeyMap.set(this.rowsToKeyMap.size + 1, key);\n        }\n        var fInfo = this.storedData.get(key);\n        if (fInfo.getFormulaText() != null && fInfo.getFormulaText().length > 0 && fInfo.getFormulaText() !== str) {\n            var s1 = this.cellPrefix + this.keyToRowsMap.get(key).toString();\n            var formulaDependent = this.getDependentFormulaCells().get(s1);\n            if (formulaDependent != null) {\n                this.clearFormulaDependentCells(s1);\n            }\n        }\n        if (str.length > 0 && str[0] === this.getFormulaCharacter()) {\n            fInfo.setFormulaText(str);\n        }\n        else if (fInfo.getFormulaValue() !== str) {\n            fInfo.setFormulaText('');\n            fInfo.setParsedFormula('');\n            fInfo.setFormulaValue(str);\n        }\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.clearFormulaDependentCells = function (cell) {\n        var _this = this;\n        var dependentFormula = this.getDependentFormulaCells().get(cell);\n        if (dependentFormula != null) {\n            dependentFormula.forEach(function (value, key) {\n                var s = key;\n                var dependent = _this.getDependentCells().get(s);\n                _this.arrayRemove(dependent, cell);\n                if (dependent.length === 0) {\n                    _this.getDependentCells().delete(s);\n                }\n            });\n            this.getDependentFormulaCells().delete(cell);\n        }\n    };\n    Calculate.prototype.arrayRemove = function (array, value) {\n        var index = array.indexOf(value);\n        if (index !== -1) {\n            array.splice(index, 1);\n        }\n        return array;\n    };\n    /**\n     * Register a key value pair for formula.\n     * @param {string} key - Key for getting the corresponding value.\n     * @returns string | number\n     */\n    Calculate.prototype.getKeyValue = function (key) {\n        key = key.toUpperCase();\n        if (this.storedData.has(key) !== null) {\n            var fInfo = this.storedData.get(key);\n            var fText = fInfo.getFormulaText();\n            if (fText.length > 0 && fText[0] === this.getFormulaCharacter()) {\n                this.cell = this.cellPrefix + this.keyToRowsMap.get(key).toString();\n                fText = fText.substring(1);\n                try {\n                    fInfo.setParsedFormula(this.parser.parseFormula(fText, key));\n                }\n                catch (ex) {\n                    var args = {\n                        message: ex.message, exception: ex, isForceCalculable: false,\n                        computeForceCalculate: false\n                    };\n                    this.trigger('onFailure', args);\n                    fInfo.setFormulaValue(args.message);\n                    return this.storedData.get(key).getFormulaValue();\n                }\n                try {\n                    fInfo.setFormulaValue(this.computeFormula(fInfo.getParsedFormula()));\n                }\n                catch (ex) {\n                    var args = {\n                        message: ex.message, exception: ex, isForceCalculable: false,\n                        computeForceCalculate: false\n                    };\n                    this.trigger('onFailure', args);\n                    var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n                    return (isNullOrUndefined(this.getErrorLine(ex)) ? '' : '#' + this.getErrorLine(ex) + ': ') + errorMessage;\n                }\n            }\n            return this.storedData.get(key).getFormulaValue();\n        }\n        else {\n            return this.emptyString;\n        }\n    };\n    Calculate.prototype.getNamedRanges = function () {\n        return this.namedRanges;\n    };\n    /**\n     * Adds a named range to the NamedRanges collection.\n     * @param {string} name - Name of the named range.\n     * @param {string} range - Range for the specified name.\n     * @param {number} sheetIndex - Defined scope for the specified name. Default - Workbook scope.\n     * @returns boolean\n     */\n    Calculate.prototype.addNamedRange = function (name, range) {\n        var sheetScopeName = name.split(this.sheetToken);\n        if (sheetScopeName.length > 1) {\n            var family = this.getSheetFamilyItem(this.grid);\n            if (!family.parentObjectToToken.get(sheetScopeName[0])) {\n                return false;\n            }\n            name = sheetScopeName[0] + this.sheetToken + sheetScopeName[1].toUpperCase();\n        }\n        else {\n            name = name.toUpperCase();\n        }\n        this.namedRanges.set(name, range);\n        return true;\n    };\n    /**\n     * Remove the specified named range form the named range collection.\n     * @param {string} name - Name of the specified named range.\n     * @returns boolean\n     */\n    Calculate.prototype.removeNamedRange = function (name) {\n        name = name.toUpperCase();\n        if (this.namedRanges.get(name) != null) {\n            this.namedRanges.delete(name);\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.convertAlpha = function (col) {\n        var arrCol = [];\n        var n = 0;\n        var charText = 'A';\n        while (col > 0) {\n            col--;\n            var aCharValue = charText.charCodeAt(0);\n            arrCol[n] = String.fromCharCode(col % 26 + aCharValue);\n            col = parseInt((col / 26).toString(), 10);\n            n++;\n        }\n        var arr = [];\n        for (var i = 0; i < n; i++) {\n            arr[n - i - 1] = arrCol[i];\n        }\n        return arr.join('');\n    };\n    /** @hidden */\n    Calculate.prototype.getCellCollection = function (cellRange) {\n        if (cellRange.indexOf(':') < 0) {\n            if (!this.isCellReference(cellRange)) {\n                return cellRange.split(this.getParseArgumentSeparator());\n            }\n            else {\n                cellRange = cellRange + ':' + cellRange;\n            }\n        }\n        var token = this.emptyString;\n        var sheetTokenIndex = cellRange.indexOf(this.sheetToken);\n        if (sheetTokenIndex > -1) {\n            var index = sheetTokenIndex;\n            var s = index + 1;\n            while (s < cellRange.length) {\n                if (cellRange[s] === this.sheetToken) {\n                    token = cellRange.substr(0, s + 1);\n                    break;\n                }\n                s++;\n            }\n        }\n        var i = cellRange.indexOf(':');\n        var row1;\n        var row2;\n        var col1;\n        var col2;\n        if (i > 0 && this.isChar(cellRange[i - 1])) {\n            var k = i - 2;\n            while (k >= 0 && this.isDigit(cellRange[k])) {\n                k--;\n            }\n        }\n        row1 = this.rowIndex(this.substring(cellRange, 0, i));\n        row2 = this.rowIndex(this.substring(cellRange, i + 1, i + cellRange.length - i - 1));\n        col1 = this.colIndex(this.substring(cellRange, 0, i));\n        col2 = this.colIndex(this.substring(cellRange, i + 1, i + cellRange.length - i - 1));\n        if (row1 > row2) {\n            i = row2;\n            row2 = row1;\n            row1 = i;\n        }\n        if (col1 > col2) {\n            i = col2;\n            col2 = col1;\n            col1 = i;\n        }\n        var cells = [];\n        var j;\n        var c = 0;\n        for (i = row1; i <= row2; i++) {\n            for (j = col1; j <= col2; j++) {\n                cells[c] = token + this.emptyString + this.convertAlpha(j) + i.toString();\n                c++;\n            }\n        }\n        return cells;\n    };\n    /**\n     * Compute the given formula.\n     * @param {string} formulaText - Specifies to compute the given formula.\n     * @returns string | number\n     */\n    Calculate.prototype.computeFormula = function (formulaText) {\n        var parsedText;\n        var lastIndexOfq;\n        var formulatResult;\n        var nestedFormula = false;\n        var fNested;\n        if (this.parser.isError) {\n            return formulaText;\n        }\n        if (!this.parser.isFormulaParsed) {\n            parsedText = this.parser.parseFormula(formulaText);\n        }\n        else {\n            parsedText = formulaText;\n        }\n        this.parser.isFormulaParsed = false;\n        try {\n            lastIndexOfq = this.findLastIndexOfq(parsedText);\n            if (lastIndexOfq > 0) {\n                nestedFormula = true;\n            }\n            if (parsedText !== this.emptyString && lastIndexOfq > -1) {\n                var i = lastIndexOfq + 1;\n                while (i > -1) {\n                    if (parsedText[i] !== this.rightBracket) {\n                        i++;\n                        continue;\n                    }\n                    var sFormula = parsedText.substring(lastIndexOfq, i + 1);\n                    var libFormula = sFormula.split(this.leftBracket)[0].split('q').join(this.emptyString);\n                    var args = sFormula.substring(sFormula.indexOf(this.leftBracket) + 1, sFormula.indexOf(this.rightBracket))\n                        .split(this.getParseArgumentSeparator());\n                    if (this.getLibraryFormulas().get(libFormula.toUpperCase()).isCustom) {\n                        var j = 0;\n                        var customArgs = [];\n                        for (j = 0; j < args.length; j++) {\n                            customArgs.push(this.getValueFromArg(args[j]));\n                        }\n                        args = customArgs;\n                    }\n                    formulatResult = isNullOrUndefined(this.getFunction(libFormula)) ? this.getErrorStrings()[CommonErrors.name] : this.getFunction(libFormula).apply(void 0, args);\n                    if (nestedFormula) {\n                        fNested = this.processNestedFormula(parsedText, sFormula, formulatResult);\n                        var q = this.findLastIndexOfq(fNested);\n                        if (q === 0) {\n                            nestedFormula = false;\n                        }\n                        if (q === -1) {\n                            formulatResult = this.computeValue(fNested);\n                        }\n                        lastIndexOfq = i = q;\n                        parsedText = fNested;\n                        continue;\n                    }\n                    break;\n                }\n            }\n            else if (this.formulaErrorStrings.indexOf(parsedText) > -1) {\n                formulatResult = parsedText;\n            }\n            else if (parsedText !== this.emptyString && lastIndexOfq === -1) {\n                formulatResult = this.computeValue(parsedText);\n            }\n        }\n        catch (ex) {\n            var args = { message: ex.message, exception: ex, isForceCalculable: false, computeForceCalculate: false };\n            this.trigger('onFailure', args);\n            var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n            formulatResult = (isNullOrUndefined(this.getErrorLine(ex)) ? '' : '#' + this.getErrorLine(ex) + ': ') + errorMessage;\n        }\n        return formulatResult;\n    };\n    /** @hidden */\n    Calculate.prototype.computeSumIfAndAvgIf = function (range) {\n        if (isNullOrUndefined(range) || range[0] === this.emptyString || range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = range;\n        for (var i = 0; i < argArr.length; i++) {\n            if (this.isCellReference(argArr[i]) && isNullOrUndefined(argArr[i].match(/[0-9]/)) && argArr[i].indexOf('!') < 0) {\n                var splitArray = argArr[i].split(':');\n                argArr[i] = splitArray[0] + '1' + ':' + splitArray[1] + this.spreadSheetUsedRange[0];\n            }\n        }\n        var argCount = argArr.length;\n        if (argCount !== 2 && argCount !== 3 && argCount === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var rangevalue = argArr[0];\n        var criteria = argArr[1].trim();\n        criteria = criteria.split(this.tic).join(this.emptyString);\n        if (criteria.length > 255) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        criteria = this.isCellReference(criteria) ? this.getValueFromArg(criteria) : criteria;\n        var opt = this.parser.tokenEqual;\n        if (criteria.startsWith('<=')) {\n            opt = this.parser.tokenLessEq;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('>=')) {\n            opt = this.parser.tokenGreaterEq;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('<>')) {\n            opt = this.parser.tokenNotEqual;\n            criteria = criteria.substring(2);\n        }\n        else if (criteria.startsWith('<')) {\n            opt = this.parser.tokenLess;\n            criteria = criteria.substring(1);\n        }\n        else if (criteria.startsWith('>')) {\n            opt = this.parser.tokenGreater;\n            criteria = criteria.substring(1);\n        }\n        else if (criteria.startsWith('=')) {\n            opt = this.parser.tokenEqual;\n            criteria = criteria.substring(1);\n        }\n        var checkCriteria = this.parseFloat(criteria);\n        var criteriaRangeArray = argArr[0];\n        var sumRange = this.getCellCollection(argCount > 2 ? argArr[2] : rangevalue);\n        var criteriaRange = this.getCellCollection(criteriaRangeArray);\n        var result = this.getComputeSumIfValue(criteriaRange, sumRange, criteria, checkCriteria, opt);\n        return [result[0], result[1]];\n    };\n    /** @hidden */\n    Calculate.prototype.computeLookup = function (range) {\n        if (range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var checkCrte = [];\n        var findMaxVal = [];\n        var argArr = range;\n        var argCount = argArr.length;\n        var criterias = argArr[0].split(this.tic).join(this.emptyString);\n        var rangevalue = argArr[1];\n        var lookupRangeArray = argCount === 2 ? rangevalue : argArr[2];\n        var criteriaRange = this.getCellCollection(argArr[1]);\n        var lookupRange = this.getCellCollection(lookupRangeArray);\n        for (var i = 0; i < criteriaRange.length; i++) {\n            findMaxVal[i] = this.getValueFromArg(criteriaRange[i]).split(this.tic).join('');\n        }\n        var s = findMaxVal.toString().split(this.getParseArgumentSeparator());\n        var maxVal = this.parseFloat(s[s.sort().length - 1]);\n        var minVal = this.parseFloat(s[0]);\n        for (var j = 0; j < criteriaRange.length; j++) {\n            checkCrte[j] = this.getValueFromArg(criteriaRange[j]).split(this.tic).join('');\n            if (criterias === checkCrte[j]) {\n                return this.getValueFromArg(lookupRange[j]).split(this.tic).join('');\n            }\n            else if (this.parseFloat(criterias) === this.parseFloat(checkCrte[j])) {\n                return this.getValueFromArg(lookupRange[j]).split(this.tic).join('');\n            }\n            else if (this.parseFloat(criterias) < minVal) {\n                return this.getErrorStrings()[CommonErrors.na];\n            }\n            else if (this.parseFloat(criterias) > maxVal) {\n                var index = findMaxVal.indexOf(maxVal.toString());\n                return this.getValueFromArg(lookupRange[index]).split(this.tic).join('');\n            }\n        }\n        if (findMaxVal.indexOf(criterias) < 0) {\n            var temp = [];\n            for (var n = 0; n < s.length; n++) {\n                if (this.parseFloat(criterias) > this.parseFloat(s[n])) {\n                    temp.push(s[n]);\n                }\n            }\n            var index = findMaxVal.indexOf(temp[temp.length - 1]);\n            return this.getValueFromArg(lookupRange[index]).split(this.tic).join('');\n        }\n        return this.getErrorStrings()[CommonErrors.na];\n    };\n    Calculate.prototype.computeVLookup = function (range) {\n        var argArr = range;\n        var findMaxValue = [];\n        var lookupValue = argArr[0].split(this.tic).join('');\n        if (lookupValue.indexOf(':') > -1) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        if (this.isCellReference(lookupValue)) {\n            lookupValue = this.getValueFromArg(lookupValue);\n        }\n        if (argArr[1].indexOf(':') < -1) {\n            return this.getErrorStrings()[CommonErrors.na];\n        }\n        var lookupRange = [];\n        var firstCol = '';\n        var secCol = '';\n        if (this.isCellReference(argArr[1])) {\n            lookupRange = this.getCellCollection(argArr[1]);\n            if (argArr[1].indexOf(':') > -1) {\n                var index = argArr[1].indexOf(':');\n                for (var i = 0; i < index; i++) {\n                    var tempCell = this.isChar(argArr[1][i]) ? argArr[1][i] : '';\n                    firstCol = firstCol + tempCell;\n                }\n                for (var j = index; j < argArr[1].length; j++) {\n                    var tempCell2 = this.isChar(argArr[1][j]) ? argArr[1][j] : '';\n                    secCol = secCol + tempCell2;\n                }\n            }\n        }\n        var lookupCol = this.colIndex(firstCol) + this.parseFloat(argArr[2]);\n        if (lookupCol > this.colIndex(secCol)) {\n            return this.getErrorStrings()[CommonErrors.na];\n        }\n        if (lookupCol === this.colIndex(firstCol)) {\n            return this.getErrorStrings()[CommonErrors.na];\n        }\n        var lookupCell = this.convertAlpha(lookupCol);\n        argArr[3] = isNullOrUndefined(argArr[3]) ? this.trueValue : argArr[3].split(this.tic).join('');\n        var cellValue = '';\n        for (var i = 0; i < lookupRange.length; i++) {\n            findMaxValue[i] = this.getValueFromArg(lookupRange[i]).split(this.tic).join('');\n        }\n        var s = findMaxValue.toString().split(this.getParseArgumentSeparator());\n        var maxValue = this.parseFloat(s[s.sort().length - 1]);\n        var minValue = this.parseFloat(s[0]);\n        for (var j = 0; j < lookupRange.length; j++) {\n            cellValue = this.getValueFromArg(lookupRange[j]);\n            if (argArr[3].toUpperCase() === this.trueValue) {\n                if (lookupValue === cellValue) {\n                    return this.getValueFromArg(lookupCell + j).split(this.tic).join('');\n                }\n                else if (this.parseFloat(lookupValue) === this.parseFloat(cellValue)) {\n                    return this.getValueFromArg(lookupCell + j).split(this.tic).join('');\n                }\n                else if (this.parseFloat(lookupValue) < minValue) {\n                    return this.getErrorStrings()[CommonErrors.na];\n                }\n                else if (this.parseFloat(lookupValue) > maxValue) {\n                    var index = findMaxValue.indexOf(maxValue.toString());\n                    return this.getValueFromArg(lookupCell + index).split(this.tic).join('');\n                }\n            }\n            if (argArr[3] === this.falseValue) {\n                if (lookupValue === cellValue) {\n                    return this.getValueFromArg(lookupCell + j);\n                }\n            }\n        }\n        return this.getErrorStrings()[CommonErrors.na];\n    };\n    Calculate.prototype.findWildCardValue = function (lookVal, cellValue) {\n        var finalText = '';\n        if (lookVal.indexOf('?') > -1) {\n            var index = lookVal.indexOf('?');\n            var checStr1 = lookVal[index - 1];\n            var checStr2 = lookVal[index + 1];\n            if (cellValue.indexOf(checStr1) > -1 && cellValue.indexOf(checStr2) > -1) {\n                var newIndex = cellValue.indexOf(checStr1);\n                if (cellValue[newIndex] === checStr1 && cellValue[newIndex + 2] === checStr2) {\n                    finalText = lookVal;\n                }\n                else {\n                    finalText = cellValue;\n                }\n            }\n            else {\n                finalText = cellValue;\n            }\n        }\n        else if (lookVal.indexOf('*') > -1) {\n            var index = lookVal.indexOf('*');\n            var left = '';\n            var right = '';\n            var compRight = this.falseValue;\n            var compLeft = this.falseValue;\n            for (var i = index - 1; i >= 0; i--) {\n                left = left + lookVal[i];\n                compLeft = this.trueValue;\n            }\n            for (var i = index + 1; i < lookVal.length; i++) {\n                right = right + lookVal[i];\n                compRight = this.trueValue;\n            }\n            var leftVal = left === '' ? -1 : cellValue.indexOf(left.split('').reverse().join(''));\n            var rightVal = right === '' ? -1 : cellValue.indexOf(right);\n            if (leftVal > -1 || rightVal > -1) {\n                if (compLeft === this.trueValue) {\n                    finalText = (left.split('').reverse().join('') === cellValue.substr(0, left.length)) ? lookVal : cellValue;\n                }\n                else if (compRight === this.trueValue) {\n                    finalText = (right === cellValue.substring(cellValue.length - right.length, cellValue.length)) ? lookVal : cellValue;\n                }\n            }\n            else {\n                finalText = cellValue;\n            }\n        }\n        return finalText;\n    };\n    /** @hidden */\n    /* tslint:disable-next-line */\n    Calculate.prototype.getComputeSumIfValue = function (criteriaRange, sumRange, criteria, checkCriteria, op) {\n        var sum = 0;\n        var count = 0;\n        switch (op) {\n            case this.parser.tokenEqual:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (value === criteria && val === checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                        else if (value === criteria) {\n                            var sumRangeVal = sumRange[i];\n                            sumRangeVal = this.getValueFromArg(sumRangeVal);\n                            sum = this.parseFloat(sumRangeVal.toString());\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenLess:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val < checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenGreater:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val > checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenLessEq:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val <= checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenGreaterEq:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (val >= checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n            case this.parser.tokenNotEqual:\n                {\n                    for (var i = 0; i < criteriaRange.length; i++) {\n                        var value = this.getValueFromArg(criteriaRange[i].split(this.tic).join(''));\n                        var val = this.parseFloat(value);\n                        if (value !== criteria && val !== checkCriteria) {\n                            var value1 = this.getValueFromArg(sumRange[i].split(this.tic).join(''));\n                            var val1 = this.parseFloat(value1);\n                            sum = sum + val1;\n                            count = count + 1;\n                        }\n                    }\n                }\n                break;\n        }\n        return [sum, count];\n    };\n    /** @hidden */\n    Calculate.prototype.computeAndOr = function (args, op) {\n        var result = op === 'and' ? true : false;\n        var value;\n        var parseVal;\n        if (args.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var l = 0, len = args.length; l < len; l++) {\n            if (args[l].split(this.tic).join('').trim() === this.emptyString) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var ranges = args;\n        for (var i = 0; i < ranges.length; i++) {\n            if (ranges[i] === (this.tic)) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n            if (ranges[i].indexOf(':') > -1 && this.isCellReference(ranges[i])) {\n                var cells = this.getCellCollection(ranges[i]);\n                for (var j = 0; j < cells.length; j++) {\n                    if (this.getErrorStrings().indexOf(cells[j]) > -1) {\n                        return cells[j];\n                    }\n                    else if (cells[j][0] === this.tic) {\n                        return this.getErrorStrings()[CommonErrors.name];\n                    }\n                    value = this.getValueFromArg(cells[j]);\n                    if (value === '') {\n                        value = this.trueValue;\n                    }\n                    if (this.getErrorStrings().indexOf(value) > -1) {\n                        return value;\n                    }\n                    parseVal = this.parseFloat(value);\n                }\n            }\n            else {\n                value = this.getValueFromArg(ranges[i]).split(this.tic).join('').toUpperCase();\n                if (this.getErrorStrings().indexOf(value) > -1) {\n                    return value;\n                }\n                var tempdate = Date.parse(value.split(this.tic).join(''));\n                if (!isNaN(tempdate)) {\n                    result = true;\n                }\n                else if (!(value === this.trueValue || value === this.falseValue)) {\n                    return this.getErrorStrings()[CommonErrors.value].toString();\n                }\n                parseVal = this.parseFloat(value);\n            }\n            result = op === 'and' ? (result && ((value === this.trueValue) || !(isNaN(parseVal)))) :\n                (result || ((value === this.trueValue) || !(isNaN(parseVal))));\n        }\n        return result ? this.trueValue : this.falseValue;\n    };\n    /** @hidden */\n    // To strip out the tic from the formula arguments.\n    Calculate.prototype.removeTics = function (text) {\n        if (text.length > 1 && text[0] === this.tic[0] && text[text.length - 1] === this.tic[0]) {\n            text = this.substring(text, 1, text.length - 2);\n        }\n        return text;\n    };\n    /** @hidden */\n    Calculate.prototype.getCellFrom = function (range) {\n        var cellRange = '';\n        var cells = range.indexOf(':') > -1 ? range.split(':') : [range];\n        //this.getCellsFromArgs(range);\n        var last = cells.length - 1;\n        var r1 = this.rowIndex(cells[0]);\n        var x;\n        if (r1 === this.rowIndex(cells[last])) {\n            var c1 = this.colIndex(cells[0]);\n            var c2 = this.colIndex(cells[last]);\n            var c = this.colIndex(this.cell);\n            if (c >= c1 && c <= c2) {\n                cellRange = getAlphalabel(c).toString() + r1.toString();\n            }\n        }\n        else if (this.colIndex(cells[0]) === this.colIndex(cells[last])) {\n            x = this.colIndex(cells[0]);\n            var r2 = this.rowIndex(cells[last]);\n            var r = this.rowIndex(this.cell);\n            if (r >= r1 && r <= r2) {\n                cellRange = getAlphalabel(x).toString() + r.toString();\n            }\n        }\n        return cellRange;\n    };\n    /* tslint:disable-next-line:max-func-body-length */\n    Calculate.prototype.computeValue = function (pFormula) {\n        try {\n            var stack = [];\n            var i = 0;\n            var sheet = '';\n            stack.length = 0;\n            while (i < pFormula.length) {\n                var uFound = pFormula[i] === 'u'; // for 3*-2\n                if (pFormula[i] === this.arithMarker) {\n                    i = i + 1;\n                    continue;\n                }\n                else if (this.isDigit(pFormula[i])) {\n                    var s = this.emptyString;\n                    while (i < pFormula.length && (this.isDigit(pFormula[i]) || pFormula[i] === this.parseDecimalSeparator)) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s);\n                }\n                if (pFormula[i] === this.sheetToken) {\n                    sheet = pFormula[i];\n                    i = i + 1;\n                    while (i < pFormula.length && pFormula[i] !== this.sheetToken) {\n                        sheet = sheet + pFormula[i];\n                        i = i + 1;\n                    }\n                    if (i < pFormula.length) {\n                        sheet = sheet + pFormula[i];\n                        i = i + 1;\n                    }\n                }\n                else if (this.isUpperChar(pFormula[i])) {\n                    var s = this.emptyString;\n                    var textName = '';\n                    while (i < pFormula.length && this.isUpperChar(pFormula[i])) {\n                        var char = pFormula[i];\n                        s = s + char;\n                        i = i + 1;\n                    }\n                    while (i < pFormula.length && this.isDigit(pFormula[i])) {\n                        var digit = pFormula[i];\n                        s = s + digit;\n                        i = i + 1;\n                    }\n                    if (i < pFormula.length && pFormula[i] === ':') {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                        if (i < pFormula.length && pFormula[i] === this.sheetToken) {\n                            s = s + pFormula[i];\n                            i = i + 1;\n                            while (i < pFormula.length && pFormula[i] !== this.sheetToken) {\n                                s = s + pFormula[i];\n                                i = i + 1;\n                            }\n                        }\n                        while (i < pFormula.length && this.isUpperChar(pFormula[i])) {\n                            s = s + pFormula[i];\n                            i = i + 1;\n                        }\n                        while (i < pFormula.length && this.isDigit(pFormula[i])) {\n                            s = s + pFormula[i];\n                            i = i + 1;\n                        }\n                        s = sheet + this.getCellFrom(s);\n                    }\n                    else {\n                        s = sheet + s;\n                    }\n                    textName = this.getParentObjectCellValue(s).toString();\n                    if (typeof textName === 'string' && this.getErrorStrings().indexOf(textName) > -1) {\n                        return textName;\n                    }\n                    stack.push(textName);\n                }\n                else if (pFormula[i] === 'q') {\n                    var leftIdx = pFormula.substring(i + 1).indexOf(this.leftBracket);\n                    var j = pFormula.substring(i + leftIdx + 1).indexOf(this.rightBracket);\n                    pFormula = this.substring(pFormula, i + leftIdx + 2, j - 1);\n                }\n                else if (pFormula[i] === this.tic[0]) {\n                    var s = pFormula[i].toString();\n                    i = i + 1;\n                    while (i < pFormula.length && pFormula[i] !== this.tic[0]) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s.split(this.tic).join(this.emptyString));\n                    i = i + 1;\n                }\n                else if (pFormula[i] === '%' && stack.length > 0) {\n                    var stackValue = stack[0];\n                    var value = this.parseFloat(stackValue);\n                    if (!this.isNaN(value)) {\n                        stack.pop();\n                        stack.push((value / 100).toString());\n                    }\n                    i = i + 1;\n                }\n                else if ((pFormula.substring(i)).indexOf(this.trueValue) === 0) {\n                    stack.push(this.trueValue);\n                    i += this.trueValue.length;\n                }\n                else if (pFormula.substring(i).indexOf(this.falseValue) === 0) {\n                    stack.push(this.falseValue);\n                    i += this.falseValue.length;\n                }\n                else if (pFormula[i] === this.tic[0] || pFormula[i] === '|') {\n                    var s = pFormula[i].toString();\n                    i++;\n                    while (i < pFormula.length && pFormula[i] !== this.tic[0]) {\n                        s = s + pFormula[i];\n                        i = i + 1;\n                    }\n                    stack.push(s + this.tic);\n                    i += 1;\n                }\n                else {\n                    switch (pFormula[i]) {\n                        case '#':\n                            {\n                                var errIndex = 0;\n                                if (this.getErrorStrings().indexOf(pFormula.substring(i)) > -1) {\n                                    if (pFormula.indexOf('!') === -1 || pFormula.substring(i).indexOf('!') === -1) {\n                                        errIndex = pFormula.indexOf('#N/A') > -1 ?\n                                            (pFormula.indexOf('#N/A') + 4 + i) : pFormula.indexOf('?') + 1 + i;\n                                    }\n                                    else {\n                                        errIndex = pFormula.indexOf('!') + 1 + i;\n                                    }\n                                    stack.push(this.substring(pFormula, i, errIndex - i));\n                                }\n                                else {\n                                    errIndex = i + 1;\n                                    stack.push(this.substring(pFormula, i, errIndex - i));\n                                }\n                                i = errIndex;\n                            }\n                            break;\n                        case 'n':\n                            {\n                                i = i + 1;\n                                var s = '';\n                                if (pFormula.substring(i).indexOf('Infinity') === 0) {\n                                    s = 'Infinity';\n                                    i += s.length;\n                                }\n                                else {\n                                    if (pFormula[i] === 'u' || uFound) {\n                                        s = '-';\n                                        if (!uFound) {\n                                            i = i + 1;\n                                        }\n                                        else {\n                                            uFound = false;\n                                        }\n                                    }\n                                    while (i < pFormula.length && (this.isDigit(pFormula[i]))\n                                        || pFormula[i] === this.getParseDecimalSeparator()) {\n                                        s = s + pFormula[i];\n                                        i = i + 1;\n                                    }\n                                    if (i < pFormula.length && pFormula[i] === '%') {\n                                        i = i + 1;\n                                        if (s === '') {\n                                            if (stack.length > 0) {\n                                                var stackValue = stack[0];\n                                                var value = this.parseFloat(stackValue);\n                                                if (!this.isNaN(value)) {\n                                                    stack.pop();\n                                                    stack.push((value / 100).toString());\n                                                }\n                                            }\n                                        }\n                                        else {\n                                            s = (this.parseFloat(s) / 100).toString();\n                                        }\n                                    }\n                                }\n                                stack.push(s);\n                            }\n                            break;\n                        case this.parser.tokenAdd:\n                            {\n                                this.getValArithmetic(stack, 'add');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenSubtract:\n                            {\n                                this.getValArithmetic(stack, 'sub');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenMultiply:\n                            {\n                                this.getValArithmetic(stack, 'mul');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenDivide:\n                            {\n                                this.getValArithmetic(stack, 'div');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenLess:\n                            {\n                                this.processLogical(stack, 'less');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenGreater:\n                            {\n                                this.processLogical(stack, 'greater');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenGreaterEq:\n                            {\n                                this.processLogical(stack, 'greaterEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenLessEq:\n                            {\n                                this.processLogical(stack, 'lessEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenNotEqual:\n                            {\n                                this.processLogical(stack, 'notEq');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenOr:\n                            {\n                                this.processLogical(stack, 'or');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenAnd:\n                            {\n                                this.processLogical(stack, 'and');\n                                i = i + 1;\n                            }\n                            break;\n                        case this.parser.tokenEqual:\n                            {\n                                this.processLogical(stack, 'equal');\n                                i = i + 1;\n                            }\n                            break;\n                        default: {\n                            return this.getErrorStrings()[CommonErrors.value];\n                        }\n                    }\n                }\n            }\n            if (stack.length === 0) {\n                return this.emptyString;\n            }\n            else {\n                var s = this.emptyString;\n                var countValue = stack.length;\n                while (countValue > 0) {\n                    s = stack.pop() + s;\n                    if (s === this.emptyString && this.isCellReference(pFormula) &&\n                        this.getTreatEmptyStringAsZero()) {\n                        return '0';\n                    }\n                    countValue--;\n                }\n                return s;\n            }\n        }\n        catch (ex) {\n            if (this.getErrorStrings().indexOf(ex) > -1 || this.formulaErrorStrings.indexOf(ex) > -1) {\n                throw ex;\n            }\n            throw new FormulaError(this.formulaErrorStrings[FormulasErrorsStrings.invalid_expression]);\n        }\n    };\n    Calculate.prototype.getValArithmetic = function (stack, operator) {\n        var num1 = stack.pop();\n        num1 = num1 === this.emptyString ? '0' : num1;\n        var num = Number(num1);\n        if (isNaN(num)) {\n            if (num1 === this.getErrorStrings()[CommonErrors.divzero]) {\n                throw this.getErrorStrings()[CommonErrors.divzero];\n            }\n            else {\n                throw this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var num2 = stack.pop();\n        num2 = num2 === this.emptyString ? (stack.length ? stack.pop() : '0') : num2;\n        num = Number(num2);\n        if (isNaN(num)) {\n            if (num1 === this.getErrorStrings()[CommonErrors.divzero]) {\n                throw this.getErrorStrings()[CommonErrors.divzero];\n            }\n            else {\n                throw this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        if (operator === 'add') {\n            stack.push((Number(num2) + Number(num1)).toString());\n        }\n        if (operator === 'sub') {\n            stack.push((Number(num2) - Number(num1)).toString());\n        }\n        if (operator === 'mul') {\n            stack.push((Number(num2) * Number(num1)).toString());\n        }\n        if (operator === 'div') {\n            if (this.isNaN(this.parseFloat(num1)) || this.isNaN(this.parseFloat(num2))) {\n                stack.push(this.getErrorStrings()[CommonErrors.value]);\n            }\n            else if (this.parseFloat(num1) === 0) {\n                stack.push(this.getErrorStrings()[CommonErrors.divzero]);\n            }\n            else {\n                stack.push((Number(num2) / Number(num1)).toString());\n            }\n        }\n    };\n    /** @hidden */\n    Calculate.prototype.processLogical = function (stack, operator) {\n        var val1;\n        var val2;\n        var value1;\n        var value2;\n        if (operator !== 'and' && operator !== 'equal') {\n            val1 = stack.pop();\n            val2 = stack.pop();\n            value1 = val1.indexOf(this.tic) > -1 ? val1 : this.parseFloat(val1);\n            value2 = val2.indexOf(this.tic) > -1 ? val2 : this.parseFloat(val2);\n        }\n        var result;\n        if (operator === 'less') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 < value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) < 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'greater') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 > value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) > 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'lessEq') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 <= value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) <= 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'greaterEq') {\n            if (!this.isNaN(value1) && !this.isNaN(value2)) {\n                result = (value2 >= value1) ? this.trueValue : this.falseValue;\n            }\n            else {\n                result = (val2.toUpperCase().split(this.tic).join('').localeCompare(val1.toUpperCase().split(this.tic).join('')) >= 0) ?\n                    this.trueValue : this.falseValue;\n            }\n        }\n        if (operator === 'notEq') {\n            result = (val2 !== val1) ? this.trueValue : this.falseValue;\n        }\n        if (operator === 'and') {\n            val1 = stack.pop().toString();\n            val2 = '';\n            if (stack.length > 0) {\n                val2 = stack.pop().toString();\n            }\n            result = this.emptyString + val2 + val1 + this.emptyString;\n            result = result.split(this.tic).join('');\n        }\n        if (operator === 'equal') {\n            val1 = stack.pop().toString();\n            val2 = stack.pop().toString();\n            if (val2 === '' && val1 !== '') {\n                val2 = '0';\n            }\n            result = val1 === val2 ? this.trueValue : this.falseValue;\n        }\n        if (operator === 'or') {\n            result = Math.pow(this.parseFloat(value2), this.parseFloat(value1)).toString();\n        }\n        stack.push(result);\n        return result;\n    };\n    /** @hidden */\n    Calculate.prototype.computeStoreCells = function (sCell) {\n        var cellValue = sCell.cellValue;\n        var cellRanges = sCell.cellRange;\n        var criterias = sCell.criteria;\n        var argArr = sCell.argArray;\n        var isCriteria = sCell.isCriteria;\n        var storeCell = sCell.storedCells;\n        var isCountIfs = sCell.isCountIfS;\n        var i = sCell.countVal;\n        var rangeLength = isCriteria === this.trueValue ? storeCell : cellValue;\n        var tempStoredCell = [];\n        for (var j = 0; j < rangeLength.length; j++) {\n            var stack = [];\n            var cellVal = this.getValueFromArg(cellValue[j]);\n            var criteria = void 0;\n            var newCell = '';\n            criteria = argArr[2].split(this.tic).join(this.emptyString);\n            criteria = this.isCellReference(criteria) ? this.getValueFromArg(criteria) : criteria;\n            isCriteria = isCountIfs === this.trueValue ? this.trueValue : isCriteria;\n            if (isCriteria === this.trueValue) {\n                var cell = '';\n                var count = 0;\n                var newCount = 0;\n                storeCell[j] = isCountIfs === this.trueValue && i === 0 ? cellValue[j] : storeCell[j];\n                cell = storeCell[j];\n                // convert the new cell ranges  for find in range with criteria.\n                while (!this.isDigit(cell[count])) {\n                    count = count + 1;\n                }\n                if (this.isCellReference(cellRanges[i]) && cellRanges[i].indexOf(':') > -1) {\n                    var k = cellRanges[i].indexOf(':');\n                    newCell = this.substring(cellRanges[i], k);\n                    while (!this.isDigit(newCell[newCount])) {\n                        newCount = newCount + 1;\n                    }\n                }\n                var cellAlpha = this.substring(cell, count);\n                var newCellAlpha = this.substring(newCell, newCount);\n                newCell = storeCell[j].split(cellAlpha).join(newCellAlpha);\n                cellVal = this.getValueFromArg(newCell);\n                criteria = isCountIfs === this.trueValue ? criterias[i].split(this.tic).join(this.emptyString) :\n                    criterias[i - 1].split(this.tic).join(this.emptyString);\n            }\n            var op = 'equal';\n            if (criteria.startsWith('<=')) {\n                op = 'lessEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('>=')) {\n                op = 'greaterEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('<>')) {\n                op = 'notEq';\n                criteria = criteria.substring(2);\n            }\n            else if (criteria.startsWith('<')) {\n                op = 'less';\n                criteria = criteria.substring(1);\n            }\n            else if (criteria.startsWith('>')) {\n                op = 'greater';\n                criteria = criteria.substring(1);\n            }\n            else if (criteria.startsWith('=')) {\n                op = 'equal';\n                criteria = criteria.substring(1);\n            }\n            if (criteria.indexOf('*') > -1 || criteria.indexOf('?') > -1) {\n                cellVal = this.findWildCardValue(criteria, cellVal);\n            }\n            stack.push(cellVal.toLowerCase());\n            stack.push(criteria.toLowerCase());\n            if (this.processLogical(stack, op) === this.trueValue) {\n                if (isCriteria === this.falseValue) {\n                    tempStoredCell.push(cellValue[j]);\n                }\n                else {\n                    tempStoredCell.push(newCell);\n                }\n            }\n        }\n        storeCell = tempStoredCell;\n        tempStoredCell = [];\n        return storeCell;\n    };\n    Calculate.prototype.computeIfsFormulas = function (range, isCountIfs, isAvgIfs) {\n        if (isNullOrUndefined(range) || range[0] === '' || range.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = range;\n        var argCount = argArr.length;\n        if (argCount < 2 || argCount > 127) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellRanges = [];\n        var criterias = [];\n        var storedCell = [];\n        var storedCellLength = 0;\n        var sum = 0;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.isCellReference(argArr[i])) {\n                cellRanges.push(argArr[i]);\n            }\n            else {\n                criterias.push(argArr[i]);\n            }\n        }\n        cellRanges = cellRanges.toString().split(',,').join(',');\n        cellRanges = cellRanges.split(this.getParseArgumentSeparator());\n        var len = [];\n        for (var i = 0; i < cellRanges.length; i++) {\n            len.push(this.getCellCollection(cellRanges[i]).length);\n        }\n        for (var j = 0; j < len.length; j++) {\n            if (len[j] && len[j + 1] && len[j] !== len[j + 1]) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var cellvalue;\n        var isCriteria;\n        if (isCountIfs === this.falseValue) {\n            isCriteria = this.falseValue;\n            cellvalue = this.getCellCollection(cellRanges[1]);\n            var sCell = {\n                cellValue: cellvalue, cellRange: cellRanges, criteria: criterias,\n                argArray: argArr, isCriteria: isCriteria, storedCells: storedCell, isCountIfS: isCountIfs\n            };\n            storedCell = this.computeStoreCells(sCell);\n            storedCellLength = storedCell.length;\n            if (storedCellLength === 0) {\n                return 0;\n            }\n        }\n        // Compare criteria and convert the new cell ranges.\n        var startRange;\n        startRange = isCountIfs === this.trueValue ? 0 : 2;\n        for (var i = startRange; i < cellRanges.length; i++) {\n            isCriteria = this.trueValue;\n            isCriteria = isCountIfs === this.trueValue && i === 0 ? this.falseValue : this.trueValue;\n            cellvalue = this.getCellCollection(cellRanges[i]);\n            var sCell = {\n                cellValue: cellvalue, cellRange: cellRanges, criteria: criterias,\n                argArray: argArr, isCriteria: isCriteria, storedCells: storedCell, isCountIfS: isCountIfs, countVal: i\n            };\n            storedCell = this.computeStoreCells(sCell);\n            storedCellLength = storedCell.length;\n            if (storedCellLength === 0) {\n                return 0;\n            }\n        }\n        for (var j = 0; j < storedCell.length; j++) {\n            // convert the new cell ranges  for find sum in range 0(first range)\n            var cell = '';\n            var newCell = '';\n            var count = 0;\n            var newCount = 0;\n            cell = storedCell[j];\n            while (!this.isDigit(cell[count])) {\n                count = count + 1;\n            }\n            if (this.isCellReference(cellRanges[0]) && cellRanges[0].indexOf(':') > -1) {\n                var k = cellRanges[0].indexOf(':');\n                newCell = this.substring(cellRanges[0], k);\n                while (!this.isDigit(newCell[newCount])) {\n                    newCount = newCount + 1;\n                }\n            }\n            var cellAlpha = this.substring(cell, count);\n            var newCellAlpha = this.substring(newCell, newCount);\n            cellvalue = storedCell[j].split(cellAlpha).join(newCellAlpha);\n            if (isCountIfs === this.trueValue) {\n                sum = sum + 1;\n            }\n            else {\n                var argValue = this.getValueFromArg(cellvalue);\n                sum = sum + parseFloat(argValue === '' ? '0' : argValue);\n            }\n        }\n        if (isAvgIfs === this.trueValue) {\n            sum = sum / cellvalue.length;\n        }\n        return sum;\n    };\n    Calculate.prototype.processNestedFormula = function (pText, sFormula, fResult) {\n        var lastIndexq = this.findLastIndexOfq(pText);\n        var interiorCalcFString = pText.split(sFormula).join('n' + fResult);\n        return interiorCalcFString;\n    };\n    /** @hidden */\n    Calculate.prototype.isNaN = function (value) {\n        if (value.toString() === 'NaN' || typeof value === 'string') {\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.fromOADate = function (doubleNumber) {\n        var result = new Date();\n        result.setTime((doubleNumber * this.millisecondsOfaDay) + Date.parse(this.oaDate.toString()));\n        return result;\n    };\n    /** @hidden */\n    Calculate.prototype.getSerialDateFromDate = function (year, month, day) {\n        var days = 0;\n        if (year < 1900) {\n            year += 1900;\n        }\n        var isValidMonth = false;\n        while (!isValidMonth) {\n            while (month > 12) {\n                year++;\n                month -= 12;\n            }\n            isValidMonth = true;\n            var tempDay = new Date(year, month, 1, -1).getDate();\n            while (day > tempDay) {\n                tempDay = new Date(year, month, 1, -1).getDate();\n                month++;\n                day -= tempDay;\n                isValidMonth = false;\n            }\n            if (day < 1) {\n                month--;\n                tempDay = new Date(year, month, 1, -1).getDate();\n                day = tempDay - day;\n            }\n        }\n        var dateTime = Date.parse(year.toString() + this.getParseDateTimeSeparator() + month.toString() +\n            this.getParseDateTimeSeparator() + day.toString());\n        if (!this.isNaN(dateTime)) {\n            days = this.toOADate(new Date(dateTime));\n        }\n        return days;\n    };\n    /** @hidden */\n    Calculate.prototype.toOADate = function (dateTime) {\n        var result = (dateTime.getTime() - Date.parse(this.oaDate.toString())) / this.millisecondsOfaDay;\n        return result;\n    };\n    /** @hidden */\n    Calculate.prototype.calculateDate = function (date) {\n        return (this.parseFloat(date) < 10) ? '0' + date : date;\n    };\n    /** @hidden */\n    Calculate.prototype.isTextEmpty = function (s) {\n        return s === null || s === '';\n    };\n    /** @hidden */\n    Calculate.prototype.isDigit = function (text) {\n        var charCode = text.charCodeAt(0);\n        if ((charCode > 47) && (charCode < 58)) {\n            return true;\n        }\n        return false;\n    };\n    Calculate.prototype.findLastIndexOfq = function (fString) {\n        return fString.lastIndexOf('q');\n    };\n    /**\n     * To get the exact value from argument.\n     * @param {string} arg - Formula argument for getting a exact value.\n     * @returns string\n     */\n    Calculate.prototype.getValueFromArg = function (arg) {\n        arg = arg.trim();\n        var s = arg;\n        var dateTime = this.dateTime1900;\n        var pObjCVal = s;\n        if (isNullOrUndefined(s) || this.isTextEmpty(s)) {\n            return s;\n        }\n        else if (arg[0] === this.tic || arg[0] === this.singleTic) {\n            dateTime = this.isDate(arg.split(this.tic).join(''));\n            if (this.isNaN(this.parseFloat(arg.split(this.tic).join(''))) && !isNullOrUndefined(dateTime) &&\n                !this.isNaN(dateTime.getDate()) && this.dateTime1900 <= dateTime) {\n                return this.toOADate(dateTime).toString();\n            }\n            return arg;\n        }\n        else {\n            arg = arg.split('u').join('-');\n            /* tslint:disable:max-line-length */\n            if (!this.isUpperChar(s[0]) && (this.isDigit(s[0]) || s[0] === this.getParseDecimalSeparator() || s[0] === '-' || s[0] === 'n')) {\n                if (s[0] === 'n') {\n                    s = s.substring(1);\n                    if (s.indexOf('\"n') > -1) {\n                        s = s.replace('\"n', '\"');\n                    }\n                }\n                return s;\n            }\n        }\n        var symbolArray = ['+', '-', '/', '*', ')', ')', '{'];\n        if ((this.parser.indexOfAny(s, symbolArray) === -1 && this.isUpperChar(s[0])) || s[0] === this.sheetToken) {\n            if (s !== this.trueValue && s !== this.falseValue && this.isCellReference(s)) {\n                var f = this.getSheetFamilyItem(this.grid);\n                if (f.sheetNameToParentObject !== null && f.sheetNameToParentObject.size > 0 && s.indexOf(this.sheetToken) === -1) {\n                    var token = f.parentObjectToToken.get(this.grid);\n                    s = token + s;\n                }\n            }\n            if (s === this.cell) {\n                var dependent = this.getDependentCells().get(s);\n                if (dependent != null && dependent.indexOf(s) > -1) {\n                    this.arrayRemove(dependent, s);\n                }\n                if (!this.getDependentFormulaCells().has(this.cell)) {\n                    this.clearFormulaDependentCells(this.cell);\n                }\n                throw this.formulaErrorStrings[FormulasErrorsStrings.circular_reference] + s;\n            }\n            pObjCVal = this.getParentObjectCellValue(s);\n            this.updateDependentCell(s);\n            return pObjCVal.toString();\n        }\n        if (this.getErrorStrings().indexOf(arg) > -1) {\n            return arg;\n        }\n        return this.computeValue(pObjCVal.toString());\n    };\n    /* tslint:disable-next-line */\n    Calculate.prototype.isDate = function (date) {\n        if (typeof date === 'object' || Date.parse(date) !== null) {\n            var dateval = new Date(Date.parse(date));\n            if (dateval >= this.dateTime1900) {\n                return dateval;\n            }\n            else {\n                return null;\n            }\n        }\n        else {\n            return null;\n        }\n    };\n    Calculate.prototype.isValidCellReference = function (text) {\n        var start = 0;\n        var end = 0;\n        var j = 0;\n        var numArr = [89, 71, 69];\n        var cellTxt = this.emptyString;\n        if (this.namedRanges.has(text)) {\n            return false;\n        }\n        for (var i = 0; i < text.length; i++) {\n            if (this.isChar(text[i])) {\n                end++;\n            }\n        }\n        cellTxt = text.substring(start, end);\n        if (cellTxt.length < 4) {\n            while (j < cellTxt.length) {\n                if (!isNullOrUndefined(cellTxt[j]) && cellTxt[j].charCodeAt(0) < numArr[j]) {\n                    j++;\n                    continue;\n                }\n                else if (isNullOrUndefined(cellTxt[j]) && j > 0) {\n                    break;\n                }\n                else {\n                    return false;\n                }\n            }\n            var cellNum = this.parseFloat(text.substring(end, text.length));\n            if (cellNum < 1048576) { // Maximum number of rows in excel.\n                return true;\n            }\n        }\n        return false;\n    };\n    /** @hidden */\n    /* tslint:disable-next-line */\n    Calculate.prototype.parseDate = function (date) {\n        if (!this.isNaN(date)) {\n            if (date instanceof Date) {\n                return new Date(date);\n            }\n            var d = parseInt(date, 10);\n            if (d < 0) {\n                return this.getErrorStrings()[CommonErrors.num];\n            }\n            if (d <= 60) {\n                return new Date(this.dateTime1900.getTime() + (d - 1) * 86400000);\n            }\n            return new Date(this.dateTime1900.getTime() + (d - 2) * 86400000);\n        }\n        if (typeof date === 'string') {\n            date = new Date(date);\n            if (!this.isNaN(date)) {\n                return date;\n            }\n        }\n        return this.getErrorStrings()[CommonErrors.value];\n    };\n    /** @hidden */\n    Calculate.prototype.isCellReference = function (args) {\n        if (args === this.emptyString) {\n            return false;\n        }\n        args = args.trim();\n        args = this.setTokensForSheets(args);\n        var sheetToken1 = this.getSheetToken(args);\n        var containsBoth = false;\n        if (sheetToken1 !== '') {\n            args = args.split(sheetToken1).join(this.emptyString);\n        }\n        var isAlpha = false;\n        var isNum = false;\n        if (args.indexOf(':') !== args.lastIndexOf(':')) {\n            return false;\n        }\n        var charArray = (args.split('').join(this.getParseArgumentSeparator())).split(this.getParseArgumentSeparator());\n        for (var c = 0; c < charArray.length; c++) {\n            if (this.isChar(charArray[c])) {\n                isAlpha = true;\n            }\n            else if (this.isDigit(charArray[c])) {\n                isNum = true;\n            }\n            else if (charArray[c] === ':') {\n                if (isAlpha && isNum) {\n                    containsBoth = true;\n                }\n                isAlpha = false;\n                isNum = false;\n            }\n            else {\n                return false;\n            }\n        }\n        if (args.indexOf(':') > -1 && args.indexOf(this.tic) === -1) {\n            if (containsBoth && isAlpha && isNum) {\n                return true;\n            }\n            else if (((isAlpha && !isNum) || (!isAlpha && isNum)) && !containsBoth) {\n                return true;\n            }\n            else {\n                return false;\n            }\n        }\n        if (isAlpha && isNum && args.indexOf(this.tic) === -1) {\n            return true;\n        }\n        return false;\n    };\n    /** @hidden */\n    Calculate.prototype.setTokensForSheets = function (text) {\n        var family = this.getSheetFamilyItem(this.grid);\n        var sortedSheetNamesCollection = this.getSortedSheetNames();\n        if (sortedSheetNamesCollection != null) {\n            for (var n = 0; n < sortedSheetNamesCollection.length; n++) {\n                var token = family.sheetNameToToken.get(sortedSheetNamesCollection[n]);\n                token = token.split(this.sheetToken).join(this.tempSheetPlaceHolder);\n                var s = this.singleTic + 'SHEET' + sortedSheetNamesCollection[n] + this.singleTic + this.sheetToken;\n                if (text.indexOf(s) === -1) {\n                    s = 'SHEET' + sortedSheetNamesCollection[n] + this.sheetToken;\n                }\n                text = text.split(s).join(token);\n                s = sortedSheetNamesCollection[n] + this.sheetToken;\n                text = text.split(s).join(token);\n            }\n        }\n        text = text.split(this.tempSheetPlaceHolder).join(this.sheetToken);\n        if (text.indexOf('!!') > -1) {\n            text = text.replace('!!', '!');\n            var textSplit = text.split('');\n            textSplit[1] = (parseInt(textSplit[1], 10) + 1).toString();\n            text = textSplit.join('');\n        }\n        return text;\n    };\n    Calculate.prototype.getParentObjectCellValue = function (val) {\n        if (val === this.trueValue || val === this.falseValue) {\n            return val;\n        }\n        var i = val.lastIndexOf(this.sheetToken);\n        var row = 0;\n        var col = 0;\n        var grid = this.grid;\n        var family = this.getSheetFamilyItem(grid);\n        if (i > -1 && family.tokenToParentObject !== null) {\n            this.grid = family.tokenToParentObject.get(val.substring(0, i + 1));\n            row = this.rowIndex(val);\n            col = this.colIndex(val);\n        }\n        else if (i === -1) {\n            var j = 0;\n            while (j < val.length && this.isChar(val[j])) {\n                j++;\n            }\n            if (j === val.length) {\n                val = val.toLowerCase();\n                return val === '' ? this.getErrorStrings()[CommonErrors.value] : this.getErrorStrings()[CommonErrors.name];\n            }\n            else {\n                row = this.rowIndex(val);\n                col = this.colIndex(val);\n                if (family.isSheetMember && family.parentObjectToToken != null) {\n                    val = family.parentObjectToToken.get(this.grid) + val;\n                }\n            }\n        }\n        var saveCell = (this.cell === '' || this.cell === null) ? '' : this.cell;\n        this.cell = val;\n        if (saveCell === this.cell) {\n            throw this.formulaErrorStrings[FormulasErrorsStrings.circular_reference];\n        }\n        var cValue = this.getParentCellValue(row, col, this.grid);\n        this.grid = grid;\n        this.cell = saveCell;\n        return cValue;\n    };\n    Calculate.prototype.getParentCellValue = function (row, col, grd) {\n        var alreadyComputed = false;\n        // formulainfotable\n        var cValue;\n        /* tslint:disable-next-line */\n        if (this.parentObject.getValueRowCol === undefined) {\n            cValue = this.getValueRowCol(this.getSheetID(grd), row, col);\n        }\n        else {\n            /* tslint:disable-next-line */\n            cValue = this.parentObject.getValueRowCol(this.getSheetID(grd), row, col);\n            return isNullOrUndefined(cValue) ? this.emptyString : cValue.toString();\n        }\n        if (cValue === '' || cValue === undefined) {\n            cValue = '';\n        }\n        // if (cValue[cValue.length - 1] == (\"%\") && !this.isNaN(d)) {\n        //     cValue = (Number(d) / 100).toString();\n        // }\n        return cValue;\n    };\n    /**\n     * Getting the formula result.\n     * @param {Object} grid - Specifies the parent object.\n     * @param {number} row - Row index of the parent object or key.\n     * @param {number} col - Column index of the parent object.\n     * @returns string\n     */\n    Calculate.prototype.getValueRowCol = function (grid, row, col) {\n        var key = this.rowsToKeyMap.get(row).toString();\n        var result = this.getKeyValue(key).toString();\n        if (result != null && result[result.length - 1] === ('%') && result.length > 1) {\n            var d = this.parseFloat(result.substring(0, result.length - 1));\n            if (this.isNaN(d)) {\n                result = (Number(d) / 100).toString();\n            }\n        }\n        return result;\n    };\n    /**\n     * To add custom library formula.\n     * @param {string} formulaName - Custom Formula name.\n     * @param {string} functionName - Custom function name.\n     * @returns void\n     */\n    Calculate.prototype.defineFunction = function (formulaName, functionName) {\n        if (typeof functionName === 'string') {\n            functionName = getValue(functionName, window);\n        }\n        formulaName = formulaName.toUpperCase();\n        this.libraryFormulas.set(formulaName, { handler: functionName, isCustom: true });\n    };\n    /**\n     * Specifies when changing the value.\n     * @param {string} grid - Parent object reference name.\n     * @param {ValueChangedArgs} changeArgs - Value changed arguments.\n     * @param {boolean} isCalculate - Value that allow to calculate.\n     */\n    Calculate.prototype.valueChanged = function (grid, changeArgs, isCalculate, usedRangeCol) {\n        var pgrid = grid;\n        this.spreadSheetUsedRange = usedRangeCol;\n        this.grid = grid;\n        var isComputedValueChanged = true;\n        var isCompute = true;\n        var calcFamily = this.getSheetFamilyItem(pgrid);\n        var cellTxt = getAlphalabel(changeArgs.getColIndex()) + changeArgs.getRowIndex().toString();\n        if (calcFamily.sheetNameToParentObject !== null && calcFamily.sheetNameToParentObject.size > 0) {\n            var token = calcFamily.parentObjectToToken.get(pgrid);\n            cellTxt = token + cellTxt;\n        }\n        var argVal = changeArgs.getValue().toUpperCase();\n        if (argVal.indexOf('=RAND()') > -1 || argVal.indexOf('RAND()') > -1 || argVal.indexOf('=RANDBETWEEN(') > -1 ||\n            argVal.indexOf('RANDBETWEEN(') > -1 || this.randomValues.has(cellTxt)) {\n            var randStrVal = this.randCollection.toString();\n            if (!this.randomValues.has(cellTxt)) {\n                this.randomValues.set(cellTxt, changeArgs.getValue());\n                this.randCollection.push(cellTxt);\n                this.isRandomVal = true;\n            }\n            else if (this.randomValues.has(cellTxt)) {\n                if (argVal.indexOf('=RAND()') > -1 || argVal.indexOf('RAND()') > -1 || argVal.indexOf('=RANDBETWEEN(') > -1 ||\n                    argVal.indexOf('RANDBETWEEN(') > -1) {\n                    this.randomValues.set(cellTxt, changeArgs.getValue());\n                }\n                else if (changeArgs.getValue().toUpperCase() !== this.randomValues.get(cellTxt.toUpperCase())) {\n                    this.randomValues.delete(cellTxt);\n                    randStrVal = randStrVal.split(cellTxt + this.parseArgumentSeparator).join('').split(this.parseArgumentSeparator + cellTxt).join('').split(cellTxt).join('');\n                    this.randCollection = randStrVal.split(this.parseArgumentSeparator);\n                }\n                if (this.randomValues.size === 0 && this.randCollection.length) {\n                    this.isRandomVal = false;\n                    this.randomValues.clear();\n                    this.randCollection = [];\n                }\n            }\n        }\n        if (changeArgs.getValue() && changeArgs.getValue()[0] === this.getFormulaCharacter()) {\n            this.cell = cellTxt;\n            var formula = void 0;\n            if (!isNullOrUndefined(isCompute)) {\n                isCompute = isCalculate;\n            }\n            if (this.getFormulaInfoTable().has(cellTxt)) {\n                formula = this.getFormulaInfoTable().get(cellTxt);\n                if (changeArgs.getValue() !== formula.getFormulaText() || formula.getParsedFormula() == null) {\n                    formula.setFormulaText(changeArgs.getValue());\n                    if (this.getDependentFormulaCells().has(this.cell)) {\n                        this.clearFormulaDependentCells(this.cell);\n                    }\n                    try {\n                        formula.setParsedFormula(this.parser.parseFormula(changeArgs.getValue()));\n                    }\n                    catch (ex) {\n                        formula.setFormulaValue(ex);\n                        isCompute = false;\n                    }\n                }\n                if (isCompute) {\n                    this.parser.isFormulaParsed = true;\n                    var cValue = this.computeFormula(formula.getParsedFormula());\n                    isComputedValueChanged = (cValue !== formula.getFormulaValue());\n                    formula.setFormulaValue(cValue);\n                }\n            }\n            else {\n                formula = new FormulaInfo();\n                formula.setFormulaText(changeArgs.getValue());\n                if (!this.getDependentFormulaCells().has(cellTxt)) {\n                    this.getDependentFormulaCells().set(cellTxt, new Map());\n                }\n                try {\n                    formula.setParsedFormula(this.parser.parseFormula(changeArgs.getValue()));\n                }\n                catch (ex) {\n                    formula.setFormulaValue(ex);\n                    isCompute = false;\n                }\n                if (isCompute) {\n                    formula.setFormulaValue(this.computeFormula(formula.getParsedFormula()));\n                }\n                if (this.getFormulaInfoTable().has(cellTxt)) {\n                    this.getFormulaInfoTable().set(cellTxt, formula);\n                }\n                else {\n                    this.getFormulaInfoTable().set(cellTxt, formula);\n                }\n            }\n            if (isCompute) {\n                /* tslint:disable */\n                if (this.parentObject.setValueRowCol === undefined) {\n                    this.setValueRowCol(this.getSheetID(pgrid) + 1, formula.getFormulaValue(), changeArgs.getRowIndex(), changeArgs.getColIndex());\n                }\n                else {\n                    this.parentObject.setValueRowCol(this.getSheetID(pgrid) + 1, formula.getFormulaValue(), changeArgs.getRowIndex(), changeArgs.getColIndex());\n                }\n                /* tslint:enable */\n            }\n        }\n        else if (this.getFormulaInfoTable().has(cellTxt)) {\n            this.getFormulaInfoTable().delete(cellTxt);\n            if (this.getDependentFormulaCells().has(cellTxt)) {\n                this.clearFormulaDependentCells(cellTxt);\n            }\n        }\n        if (isCompute && isComputedValueChanged && this.getDependentCells().has(cellTxt) &&\n            this.getDependentCells().get(cellTxt).toString() !== cellTxt) {\n            this.getComputedValue().clear();\n            this.refresh(cellTxt);\n        }\n    };\n    /** @hidden */\n    Calculate.prototype.getComputedValue = function () {\n        if (this.computedValues === null) {\n            this.computedValues = new Map();\n        }\n        return this.computedValues;\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.setValueRowCol = function (value, formulaValue, row, col) {\n        /* No Implementation */\n    };\n    Calculate.prototype.getSortedSheetNames = function () {\n        var family = this.getSheetFamilyItem(this.grid);\n        if (family != null && family.sheetNameToToken != null) {\n            var arr_1 = [];\n            family.sheetNameToToken.forEach(function (value, key) {\n                arr_1.push(key);\n                arr_1.sort();\n            });\n            this.sortedSheetNames = arr_1;\n            this.sortedSheetNames.sort();\n        }\n        return this.sortedSheetNames;\n    };\n    /** @hidden */\n    Calculate.prototype.getErrorLine = function (error) {\n        /* tslint:disable-next-line */\n        var errorStack = error.stack ? error.stack.split('\\n')[1].split(':') : null;\n        return errorStack ? errorStack[errorStack.length - 2] : null; // Getting row number of the error file.\n    };\n    /** @hidden */\n    Calculate.prototype.createSheetFamilyID = function () {\n        if (this.sheetFamilyID === Number.MAX_SAFE_INTEGER) {\n            this.sheetFamilyID = Number.MIN_SAFE_INTEGER;\n        }\n        return this.sheetFamilyID++;\n    };\n    /** @hidden */\n    Calculate.prototype.computeMinMax = function (args, operation) {\n        var result;\n        var argVal;\n        var countStrVal = 0;\n        if (isNullOrUndefined(args) || args.length === 0) {\n            return this.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var k = 0, len = args.length; k < len; k++) {\n            if (args[k].split(this.tic).join('').trim() === this.emptyString) {\n                return this.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        result = (operation === 'max') ? this.minValue : this.maxValue;\n        var argArr = args;\n        if (argArr.length > 255) {\n            return this.getErrorStrings()[CommonErrors.value];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.isCellReference(argArr[i])) {\n                var cellValue = this.getCellCollection(argArr[i]);\n                for (var j = 0; j < cellValue.length; j++) {\n                    argVal = this.getValueFromArg(cellValue[j]);\n                    if (this.getErrorStrings().indexOf(argVal) > -1) {\n                        return argVal;\n                    }\n                    var cellVal = this.parseFloat(argVal);\n                    if (argVal === '' || this.isNaN(this.parseFloat(cellVal))) {\n                        countStrVal = countStrVal + 1;\n                        if (countStrVal === cellValue.length) {\n                            result = 0;\n                        }\n                        continue;\n                    }\n                    else {\n                        result = (operation === 'max') ? Math.max(result, cellVal) : Math.min(result, cellVal);\n                    }\n                }\n            }\n            else {\n                var val = void 0;\n                val = this.getValueFromArg(argArr[i]);\n                if (this.getErrorStrings().indexOf(val) > -1) {\n                    return val;\n                }\n                var cellVal = this.parseFloat(val);\n                if (val === '' || this.isNaN(this.parseFloat(cellVal))) {\n                    countStrVal = countStrVal + 1;\n                    if (countStrVal === argVal.length) {\n                        result = 0;\n                    }\n                    continue;\n                }\n                else {\n                    result = (operation === 'max') ? Math.max(result, cellVal) : Math.min(result, cellVal);\n                }\n            }\n        }\n        return result.toString();\n    };\n    /** @hidden */\n    Calculate.prototype.calculateAvg = function (args) {\n        var sumCell = 0;\n        var argArr = args;\n        var cellVal = [];\n        var avgVal = 0;\n        var countNum = 0;\n        var countNum1 = 0;\n        for (var k = 0; k < argArr.length; k++) {\n            if (argArr[k].indexOf(':') > -1 && this.isCellReference(argArr[k])) {\n                countNum = 0;\n                cellVal = this.getCellCollection(argArr[k]);\n                avgVal = 0;\n                for (var i = 0; i < cellVal.length; i++) {\n                    var value = this.getValueFromArg(cellVal[i]);\n                    if (isNullOrUndefined(value) || isNaN(this.parseFloat(value))) {\n                        continue;\n                    }\n                    avgVal = avgVal + this.parseFloat(value);\n                    countNum = countNum + 1;\n                }\n                if (countNum === 0) {\n                    return this.getErrorStrings()[CommonErrors.divzero];\n                }\n                avgVal = avgVal / countNum;\n                sumCell = avgVal + sumCell;\n            }\n            else {\n                if (argArr[k].indexOf(this.tic) > -1) {\n                    if (isNaN(parseFloat(argArr[k].split(this.tic).join('')))) {\n                        return this.getErrorStrings()[CommonErrors.value];\n                    }\n                }\n                if (argArr[k].length === 0) {\n                    argArr[k] = '1';\n                }\n                var value = this.getValueFromArg(argArr[k].split(this.tic).join(''));\n                if (isNullOrUndefined(value) || isNaN(this.parseFloat(value))) {\n                    return this.getErrorStrings()[CommonErrors.name];\n                }\n                sumCell = sumCell + this.parseFloat(value);\n            }\n        }\n        return (sumCell / (argArr.length - countNum1)).toString();\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.registerGridAsSheet = function (refName, model, sheetFamilyID) {\n        if (isNullOrUndefined(this.modelToSheetID)) {\n            this.modelToSheetID = new Map();\n        }\n        if (isNullOrUndefined(this.modelToSheetID.get(model))) {\n            this.modelToSheetID.set(model, sheetFamilyID);\n        }\n        var family = this.getSheetFamilyItem(model);\n        family.isSheetMember = true;\n        var tempRef = refName.toUpperCase();\n        if (family.parentObjectToToken.size === 0) {\n            family.parentObjectToToken = new Map();\n        }\n        if (family.sheetNameToParentObject.size === 0) {\n            family.sheetNameToParentObject = new Map();\n        }\n        if (family.sheetNameToToken.size === 0) {\n            family.sheetNameToToken = new Map();\n        }\n        if (family.tokenToParentObject.size === 0) {\n            family.tokenToParentObject = new Map();\n        }\n        if (!isUndefined(family.sheetNameToParentObject.get(tempRef))) {\n            var token = family.sheetNameToToken.get(tempRef);\n            family.tokenToParentObject.set(token, model);\n            family.parentObjectToToken.set(model, token);\n        }\n        else {\n            var token = this.sheetToken + this.tokenCount.toString() + this.sheetToken;\n            this.tokenCount++;\n            family.tokenToParentObject.set(token, model);\n            family.parentObjectToToken.set(model, token);\n            family.sheetNameToToken.set(tempRef, token);\n            family.sheetNameToParentObject.set(tempRef, model);\n        }\n        return refName;\n    };\n    /**\n     * @hidden\n     */\n    Calculate.prototype.unregisterGridAsSheet = function (refName, model) {\n        var family = this.getSheetFamilyItem(model);\n        var refName1 = refName.toUpperCase();\n        if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.has(refName1)) {\n            family.sheetNameToParentObject.delete(refName1);\n            var token = family.sheetNameToToken.get(refName1);\n            family.sheetNameToToken.delete(refName1);\n            family.tokenToParentObject.delete(token);\n            family.parentObjectToToken.delete(model);\n        }\n    };\n    ;\n    /**\n     * @hidden\n     */\n    Calculate.prototype.computeExpression = function (formula) {\n        var parsedFormula = this.parser.parseFormula(formula);\n        var calcValue = this.computeFormula(parsedFormula);\n        return calcValue;\n    };\n    ;\n    Calculate.prototype.isSheetMember = function () {\n        var family = this.getSheetFamilyItem(this.grid);\n        return isNullOrUndefined(family) ? false : family.isSheetMember;\n    };\n    /**\n     * To dispose the calculate engine.\n     * @returns void\n     */\n    Calculate.prototype.dispose = function () {\n        this.resetKeys();\n        // this.dependentCells.clear();\n        // this.dependentFormulaCells.clear();\n        this.namedRanges.clear();\n        // this.sheetFamiliesList.clear();\n        this.lFormulas.clear();\n    };\n    Calculate.prototype.refreshRandValues = function (cellRef) {\n        var rowIdx;\n        var colIdx;\n        var value;\n        var tokenRef = '';\n        var stringCollection = this.randCollection.toString();\n        var family;\n        if (this.randomValues.has(cellRef)) {\n            this.randomValues.delete(cellRef);\n            stringCollection = stringCollection.split(cellRef + this.parseArgumentSeparator).join('').split(this.parseArgumentSeparator + cellRef).join('').split(cellRef).join('');\n            if (this.randomValues.size === 0 && stringCollection === '') {\n                this.randomValues.clear();\n                this.randCollection = [];\n            }\n            else {\n                this.randCollection = stringCollection.split(this.parseArgumentSeparator);\n            }\n        }\n        for (var i = 0; i < this.randomValues.size; i++) {\n            rowIdx = this.rowIndex(this.randCollection[i]);\n            colIdx = this.colIndex(this.randCollection[i]);\n            tokenRef = (parseFloat(this.getSheetToken(this.randCollection[i]).split(this.sheetToken).join('')) + 1).toString();\n            family = this.getSheetFamilyItem(tokenRef);\n            this.grid = family.sheetNameToParentObject.get(tokenRef);\n            value = this.randomValues.get(this.randCollection[i]);\n            value = this.computeFormula(value);\n            if (this.parentObject.setValueRowCol === undefined) {\n                this.setValueRowCol(this.getSheetID(this.grid) + 1, value, rowIdx, colIdx);\n            }\n            else {\n                this.parentObject.setValueRowCol(this.getSheetID(this.grid) + 1, value, rowIdx, colIdx);\n            }\n        }\n    };\n    Calculate.prototype.refresh = function (cellRef) {\n        if (this.dependencyLevel === 0) {\n            this.refreshedCells.clear();\n        }\n        if (this.getDependentCells().has(cellRef) && this.getDependentCells().get(cellRef) !== null) {\n            var family = this.getSheetFamilyItem(this.grid);\n            this.dependencyLevel = this.dependencyLevel + 1;\n            try {\n                var dependentCells = this.getDependentCells().get(cellRef);\n                var i = void 0;\n                for (i = 0; i < dependentCells.length; i++) {\n                    var dCell = dependentCells[i];\n                    var token = this.getSheetToken(dCell);\n                    if (token.length) {\n                        this.grid = family.tokenToParentObject.get(token);\n                    }\n                    try {\n                        var rowIdx = this.rowIndex(dCell);\n                        var colIdx = this.colIndex(dCell);\n                        var formulaInfo = this.getFormulaInfoTable().get(dCell);\n                        var result = void 0;\n                        if (formulaInfo) {\n                            this.cell = dCell;\n                            if (!this.getComputedValue().has(dCell)) {\n                                this.parser.isFormulaParsed = true;\n                                result = this.computeFormula(formulaInfo.getParsedFormula());\n                                this.computedValues.set(dCell, result);\n                            }\n                            else {\n                                result = this.getComputedValue().get(dCell);\n                            }\n                            formulaInfo.setFormulaValue(result);\n                        }\n                        if (this.parentObject.setValueRowCol === undefined) {\n                            this.setValueRowCol(this.getSheetID(this.grid) + 1, formulaInfo.getFormulaValue(), rowIdx, colIdx);\n                        }\n                        else {\n                            this.parentObject.setValueRowCol(this.getSheetID(this.grid) + 1, formulaInfo.getFormulaValue(), rowIdx, colIdx);\n                        }\n                        if (!this.refreshedCells.has(dCell)) {\n                            this.refreshedCells.set(dCell, []);\n                            this.refresh(dCell);\n                        }\n                    }\n                    catch (ex) {\n                        continue;\n                    }\n                }\n            }\n            finally {\n                this.grid = family.tokenToParentObject.get(this.getSheetToken(cellRef));\n                this.dependencyLevel--;\n                if (this.dependencyLevel === 0) {\n                    this.refreshedCells.clear();\n                }\n            }\n        }\n    };\n    var Calculate_1;\n    __decorate([\n        Property(true)\n    ], Calculate.prototype, \"includeBasicFormulas\", void 0);\n    __decorate([\n        Event()\n    ], Calculate.prototype, \"onFailure\", void 0);\n    Calculate = Calculate_1 = __decorate([\n        NotifyPropertyChanges\n    ], Calculate);\n    return Calculate;\n}(Base));\nexport { Calculate };\n/** @hidden */\nvar FormulaError = /** @class */ (function () {\n    function FormulaError(errorMessage, formulaAutoCorrection) {\n        this.formulaCorrection = false;\n        this.message = errorMessage;\n        this.formulaCorrection = formulaAutoCorrection;\n    }\n    return FormulaError;\n}());\nexport { FormulaError };\n/** @hidden */\nvar FormulaInfo = /** @class */ (function () {\n    function FormulaInfo() {\n        /**\n         * @hidden\n         */\n        this.calcID = Number.MIN_VALUE + 1;\n        this.calcID1 = Number.MIN_VALUE + 1;\n    }\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.getFormulaText = function () {\n        return this.formulaText;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.setFormulaText = function (value) {\n        this.formulaText = value;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.getFormulaValue = function () {\n        return this.formulaValue;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.setFormulaValue = function (value) {\n        this.formulaValue = value;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.getParsedFormula = function () {\n        return this.parsedFormula;\n    };\n    /**\n     * @hidden\n     */\n    FormulaInfo.prototype.setParsedFormula = function (value) {\n        this.parsedFormula = value;\n    };\n    return FormulaInfo;\n}());\nexport { FormulaInfo };\n/** @hidden */\nvar CalcSheetFamilyItem = /** @class */ (function () {\n    function CalcSheetFamilyItem() {\n        /**\n         * @hidden\n         */\n        this.isSheetMember = false;\n        /**\n         * @hidden\n         */\n        this.parentObjectToToken = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetDependentCells = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetDependentFormulaCells = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetNameToParentObject = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetNameToToken = new Map();\n        /**\n         * @hidden\n         */\n        this.tokenToParentObject = new Map();\n        /**\n         * @hidden\n         */\n        this.sheetFormulaInfotable = new Map();\n    }\n    return CalcSheetFamilyItem;\n}());\nexport { CalcSheetFamilyItem };\n/**\n * @hidden\n */\nexport function getAlphalabel(col) {\n    var cols = [];\n    var n = 0;\n    var charText = 'A';\n    while (col > 0 && n < 9) {\n        col--;\n        var aCharNo = charText.charCodeAt(0);\n        cols[n] = String.fromCharCode(col % 26 + aCharNo);\n        col = parseInt((col / 26).toString(), 10);\n        n++;\n    }\n    var chs = [];\n    for (var i = 0; i < n; i++) {\n        chs[n - i - 1] = cols[i];\n    }\n    return chs.join('');\n}\nvar ValueChangedArgs = /** @class */ (function () {\n    function ValueChangedArgs(row, col, value) {\n        this.row = row;\n        this.col = col;\n        this.value = value;\n        this.getRowIndex = function () {\n            return row;\n        };\n        this.setRowIndex = function (value) {\n            row = value;\n        };\n        this.getColIndex = function () {\n            return col;\n        };\n        this.setColIndex = function (value) {\n            col = value;\n        };\n        this.getValue = function () {\n            return value;\n        };\n        this.setValue = function (value) {\n            value = value;\n        };\n        return this;\n    }\n    return ValueChangedArgs;\n}());\nexport { ValueChangedArgs };\n","/**\n * To get Workbook required modules.\n * @hidden\n * @param {Workbook} context\n */\nexport function getWorkbookRequiredModules(context, modules) {\n    if (modules === void 0) { modules = []; }\n    modules.push({ member: 'workbookBasic', args: [] });\n    modules.push({ member: 'workbookAll', args: [] });\n    modules.push({\n        member: 'dataBind',\n        args: [context]\n    });\n    modules.push({\n        member: 'workbookProtectSheet',\n        args: [context]\n    });\n    if (context.allowSave) {\n        modules.push({\n            member: 'workbookSave',\n            args: [context]\n        });\n    }\n    if (context.allowOpen) {\n        modules.push({\n            member: 'workbookOpen',\n            args: [context]\n        });\n    }\n    if (context.allowEditing) {\n        modules.push({\n            member: 'workbookEdit',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookFormula',\n            args: [context]\n        });\n    }\n    if (context.allowNumberFormatting) {\n        modules.push({\n            member: 'workbookNumberFormat',\n            args: [context]\n        });\n    }\n    if (context.allowCellFormatting) {\n        modules.push({\n            member: 'workbookcellformat',\n            args: [context]\n        });\n    }\n    if (context.allowSorting) {\n        modules.push({ member: 'workbookSort', args: [context] });\n    }\n    if (context.allowHyperlink) {\n        modules.push({ member: 'workbookHyperlink', args: [context] });\n    }\n    if (context.allowFiltering) {\n        modules.push({ member: 'workbookFilter', args: [context] });\n    }\n    if (context.allowFindAndReplace) {\n        modules.push({ member: 'workbookfindAndReplace', args: [context] });\n    }\n    if (context.allowInsert) {\n        modules.push({ member: 'workbookinsert', args: [context] });\n    }\n    if (context.allowDelete) {\n        modules.push({ member: 'workbookdelete', args: [context] });\n    }\n    if (context.allowDataValidation) {\n        modules.push({ member: 'workbookDataValidation', args: [context] });\n    }\n    if (context.allowMerge) {\n        modules.push({ member: 'workbookmerge', args: [context] });\n    }\n    if (context.allowDataValidation) {\n        modules.push({ member: 'workbookConditionalFormatting', args: [context] });\n    }\n    if (context.allowImage) {\n        modules.push({ member: 'workbookImage', args: [context] });\n    }\n    if (context.allowChart) {\n        modules.push({ member: 'workbookChart', args: [context] });\n    }\n    return modules;\n}\n","/**\n * Check whether the text is formula or not.\n * @param text\n */\nexport function checkIsFormula(text) {\n    return text && text[0] === '=' && text.length > 1;\n}\n/**\n * Check whether the value is cell reference or not.\n * @param {string} value - Specify the value to check.\n */\nexport function isCellReference(value) {\n    var range = value;\n    range = range.split('$').join('');\n    if (range.indexOf(':') > -1) {\n        var rangeSplit = range.split(':');\n        if (isValidCellReference(rangeSplit[0]) && isValidCellReference(rangeSplit[1])) {\n            return true;\n        }\n    }\n    else if (range.indexOf(':') < 0) {\n        if (isValidCellReference(range)) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Check whether the value is character or not.\n * @param {string} value - Specify the value to check.\n */\nexport function isChar(value) {\n    if ((value.charCodeAt(0) >= 65 && value.charCodeAt(0) <= 90) || (value.charCodeAt(0) >= 97 && value.charCodeAt(0) <= 122)) {\n        return true;\n    }\n    return false;\n}\nexport function inRange(range, rowIdx, colIdx) {\n    return range && (rowIdx >= range[0] && rowIdx <= range[2] && colIdx >= range[1] && colIdx <= range[3]);\n}\n/**\n * Check whether the cell is locked or not\n * @hidden\n */\nexport function isLocked(cell, column) {\n    if (!cell) {\n        cell = {};\n    }\n    if (cell.isLocked) {\n        return true;\n    }\n    else if (cell.isLocked === false) {\n        return false;\n    }\n    else if (column && column.isLocked) {\n        return true;\n    }\n    else if (!cell.isLocked && (column && column.isLocked !== false)) {\n        return true;\n    }\n    return false;\n}\n/**\n * Check whether the value is cell reference or not.\n * @param {string} value - Specify the value to check.\n * @hidden\n */\nexport function isValidCellReference(value) {\n    var text = value;\n    var startNum = 0;\n    var endNum = 0;\n    var j = 0;\n    var numArr = [89, 71, 69];\n    // XFD is the last column, for that we are using ascii values of Z, G, E (89, 71, 69) to restrict the flow.\n    var cellText = '';\n    var textLength = text.length;\n    for (var i = 0; i < textLength; i++) {\n        if (isChar(text[i])) {\n            endNum++;\n        }\n    }\n    cellText = text.substring(startNum, endNum);\n    var cellTextLength = cellText.length;\n    if (cellTextLength !== textLength) {\n        if (cellTextLength < 4) {\n            if (textLength !== 1 && (isNaN(parseInt(text, 10)))) {\n                while (j < cellTextLength) {\n                    if ((cellText[j]) && cellText[j].charCodeAt(0) < numArr[j]) {\n                        j++;\n                        continue;\n                    }\n                    else if (!(cellText[j]) && j > 0) {\n                        break;\n                    }\n                    else {\n                        return false;\n                    }\n                }\n                var cellNumber = parseFloat(text.substring(endNum, textLength));\n                if (cellNumber > 0 && cellNumber < 1048577) { // 1048576 - Maximum number of rows in excel.\n                    return true;\n                }\n            }\n        }\n    }\n    return false;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { extend, Property, ChildProperty, Complex, Collection, } from '@syncfusion/ej2-base';\nimport { CellStyle, wrapEvent, Chart } from '../common/index';\nimport { Image } from '../common/index';\nimport { getRow } from './index';\nimport { getSheet } from './sheet';\n/**\n * Represents the cell.\n */\nvar Cell = /** @class */ (function (_super) {\n    __extends(Cell, _super);\n    function Cell() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Collection([], Image)\n    ], Cell.prototype, \"image\", void 0);\n    __decorate([\n        Collection([], Chart)\n    ], Cell.prototype, \"chart\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"value\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"formula\", void 0);\n    __decorate([\n        Property(0)\n    ], Cell.prototype, \"index\", void 0);\n    __decorate([\n        Property('General')\n    ], Cell.prototype, \"format\", void 0);\n    __decorate([\n        Complex({}, CellStyle)\n    ], Cell.prototype, \"style\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"hyperlink\", void 0);\n    __decorate([\n        Property(false)\n    ], Cell.prototype, \"wrap\", void 0);\n    __decorate([\n        Property(true)\n    ], Cell.prototype, \"isLocked\", void 0);\n    __decorate([\n        Property('')\n    ], Cell.prototype, \"validation\", void 0);\n    __decorate([\n        Property(1)\n    ], Cell.prototype, \"colSpan\", void 0);\n    __decorate([\n        Property(1)\n    ], Cell.prototype, \"rowSpan\", void 0);\n    return Cell;\n}(ChildProperty));\nexport { Cell };\n/**\n * @hidden\n */\nexport function getCell(rowIndex, colIndex, sheet, isInitRow, returnEmptyObjIfNull) {\n    var row = getRow(sheet, rowIndex);\n    if (!row || !row.cells) {\n        if (isInitRow) {\n            if (!row) {\n                sheet.rows[rowIndex] = { cells: [] };\n            }\n            else {\n                sheet.rows[rowIndex].cells = [];\n            }\n        }\n        else {\n            return returnEmptyObjIfNull ? {} : null;\n        }\n    }\n    return sheet.rows[rowIndex].cells[colIndex] || (returnEmptyObjIfNull ? {} : null);\n}\n/**\n * @hidden\n */\nexport function setCell(rowIndex, colIndex, sheet, cell, isExtend) {\n    if (!sheet.rows[rowIndex]) {\n        sheet.rows[rowIndex] = { cells: [] };\n    }\n    else if (!sheet.rows[rowIndex].cells) {\n        sheet.rows[rowIndex].cells = [];\n    }\n    if (isExtend && sheet.rows[rowIndex].cells[colIndex]) {\n        extend(sheet.rows[rowIndex].cells[colIndex], cell, null, true);\n    }\n    else {\n        sheet.rows[rowIndex].cells[colIndex] = cell;\n    }\n}\n/** @hidden */\nexport function skipDefaultValue(style, defaultKey) {\n    var defaultProps = { fontFamily: 'Calibri', verticalAlign: 'bottom', textIndent: '0pt', backgroundColor: '#ffffff',\n        color: '#000000', textAlign: 'left', fontSize: '11pt', fontWeight: 'normal', fontStyle: 'normal', textDecoration: 'none',\n        border: '', borderLeft: '', borderTop: '', borderRight: '', borderBottom: '' };\n    var changedProps = {};\n    Object.keys(defaultKey ? defaultProps : style).forEach(function (propName) {\n        if (style[propName] !== defaultProps[propName]) {\n            changedProps[propName] = style[propName];\n        }\n    });\n    return changedProps;\n}\n/** @hidden */\nexport function wrap(address, wrap, context) {\n    if (wrap === void 0) { wrap = true; }\n    var addressInfo = context.getAddressInfo(address);\n    var rng = addressInfo.indices;\n    var sheet = getSheet(context, addressInfo.sheetIndex);\n    for (var i = rng[0]; i <= rng[2]; i++) {\n        for (var j = rng[1]; j <= rng[3]; j++) {\n            setCell(i, j, sheet, { wrap: wrap }, true);\n        }\n    }\n    context.setProperties({ sheets: context.sheets }, true);\n    if (addressInfo.sheetIndex === context.activeSheetIndex) {\n        context.notify(wrapEvent, { range: rng, wrap: wrap, sheet: sheet });\n    }\n}\n","import { getSheetNameFromAddress, getSheetIndex, getSheet } from '../base/index';\nimport { getCellAddress, getIndexesFromAddress, getColumnHeaderText, updateSheetFromDataSource, checkDateFormat } from '../common/index';\nimport { queryCellInfo, cFDelete } from '../common/index';\nimport { getRow, getCell, isHiddenRow, isHiddenCol, getMaxSheetId, getSheetNameCount } from './index';\nimport { isUndefined, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { setCell } from './cell';\n/**\n * Update data source to Sheet and returns Sheet\n * @hidden\n */\nexport function getData(context, address, columnWiseData, valueOnly) {\n    return new Promise(function (resolve, reject) {\n        resolve((function () {\n            var i;\n            var cell;\n            var row;\n            var data = new Map();\n            var sheetIdx = address.indexOf('!') > -1 ? getSheetIndex(context, getSheetNameFromAddress(address))\n                : context.activeSheetIndex;\n            var sheet = getSheet(context, sheetIdx);\n            var indexes = getIndexesFromAddress(address);\n            var sRow = indexes[0];\n            var index = 0;\n            var args = {\n                sheet: sheet, indexes: indexes, promise: new Promise(function (resolve, reject) { resolve((function () { })()); })\n            };\n            context.notify(updateSheetFromDataSource, args);\n            return args.promise.then(function () {\n                while (sRow <= indexes[2]) {\n                    var cells = {};\n                    row = getRow(sheet, sRow);\n                    i = indexes[1];\n                    while (i <= indexes[3]) {\n                        if (columnWiseData) {\n                            if (data instanceof Map) {\n                                data = [];\n                            }\n                            var key = getColumnHeaderText(i + 1);\n                            var rowKey = '__rowIndex';\n                            if (valueOnly) {\n                                cells[key] = row ? getValueFromFormat(context, sRow, i, sheetIdx, sheet) : '';\n                            }\n                            else {\n                                cells[key] = row ? getCell(sRow, i, sheet) : null;\n                            }\n                            if (indexes[3] < i + 1) {\n                                cells[rowKey] = (sRow + 1).toString();\n                            }\n                            data[index.toString()] = cells;\n                        }\n                        else {\n                            var cellObj = {};\n                            Object.assign(cellObj, row ? getCell(sRow, i, sheet) : null);\n                            if (cellObj.colSpan > 1 && cellObj.rowSpan > 1) {\n                                var cell_1 = void 0;\n                                for (var j = sRow, len = sRow + cellObj.rowSpan; j < len; j++) {\n                                    for (var k = i, len_1 = i + cellObj.colSpan; k < len_1; k++) {\n                                        if (j === sRow && k === i) {\n                                            continue;\n                                        }\n                                        cell_1 = new Object();\n                                        if (j !== sRow) {\n                                            cell_1.rowSpan = sRow - j;\n                                        }\n                                        if (k !== i) {\n                                            cell_1.colSpan = i - k;\n                                        }\n                                        if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[k]) {\n                                            delete sheet.rows[j].cells[k].value;\n                                            delete sheet.rows[j].cells[k].formula;\n                                        }\n                                        setCell(j, k, sheet, cell_1, true);\n                                    }\n                                }\n                            }\n                            else if (cellObj.colSpan > 1) {\n                                for (var j = i + 1, len = i + cellObj.colSpan; j < len; j++) {\n                                    setCell(sRow, j, sheet, { colSpan: i - j }, true);\n                                    if (sheet.rows[sRow] && sheet.rows[sRow].cells && sheet.rows[sRow].cells[j]) {\n                                        delete sheet.rows[sRow].cells[j].value;\n                                        delete sheet.rows[sRow].cells[j].formula;\n                                    }\n                                }\n                            }\n                            else if (cellObj.rowSpan > 1) {\n                                for (var j = sRow + 1, len = sRow + cellObj.rowSpan; j < len; j++) {\n                                    setCell(j, i, sheet, { rowSpan: sRow - j }, true);\n                                    if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[i]) {\n                                        delete sheet.rows[j].cells[i].value;\n                                        delete sheet.rows[j].cells[i].formula;\n                                    }\n                                }\n                            }\n                            if (!valueOnly && isHiddenRow(sheet, sRow)) {\n                                sRow++;\n                                continue;\n                            }\n                            if (!valueOnly && isHiddenCol(sheet, i)) {\n                                i++;\n                                continue;\n                            }\n                            if (cellObj.style) {\n                                var style = {};\n                                Object.assign(style, cellObj.style);\n                                cellObj.style = style;\n                            }\n                            var eventArgs = { cell: cellObj, address: getCellAddress(sRow, i) };\n                            context.trigger(queryCellInfo, eventArgs);\n                            data.set(eventArgs.address, eventArgs.cell);\n                        }\n                        i++;\n                    }\n                    sRow++;\n                    index++;\n                }\n                return data;\n            });\n        })());\n    });\n}\nfunction getValueFromFormat(context, rowIndex, colIndex, sheetIdx, sheet) {\n    var cell = getCell(rowIndex, colIndex, sheet);\n    if (cell) {\n        if (cell.format) {\n            var args = {\n                value: context.getDisplayText(cell), rowIndex: rowIndex, colIndex: colIndex,\n                sheetIndex: sheetIdx, dateObj: '', isDate: false, isTime: false\n            };\n            context.notify(checkDateFormat, args);\n            if (args.isDate) {\n                return args.dateObj;\n            }\n            else {\n                return cell.value;\n            }\n        }\n        else {\n            return cell.value;\n        }\n    }\n    else {\n        return '';\n    }\n}\n/**\n * @hidden\n */\nexport function getModel(model, idx) {\n    var diff;\n    var j;\n    var prevIdx;\n    if (isUndefined(model[idx]) || !(model[idx] && model[idx].index === idx)) {\n        for (var i = 0; i <= idx; i++) {\n            if (model && model[i]) {\n                diff = model[i].index - i;\n                if (diff > 0) {\n                    model.forEach(function (value, index) {\n                        if (value && value.index) {\n                            prevIdx = value.index;\n                            j = 1;\n                        }\n                        if (value && !value.index && index !== 0) {\n                            value.index = prevIdx + j;\n                        }\n                        j++;\n                    });\n                    while (diff--) {\n                        model.splice(i, 0, null);\n                    }\n                    i += diff;\n                }\n            }\n            else if (model) {\n                model[i] = null;\n            }\n            else {\n                model = [];\n            }\n        }\n    }\n    return model[idx];\n}\n/**\n * @hidden\n */\nexport function processIdx(model, isSheet, context) {\n    var j;\n    var diff = 0;\n    var cnt;\n    var len = model.length;\n    var _loop_1 = function (i) {\n        if (!isNullOrUndefined(model[i]) && !isUndefined(model[i].index)) {\n            cnt = diff = model[i].index - i;\n            delete model[i].index;\n        }\n        if (diff > 0) {\n            j = 0;\n            while (diff--) {\n                if (isSheet) {\n                    context.createSheet(i + j);\n                    j++;\n                }\n                else {\n                    model.splice(i, 0, null);\n                }\n            }\n            i += cnt;\n            len += cnt;\n        }\n        if (isSheet) {\n            if (model[i].id < 1) {\n                model[i].id = getMaxSheetId(context.sheets);\n                if (model[i].properties) {\n                    model[i].properties.id = model[i].id;\n                }\n            }\n            if (!model[i].name) {\n                context.setSheetPropertyOnMute(model[i], 'name', 'Sheet' + getSheetNameCount(context));\n            }\n            var cellCnt_1 = 0;\n            model[i].rows.forEach(function (row) {\n                cellCnt_1 = Math.max(cellCnt_1, (row && row.cells && row.cells.length - 1) || 0);\n            });\n            context.setSheetPropertyOnMute(model[i], 'usedRange', { rowIndex: model[i].rows.length - 1, colIndex: cellCnt_1 });\n        }\n        out_i_1 = i;\n    };\n    var out_i_1;\n    for (var i = 0; i < len; i++) {\n        _loop_1(i);\n        i = out_i_1;\n    }\n}\n/**\n * @hidden\n */\nexport function clearRange(context, address, sheetIdx, valueOnly) {\n    var sheet = getSheet(context, sheetIdx);\n    var range = getIndexesFromAddress(address);\n    var sRIdx = range[0];\n    var eRIdx = range[2];\n    var sCIdx;\n    var eCIdx;\n    for (sRIdx; sRIdx <= eRIdx; sRIdx++) {\n        sCIdx = range[1];\n        eCIdx = range[3];\n        for (sCIdx; sCIdx <= eCIdx; sCIdx++) {\n            var cell = getCell(sRIdx, sCIdx, sheet);\n            context.notify(cFDelete, { rowIdx: sRIdx, colIdx: sCIdx });\n            if (!isNullOrUndefined(cell) && valueOnly) {\n                delete cell.value;\n                if (!isNullOrUndefined(cell.formula)) {\n                    delete cell.formula;\n                }\n            }\n        }\n    }\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { processIdx } from './data';\nimport { ConditionalFormat } from '../common/index';\nimport { ProtectSettings } from '../common/index';\nimport { isUndefined, ChildProperty, Property, Complex, Collection } from '@syncfusion/ej2-base';\n/**\n * Configures the range processing for the spreadsheet.\n *  ```html\n * <div id='Spreadsheet'></div>\n * ```\n * ```typescript\n * let spreadsheet: Spreadsheet = new Spreadsheet({\n *      sheets: [{\n *                  name: 'First Sheet',\n *                  ranges: [{ dataSource: defaultData }],\n *                  rows: [{\n *                          index: 30,\n *                          cells: [{ index: 4, value: 'Total Amount:' },\n *                                  { formula: '=SUM(F2:F30)', style: { fontWeight: 'bold' } }]\n *                  }]\n * ...\n * });\n * spreadsheet.appendTo('#Spreadsheet');\n * ```\n */\nvar Range = /** @class */ (function (_super) {\n    __extends(Range, _super);\n    function Range() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Range.prototype.setProperties = function (prop, muteOnChange) {\n        var _this = this;\n        var name = 'name';\n        var instance = 'instance';\n        var parentObj = 'parentObj';\n        var currRangeIdx = 'currRangeIdx';\n        var controlParent = 'controlParent';\n        if (this[parentObj].isComplexArraySetter && this[controlParent] && this[controlParent].isAngular) {\n            if (Object.keys(prop).length) {\n                if (this[parentObj][currRangeIdx] === undefined) {\n                    this[parentObj][currRangeIdx] = 0;\n                }\n                else {\n                    this[parentObj][currRangeIdx] += 1;\n                }\n                var range = this[parentObj].ranges[this[parentObj][currRangeIdx]];\n                if (range && range.info) {\n                    this.info = range.info;\n                }\n                setTimeout(function () {\n                    if (_this[parentObj][currRangeIdx] !== undefined) {\n                        delete _this[parentObj][currRangeIdx];\n                    }\n                });\n            }\n            else if (this[controlParent].tagObjects[0].instance && this[controlParent].tagObjects[0].instance.hasChanges\n                && !this[controlParent].tagObjects[0].instance.isInitChanges) {\n                var sheetIdx = this[controlParent].sheets.indexOf(this[parentObj]);\n                if (this[parentObj].changedRangeIdx === undefined) {\n                    var rangeIdx_1;\n                    var tagObjects = this[controlParent].tagObjects[0].instance.list[sheetIdx].tagObjects;\n                    for (var i = 0; i < tagObjects.length; i++) {\n                        if (tagObjects[i][name] === 'ranges') {\n                            tagObjects[i][instance].list\n                                .forEach(function (range, idx) {\n                                if (range.hasChanges) {\n                                    rangeIdx_1 = idx;\n                                }\n                            });\n                            break;\n                        }\n                    }\n                    this[parentObj].changedRangeIdx = rangeIdx_1;\n                }\n            }\n        }\n        _super.prototype.setProperties.call(this, prop, muteOnChange);\n    };\n    __decorate([\n        Property(null)\n    ], Range.prototype, \"dataSource\", void 0);\n    __decorate([\n        Property('A1')\n    ], Range.prototype, \"startCell\", void 0);\n    __decorate([\n        Property(null)\n    ], Range.prototype, \"query\", void 0);\n    __decorate([\n        Property(true)\n    ], Range.prototype, \"showFieldAsHeader\", void 0);\n    __decorate([\n        Property('')\n    ], Range.prototype, \"template\", void 0);\n    __decorate([\n        Property('A1')\n    ], Range.prototype, \"address\", void 0);\n    return Range;\n}(ChildProperty));\nexport { Range };\n/**\n * Used range which contains end row index and end column index of the last used cell in sheet .\n */\nvar UsedRange = /** @class */ (function (_super) {\n    __extends(UsedRange, _super);\n    function UsedRange() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], UsedRange.prototype, \"rowIndex\", void 0);\n    __decorate([\n        Property(0)\n    ], UsedRange.prototype, \"colIndex\", void 0);\n    return UsedRange;\n}(ChildProperty));\nexport { UsedRange };\n/**\n * Configures the sheet behavior for the spreadsheet.\n */\nvar Sheet = /** @class */ (function (_super) {\n    __extends(Sheet, _super);\n    function Sheet() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], Sheet.prototype, \"rows\", void 0);\n    __decorate([\n        Property([])\n    ], Sheet.prototype, \"columns\", void 0);\n    __decorate([\n        Complex({}, ProtectSettings)\n    ], Sheet.prototype, \"protectSettings\", void 0);\n    __decorate([\n        Collection([], Range)\n    ], Sheet.prototype, \"ranges\", void 0);\n    __decorate([\n        Collection([], ConditionalFormat)\n    ], Sheet.prototype, \"conditionalFormats\", void 0);\n    __decorate([\n        Property(0)\n    ], Sheet.prototype, \"index\", void 0);\n    __decorate([\n        Property('')\n    ], Sheet.prototype, \"name\", void 0);\n    __decorate([\n        Property(100)\n    ], Sheet.prototype, \"rowCount\", void 0);\n    __decorate([\n        Property(100)\n    ], Sheet.prototype, \"colCount\", void 0);\n    __decorate([\n        Property('A1:A1')\n    ], Sheet.prototype, \"selectedRange\", void 0);\n    __decorate([\n        Property('A1')\n    ], Sheet.prototype, \"activeCell\", void 0);\n    __decorate([\n        Property({})\n    ], Sheet.prototype, \"usedRange\", void 0);\n    __decorate([\n        Property('A1')\n    ], Sheet.prototype, \"topLeftCell\", void 0);\n    __decorate([\n        Property(true)\n    ], Sheet.prototype, \"showHeaders\", void 0);\n    __decorate([\n        Property(true)\n    ], Sheet.prototype, \"showGridLines\", void 0);\n    __decorate([\n        Property(false)\n    ], Sheet.prototype, \"isProtected\", void 0);\n    __decorate([\n        Property('Visible')\n    ], Sheet.prototype, \"state\", void 0);\n    return Sheet;\n}(ChildProperty));\nexport { Sheet };\n/**\n * To get sheet index from address.\n * @hidden\n */\nexport function getSheetIndex(context, name) {\n    var idx;\n    for (var i = 0; i < context.sheets.length; i++) {\n        if (context.sheets[i].name.toLowerCase() === name.toLowerCase()) {\n            idx = i;\n            break;\n        }\n    }\n    return idx;\n}\n/**\n * To get sheet index from sheet id.\n * @hidden\n */\nexport function getSheetIndexFromId(context, id) {\n    var idx;\n    for (var i = 0; i < context.sheets.length; i++) {\n        if (context.sheets[i].id === id) {\n            idx = i;\n            break;\n        }\n    }\n    return idx;\n}\n/**\n * To get sheet name from address.\n * @hidden\n */\nexport function getSheetNameFromAddress(address) {\n    return address.split('!')[0].replace(/\\'/gi, '');\n}\n/**\n * To get sheet index from sheet name.\n * @hidden\n */\nexport function getSheetIndexByName(context, name, info) {\n    var len = info.length;\n    for (var i = 0; i < len; i++) {\n        if (info[i].sheet.toUpperCase() === name.toUpperCase()) {\n            return info[i].index;\n        }\n    }\n    return -1;\n}\n/**\n * update selected range\n * @hidden\n */\nexport function updateSelectedRange(context, range, sheet) {\n    if (sheet === void 0) { sheet = {}; }\n    context.setSheetPropertyOnMute(sheet, 'selectedRange', range);\n}\n/**\n * get selected range\n * @hidden\n */\nexport function getSelectedRange(sheet) {\n    return sheet && sheet.selectedRange || 'A1';\n}\n/**\n * @hidden\n */\nexport function getSheet(context, idx) {\n    return context.sheets[idx];\n}\n/**\n * @hidden\n */\nexport function getSheetNameCount(context) {\n    var name = [];\n    context.sheets.forEach(function (sheet) {\n        name.push(sheet.name.toLowerCase());\n    });\n    for (var i = 0; i < name.length; i++) {\n        if (name.indexOf('sheet' + context.sheetNameCount) > -1) {\n            context.sheetNameCount++;\n        }\n        else {\n            return context.sheetNameCount++;\n        }\n    }\n    return context.sheetNameCount++;\n}\n/**\n * @hidden\n */\nexport function getMaxSheetId(sheets) {\n    var cnt = 0;\n    sheets.forEach(function (sheet) {\n        cnt = Math.max(sheet.id, cnt);\n    });\n    return cnt + 1;\n}\n/**\n * @hidden\n */\nexport function initSheet(context, sheet) {\n    var sheets = sheet ? sheet : context.sheets;\n    sheets.forEach(function (sheet) {\n        sheet.id = sheet.id || 0;\n        sheet.name = sheet.name || '';\n        sheet.rowCount = isUndefined(sheet.rowCount) ? 100 : sheet.rowCount;\n        sheet.colCount = isUndefined(sheet.colCount) ? 100 : sheet.colCount;\n        sheet.topLeftCell = sheet.topLeftCell || 'A1';\n        sheet.activeCell = sheet.activeCell || 'A1';\n        sheet.selectedRange = sheet.selectedRange || 'A1:A1';\n        sheet.usedRange = sheet.usedRange || { rowIndex: 0, colIndex: 0 };\n        context.setSheetPropertyOnMute(sheet, 'ranges', sheet.ranges ? sheet.ranges : []);\n        context.setSheetPropertyOnMute(sheet, 'rows', sheet.rows || []);\n        context.setSheetPropertyOnMute(sheet, 'columns', sheet.columns || []);\n        sheet.showHeaders = isUndefined(sheet.showHeaders) ? true : sheet.showHeaders;\n        sheet.showGridLines = isUndefined(sheet.showGridLines) ? true : sheet.showGridLines;\n        sheet.state = sheet.state || 'Visible';\n        sheet.maxHgts = [];\n        sheet.protectSettings = sheet.protectSettings || { selectCells: false, formatCells: false, formatRows: false, formatColumns: false,\n            insertLink: false };\n        sheet.isProtected = sheet.isProtected || false;\n        processIdx(sheet.columns);\n        initRow(sheet.rows);\n    });\n    processIdx(sheets, true, context);\n}\nfunction initRangeSettings(ranges) {\n    ranges.forEach(function (range) {\n        range.startCell = range.startCell || 'A1';\n        range.address = range.address || 'A1';\n        range.template = range.template || '';\n        range.showFieldAsHeader = isUndefined(range.showFieldAsHeader) ? true : range.showFieldAsHeader;\n    });\n    return ranges;\n}\nfunction initRow(rows) {\n    rows.forEach(function (row) {\n        if (row && row.cells) {\n            processIdx(row.cells);\n        }\n    });\n    processIdx(rows);\n}\n/**\n * get sheet name\n * @hidden\n */\nexport function getSheetName(context, idx) {\n    if (idx === void 0) { idx = context.activeSheetIndex; }\n    return getSheet(context, idx).name;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { ChildProperty, Collection, Property, Complex } from '@syncfusion/ej2-base';\nimport { Cell } from './cell';\nimport { Format } from '../common/index';\n/**\n * Configures the Row behavior for the spreadsheet.\n *  ```html\n * <div id='Spreadsheet'></div>\n * ```\n * ```typescript\n * let spreadsheet: Spreadsheet = new Spreadsheet({\n *      sheets: [{\n *                rows: [{\n *                        index: 30,\n *                        cells: [{ index: 4, value: 'Total Amount:' },\n *                               { formula: '=SUM(F2:F30)', style: { fontWeight: 'bold' } }]\n *                }]\n * ...\n * });\n * spreadsheet.appendTo('#Spreadsheet');\n * ```\n */\nvar Row = /** @class */ (function (_super) {\n    __extends(Row, _super);\n    function Row() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Collection([], Cell)\n    ], Row.prototype, \"cells\", void 0);\n    __decorate([\n        Property(0)\n    ], Row.prototype, \"index\", void 0);\n    __decorate([\n        Property(20)\n    ], Row.prototype, \"height\", void 0);\n    __decorate([\n        Property(false)\n    ], Row.prototype, \"customHeight\", void 0);\n    __decorate([\n        Property(false)\n    ], Row.prototype, \"hidden\", void 0);\n    __decorate([\n        Complex({}, Format)\n    ], Row.prototype, \"format\", void 0);\n    return Row;\n}(ChildProperty));\nexport { Row };\n/**\n * @hidden\n */\nexport function getRow(sheet, rowIndex) {\n    return sheet.rows[rowIndex];\n}\n/** @hidden */\nexport function setRow(sheet, rowIndex, row) {\n    if (!sheet.rows[rowIndex]) {\n        sheet.rows[rowIndex] = {};\n    }\n    Object.keys(row).forEach(function (key) {\n        sheet.rows[rowIndex][key] = row[key];\n    });\n}\n/** @hidden */\nexport function isHiddenRow(sheet, index) {\n    return sheet.rows[index] && sheet.rows[index].hidden;\n}\n/**\n * @hidden\n */\nexport function getRowHeight(sheet, rowIndex) {\n    if (sheet && sheet.rows && sheet.rows[rowIndex]) {\n        if (sheet.rows[rowIndex].hidden) {\n            return 0;\n        }\n        return sheet.rows[rowIndex].height === undefined ? 20 : sheet.rows[rowIndex].height;\n    }\n    else {\n        return 20;\n    }\n}\n/**\n * @hidden\n */\nexport function setRowHeight(sheet, rowIndex, height) {\n    if (sheet && sheet.rows) {\n        if (!sheet.rows[rowIndex]) {\n            sheet.rows[rowIndex] = {};\n        }\n        sheet.rows[rowIndex].height = height;\n    }\n}\n/**\n * @hidden\n */\nexport function getRowsHeight(sheet, startRow, endRow) {\n    if (endRow === void 0) { endRow = startRow; }\n    var height = 0;\n    var swap;\n    if (startRow > endRow) {\n        swap = startRow;\n        startRow = endRow;\n        endRow = swap;\n    }\n    for (var i = startRow; i <= endRow; i++) {\n        height += getRowHeight(sheet, i);\n    }\n    return height;\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { ChildProperty, Property, Complex } from '@syncfusion/ej2-base';\nimport { Format } from '../common/index';\n/**\n * Configures the Column behavior for the spreadsheet.\n */\nvar Column = /** @class */ (function (_super) {\n    __extends(Column, _super);\n    function Column() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(0)\n    ], Column.prototype, \"index\", void 0);\n    __decorate([\n        Property(64)\n    ], Column.prototype, \"width\", void 0);\n    __decorate([\n        Property(false)\n    ], Column.prototype, \"customWidth\", void 0);\n    __decorate([\n        Property(false)\n    ], Column.prototype, \"hidden\", void 0);\n    __decorate([\n        Complex({}, Format)\n    ], Column.prototype, \"format\", void 0);\n    __decorate([\n        Property(true)\n    ], Column.prototype, \"isLocked\", void 0);\n    return Column;\n}(ChildProperty));\nexport { Column };\n/**\n * @hidden\n */\nexport function getColumn(sheet, colIndex) {\n    if (sheet.columns) {\n        if (!sheet.columns[colIndex]) {\n            sheet.columns[colIndex] = {};\n        }\n    }\n    else {\n        sheet.columns = [];\n        sheet.columns[colIndex] = {};\n    }\n    return sheet.columns[colIndex];\n}\n/** @hidden */\nexport function setColumn(sheet, colIndex, column) {\n    var curColumn = getColumn(sheet, colIndex);\n    Object.keys(column).forEach(function (key) {\n        curColumn[key] = column[key];\n    });\n}\n/**\n * @hidden\n */\nexport function getColumnWidth(sheet, index, skipHidden) {\n    if (sheet && sheet.columns && sheet.columns[index]) {\n        if (!skipHidden && sheet.columns[index].hidden) {\n            return 0;\n        }\n        return (sheet.columns[index].width || sheet.columns[index].customWidth) ? sheet.columns[index].width : 64;\n    }\n    else {\n        return 64;\n    }\n}\n/**\n * @hidden\n */\nexport function getColumnsWidth(sheet, startCol, endCol) {\n    if (endCol === void 0) { endCol = startCol; }\n    var width = 0;\n    if (startCol > endCol) {\n        var swap = startCol;\n        startCol = endCol;\n        endCol = swap;\n    }\n    for (var i = startCol; i <= endCol; i++) {\n        width += getColumnWidth(sheet, i);\n    }\n    return width;\n}\n/** @hidden */\nexport function isHiddenCol(sheet, index) {\n    return sheet.columns[index] && sheet.columns[index].hidden;\n}\n","import { getWorkbookRequiredModules } from '../../workbook/common/module';\n/**\n * To get Spreadsheet required modules.\n * @hidden\n * @param {Spreadsheet} context\n */\nexport function getRequiredModules(context) {\n    var modules = [];\n    pushBasicModules(context, modules);\n    getWorkbookRequiredModules(context, modules);\n    return modules;\n}\n// tslint:disable-next-line:max-func-body-length\nfunction pushBasicModules(context, modules) {\n    modules.push({ member: 'basic', args: [] });\n    modules.push({ member: 'all', args: [] });\n    if (context.showRibbon) {\n        modules.push({\n            member: 'ribbon',\n            args: [context]\n        });\n    }\n    if (context.showFormulaBar) {\n        modules.push({\n            member: 'formulaBar',\n            args: [context]\n        });\n    }\n    if (context.showSheetTabs) {\n        modules.push({\n            member: 'sheetTabs',\n            args: [context]\n        });\n    }\n    if (context.allowEditing) {\n        modules.push({\n            member: 'edit',\n            args: [context]\n        });\n        modules.push({\n            member: 'formula',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookFormula',\n            args: [context]\n        });\n        modules.push({\n            member: 'workbookEdit',\n            args: [context]\n        });\n    }\n    if (context.allowOpen) {\n        modules.push({\n            member: 'open',\n            args: [context]\n        });\n    }\n    if (context.allowSave) {\n        modules.push({\n            member: 'save',\n            args: [context]\n        });\n    }\n    if (context.enableContextMenu) {\n        modules.push({\n            member: 'contextMenu',\n            args: [context]\n        });\n    }\n    if (context.selectionSettings.mode !== 'None') {\n        modules.push({\n            member: 'selection',\n            args: [context]\n        });\n    }\n    if (context.enableKeyboardNavigation) {\n        modules.push({\n            member: 'keyboardNavigation',\n            args: [context]\n        });\n    }\n    if (context.allowNumberFormatting) {\n        modules.push({\n            member: 'numberFormat',\n            args: [context]\n        });\n    }\n    if (context.enableKeyboardShortcut) {\n        modules.push({\n            member: 'keyboardShortcut',\n            args: [context]\n        });\n    }\n    if (context.enableClipboard) {\n        modules.push({\n            member: 'clipboard',\n            args: [context]\n        });\n    }\n    if (context.allowCellFormatting) {\n        modules.push({\n            member: 'cellformat',\n            args: [context]\n        });\n    }\n    if (context.allowSorting) {\n        modules.push({ member: 'sort', args: [context] });\n    }\n    if (context.allowResizing) {\n        modules.push({\n            member: 'resize',\n            args: [context]\n        });\n    }\n    modules.push({\n        member: 'collaborativeEditing',\n        args: [context]\n    });\n    modules.push({\n        member: 'protectSheet',\n        args: [context]\n    });\n    if (context.allowHyperlink) {\n        modules.push({\n            member: 'spreadsheetHyperlink',\n            args: [context]\n        });\n    }\n    if (context.allowUndoRedo) {\n        modules.push({\n            member: 'undoredo',\n            args: [context]\n        });\n    }\n    if (context.allowFiltering) {\n        modules.push({ member: 'filter', args: [context] });\n    }\n    if (context.allowWrap) {\n        modules.push({ member: 'wrapText', args: [context] });\n    }\n    if (context.allowInsert) {\n        modules.push({ member: 'insert', args: [context] });\n    }\n    if (context.allowDelete) {\n        modules.push({ member: 'delete', args: [context] });\n    }\n    if (context.allowDataValidation) {\n        modules.push({ member: 'dataValidation', args: [context] });\n    }\n    if (context.allowFindAndReplace) {\n        modules.push({ member: 'findAndReplace', args: [context] });\n    }\n    if (context.allowMerge) {\n        modules.push({ member: 'merge', args: [context] });\n    }\n    if (context.allowConditionalFormat) {\n        modules.push({ member: 'conditionalFormatting', args: [context] });\n    }\n    if (context.allowImage) {\n        modules.push({ member: 'spreadsheetImage', args: [context] });\n    }\n    if (context.allowChart) {\n        modules.push({ member: 'spreadsheetChart', args: [context] });\n    }\n}\n","import { Browser, setStyleAttribute as setBaseStyleAttribute, getComponent } from '@syncfusion/ej2-base';\nimport { clearViewer, deleteImage, createImageElement, refreshImgCellObj } from './index';\nimport { getRowsHeight, getColumnsWidth, getSwapRange, clearCells } from '../../workbook/index';\nimport { getRangeIndexes, wrap, setRowHeight, insertModel, } from '../../workbook/index';\nimport { initiateSort, getIndexesFromAddress, getRowHeight, setMerge } from '../../workbook/index';\nimport { setValidation, removeValidation, clearCFRule, setCFRule } from '../../workbook/index';\nimport { removeSheetTab, rowHeightChanged } from './index';\nimport { getCellIndexes, getCell, setChart, refreshChartSize } from '../../workbook/index';\nimport { deleteChart } from '../../spreadsheet/index';\nimport { initiateFilterUI } from './event';\n/**\n * The function used to update Dom using requestAnimationFrame.\n * @param  {Function} fn - Function that contains the actual action\n * @return {Promise<T>}\n * @hidden\n */\nexport function getUpdateUsingRaf(fn) {\n    requestAnimationFrame(function () {\n        fn();\n    });\n}\n/**\n * The function used to remove the dom element children.\n * @param  parent -\n * @hidden\n */\nexport function removeAllChildren(parent, index) {\n    while (parent.firstChild) {\n        parent.removeChild(parent.firstChild);\n    }\n}\n/**\n * The function used to get colgroup width based on the row index.\n * @param  parent -\n * @hidden\n */\nexport function getColGroupWidth(index) {\n    var width = 30;\n    if (index.toString().length > 3) {\n        width = index.toString().length * 10;\n    }\n    return width;\n}\nvar scrollAreaWidth = null;\n/** @hidden */\nexport function getScrollBarWidth() {\n    if (scrollAreaWidth !== null) {\n        return scrollAreaWidth;\n    }\n    var htmlDivNode = document.createElement('div');\n    var result = 0;\n    htmlDivNode.style.cssText = 'width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;';\n    document.body.appendChild(htmlDivNode);\n    result = (htmlDivNode.offsetWidth - htmlDivNode.clientWidth) | 0;\n    document.body.removeChild(htmlDivNode);\n    return scrollAreaWidth = result;\n}\nvar classes = ['e-ribbon', 'e-formula-bar-panel', 'e-sheet-tab-panel', 'e-header-toolbar'];\n/** @hidden */\nexport function getSiblingsHeight(element, classList) {\n    if (classList === void 0) { classList = classes; }\n    var previous = getHeightFromDirection(element, 'previous', classList);\n    var next = getHeightFromDirection(element, 'next', classList);\n    return previous + next;\n}\nfunction getHeightFromDirection(element, direction, classList) {\n    // tslint:disable-next-line:no-any\n    var sibling = (element)[direction + 'ElementSibling'];\n    var result = 0;\n    while (sibling) {\n        if (classList.some(function (value) { return sibling.classList.contains(value); })) {\n            result += sibling.offsetHeight;\n        }\n        // tslint:disable-next-line:no-any\n        sibling = (sibling)[direction + 'ElementSibling'];\n    }\n    return result;\n}\n/**\n * @hidden\n */\nexport function inView(context, range, isModify) {\n    if (context.scrollSettings.enableVirtualization) {\n        var topIdx = context.viewport.topIndex;\n        var leftIdx = context.viewport.leftIndex;\n        var bottomIdx = topIdx + context.viewport.rowCount + context.getThreshold('row') * 2;\n        var rightIdx = leftIdx + context.viewport.colCount + context.getThreshold('col') * 2;\n        var inView_1 = topIdx <= range[0] && bottomIdx >= range[2] && leftIdx <= range[1] && rightIdx >= range[3];\n        if (inView_1) {\n            return true;\n        }\n        if (isModify) {\n            if (range[0] < topIdx && range[2] < topIdx || range[0] > bottomIdx && range[2] > bottomIdx) {\n                return false;\n            }\n            else {\n                if (range[0] < topIdx && range[2] > topIdx) {\n                    range[0] = topIdx;\n                    inView_1 = true;\n                }\n                if (range[2] > bottomIdx) {\n                    range[2] = bottomIdx;\n                    inView_1 = true;\n                }\n            }\n            if (range[1] < leftIdx && range[3] < leftIdx || range[1] > rightIdx && range[3] > rightIdx) {\n                return false;\n            }\n            else {\n                if (range[1] < leftIdx && range[3] > leftIdx) {\n                    range[1] = leftIdx;\n                    inView_1 = true;\n                }\n                if (range[3] > rightIdx) {\n                    range[3] = rightIdx;\n                    inView_1 = true;\n                }\n            }\n        }\n        return inView_1;\n    }\n    else {\n        return true;\n    }\n}\n/**\n * To get the top left cell position in viewport.\n * @hidden\n */\nexport function getCellPosition(sheet, indexes, offset) {\n    if (offset === void 0) { offset = { left: { idx: 0, size: 0 }, top: { idx: 0, size: 0 } }; }\n    var i;\n    var top = offset.top.size;\n    var left = offset.left.size;\n    for (i = offset.top.idx; i < indexes[0]; i++) {\n        top += getRowsHeight(sheet, i);\n    }\n    for (i = offset.left.idx; i < indexes[1]; i++) {\n        left += getColumnsWidth(sheet, i);\n    }\n    return { top: top, left: left };\n}\n/**\n * Position element with given range\n * @hidden\n */\nexport function locateElem(ele, range, sheet, isRtl, offset) {\n    var swapRange = getSwapRange(range);\n    var cellPosition = getCellPosition(sheet, swapRange, offset);\n    var startIndex = [skipHiddenIdx(sheet, 0, true), skipHiddenIdx(sheet, 0, true, 'columns')];\n    var attrs = {\n        'top': (swapRange[0] === startIndex[0] ? cellPosition.top : cellPosition.top - 1) + 'px',\n        'height': getRowsHeight(sheet, range[0], range[2]) + (swapRange[0] === startIndex[0] ? 0 : 1) + 'px',\n        'width': getColumnsWidth(sheet, range[1], range[3]) + (swapRange[1] === startIndex[1] ? 0 : 1) + 'px'\n    };\n    attrs[isRtl ? 'right' : 'left'] = (swapRange[1] === startIndex[1] ? cellPosition.left : cellPosition.left - 1) + 'px';\n    if (ele) {\n        setStyleAttribute([{ element: ele, attrs: attrs }]);\n    }\n}\n/**\n * To update element styles using request animation frame\n * @hidden\n */\nexport function setStyleAttribute(styles) {\n    requestAnimationFrame(function () {\n        styles.forEach(function (style) {\n            setBaseStyleAttribute(style.element, style.attrs);\n        });\n    });\n}\n/**\n * @hidden\n */\nexport function getStartEvent() {\n    return (Browser.isPointer ? 'pointerdown' : 'mousedown touchstart');\n}\n/**\n * @hidden\n */\nexport function getMoveEvent() {\n    return (Browser.isPointer ? 'pointermove' : 'mousemove touchmove');\n}\n/**\n * @hidden\n */\nexport function getEndEvent() {\n    return (Browser.isPointer ? 'pointerup' : 'mouseup touchend');\n}\n/**\n * @hidden\n */\nexport function isTouchStart(e) {\n    return e.type === 'touchstart' || (e.type === 'pointerdown' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n */\nexport function isTouchMove(e) {\n    return e.type === 'touchmove' || (e.type === 'pointermove' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n */\nexport function isTouchEnd(e) {\n    return e.type === 'touchend' || (e.type === 'pointerup' && e.pointerType === 'touch');\n}\n/**\n * @hidden\n */\nexport function getClientX(e) {\n    return e.changedTouches ? e.changedTouches[0].clientX : e.clientX;\n}\n/**\n * @hidden\n */\nexport function getClientY(e) {\n    return e.changedTouches ? e.changedTouches[0].clientY : e.clientY;\n}\nvar config = {\n    role: 'role',\n    selected: 'aria-selected',\n    multiselectable: 'aria-multiselectable',\n    busy: 'aria-busy',\n    colcount: 'aria-colcount'\n};\n/** @hidden */\nexport function setAriaOptions(target, options) {\n    var props = Object.keys(options);\n    props.forEach(function (name) {\n        if (target) {\n            target.setAttribute(config[name], options[name]);\n        }\n    });\n}\n/**\n * @hidden\n */\nexport function destroyComponent(element, component) {\n    if (element) {\n        var compObj = getComponent(element, component);\n        if (compObj) {\n            compObj.destroy();\n        }\n    }\n}\n/**\n * @hidden\n */\n// tslint:disable-next-line:max-func-body-length\nexport function setResize(index, value, isCol, parent) {\n    var curEle;\n    var curEleH;\n    var curEleC;\n    var preEle;\n    var preEleH;\n    var preEleC;\n    var nxtEle;\n    var nxtEleH;\n    var nxtEleC;\n    var sheet = parent.getActiveSheet();\n    if (isCol) {\n        if (sheet.showHeaders) {\n            curEle = parent.element.getElementsByClassName('e-column-header')[0].getElementsByTagName('th')[index];\n            curEleH = parent.element.getElementsByClassName('e-column-header')[0].getElementsByTagName('col')[index];\n        }\n        curEleC = parent.element.getElementsByClassName('e-sheet-content')[0].getElementsByTagName('col')[index];\n    }\n    else {\n        if (sheet.showHeaders) {\n            curEle = parent.element.getElementsByClassName('e-row-header')[0].getElementsByTagName('tr')[index];\n            curEleH = parent.element.getElementsByClassName('e-row-header')[0].getElementsByTagName('tr')[index];\n            curEleH.style.height = parseInt(value, 10) > 0 ? value : '2px';\n        }\n        curEleC = parent.element.getElementsByClassName('e-sheet-content')[0].getElementsByTagName('tr')[index];\n        curEleC.style.height = parseInt(value, 10) > 0 ? value : '0px';\n        var hdrFntSize = void 0;\n        if (sheet.showHeaders) {\n            var hdrRow = parent.getRowHeaderContent().getElementsByClassName('e-row');\n            var hdrClone = [];\n            hdrClone[0] = hdrRow[index].getElementsByTagName('td')[0].cloneNode(true);\n            hdrFntSize = findMaxValue(parent.getRowHeaderTable(), hdrClone, false, parent) + 1;\n        }\n        var contentRow = parent.getMainContent().getElementsByClassName('e-row');\n        var contentClone = [];\n        for (var idx = 0; idx < contentRow[index].getElementsByTagName('td').length; idx++) {\n            contentClone[idx] = contentRow[index].getElementsByTagName('td')[idx].cloneNode(true);\n        }\n        var cntFntSize = findMaxValue(parent.getContentTable(), contentClone, false, parent) + 1;\n        var fntSize = hdrFntSize >= cntFntSize ? hdrFntSize : cntFntSize;\n        if (parseInt(curEleC.style.height, 10) < fntSize ||\n            (curEle && curEle.classList.contains('e-reach-fntsize') && parseInt(curEleC.style.height, 10) === fntSize)) {\n            if (sheet.showHeaders) {\n                curEle.classList.add('e-reach-fntsize');\n                curEleH.style.lineHeight = parseInt(value, 10) >= 4 ? ((parseInt(value, 10)) - 4) + 'px' :\n                    parseInt(value, 10) > 0 ? ((parseInt(value, 10)) - 1) + 'px' : '0px';\n            }\n            curEleC.style.lineHeight = parseInt(value, 10) > 0 ? ((parseInt(value, 10)) - 1) + 'px' : '0px';\n        }\n        else {\n            if (curEleH) {\n                curEleH.style.removeProperty('line-height');\n            }\n            curEleC.style.removeProperty('line-height');\n            if (curEle && curEle.classList.contains('e-reach-fntsize')) {\n                curEle.classList.remove('e-reach-fntsize');\n            }\n        }\n    }\n    preEleC = curEleC.previousElementSibling;\n    nxtEleC = curEleC.nextElementSibling;\n    if (preEleC) {\n        if (sheet.showHeaders) {\n            preEle = curEle.previousElementSibling;\n            preEleH = curEleH.previousElementSibling;\n        }\n        preEleC = curEleC.previousElementSibling;\n    }\n    if (nxtEleC) {\n        if (sheet.showHeaders) {\n            nxtEle = curEle.nextElementSibling;\n            nxtEleH = curEleH.nextElementSibling;\n        }\n        nxtEleC = curEleC.nextElementSibling;\n    }\n    if (parseInt(value, 10) <= 0 && !(curEleC.classList.contains('e-zero') || curEleC.classList.contains('e-zero-start'))) {\n        if (preEleC && nxtEleC) {\n            if (isCol) {\n                if (sheet.showHeaders) {\n                    curEleH.style.width = '2px';\n                }\n                curEleC.style.width = '0px';\n            }\n            else {\n                if (sheet.showHeaders) {\n                    curEleH.style.height = '2px';\n                }\n                curEleC.style.height = '0px';\n            }\n            if (preEleC.classList.contains('e-zero-start')) {\n                if (sheet.showHeaders) {\n                    curEle.classList.add('e-zero-start');\n                }\n                curEleC.classList.add('e-zero-start');\n            }\n            else {\n                if (sheet.showHeaders) {\n                    curEle.classList.add('e-zero');\n                }\n                curEleC.classList.add('e-zero');\n            }\n            if (nxtEle && !nxtEle.classList.contains('e-zero') && !nxtEle.classList.contains('e-zero-last')) {\n                if (sheet.showHeaders) {\n                    curEle.classList.add('e-zero-last');\n                }\n                curEleC.classList.add('e-zero-last');\n            }\n            if (preEleC.classList.contains('e-zero-last')) {\n                if (sheet.showHeaders) {\n                    preEle.classList.remove('e-zero-last');\n                }\n                preEleC.classList.remove('e-zero-last');\n            }\n            if (sheet.showHeaders && preEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero-end')) {\n                    setWidthAndHeight(preEleH, -2, isCol);\n                }\n                else {\n                    setWidthAndHeight(preEleH, -2, isCol);\n                }\n            }\n            else if (sheet.showHeaders) {\n                setWidthAndHeight(preEleH, -1, isCol);\n            }\n            if (sheet.showHeaders && preEle.classList.contains('e-zero-start')) {\n                setWidthAndHeight(curEleH, -1, isCol);\n            }\n            if (sheet.showHeaders && nxtEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero-start')) {\n                    while (nxtEle) {\n                        if (nxtEle.classList.contains('e-zero') && (parseInt(nxtEleH.style.height, 10) !== 0 && !isCol) ||\n                            (parseInt(nxtEleH.style.width, 10) !== 0 && isCol)) {\n                            if (isCol) {\n                                curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                                nxtEleH.style.width = parseInt(nxtEleH.style.width, 10) - 1 + 'px';\n                            }\n                            else {\n                                curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                                nxtEleH.style.height = parseInt(nxtEleH.style.height, 10) - 1 + 'px';\n                            }\n                            nxtEle.classList.remove('e-zero');\n                            nxtEle.classList.add('e-zero-start');\n                            break;\n                        }\n                        else {\n                            var nxtIndex = void 0;\n                            nxtEle.classList.remove('e-zero');\n                            nxtEle.classList.add('e-zero-start');\n                            if (isCol) {\n                                nxtIndex = parseInt(nxtEle.getAttribute('aria-colindex'), 10) - 1;\n                                nxtEle = parent.getColHeaderTable().getElementsByTagName('th')[nxtIndex + 1];\n                                nxtEleH = parent.getColHeaderTable().getElementsByTagName('col')[nxtIndex + 1];\n                            }\n                            else {\n                                nxtIndex = parseInt(nxtEle.getAttribute('aria-rowindex'), 10) - 1;\n                                nxtEle = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                                nxtEleH = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                            }\n                        }\n                    }\n                }\n                else {\n                    setWidthAndHeight(curEleH, -2, isCol);\n                }\n            }\n            else if (sheet.showHeaders) {\n                if (nxtEle.classList.contains('e-zero-end')) {\n                    if (isCol) {\n                        curEleH.style.width = '0px';\n                    }\n                    else {\n                        curEleH.style.height = '0px';\n                    }\n                }\n                else {\n                    setWidthAndHeight(nxtEleH, -1, isCol);\n                }\n            }\n        }\n        else if (preEleC) {\n            if (isCol) {\n                if (sheet.showHeaders) {\n                    curEleH.style.width = '1px';\n                }\n                curEleC.style.width = '0px';\n            }\n            else {\n                if (sheet.showHeaders) {\n                    curEleH.style.height = '1px';\n                }\n                curEleC.style.height = '0px';\n            }\n            if (sheet.showHeaders) {\n                curEle.classList.add('e-zero-end');\n            }\n            curEleC.classList.add('e-zero-end');\n            if (sheet.showHeaders) {\n                curEle.classList.add('e-zero-last');\n            }\n            curEleC.classList.add('e-zero-last');\n            if (sheet.showHeaders && preEle.classList.contains('e-zero')) {\n                setWidthAndHeight(preEleH, -2, isCol);\n            }\n            else {\n                setWidthAndHeight(preEleH, -1, isCol);\n            }\n        }\n        else if (nxtEle) {\n            curEle.classList.add('e-zero-start');\n            curEleC.classList.add('e-zero-start');\n            if (!nxtEle.classList.contains('e-zero')) {\n                curEle.classList.add('e-zero-last');\n                curEleC.classList.add('e-zero-last');\n            }\n            if (isCol) {\n                curEleH.style.width = '1px';\n                curEleC.style.width = '0px';\n            }\n            else {\n                curEleH.style.height = '1px';\n                curEleC.style.height = '0px';\n            }\n            if (sheet.showHeaders && nxtEle.classList.contains('e-zero')) {\n                while (nxtEle) {\n                    if (nxtEle.classList.contains('e-zero') && (parseInt(nxtEleH.style.width, 10) !== 0\n                        && isCol) || (parseInt(nxtEleH.style.height, 10) !== 0 && !isCol)) {\n                        if (isCol) {\n                            nxtEleH.style.width = parseInt(nxtEleH.style.width, 10) - 1 + 'px';\n                            curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                        }\n                        else {\n                            nxtEleH.style.height = parseInt(nxtEleH.style.height, 10) - 1 + 'px';\n                            curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                        }\n                        nxtEle.classList.add('e-zero-start');\n                        nxtEle.classList.remove('e-zero');\n                        break;\n                    }\n                    else {\n                        var nxtIndex = void 0;\n                        nxtEle.classList.add('e-zero-start');\n                        nxtEle.classList.remove('e-zero');\n                        if (isCol) {\n                            nxtIndex = parseInt(nxtEle.getAttribute('aria-colindex'), 10) - 1;\n                            nxtEleH = parent.getColHeaderTable().getElementsByTagName('col')[nxtIndex + 1];\n                            nxtEle = parent.getColHeaderTable().getElementsByTagName('th')[nxtIndex + 1];\n                        }\n                        else {\n                            nxtIndex = parseInt(nxtEle.getAttribute('aria-rowindex'), 10) - 1;\n                            nxtEleH = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                            nxtEle = parent.getRowHeaderTable().getElementsByTagName('tr')[nxtIndex + 1];\n                        }\n                    }\n                }\n            }\n            else if (sheet.showHeaders) {\n                setWidthAndHeight(nxtEleH, -1, isCol);\n            }\n        }\n    }\n    else if (parseInt(value, 10) > 0) {\n        if (isCol) {\n            if (sheet.showHeaders) {\n                curEleH.style.width = value;\n            }\n            curEleC.style.width = value;\n        }\n        else {\n            if (sheet.showHeaders) {\n                curEleH.style.height = value;\n            }\n            curEleC.style.height = value;\n        }\n        if (sheet.showHeaders && preEle && nxtEle) {\n            if (preEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero')) {\n                    if (isCol) {\n                        preEleH.style.width = parseInt(preEleH.style.width, 10) + 2 + 'px';\n                        curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                    }\n                    else {\n                        preEleH.style.height = parseInt(preEleH.style.height, 10) + 2 + 'px';\n                        curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                    }\n                }\n                else {\n                    setWidthAndHeight(curEleH, -1, isCol);\n                }\n            }\n            else {\n                if (curEle.classList.contains('e-zero')) {\n                    setWidthAndHeight(preEleH, 1, isCol);\n                }\n                else {\n                    if (curEle.classList.contains('e-zero-start')) {\n                        if (isCol) {\n                            preEleH.style.width = parseInt(preEleH.style.width, 10) + 1 + 'px';\n                            curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                        }\n                        else {\n                            preEleH.style.height = parseInt(preEleH.style.height, 10) + 1 + 'px';\n                            curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                        }\n                    }\n                }\n            }\n            if (nxtEle.classList.contains('e-zero')) {\n                setWidthAndHeight(curEleH, -1, isCol);\n            }\n            else {\n                if (curEle.classList.contains('e-zero') || curEle.classList.contains('e-zero-start')) {\n                    setWidthAndHeight(nxtEleH, 1, isCol);\n                }\n            }\n            if (curEle.classList.contains('e-zero')) {\n                curEle.classList.remove('e-zero');\n            }\n            if (curEle.classList.contains('e-zero-start')) {\n                curEle.classList.remove('e-zero-start');\n            }\n            if (curEleC.classList.contains('e-zero')) {\n                curEleC.classList.remove('e-zero');\n            }\n            if (curEleC.classList.contains('e-zero-start')) {\n                curEleC.classList.remove('e-zero-start');\n            }\n            if (curEle.classList.contains('e-zero-last')) {\n                curEle.classList.remove('e-zero-last');\n            }\n            if (curEleC.classList.contains('e-zero-last')) {\n                curEleC.classList.remove('e-zero-last');\n            }\n            if (preEle.classList.contains('e-zero') || preEle.classList.contains('e-zero-start')) {\n                preEle.classList.add('e-zero-last');\n                preEleC.classList.add('e-zero-last');\n            }\n        }\n        else if (sheet.showHeaders && preEle) {\n            if (preEle.classList.contains('e-zero')) {\n                if (curEle.classList.contains('e-zero')) {\n                    if (isCol) {\n                        curEleH.style.width = parseInt(curEleH.style.width, 10) - 1 + 'px';\n                        preEleH.style.width = parseInt(preEleH.style.width, 10) + 2 + 'px';\n                    }\n                    else {\n                        curEleH.style.height = parseInt(curEleH.style.height, 10) - 1 + 'px';\n                        preEleH.style.height = parseInt(preEleH.style.height, 10) + 2 + 'px';\n                    }\n                }\n                else {\n                    setWidthAndHeight(curEleH, -1, isCol);\n                }\n            }\n            else {\n                if (curEle.classList.contains('e-zero')) {\n                    setWidthAndHeight(preEleH, 1, isCol);\n                }\n                else {\n                    setWidthAndHeight(curEleH, -1, isCol);\n                }\n            }\n            if (curEle.classList.contains('e-zero')) {\n                curEle.classList.remove('e-zero');\n            }\n            if (curEle.classList.contains('e-zero-end')) {\n                curEle.classList.remove('e-zero-end');\n            }\n            if (curEleC.classList.contains('e-zero')) {\n                curEleC.classList.remove('e-zero');\n            }\n            if (curEleC.classList.contains('e-zero-end')) {\n                curEleC.classList.remove('e-zero-end');\n            }\n        }\n        else if (sheet.showHeaders && nxtEle) {\n            if (nxtEle.classList.contains('e-zero')) {\n                setWidthAndHeight(curEleH, -1, isCol);\n            }\n            else if (curEle.classList.contains('e-zero-start')) {\n                setWidthAndHeight(nxtEleH, 1, isCol);\n                curEle.classList.remove('e-zero-start');\n            }\n            if (curEle.classList.contains('e-zero')) {\n                curEle.classList.remove('e-zero');\n            }\n            if (curEleC.classList.contains('e-zero')) {\n                curEleC.classList.remove('e-zero');\n            }\n            if (curEle.classList.contains('e-zero-start')) {\n                curEle.classList.remove('e-zero-start');\n            }\n            if (curEleC.classList.contains('e-zero-start')) {\n                curEleC.classList.remove('e-zero-start');\n            }\n        }\n    }\n}\n/**\n * @hidden\n */\nexport function setWidthAndHeight(trgt, value, isCol) {\n    if (isCol) {\n        trgt.style.width = parseInt(trgt.style.width, 10) + value + 'px';\n    }\n    else {\n        trgt.style.height = parseInt(trgt.style.height, 10) + value + 'px';\n    }\n}\n/**\n * @hidden\n */\nexport function findMaxValue(table, text, isCol, parent, prevData, isWrap) {\n    var myTableDiv = parent.createElement('div', { className: parent.element.className, styles: 'display: block' });\n    var myTable = parent.createElement('table', {\n        className: table.className + 'e-resizetable',\n        styles: 'width: auto;height: auto'\n    });\n    var myTr = parent.createElement('tr');\n    if (isCol) {\n        text.forEach(function (element) {\n            var tr = myTr.cloneNode();\n            tr.appendChild(element);\n            myTable.appendChild(tr);\n        });\n    }\n    else {\n        text.forEach(function (element) {\n            myTr.appendChild(element.cloneNode(true));\n        });\n        myTable.appendChild(myTr);\n    }\n    myTableDiv.appendChild(myTable);\n    document.body.appendChild(myTableDiv);\n    var offsetWidthValue;\n    var offsetHeightValue;\n    if (!isWrap) {\n        offsetHeightValue = myTable.getBoundingClientRect().height;\n        offsetWidthValue = myTable.getBoundingClientRect().width;\n    }\n    else {\n        offsetHeightValue = parseInt(prevData, 10);\n        offsetWidthValue = parseInt(prevData, 10);\n    }\n    document.body.removeChild(myTableDiv);\n    if (isCol) {\n        return Math.ceil(offsetWidthValue);\n    }\n    else {\n        return Math.ceil(offsetHeightValue);\n    }\n}\n/**\n * @hidden\n */\n// tslint:disable-next-line\nexport function updateAction(options, spreadsheet, isRedo) {\n    /* tslint:disable-next-line no-any */\n    var eventArgs = options.eventArgs;\n    switch (options.action) {\n        case 'sorting':\n            var args = {\n                range: options.eventArgs.range,\n                sortOptions: options.eventArgs.sortOptions,\n                cancel: false\n            };\n            var promise = new Promise(function (resolve, reject) {\n                resolve((function () { })());\n            });\n            var sortArgs = { args: args, promise: promise };\n            spreadsheet.notify(initiateSort, sortArgs);\n            sortArgs.promise.then(function (args) {\n                spreadsheet.serviceLocator.getService('cell').refreshRange(getIndexesFromAddress(args.range));\n            });\n            break;\n        case 'cellSave':\n            var cellEvtArgs = options.eventArgs;\n            var cellValue = eventArgs.formula ? { formula: cellEvtArgs.formula } : { value: cellEvtArgs.value };\n            spreadsheet.updateCell(cellValue, cellEvtArgs.address);\n            break;\n        case 'cellDelete':\n            spreadsheet.clearRange(options.eventArgs.address, null, true);\n            spreadsheet.serviceLocator.getService('cell').refreshRange(getRangeIndexes(options.eventArgs.address));\n            break;\n        case 'format':\n            if (eventArgs.requestType === 'CellFormat') {\n                spreadsheet.cellFormat(eventArgs.style, eventArgs.range);\n            }\n            else {\n                spreadsheet.numberFormat(eventArgs.format, eventArgs.range);\n            }\n            break;\n        case 'clipboard':\n            if (eventArgs.copiedInfo.isCut && !isRedo) {\n                return;\n            }\n            var clipboardPromise = eventArgs.copiedInfo.isCut ? spreadsheet.cut(eventArgs.copiedRange)\n                : spreadsheet.copy(eventArgs.copiedRange);\n            clipboardPromise.then(function (args) {\n                spreadsheet.paste(eventArgs.pastedRange, eventArgs.type);\n            });\n            break;\n        case 'gridLines':\n            spreadsheet.setSheetPropertyOnMute(spreadsheet.sheets[eventArgs.sheetIdx], 'showGridLines', eventArgs.isShow);\n            break;\n        case 'headers':\n            spreadsheet.setSheetPropertyOnMute(spreadsheet.sheets[eventArgs.sheetIdx], 'showHeaders', eventArgs.isShow);\n            break;\n        case 'resize':\n        case 'resizeToFit':\n            if (eventArgs.isCol) {\n                if (eventArgs.hide === undefined) {\n                    spreadsheet.setColWidth(eventArgs.width, eventArgs.index, eventArgs.sheetIdx);\n                }\n                else {\n                    spreadsheet.hideColumn(eventArgs.index, eventArgs.index, eventArgs.hide);\n                }\n            }\n            else {\n                if (eventArgs.hide === undefined) {\n                    spreadsheet.setRowHeight(eventArgs.height, eventArgs.index, eventArgs.sheetIdx);\n                }\n                else {\n                    spreadsheet.hideRow(eventArgs.index, eventArgs.index, eventArgs.hide);\n                }\n            }\n            break;\n        case 'renameSheet':\n            spreadsheet.setSheetPropertyOnMute(spreadsheet.sheets[eventArgs.index - 1], 'name', eventArgs.value);\n            break;\n        case 'removeSheet':\n            spreadsheet.notify(removeSheetTab, {\n                index: eventArgs.index,\n                isAction: true,\n                count: eventArgs.sheetCount,\n                clicked: true\n            });\n            break;\n        case 'wrap':\n            wrap(options.eventArgs.address, options.eventArgs.wrap, spreadsheet);\n            break;\n        case 'hideShow':\n            eventArgs.isCol ? spreadsheet.hideColumn(eventArgs.startIndex, eventArgs.endIndex, eventArgs.hide) :\n                spreadsheet.hideRow(eventArgs.startIndex, eventArgs.endIndex, eventArgs.hide);\n            break;\n        case 'replace':\n            spreadsheet.updateCell({ value: eventArgs.compareVal }, eventArgs.address);\n            break;\n        case 'filter':\n            spreadsheet.notify(initiateFilterUI, { predicates: null, range: eventArgs.range, sIdx: eventArgs.index, isCut: true });\n            break;\n        case 'insert':\n            if (isRedo === false) {\n                spreadsheet.delete(options.eventArgs.index, options.eventArgs.index + (options.eventArgs.model.length - 1), options.eventArgs.modelType);\n            }\n            else {\n                spreadsheet.notify(insertModel, {\n                    model: options.eventArgs.modelType === 'Sheet' ? spreadsheet :\n                        spreadsheet.getActiveSheet(), start: options.eventArgs.index, end: options.eventArgs.index +\n                        (options.eventArgs.model.length - 1), modelType: options.eventArgs.modelType,\n                    isAction: false, checkCount: options.eventArgs.sheetCount,\n                    activeSheetIndex: options.eventArgs.activeSheetIndex\n                });\n            }\n            break;\n        case 'delete':\n            if (isRedo === false) {\n                spreadsheet.notify(insertModel, {\n                    model: options.eventArgs.modelType === 'Sheet' ? spreadsheet :\n                        spreadsheet.getActiveSheet(), start: options.eventArgs.deletedModel, modelType: options.eventArgs.modelType,\n                    isAction: false, columnCellsModel: options.eventArgs.deletedCellsModel\n                });\n            }\n            else {\n                spreadsheet.delete(options.eventArgs.startIndex, options.eventArgs.endIndex, options.eventArgs.modelType);\n            }\n            break;\n        case 'validation':\n            if (isRedo) {\n                var rules = {\n                    type: eventArgs.type, operator: eventArgs.operator, value1: eventArgs.value1,\n                    value2: eventArgs.value2, ignoreBlank: eventArgs.ignoreBlank, inCellDropDown: eventArgs.inCellDropDown\n                };\n                spreadsheet.notify(setValidation, { rules: rules, range: eventArgs.range });\n            }\n            else {\n                spreadsheet.notify(removeValidation, { range: eventArgs.range });\n            }\n            break;\n        case 'merge':\n            options.eventArgs.isAction = false;\n            spreadsheet.notify(setMerge, options.eventArgs);\n            break;\n        case 'clear':\n            spreadsheet.notify(clearViewer, { options: options.eventArgs, isPublic: true });\n            break;\n        case 'conditionalFormat':\n            if (isRedo) {\n                var conditionalFormat = {\n                    type: eventArgs.type, cFColor: eventArgs.cFColor, value: eventArgs.value,\n                    range: eventArgs.range\n                };\n                spreadsheet.notify(setCFRule, { conditionalFormat: conditionalFormat });\n            }\n            else {\n                spreadsheet.notify(clearCFRule, { range: eventArgs.range });\n            }\n            break;\n        case 'clearCF':\n            if (isRedo) {\n                spreadsheet.notify(clearCFRule, { range: eventArgs.selectedRange });\n            }\n            else {\n                spreadsheet.notify(clearCells, {\n                    conditionalFormats: eventArgs.cFormats,\n                    oldRange: eventArgs.oldRange, selectedRange: eventArgs.selectedRange\n                });\n            }\n            break;\n        case 'insertImage':\n            if (isRedo) {\n                spreadsheet.notify(createImageElement, {\n                    options: {\n                        src: options.eventArgs.imageData,\n                        height: options.eventArgs.imageHeight, width: options.eventArgs.imageWidth, imageId: options.eventArgs.id\n                    },\n                    range: options.eventArgs.range, isPublic: false, isUndoRedo: true\n                });\n            }\n            else {\n                spreadsheet.notify(deleteImage, {\n                    id: options.eventArgs.id, sheetIdx: options.eventArgs.sheetIndex + 1, range: options.eventArgs.range\n                });\n            }\n            break;\n        case 'imageRefresh':\n            var element = document.getElementById(options.eventArgs.id);\n            if (isRedo) {\n                options.eventArgs.isUndoRedo = true;\n                spreadsheet.notify(refreshImgCellObj, options.eventArgs);\n            }\n            else {\n                spreadsheet.notify(refreshImgCellObj, {\n                    prevTop: options.eventArgs.currentTop, prevLeft: options.eventArgs.currentLeft,\n                    currentTop: options.eventArgs.prevTop, currentLeft: options.eventArgs.prevLeft, id: options.eventArgs.id,\n                    currentHeight: options.eventArgs.prevHeight, currentWidth: options.eventArgs.prevWidth, requestType: 'imageRefresh',\n                    prevHeight: options.eventArgs.currentHeight, prevWidth: options.eventArgs.currentWidth, isUndoRedo: true\n                });\n            }\n            element.style.height = isRedo ? options.eventArgs.currentHeight + 'px' : options.eventArgs.prevHeight + 'px';\n            element.style.width = isRedo ? options.eventArgs.currentWidth + 'px' : options.eventArgs.prevWidth + 'px';\n            element.style.top = isRedo ? options.eventArgs.currentTop + 'px' : options.eventArgs.prevTop + 'px';\n            element.style.left = isRedo ? options.eventArgs.currentLeft + 'px' : options.eventArgs.prevLeft + 'px';\n            break;\n        case 'insertChart':\n            if (isRedo) {\n                var chartOptions = [{\n                        type: eventArgs.type, theme: eventArgs.theme, isSeriesInRows: eventArgs.isSeriesInRows,\n                        range: eventArgs.range, id: eventArgs.id, height: eventArgs.height, width: eventArgs.width\n                    }];\n                spreadsheet.notify(setChart, {\n                    chart: chartOptions, isInitCell: eventArgs.isInitCell, isUndoRedo: false, range: eventArgs.posRange\n                });\n            }\n            else {\n                spreadsheet.notify(deleteChart, { id: eventArgs.id });\n            }\n            break;\n        case 'deleteChart':\n            if (isRedo) {\n                spreadsheet.notify(deleteChart, { id: eventArgs.id });\n            }\n            else {\n                var chartOpts = [{\n                        type: eventArgs.type, theme: eventArgs.theme, isSeriesInRows: eventArgs.isSeriesInRows,\n                        range: eventArgs.range, id: eventArgs.id, height: eventArgs.height, width: eventArgs.width\n                    }];\n                spreadsheet.notify(setChart, {\n                    chart: chartOpts, isInitCell: eventArgs.isInitCell, isUndoRedo: false, range: eventArgs.posRange\n                });\n            }\n            break;\n        case 'chartRefresh':\n            var chartElement = document.getElementById(options.eventArgs.id);\n            if (chartElement) {\n                chartElement.style.height = isRedo ? options.eventArgs.currentHeight + 'px' : options.eventArgs.prevHeight + 'px';\n                chartElement.style.width = isRedo ? options.eventArgs.currentWidth + 'px' : options.eventArgs.prevWidth + 'px';\n                chartElement.style.top = isRedo ? options.eventArgs.currentTop + 'px' : options.eventArgs.prevTop + 'px';\n                chartElement.style.left = isRedo ? options.eventArgs.currentLeft + 'px' : options.eventArgs.prevLeft + 'px';\n            }\n            if (isRedo) {\n                options.eventArgs.isUndoRedo = true;\n                spreadsheet.notify(refreshChartSize, {\n                    height: chartElement.style.height, width: chartElement.style.width, overlayEle: chartElement\n                });\n            }\n            else {\n                spreadsheet.notify(refreshChartSize, {\n                    height: chartElement.style.height, width: chartElement.style.width, overlayEle: chartElement\n                });\n            }\n            break;\n    }\n}\n/**\n * @hidden\n */\nexport function hasTemplate(workbook, rowIdx, colIdx, sheetIdx) {\n    var sheet = workbook.sheets[sheetIdx];\n    var ranges = sheet.ranges;\n    var range;\n    for (var i = 0, len = ranges.length; i < len; i++) {\n        if (ranges[i].template) {\n            range = getRangeIndexes(ranges[i].address.length ? ranges[i].address : ranges[i].startCell);\n            if (range[0] <= rowIdx && range[1] <= colIdx && range[2] >= rowIdx && range[3] >= colIdx) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\n/**\n * Setting row height in view an model.\n * @hidden\n */\nexport function setRowEleHeight(parent, sheet, height, rowIdx, row, hRow, notifyRowHgtChange) {\n    if (notifyRowHgtChange === void 0) { notifyRowHgtChange = true; }\n    var prevHgt = getRowHeight(sheet, rowIdx);\n    var edit = parent.element.querySelector('.e-spreadsheet-edit');\n    if (edit && (edit.innerHTML.indexOf('\\n') > -1)) {\n        var actCell = getCellIndexes(parent.getActiveSheet().activeCell);\n        var cell = getCell(actCell[0], actCell[1], sheet);\n        var i = void 0;\n        var splitVal = edit.innerHTML.split('\\n');\n        var n = 0;\n        var valLength = splitVal.length;\n        for (i = 0; i < valLength; i++) {\n            var lines = getLines(splitVal[i], getExcludedColumnWidth(sheet, actCell[0], actCell[1]), cell.style, parent.cellStyle);\n            if (lines === 0) {\n                lines = 1; // for empty new line\n            }\n            n = n + lines;\n        }\n        height = getTextHeight(parent, cell.style || parent.cellStyle, n) + 1;\n    }\n    if (row || parent.getRow(rowIdx)) {\n        (row || parent.getRow(rowIdx)).style.height = height + \"px\";\n    }\n    if (sheet.showHeaders && hRow || parent.getRow(rowIdx, parent.getRowHeaderTable())) {\n        (hRow || parent.getRow(rowIdx, parent.getRowHeaderTable())).style.height = height + \"px\";\n    }\n    setRowHeight(sheet, rowIdx, height);\n    parent.setProperties({ sheets: parent.sheets }, true);\n    if (notifyRowHgtChange) {\n        parent.notify(rowHeightChanged, { rowIdx: rowIdx, threshold: height - prevHgt });\n    }\n}\n/** @hidden */\nexport function getTextHeight(context, style, lines) {\n    if (lines === void 0) { lines = 1; }\n    var fontSize = (style && style.fontSize) || context.cellStyle.fontSize;\n    var fontSizePx = fontSize.indexOf('pt') > -1 ? parseInt(fontSize, 10) * 1.33 : parseInt(fontSize, 10);\n    return Math.ceil(fontSizePx * (style && style.fontFamily === 'Arial Black' ? 1.44 : 1.24) * lines);\n}\n/** @hidden */\nexport function getTextWidth(text, style, parentStyle) {\n    if (!style) {\n        style = parentStyle;\n    }\n    var canvas = document.createElement('canvas');\n    var context = canvas.getContext('2d');\n    context.font = (style.fontStyle || parentStyle.fontStyle) + ' ' + (style.fontWeight || parentStyle.fontWeight) + ' '\n        + (style.fontSize || parentStyle.fontSize) + ' ' + (style.fontFamily || parentStyle.fontFamily);\n    return context.measureText(text).width;\n}\n/**\n * @hidden\n */\nexport function getLines(text, colwidth, style, parentStyle) {\n    var width;\n    var prevWidth = 0;\n    var textArr = text.toString().split(' ');\n    var spaceWidth = getTextWidth(' ', style, parentStyle);\n    var lines;\n    var cnt = 0;\n    textArr.forEach(function (txt) {\n        var lWidth = 0;\n        var cWidth = 0;\n        width = getTextWidth(txt, style, parentStyle);\n        lines = (prevWidth + width) / colwidth;\n        if (lines >= 1) {\n            if (prevWidth) {\n                cnt++;\n            }\n            if (width / colwidth >= 1) {\n                txt.split('').forEach(function (val) {\n                    cWidth = getTextWidth(val, style, parentStyle);\n                    lWidth += cWidth;\n                    if (lWidth > colwidth) {\n                        cnt++;\n                        lWidth = cWidth;\n                    }\n                });\n                prevWidth = lWidth + spaceWidth;\n            }\n            else {\n                prevWidth = width + spaceWidth;\n            }\n        }\n        else {\n            prevWidth += (width + spaceWidth);\n        }\n    });\n    if (prevWidth) {\n        cnt += Math.ceil((prevWidth - spaceWidth) / colwidth);\n    }\n    return cnt;\n}\n/**\n * calculation for width taken by border inside a cell\n */\nfunction getBorderWidth(rowIdx, colIdx, sheet) {\n    var width = 0;\n    var cell = getCell(rowIdx, colIdx, sheet, null, true);\n    var rightSideCell = getCell(rowIdx, colIdx + 1, sheet, null, true);\n    if (cell.style) {\n        if (cell.style.border) {\n            width = (colIdx === 0 ? 2 : 1) * parseFloat(cell.style.border.split('px')[0]);\n        }\n        else {\n            if (colIdx === 0 && cell.style.borderLeft) {\n                width = parseFloat(cell.style.borderLeft.split('px')[0]);\n            }\n            if (cell.style.borderRight) {\n                width += parseFloat(cell.style.borderRight.split('px')[0]);\n            }\n        }\n    }\n    if (!(cell.style && (cell.style.border || cell.style.borderRight)) && rightSideCell.style && rightSideCell.style.borderLeft) {\n        width += parseFloat(rightSideCell.style.borderLeft.split('px')[0]);\n    }\n    return width;\n}\n/**\n * calculation for height taken by border inside a cell\n * @hidden\n */\nexport function getBorderHeight(rowIdx, colIdx, sheet) {\n    var height = 0;\n    var cell = getCell(rowIdx, colIdx, sheet, null, true);\n    var bottomSideCell = getCell(rowIdx + 1, colIdx, sheet, null, true);\n    if (cell.style) {\n        if (cell.style.border) {\n            height = (rowIdx === 0 ? 2 : 1) * parseFloat(cell.style.border.split('px')[0]);\n        }\n        else {\n            if (rowIdx === 0 && cell.style.borderTop) {\n                height = parseFloat(cell.style.borderTop.split('px')[0]);\n            }\n            if (cell.style.borderBottom) {\n                height += parseFloat(cell.style.borderBottom.split('px')[0]);\n            }\n        }\n    }\n    if (!(cell.style && (cell.style.border || cell.style.borderBottom)) && bottomSideCell.style && bottomSideCell.style.borderTop) {\n        height += parseFloat(bottomSideCell.style.borderTop.split('px')[0]);\n    }\n    return height;\n}\n/**\n * Calculating column width by excluding cell padding and border width\n * @hidden\n */\nexport function getExcludedColumnWidth(sheet, rowIdx, startColIdx, endColIdx) {\n    if (endColIdx === void 0) { endColIdx = startColIdx; }\n    return getColumnsWidth(sheet, startColIdx, endColIdx) - (5 + getBorderWidth(rowIdx, startColIdx, sheet)); // 5 -> For cell padding\n}\n/**\n * Setting maximum height while doing formats and wraptext\n * @hidden\n */\nexport function setMaxHgt(sheet, rIdx, cIdx, hgt) {\n    if (!sheet.maxHgts[rIdx]) {\n        sheet.maxHgts[rIdx] = {};\n    }\n    sheet.maxHgts[rIdx][cIdx] = hgt;\n}\n/**\n * Getting maximum height by comparing each cell's modified height.\n * @hidden\n */\nexport function getMaxHgt(sheet, rIdx) {\n    var maxHgt = 0;\n    var rowHgt = sheet.maxHgts[rIdx];\n    if (rowHgt) {\n        Object.keys(rowHgt).forEach(function (key) {\n            if (rowHgt[key] > maxHgt) {\n                maxHgt = rowHgt[key];\n            }\n        });\n    }\n    return maxHgt;\n}\n/** @hidden */\nexport function skipHiddenIdx(sheet, index, increase, layout) {\n    if (layout === void 0) { layout = 'rows'; }\n    if (index < 0) {\n        index = -1;\n    }\n    if ((sheet[layout])[index] && (sheet[layout])[index].hidden) {\n        increase ? index++ : index--;\n        index = skipHiddenIdx(sheet, index, increase, layout);\n    }\n    return index;\n}\n/** @hidden */\nexport function focus(ele) {\n    if (Browser.isIE) {\n        var scrollX_1 = window.scrollX;\n        var scrollY_1 = window.scrollY;\n        ele.focus();\n        window.scrollTo(scrollX_1, scrollY_1);\n    }\n    else {\n        // tslint:disable-next-line\n        ele.focus({ preventScroll: true });\n    }\n}\n","/**\n * Specifies Workbook internal events.\n */\n/** @hidden */\nexport var workbookDestroyed = 'workbookDestroyed';\n/** @hidden */\nexport var updateSheetFromDataSource = 'updateSheetFromDataSource';\n/** @hidden */\nexport var dataSourceChanged = 'dataSourceChanged';\n/** @hidden */\nexport var dataChanged = 'dataChanged';\n/** @hidden */\nexport var workbookOpen = 'workbookOpen';\n/** @hidden */\nexport var beginSave = 'beginSave';\n/** @hidden */\nexport var getFilteredCollection = 'getFilteredCollection';\n/** @hidden */\nexport var saveCompleted = 'saveCompleted';\n/** @hidden */\nexport var applyNumberFormatting = 'applyNumber';\n/** @hidden */\nexport var getFormattedCellObject = 'getFormattedCell';\n/** @hidden */\nexport var refreshCellElement = 'refreshCellElem';\n/** @hidden */\nexport var setCellFormat = 'setCellFormat';\n/** @hidden */\nexport var findAllValues = 'findAllValues';\n/** @hidden */\nexport var textDecorationUpdate = 'textDecorationUpdate';\n/** @hidden */\nexport var applyCellFormat = 'applyCellFormat';\n/** @hidden */\nexport var updateUsedRange = 'updateUsedRange';\n/** @hidden */\nexport var workbookFormulaOperation = 'workbookFormulaOperation';\n/** @hidden */\nexport var workbookEditOperation = 'workbookEditOperation';\n/** @hidden */\nexport var checkDateFormat = 'checkDateFormat';\n/** @hidden */\nexport var getFormattedBarText = 'getFormattedBarText';\n/** @hidden */\nexport var activeCellChanged = 'activeCellChanged';\n/** @hidden */\nexport var openSuccess = 'openSuccess';\n/** @hidden */\nexport var openFailure = 'openFailure';\n/** @hidden */\nexport var sheetCreated = 'sheetCreated';\n/** @hidden */\nexport var sheetsDestroyed = 'sheetsDestroyed';\n/** @hidden */\nexport var aggregateComputation = 'aggregateComputation';\n/** @hidden */\nexport var beforeSort = 'beforeSort';\n/** @hidden */\nexport var initiateSort = 'initiateSort';\n/** @hidden */\nexport var sortComplete = 'sortComplete';\n/** @hidden */\nexport var sortRangeAlert = 'sortRangeAlert';\n/** @hidden */\nexport var initiatelink = 'initiatelink';\n/** @hidden */\nexport var beforeHyperlinkCreate = 'beforeHyperlinkCreate';\n/** @hidden */\nexport var afterHyperlinkCreate = 'afterHyperlinkCreate';\n/** @hidden */\nexport var beforeHyperlinkClick = 'beforeHyperlinkClick';\n/** @hidden */\nexport var afterHyperlinkClick = 'afterHyperlinkClick';\n/** @hidden */\nexport var addHyperlink = 'addHyperlink';\n/** @hidden */\nexport var setLinkModel = 'setLinkModel';\n/** @hidden */\nexport var beforeFilter = 'beforeFilter';\n/** @hidden */\nexport var initiateFilter = 'initiateFilter';\n/** @hidden */\nexport var filterComplete = 'filterComplete';\n/** @hidden */\nexport var filterRangeAlert = 'filterRangeAlert';\n/** @hidden */\nexport var clearAllFilter = 'clearAllFilter';\n/** @hidden */\nexport var wrapEvent = 'wrapText';\n/** @hidden */\nexport var onSave = 'onSave';\n/** @hidden */\nexport var insert = 'insert';\n/** @hidden */\nexport var deleteAction = 'delete';\n/** @hidden */\nexport var insertModel = 'insertModel';\n/** @hidden */\nexport var deleteModel = 'deleteModel';\n/** @hidden */\nexport var isValidation = 'isValidation';\n/** @hidden */\nexport var setValidation = 'setValidation';\n/** @hidden */\nexport var addHighlight = 'addHighlight';\n/** @hidden */\nexport var dataValidate = 'dataValidate';\n/** @hidden */\nexport var findNext = 'findNext';\n/** @hidden */\nexport var findPrevious = 'findPrevious';\n/** @hidden */\nexport var goto = 'gotoHandler';\n/** @hidden */\nexport var findWorkbookHandler = 'findHandler';\n/** @hidden */\nexport var replaceHandler = 'replace';\n/** @hidden */\nexport var replaceAllHandler = 'replaceAll';\n/** @hidden */\nexport var showDialog = 'ShowDialog';\n/** @hidden */\nexport var findUndoRedo = 'findUndoRedo';\n/** @hidden */\nexport var findKeyUp = 'findKeyUp';\n/** @hidden */\nexport var removeValidation = 'removeValidation';\n/** @hidden */\nexport var removeHighlight = 'removeHighlight';\n/** @hidden */\nexport var queryCellInfo = 'queryCellInfo';\n/** @hidden */\nexport var count = 'count';\n/** @hidden */\nexport var findCount = 'findCount';\n/** @hidden */\nexport var protectSheetWorkBook = 'protectSheet';\n/** @hidden */\nexport var updateToggle = 'updateToggleItem';\n/** @hidden */\nexport var protectsheetHandler = 'protectsheetHandler';\n/** @hidden */\nexport var replaceAllDialog = 'replaceAllDialog';\n/** @hidden */\nexport var unprotectsheetHandler = 'unprotectsheetHandler';\n/** @hidden */\nexport var workBookeditAlert = 'editAlert';\n/** @hidden */\nexport var setLockCells = 'setLockCells';\n/** @hidden */\nexport var applyLockCells = 'applyLockCells';\n/** @hidden */\nexport var setMerge = 'setMerge';\n/** @hidden */\nexport var applyMerge = 'applyMerge';\n/** @hidden */\nexport var mergedRange = 'mergedRange';\n/** @hidden */\nexport var activeCellMergedRange = 'activeCellMergedRange';\n/** @hidden */\nexport var insertMerge = 'insertMerge';\n/** @hidden */\nexport var pasteMerge = 'pasteMerge';\n/** @hidden */\nexport var setCFRule = 'setCFRule';\n/** @hidden */\nexport var cFInitialCheck = 'cFInitialCheck';\n/** @hidden */\nexport var clearCFRule = 'clearCFRule';\n/** @hidden */\nexport var initiateClearCFRule = 'initiateClearCFRule';\n/** @hidden */\nexport var cFRender = 'cFRender';\n/** @hidden */\nexport var cFDelete = 'cFDelete';\n/** @hidden */\nexport var clear = 'clear';\n/** @hidden */\nexport var clearCF = 'clearCF';\n/** @hidden */\nexport var clearCells = 'clearCells';\n/** @hidden */\nexport var setImage = 'setImage';\n/** @hidden */\nexport var setChart = 'setChart';\n/** @hidden */\nexport var initiateChart = 'initiateChart';\n/** @hidden */\nexport var refreshRibbonIcons = 'refreshRibbonIcons';\n/** @hidden */\nexport var refreshChart = 'refreshChart';\n/** @hidden */\nexport var refreshChartSize = 'refreshChartSize';\n/** @hidden */\nexport var updateChart = 'updateChart';\n/** @hidden */\nexport var deleteChartColl = 'deleteChartColl';\n/** @hidden */\nexport var initiateChartModel = 'initiateChartModel';\n/** @hidden */\nexport var focusChartBorder = 'focusChartBorder';\n/** @hidden */\nexport var saveError = 'saveError';\n","import { DataManager, Query, Deferred } from '@syncfusion/ej2-data';\nimport { getCell, setCell } from '../base/index';\nimport { getRangeIndexes, checkIsFormula, updateSheetFromDataSource, checkDateFormat, dataSourceChanged } from '../common/index';\nimport { getCellIndexes, dataChanged, getCellAddress } from '../common/index';\nimport { getFormatFromType } from './number-format';\n/**\n * Data binding module\n */\nvar DataBind = /** @class */ (function () {\n    function DataBind(parent) {\n        this.parent = parent;\n        this.requestedInfo = [];\n        this.addEventListener();\n    }\n    DataBind.prototype.addEventListener = function () {\n        this.parent.on(updateSheetFromDataSource, this.updateSheetFromDataSourceHandler, this);\n        this.parent.on(dataSourceChanged, this.dataSourceChangedHandler, this);\n        this.parent.on(dataChanged, this.dataChangedHandler, this);\n    };\n    DataBind.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(updateSheetFromDataSource, this.updateSheetFromDataSourceHandler);\n            this.parent.off(dataSourceChanged, this.dataSourceChangedHandler);\n            this.parent.off(dataChanged, this.dataChangedHandler);\n        }\n    };\n    /**\n     * Update given data source to sheet.\n     */\n    // tslint:disable-next-line\n    DataBind.prototype.updateSheetFromDataSourceHandler = function (args) {\n        var _this = this;\n        var cell;\n        var flds;\n        var sCellIdx;\n        var result;\n        var remoteUrl;\n        var isLocal;\n        var dataManager;\n        var requestedRange = [];\n        var sRanges = [];\n        var rowIdx;\n        var deferred = new Deferred();\n        var sRowIdx;\n        var sColIdx;\n        var loadedInfo;\n        args.promise = deferred.promise;\n        if (args.sheet && args.sheet.ranges.length) {\n            var _loop_1 = function (k) {\n                var sRange = args.indexes[0];\n                var eRange = args.indexes[2];\n                var range = args.sheet.ranges[k];\n                sRowIdx = getRangeIndexes(range.startCell)[0];\n                dataManager = range.dataSource instanceof DataManager ? range.dataSource\n                    : range.dataSource ? new DataManager(range.dataSource) : new DataManager();\n                remoteUrl = remoteUrl || dataManager.dataSource.url;\n                args.sheet.isLocalData = isLocal || !dataManager.dataSource.url;\n                if (sRowIdx <= sRange) {\n                    sRange = sRange - sRowIdx;\n                }\n                else {\n                    if (sRowIdx <= eRange) {\n                        eRange = eRange - sRowIdx;\n                        sRange = 0;\n                    }\n                    else {\n                        sRange = -1;\n                    }\n                }\n                if (range.showFieldAsHeader && sRange !== 0) {\n                    sRange -= 1;\n                }\n                var isEndReached = false;\n                var insertRowCount = 0;\n                this_1.initRangeInfo(range);\n                var count = this_1.getMaxCount(range);\n                loadedInfo = this_1.getLoadedInfo(sRange, eRange, range);\n                sRange = loadedInfo.unloadedRange[0];\n                eRange = loadedInfo.unloadedRange[1];\n                if (range.info.insertRowRange) {\n                    range.info.insertRowRange.forEach(function (range) {\n                        insertRowCount += ((range[1] - range[0]) + 1);\n                    });\n                    sRange -= insertRowCount;\n                    eRange -= insertRowCount;\n                }\n                if (sRange > count) {\n                    isEndReached = true;\n                }\n                else if (eRange > count) {\n                    eRange = count;\n                }\n                this_1.requestedInfo.push({ deferred: deferred, indexes: args.indexes, isNotLoaded: loadedInfo.isNotLoaded });\n                if (sRange >= 0 && loadedInfo.isNotLoaded && !isEndReached) {\n                    sRanges[k] = sRange;\n                    requestedRange[k] = false;\n                    var query = (range.query ? range.query : new Query()).clone();\n                    dataManager.executeQuery(query.range(sRange, eRange >= count ? eRange : eRange + 1)\n                        .requiresCount()).then(function (e) {\n                        if (!_this.parent || _this.parent.isDestroyed) {\n                            return;\n                        }\n                        result = (e.result && e.result.result ? e.result.result : e.result);\n                        sCellIdx = getRangeIndexes(range.startCell);\n                        sRowIdx = sCellIdx[0];\n                        sColIdx = sCellIdx[1];\n                        if (result.length) {\n                            if (!range.info.count) {\n                                count = e.count;\n                                range.info.count = e.count;\n                            }\n                            flds = Object.keys(result[0]);\n                            if (!range.info.fldLen) {\n                                range.info.fldLen = flds.length;\n                                range.info.flds = flds;\n                            }\n                            if (range.info.insertColumnRange) {\n                                var insertCount_1 = 0;\n                                range.info.insertColumnRange.forEach(function (insertRange) {\n                                    for (var i = insertRange[0]; i <= insertRange[1]; i++) {\n                                        i <= sColIdx ? flds.splice(0, 0, \"emptyCell\" + insertCount_1) : flds.splice(i - sColIdx, 0, \"emptyCell\" + insertCount_1);\n                                        insertCount_1++;\n                                    }\n                                });\n                            }\n                            if (sRanges[k] === 0 && range.showFieldAsHeader) {\n                                rowIdx = sRowIdx + sRanges[k] + insertRowCount;\n                                flds.forEach(function (field, i) {\n                                    cell = getCell(rowIdx, sColIdx + i, args.sheet, true);\n                                    if (!cell) {\n                                        args.sheet.rows[sRowIdx + sRanges[k]].cells[sColIdx + i] = field.includes('emptyCell') ? {}\n                                            : { value: field };\n                                    }\n                                    else if (!cell.value && !field.includes('emptyCell')) {\n                                        cell.value = field;\n                                    }\n                                });\n                            }\n                            result.forEach(function (item, i) {\n                                rowIdx = sRowIdx + sRanges[k] + i + (range.showFieldAsHeader ? 1 : 0) + insertRowCount;\n                                for (var j = 0; j < flds.length; j++) {\n                                    cell = getCell(rowIdx, sColIdx + j, args.sheet, true);\n                                    if (cell) {\n                                        if (!cell.value && !flds[j].includes('emptyCell')) {\n                                            setCell(rowIdx, sColIdx + j, args.sheet, _this.getCellDataFromProp(item[flds[j]]), true);\n                                        }\n                                    }\n                                    else {\n                                        args.sheet.rows[rowIdx].cells[sColIdx + j] =\n                                            flds[j].includes('emptyCell') ? {} : _this.getCellDataFromProp(item[flds[j]]);\n                                    }\n                                    _this.checkDataForFormat({\n                                        args: args, cell: cell, colIndex: sColIdx + j, rowIndex: rowIdx, i: i, j: j, k: k,\n                                        range: range, sRanges: sRanges, value: item[flds[j]]\n                                    });\n                                }\n                            });\n                        }\n                        else {\n                            flds = [];\n                        }\n                        args.sheet.usedRange.rowIndex = Math.max((sRowIdx + (count || e.count) + (range.showFieldAsHeader ? 1 : 0) + insertRowCount) - 1, args.sheet.usedRange.rowIndex);\n                        args.sheet.usedRange.colIndex = Math.max(sColIdx + flds.length - 1, args.sheet.usedRange.colIndex);\n                        if (insertRowCount) {\n                            loadedInfo = _this.getLoadedInfo(sRange, eRange, range);\n                            sRange = loadedInfo.unloadedRange[0];\n                            eRange = loadedInfo.unloadedRange[1];\n                            if (sRange > count) {\n                                loadedInfo.isNotLoaded = false;\n                            }\n                            if (loadedInfo.isNotLoaded) {\n                                if (eRange > count) {\n                                    eRange = count;\n                                }\n                                range.info.loadedRange.push([sRange, eRange]);\n                            }\n                        }\n                        else {\n                            range.info.loadedRange.push([sRange, eRange]);\n                        }\n                        requestedRange[k] = true;\n                        if (requestedRange.indexOf(false) === -1) {\n                            if (eRange + sRowIdx < sRowIdx + range.info.count) {\n                                if (!args.rangeSettingCount) {\n                                    args.rangeSettingCount = [];\n                                }\n                                args.rangeSettingCount.push(k);\n                                //if (remoteUrl) {\n                                var unloadedArgs = {\n                                    sheet: args.sheet, indexes: [0, 0, args.sheet.usedRange.rowIndex, args.sheet.usedRange.colIndex],\n                                    promise: new Promise(function (resolve, reject) { resolve((function () { })()); }),\n                                    rangeSettingCount: args.rangeSettingCount\n                                };\n                                _this.updateSheetFromDataSourceHandler(unloadedArgs);\n                                unloadedArgs.promise.then(function () {\n                                    if (_this.parent.getModuleName() === 'workbook') {\n                                        return;\n                                    }\n                                    args.rangeSettingCount.pop();\n                                    if (!args.rangeSettingCount.length) {\n                                        _this.parent.notify('created', null);\n                                    }\n                                });\n                                //}\n                            }\n                            _this.checkResolve(args.indexes);\n                        }\n                    });\n                }\n                else if (k === 0 && requestedRange.indexOf(false) === -1) {\n                    this_1.checkResolve(args.indexes);\n                }\n            };\n            var this_1 = this;\n            for (var k = args.sheet.ranges.length - 1; k >= 0; k--) {\n                _loop_1(k);\n            }\n        }\n        else {\n            deferred.resolve();\n        }\n    };\n    DataBind.prototype.checkResolve = function (indexes) {\n        var resolved;\n        var isSameRng;\n        var cnt = 0;\n        this.requestedInfo.forEach(function (info, idx) {\n            isSameRng = JSON.stringify(info.indexes) === JSON.stringify(indexes);\n            if (isSameRng || resolved) {\n                if (idx === 0) {\n                    info.deferred.resolve();\n                    cnt++;\n                    resolved = true;\n                }\n                else {\n                    if (resolved && (info.isLoaded || !info.isNotLoaded)) {\n                        info.deferred.resolve();\n                        cnt++;\n                    }\n                    else if (isSameRng && resolved) {\n                        info.deferred.resolve();\n                        cnt++;\n                    }\n                    else if (isSameRng) {\n                        info.isLoaded = true;\n                    }\n                    else {\n                        resolved = false;\n                    }\n                }\n            }\n        });\n        this.requestedInfo.splice(0, cnt);\n    };\n    DataBind.prototype.getCellDataFromProp = function (prop) {\n        var data = {};\n        if (Object.prototype.toString.call(prop) === '[object Object]') {\n            if (prop.formula) {\n                data.formula = prop.formula;\n            }\n            else if (prop.value) {\n                if (typeof (prop.value) === 'string') {\n                    if (prop.value.indexOf('http://') === 0 || prop.value.indexOf('https://') === 0 ||\n                        prop.value.indexOf('ftp://') === 0 || prop.value.indexOf('www.') === 0) {\n                        data.hyperlink = prop.value;\n                    }\n                    else {\n                        data.value = prop.value;\n                    }\n                }\n                else {\n                    data.value = prop.value;\n                }\n            }\n        }\n        else {\n            if (checkIsFormula(prop)) {\n                data.formula = prop;\n            }\n            else {\n                if (typeof (prop) === 'string') {\n                    if (prop.indexOf('http://') === 0 || prop.indexOf('https://') === 0 ||\n                        prop.indexOf('ftp://') === 0 || prop.indexOf('www.') === 0) {\n                        data.hyperlink = prop;\n                    }\n                    else {\n                        data.value = prop;\n                    }\n                }\n                else {\n                    data.value = prop;\n                }\n            }\n        }\n        return data;\n    };\n    DataBind.prototype.checkDataForFormat = function (args) {\n        if (args.value !== '') {\n            var dateEventArgs = {\n                value: args.value,\n                rowIndex: args.rowIndex,\n                colIndex: args.colIndex,\n                isDate: false,\n                updatedVal: args.value,\n                isTime: false\n            };\n            this.parent.notify(checkDateFormat, dateEventArgs);\n            if (dateEventArgs.isDate) {\n                if (args.cell) {\n                    args.cell.format = getFormatFromType('ShortDate');\n                    args.cell.value = dateEventArgs.updatedVal;\n                }\n                else {\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].format = getFormatFromType('ShortDate');\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].value = dateEventArgs.updatedVal;\n                }\n            }\n            else if (dateEventArgs.isTime) {\n                if (args.cell) {\n                    args.cell.format = getFormatFromType('Time');\n                    args.cell.value = dateEventArgs.updatedVal;\n                }\n                else {\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].format = getFormatFromType('Time');\n                    args.args.sheet.rows[args.rowIndex]\n                        .cells[args.colIndex].value = dateEventArgs.updatedVal;\n                }\n            }\n        }\n    };\n    DataBind.prototype.getLoadedInfo = function (sRange, eRange, range) {\n        var isNotLoaded = true;\n        range.info.loadedRange.forEach(function (range) {\n            if (range[0] <= sRange && sRange <= range[1]) {\n                if (range[0] <= eRange && eRange <= range[1]) {\n                    isNotLoaded = false;\n                }\n                else {\n                    sRange = range[1] + 1;\n                }\n            }\n            else if (range[0] <= eRange && eRange <= range[1]) {\n                eRange = range[0] - 1;\n            }\n        });\n        return { isNotLoaded: isNotLoaded, unloadedRange: [sRange, eRange] };\n    };\n    DataBind.prototype.getMaxCount = function (range) {\n        if (range.query) {\n            var query = range.query.queries;\n            for (var i = 0; i < query.length; i++) {\n                if (query[i].fn === 'onTake') {\n                    return Math.min(query[i].e.nos, range.info.count || query[i].e.nos);\n                }\n            }\n        }\n        return range.info.count;\n    };\n    DataBind.prototype.initRangeInfo = function (range) {\n        if (!range.info) {\n            range.info = { loadedRange: [] };\n        }\n    };\n    /**\n     * Remove old data from sheet.\n     */\n    DataBind.prototype.dataSourceChangedHandler = function (args) {\n        var _this = this;\n        var row;\n        var sheet = this.parent.sheets[args.sheetIdx];\n        var range = sheet.ranges[args.rangeIdx];\n        if (range && (this.checkRangeHasChanges(sheet, args.rangeIdx) || !range.info)) {\n            var showFieldAsHeader_1 = range.showFieldAsHeader;\n            var indexes_1 = getCellIndexes(range.startCell);\n            if (range.info) {\n                range.info.loadedRange.forEach(function (loadedRange) {\n                    for (var i = loadedRange[0]; i <= loadedRange[1] && (i < range.info.count + (showFieldAsHeader_1 ? 1 : 0)); i++) {\n                        row = sheet.rows[i + indexes_1[0]];\n                        if (row) {\n                            for (var j = indexes_1[1]; j < indexes_1[1] + range.info.fldLen; j++) {\n                                if (row.cells && row.cells[j]) {\n                                    delete row.cells[j];\n                                }\n                            }\n                        }\n                    }\n                });\n                range.info = null;\n            }\n            var viewport = this.parent.viewport;\n            var refreshRange_1 = [viewport.topIndex, viewport.leftIndex, viewport.bottomIndex, viewport.rightIndex];\n            var args_1 = {\n                sheet: sheet, indexes: refreshRange_1, promise: new Promise(function (resolve, reject) { resolve((function () { })()); })\n            };\n            this.updateSheetFromDataSourceHandler(args_1);\n            args_1.promise.then(function () {\n                _this.parent.notify('updateView', { indexes: refreshRange_1 });\n            });\n        }\n    };\n    DataBind.prototype.checkRangeHasChanges = function (sheet, rangeIdx) {\n        if (this.parent.isAngular) {\n            var changedRangeIdx = 'changedRangeIdx';\n            if (sheet[changedRangeIdx] === parseInt(rangeIdx, 10)) {\n                delete sheet[changedRangeIdx];\n                return true;\n            }\n            return false;\n        }\n        else {\n            return true;\n        }\n    };\n    /**\n     * Triggers dataSourceChange event when cell data changes\n     */\n    DataBind.prototype.dataChangedHandler = function (args) {\n        var _this = this;\n        var changedData = [{}];\n        var action;\n        var cell;\n        var dataRange;\n        var startCell;\n        var inRange;\n        var deleteRowDetails;\n        var sheetIdx = this.parent.activeSheetIndex;\n        var sheet = this.parent.sheets[sheetIdx];\n        var cellIndices;\n        sheet.ranges.forEach(function (range, idx) {\n            if (range.dataSource) {\n                var isNewRow = void 0;\n                startCell = getCellIndexes(range.startCell);\n                dataRange = startCell.concat([startCell[0] + range.info.count + (range.showFieldAsHeader ? 0 : -1),\n                    startCell[1] + range.info.fldLen - 1]);\n                if (args.modelType === 'Row') {\n                    if (args.insertType) {\n                        inRange = ((!range.showFieldAsHeader && args.insertType === 'above') ? dataRange[0] <= args.index\n                            : dataRange[0] < args.index) && dataRange[2] >= args.index;\n                        cellIndices = [args.index];\n                        if (!inRange) {\n                            if ((dataRange[2] + 1 === args.index && args.insertType === 'below')) {\n                                isNewRow = true;\n                                range.info.count += args.model.length;\n                            }\n                            else if (dataRange[0] >= args.index) {\n                                range.startCell = getCellAddress(startCell[0] + args.model.length, startCell[1]);\n                            }\n                        }\n                        else {\n                            isNewRow = true;\n                            range.info.count += args.model.length;\n                        }\n                    }\n                    else {\n                        inRange = dataRange[0] <= args.startIndex && dataRange[2] >= args.startIndex;\n                        action = 'delete';\n                    }\n                }\n                else {\n                    cellIndices = getCellIndexes(args.sheetIdx > -1 ? args.address : args.address.split('!')[1]);\n                    inRange = ((range.showFieldAsHeader ? dataRange[0] + 1 : dataRange[0]) <= cellIndices[0])\n                        && dataRange[2] >= cellIndices[0] && dataRange[1] <= cellIndices[1] && dataRange[3] >= cellIndices[1];\n                }\n                if (inRange || isNewRow) {\n                    if (args.modelType === 'Row' && !args.insertType) {\n                        args.deletedModel.forEach(function (row, rowIdx) {\n                            changedData[rowIdx] = {};\n                            range.info.flds.forEach(function (fld, idx) {\n                                if (row.cells) {\n                                    cell = row.cells[startCell[1] + idx];\n                                    changedData[rowIdx][fld] = (cell && cell.value) || null;\n                                }\n                                else {\n                                    changedData[rowIdx][fld] = null;\n                                }\n                            });\n                            range.info.count -= 1;\n                        });\n                        deleteRowDetails = { count: args.deletedModel.length, index: args.endIndex };\n                    }\n                    else {\n                        action = isNewRow ? 'add' : 'edit';\n                        var _loop_2 = function (i) {\n                            changedData[i] = {};\n                            range.info.flds.forEach(function (fld, idx) {\n                                cell = getCell(cellIndices[0], startCell[1] + idx, sheet);\n                                changedData[i][fld] = (cell && cell.value) || null;\n                            });\n                        };\n                        for (var i = 0; i < (isNewRow ? args.model.length : 1); i++) {\n                            _loop_2(i);\n                        }\n                    }\n                    _this.parent.trigger('dataSourceChanged', { data: changedData, action: action, rangeIndex: idx, sheetIndex: sheetIdx });\n                }\n                else if (deleteRowDetails && deleteRowDetails.count && dataRange[0] > deleteRowDetails.index) {\n                    range.startCell = getCellAddress(startCell[0] - deleteRowDetails.count, startCell[1]);\n                }\n            }\n        });\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    DataBind.prototype.getModuleName = function () {\n        return 'dataBind';\n    };\n    /**\n     * Destroys the Data binding module.\n     * @return {void}\n     */\n    DataBind.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        this.requestedInfo = [];\n    };\n    return DataBind;\n}());\nexport { DataBind };\n","/**\n * Specifies spreadsheet internal events\n */\n/** @hidden */\nexport var ribbon = 'ribbon';\n/** @hidden */\nexport var formulaBar = 'formulaBar';\n/** @hidden */\nexport var sheetTabs = 'sheetTabs';\n/** @hidden */\nexport var refreshSheetTabs = 'refreshSheetTabs';\n/** @hidden */\nexport var isFormulaBarEdit = 'isFormulaBarEdit';\n/** @hidden */\nexport var dataRefresh = 'dataRefresh';\n/** @hidden */\nexport var initialLoad = 'initialLoad';\n/** @hidden */\nexport var contentLoaded = 'contentLoaded';\n/** @hidden */\nexport var mouseDown = 'mouseDown';\n/** @hidden */\nexport var spreadsheetDestroyed = 'spreadsheetDestroyed';\n/** @hidden */\nexport var editOperation = 'editOperation';\n/** @hidden */\nexport var formulaOperation = 'formulaOperation';\n/** @hidden */\nexport var formulaBarOperation = 'formulaBarOperation';\n/** @hidden */\nexport var click = 'click';\n/** @hidden */\nexport var keyUp = 'keyUp';\n/** @hidden */\nexport var keyDown = 'keyDown';\n/** @hidden */\nexport var formulaKeyUp = 'formulaKeyUp';\n/** @hidden */\nexport var formulaBarUpdate = 'formulaBarUpdate';\n/** @hidden */\nexport var onVerticalScroll = 'verticalScroll';\n/** @hidden */\nexport var onHorizontalScroll = 'horizontalScroll';\n/** @hidden */\nexport var beforeContentLoaded = 'beforeContentLoaded';\n/** @hidden */\nexport var beforeVirtualContentLoaded = 'beforeVirtualContentLoaded';\n/** @hidden */\nexport var virtualContentLoaded = 'virtualContentLoaded';\n/** @hidden */\nexport var contextMenuOpen = 'contextMenuOpen';\n/** @hidden */\nexport var cellNavigate = 'cellNavigate';\n/** @hidden */\nexport var mouseUpAfterSelection = 'mouseUpAfterSelection';\n/** @hidden */\nexport var selectionComplete = 'selectionComplete';\n/** @hidden */\nexport var cMenuBeforeOpen = 'contextmenuBeforeOpen';\n/** @hidden */\nexport var insertSheetTab = 'insertSheetTab';\n/** @hidden */\nexport var removeSheetTab = 'removeSheetTab';\n/** @hidden */\nexport var renameSheetTab = 'renameSheetTab';\n/** @hidden */\nexport var ribbonClick = 'ribboClick';\n/** @hidden */\nexport var refreshRibbon = 'ribbonRefresh';\n/** @hidden */\nexport var enableToolbarItems = 'enableToolbarItems';\n/** @hidden */\nexport var tabSwitch = 'tabSwitch';\n/** @hidden */\nexport var selectRange = 'selectRange';\n/** @hidden */\nexport var cut = 'cut';\n/** @hidden */\nexport var copy = 'copy';\n/** @hidden */\nexport var paste = 'paste';\n/** @hidden */\nexport var clearCopy = 'clearCopy';\n/** @hidden */\nexport var dataBound = 'dataBound';\n/** @hidden */\nexport var beforeDataBound = 'beforeDataBound';\n/** @hidden */\nexport var addContextMenuItems = 'addContextMenuItems';\n/** @hidden */\nexport var removeContextMenuItems = 'removeContextMenuItems';\n/** @hidden */\nexport var enableContextMenuItems = 'enableContextMenuItems';\n/** @hidden */\nexport var enableFileMenuItems = 'enableFileMenuItems';\n/** @hidden */\nexport var hideFileMenuItems = 'hideFileMenuItems';\n/** @hidden */\nexport var addFileMenuItems = 'addFileMenuItems';\n/** @hidden */\nexport var hideRibbonTabs = 'hideRibbonTabs';\n/** @hidden */\nexport var enableRibbonTabs = 'enableRibbonTabs';\n/** @hidden */\nexport var addRibbonTabs = 'addRibbonTabs';\n/** @hidden */\nexport var addToolbarItems = 'addToolbarItems';\n/** @hidden */\nexport var hideToolbarItems = 'hideToolbarItems';\n/** @hidden */\nexport var beforeRibbonCreate = 'beforeRibbonCreate';\n/** @hidden */\nexport var rowHeightChanged = 'rowHeightChanged';\n/** @hidden */\nexport var colWidthChanged = 'colWidthChanged';\n/** @hidden */\nexport var beforeHeaderLoaded = 'beforeHeaderLoaded';\n/** @hidden */\nexport var onContentScroll = 'onContentScroll';\n/** @hidden */\nexport var deInitProperties = 'deInitProperties';\n/** @hidden */\nexport var activeSheetChanged = 'activeSheetChanged';\n/** @hidden */\nexport var renameSheet = 'renameSheet';\n/** @hidden */\nexport var initiateCustomSort = 'initiateCustomSort';\n/** @hidden */\nexport var applySort = 'applySort';\n/** @hidden */\nexport var collaborativeUpdate = 'collaborativeUpdate';\n/** @hidden */\nexport var hideShow = 'hideShow';\n/** @hidden */\nexport var autoFit = 'autoFitRowsColumns';\n/** @hidden */\nexport var updateToggleItem = 'updateToggleItem';\n/** @hidden */\nexport var initiateHyperlink = 'initiateHyperlink';\n/** @hidden */\nexport var editHyperlink = 'editHyperlink';\n/** @hidden */\nexport var openHyperlink = 'openHyperlink';\n/** @hidden */\nexport var removeHyperlink = 'removeHyperlink';\n/** @hidden */\nexport var createHyperlinkElement = 'createHyperlinkElement';\n/** @hidden */\nexport var sheetNameUpdate = 'sheetNameUpdate';\n/** @hidden */\nexport var hideSheet = 'hideSheet';\n/** @hidden */\nexport var performUndoRedo = 'performUndoRedo';\n/** @hidden */\nexport var updateUndoRedoCollection = 'updateUndoRedoCollection';\n/** @hidden */\nexport var setActionData = 'setActionData';\n/** @hidden */\nexport var getBeforeActionData = 'getBeforeActionData';\n/** @hidden */\nexport var clearUndoRedoCollection = 'clearUndoRedoCollection';\n/** @hidden */\nexport var initiateFilterUI = 'initiateFilterUI';\n/** @hidden */\nexport var renderFilterCell = 'renderFilterCell';\n/** @hidden */\nexport var reapplyFilter = 'reapplyFilter';\n/** @hidden */\nexport var filterByCellValue = 'filterByCellValue';\n/** @hidden */\nexport var clearFilter = 'clearFilter';\n/** @hidden */\nexport var getFilteredColumn = 'getFilteredColumn';\n/** @hidden */\nexport var completeAction = 'actionComplete';\n/** @hidden */\nexport var beginAction = 'actionBegin';\n/** @hidden */\nexport var filterCellKeyDown = 'filterCellKeyDown';\n/** @hidden */\nexport var getFilterRange = 'getFilterRange';\n/** @hidden */\nexport var setAutoFit = 'setAutoFit';\n/** @hidden */\nexport var refreshFormulaDatasource = 'refreshFormulaDatasource';\n/** @hidden */\nexport var setScrollEvent = 'setScrollEvent';\n/** @hidden */\nexport var initiateDataValidation = 'initiatedatavalidation';\n/** @hidden */\nexport var validationError = 'validationError';\n/** @hidden */\nexport var startEdit = 'startEdit';\n/** @hidden */\nexport var invalidData = 'invalidData';\n/** @hidden */\nexport var clearInvalid = 'clearInvalid';\n/** @hidden */\nexport var protectSheet = 'protectSheet';\n/** @hidden */\nexport var applyProtect = 'applyProtect';\n/** @hidden */\nexport var unprotectSheet = 'unprotectSheet';\n/** @hidden */\nexport var protectCellFormat = 'protectCellFormat';\n/** @hidden */\nexport var gotoDlg = 'renderGotoDlgt';\n/** @hidden */\nexport var findDlg = 'renderFindDlg';\n/** @hidden */\nexport var findHandler = 'findHandler';\n/** @hidden */\nexport var replace = 'replaceHandler';\n/** @hidden */\nexport var created = 'created';\n/** @hidden */\nexport var editAlert = 'editAlert';\n/** @hidden */\nexport var setUndoRedo = 'setUndoRedo';\n/** @hidden */\nexport var enableFormulaInput = 'enableFormulaInput';\n/** @hidden */\nexport var protectSelection = 'protectSelection';\n/** @hidden */\nexport var hiddenMerge = 'hiddenMerge';\n/** @hidden */\nexport var checkPrevMerge = 'checkPrevMerge';\n/** @hidden */\nexport var checkMerge = 'checkMerge';\n/** @hidden */\nexport var removeDataValidation = 'removeDataValidation';\n/** @hidden */\nexport var showAggregate = 'showAggregate';\n/** @hidden */\nexport var initiateConditionalFormat = 'initiateConditionalFormat';\n/** @hidden */\nexport var checkConditionalFormat = 'checkConditionalFormat';\n/** @hidden */\nexport var setCF = 'setCF';\n/** @hidden */\nexport var clearViewer = 'clearViewer';\n/** @hidden */\nexport var initiateFormulaReference = 'initiateFormulaReference';\n/** @hidden */\nexport var initiateCur = 'initiateCur';\n/** @hidden */\nexport var clearCellRef = 'clearCellRef';\n/** @hidden */\nexport var editValue = 'editValue';\n/** @hidden */\nexport var addressHandle = 'addressHandle';\n/** @hidden */\nexport var initiateEdit = 'initiateEdit';\n/** @hidden */\nexport var forRefSelRender = 'forRefSelRender';\nexport var blankWorkbook = 'blankWorkbook';\n/** @hidden */\nexport var insertImage = 'insertImage';\n/** @hidden */\nexport var refreshImgElem = 'refreshImgElem';\n/** @hidden */\nexport var refreshImgCellObj = 'refreshImgCellObj';\n/** @hidden */\nexport var getRowIdxFromClientY = 'getRowIdxFromClientY';\n/** @hidden */\nexport var getColIdxFromClientX = 'getColIdxFromClientX';\n/** @hidden */\nexport var createImageElement = 'createImageElement';\n/** @hidden */\nexport var deleteImage = 'deleteImage';\n/** @hidden */\nexport var deleteChart = 'deleteChart';\n/** @hidden */\nexport var refreshChartCellObj = 'refreshChartCellObj';\n/** @hidden */\nexport var refreshImagePosition = 'refreshImagePosition';\n/** @hidden */\nexport var updateTableWidth = 'updateTableWidth';\n/** @hidden */\nexport var focusBorder = 'focusBorder';\n/** @hidden */\nexport var clearChartBorder = 'clearChartBorder';\n/** @hidden */\nexport var insertChart = 'insertChart';\n/** @hidden */\nexport var chartRangeSelection = 'chartRangeSelection';\n/** @hidden */\nexport var isReact = 'isReact';\n/** @hidden */\nexport var renderReactTemplates = 'renderReactTemplates';\n/** @hidden */\nexport var clearTemplate = 'clearTemplate';\n","/**\n * Open properties.\n */\nimport { isUndefined } from '@syncfusion/ej2-base';\nimport { workbookOpen, openSuccess, openFailure, sheetsDestroyed, workbookFormulaOperation, getRangeIndexes } from '../common/index';\nimport { sheetCreated, protectSheetWorkBook, getRangeAddress } from '../common/index';\nimport { initSheet } from '../base/index';\nimport { beginAction } from '../../spreadsheet/common/event';\nvar WorkbookOpen = /** @class */ (function () {\n    function WorkbookOpen(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To open the excel file stream or excel url into the spreadsheet.\n     * @param {OpenOptions} options - Options to open a excel file.\n     */\n    WorkbookOpen.prototype.open = function (options) {\n        var _this = this;\n        if (!this.parent.allowOpen) {\n            return;\n        }\n        /* tslint:disable-next-line:no-any */\n        if (options.jsonObject) {\n            /* tslint:disable-next-line:no-any */\n            this.fetchSuccess(options.jsonObject);\n            return;\n        }\n        var formData = new FormData();\n        if (options.file) {\n            formData.append('file', options.file);\n        }\n        else {\n            this.parent.isOpen = false;\n            return;\n        }\n        var eventArgs = {\n            file: options.file || null,\n            cancel: false,\n            requestData: {\n                method: 'POST',\n                body: formData\n            }\n        };\n        this.parent.trigger('beforeOpen', eventArgs);\n        this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'beforeOpen' });\n        if (eventArgs.cancel) {\n            return;\n        }\n        fetch(this.parent.openUrl, eventArgs.requestData)\n            .then(function (response) {\n            if (response.ok) {\n                return response.json();\n            }\n            else {\n                return Promise.reject({\n                    status: response.status,\n                    statusText: response.statusText,\n                    url: response.url\n                });\n            }\n        })\n            .then(function (data) { return _this.fetchSuccess(data); })\n            .catch(function (error) { return _this.fetchFailure(error); });\n    };\n    WorkbookOpen.prototype.fetchFailure = function (error) {\n        if (isUndefined(error.status) && isUndefined(error.statusText)) {\n            error.statusText = 'Improper response';\n        }\n        this.parent.notify(openFailure, error);\n        this.parent.isOpen = false;\n    };\n    WorkbookOpen.prototype.fetchSuccess = function (data) {\n        var openError = ['UnsupportedFile', 'InvalidUrl'];\n        var workbookData = data;\n        workbookData = (typeof data === 'string') ? JSON.parse(data) : data;\n        /* tslint:disable-next-line:no-any */\n        var impData = workbookData.Workbook;\n        if (openError.indexOf(impData) > -1) {\n            this.parent.notify(openSuccess, {\n                context: this, data: impData\n            });\n            return;\n        }\n        this.updateModel(impData);\n        this.parent.notify(openSuccess, {\n            context: this, data: impData\n        });\n        this.parent.isOpen = false;\n    };\n    WorkbookOpen.prototype.updateModel = function (workbookModel) {\n        this.parent.notify(workbookFormulaOperation, { action: 'unRegisterSheet' });\n        this.parent.sheetNameCount = 1;\n        this.parent.sheets = [];\n        this.parent.notify(sheetsDestroyed, {});\n        workbookModel.activeSheetIndex = workbookModel.activeSheetIndex || 0;\n        this.setSelectAllRange(workbookModel.sheets);\n        this.parent.setProperties({\n            'sheets': workbookModel.sheets,\n            'activeSheetIndex': workbookModel.activeSheetIndex,\n            'definedNames': workbookModel.definedNames || []\n        }, true);\n        initSheet(this.parent);\n        this.parent.notify(sheetCreated, null);\n        this.parent.notify(workbookFormulaOperation, { action: 'registerSheet', isImport: true });\n        this.parent.notify(workbookFormulaOperation, { action: 'initiateDefinedNames' });\n        this.parent.notify(protectSheetWorkBook, null);\n    };\n    WorkbookOpen.prototype.setSelectAllRange = function (sheets) {\n        sheets.forEach(function (sheet) {\n            if (sheet.selectedRange) {\n                var selectedIndex = getRangeIndexes(sheet.selectedRange);\n                var rowCount = (isUndefined(sheet.rowCount) ? 100 : sheet.rowCount) - 1;\n                var colCount = (isUndefined(sheet.colCount) ? 100 : sheet.colCount) - 1;\n                if (selectedIndex[2] === 65535) {\n                    selectedIndex[2] = rowCount;\n                }\n                if (selectedIndex[3] === 255) {\n                    selectedIndex[3] = colCount;\n                }\n                if (selectedIndex[0] === 65535) {\n                    selectedIndex[0] = rowCount;\n                }\n                if (selectedIndex[1] === 255) {\n                    selectedIndex[1] = colCount;\n                }\n                sheet.selectedRange = getRangeAddress(selectedIndex);\n            }\n        });\n    };\n    /**\n     * Adding event listener for workbook open.\n     */\n    WorkbookOpen.prototype.addEventListener = function () {\n        this.parent.on(workbookOpen, this.open.bind(this));\n    };\n    /**\n     * Removing event listener workbook open.\n     */\n    WorkbookOpen.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookOpen, this.open.bind(this));\n        }\n    };\n    /**\n     * To Remove the event listeners\n     */\n    WorkbookOpen.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook open module name.\n     */\n    WorkbookOpen.prototype.getModuleName = function () {\n        return 'workbookOpen';\n    };\n    return WorkbookOpen;\n}());\nexport { WorkbookOpen };\n","/**\n * @hidden\n * The `SaveWorker` module is used to perform save functionality with Web Worker.\n */\nvar SaveWorker = /** @class */ (function () {\n    /**\n     * Constructor for SaveWorker module in Workbook library.\n     * @private\n     */\n    function SaveWorker(parent) {\n        this.parent = parent;\n    }\n    /**\n     * Process sheet.\n     * @hidden\n     */\n    SaveWorker.prototype.processSheet = function (sheet, sheetIndex) {\n        var parsedSheet = JSON.parse(sheet, function (key, value) {\n            //Remove empty properties\n            if ((Array.isArray(value) || typeof value === 'string') && !value.length) {\n                return undefined;\n            }\n            return value;\n        });\n        return [sheetIndex, parsedSheet];\n    };\n    /**\n     * Process save action.\n     * @hidden\n     */\n    SaveWorker.prototype.processSave = function (saveJSON, saveSettings, customParams) {\n        var formData = new FormData();\n        var i;\n        var keys = Object.keys(saveSettings);\n        formData.append('JSONData', JSON.stringify(saveJSON));\n        for (i = 0; i < keys.length; i++) {\n            formData.append(keys[i], saveSettings[keys[i]]);\n        }\n        keys = Object.keys(customParams);\n        for (i = 0; i < keys.length; i++) {\n            formData.append(keys[i], customParams[keys[i]]);\n        }\n        fetch(saveSettings.url, { method: 'POST', body: formData })\n            .then(function (response) {\n            if (response.ok) {\n                return response.blob();\n            }\n            else {\n                return Promise.reject({\n                    message: response.statusText\n                });\n            }\n        })\n            .then(function (data) {\n            new Promise(function (resolve) {\n                var reader = new FileReader();\n                reader.onload = function () {\n                    var result = reader.result.toString();\n                    if (result.indexOf('data:text/plain;base64,') > -1 || result.indexOf('data:text/html;base64,') > -1 ||\n                        result.indexOf('data:application/json;base64,') > -1) {\n                        var str = void 0;\n                        result = result.replace('data:text/plain;base64,', '');\n                        result = result.replace('data:text/html;base64,', '');\n                        if (result.indexOf('data:application/json;base64,') > -1) {\n                            result = result.replace('data:application/json;base64,', '');\n                            str = atob(result).split('.');\n                        }\n                        else {\n                            str = atob(result).split(/(\\r\\n|\\n|\\r)/gm);\n                        }\n                        if (str.length) {\n                            var text = str[0].length > 1 && str[0][0] === '\"' ? str[0].split('\"')[1] + '.' : str[0];\n                            postMessage({ dialog: text });\n                        }\n                    }\n                    else {\n                        postMessage(data);\n                    }\n                    resolve(reader.result);\n                };\n                reader.readAsDataURL(data);\n            });\n        })\n            .catch(function (error) {\n            postMessage({ error: error.message });\n        });\n        // try {\n        //     let httpRequest: XMLHttpRequest = new XMLHttpRequest();\n        //     let formData: FormData = new FormData();\n        //     let i: number;\n        //     let keys: string[] = Object.keys(saveSettings);\n        //     httpRequest.onreadystatechange = (event: Event) => {\n        //         if (httpRequest.readyState === 4 && httpRequest.status === 200) {\n        //             (postMessage as Function)(httpRequest.response);\n        //         }\n        //     };\n        //     httpRequest.onerror = (event: Event) => {\n        //         (postMessage as Function)(event);\n        //     };\n        //     formData.append('JSONData', JSON.stringify(saveJSON));\n        //     for (i = 0; i < keys.length; i++) {\n        //         formData.append(keys[i], (<{ [key: string]: string }>saveSettings)[keys[i]]);\n        //     }\n        //     httpRequest.open('POST', saveSettings.saveUrl, false);\n        //     httpRequest.send(formData);\n        // } catch (e) {\n        //     (postMessage as Function)({ error: e.message });\n        // }\n    };\n    return SaveWorker;\n}());\nexport { SaveWorker };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { executeTaskAsync } from '../common/worker';\nimport * as events from '../common/event';\nimport { SaveWorker } from '../workers/save-worker';\nimport { detach } from '@syncfusion/ej2-base';\n/**\n * @hidden\n * The `WorkbookSave` module is used to handle the save action in Workbook library.\n */\nvar WorkbookSave = /** @class */ (function (_super) {\n    __extends(WorkbookSave, _super);\n    /**\n     * Constructor for WorkbookSave module in Workbook library.\n     * @private\n     */\n    function WorkbookSave(parent) {\n        var _this = _super.call(this, parent) || this;\n        _this.isProcessCompleted = false;\n        _this.saveJSON = {};\n        _this.isFullPost = false;\n        _this.needBlobData = false;\n        _this.customParams = null;\n        _this.addEventListener();\n        return _this;\n    }\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookSave.prototype.getModuleName = function () {\n        return 'workbookSave';\n    };\n    /**\n     * To destroy the WorkbookSave module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookSave.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * @hidden\n     */\n    WorkbookSave.prototype.addEventListener = function () {\n        this.parent.on(events.beginSave, this.initiateSave, this);\n    };\n    /**\n     * @hidden\n     */\n    WorkbookSave.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(events.beginSave, this.initiateSave);\n        }\n    };\n    /**\n     * Initiate save process.\n     * @hidden\n     */\n    WorkbookSave.prototype.initiateSave = function (args) {\n        var saveSettings = args.saveSettings;\n        this.saveSettings = {\n            saveType: saveSettings.saveType,\n            url: saveSettings.url,\n            fileName: saveSettings.fileName || 'Sample'\n        };\n        this.isFullPost = args.isFullPost;\n        this.needBlobData = args.needBlobData;\n        if (this.needBlobData) {\n            this.isFullPost = false;\n        }\n        this.customParams = args.customParams;\n        this.updateBasicSettings();\n        this.processSheets();\n    };\n    /**\n     * Update save JSON with basic settings.\n     * @hidden\n     */\n    WorkbookSave.prototype.updateBasicSettings = function () {\n        var jsonStr = this.getStringifyObject(this.parent, ['sheets', '_isScalar', 'observers', 'closed', 'isStopped', 'hasError',\n            '__isAsync', 'beforeCellFormat', 'beforeCellRender', 'beforeDataBound', 'beforeOpen', 'beforeSave', 'beforeSelect',\n            'beforeSort', 'cellEdit', 'cellEditing', 'cellSave', 'beforeCellSave', 'contextMenuItemSelect', 'contextMenuBeforeClose',\n            'contextMenuBeforeOpen', 'created', 'dataBound', 'fileMenuItemSelect', 'fileMenuBeforeClose', 'fileMenuBeforeOpen',\n            'saveComplete', 'sortComplete', 'select', 'actionBegin', 'actionComplete', 'afterHyperlinkClick', 'afterHyperlinkCreate',\n            'beforeHyperlinkClick', 'beforeHyperlinkCreate', 'openComplete', 'openFailure', 'queryCellInfo', 'dialogBeforeOpen',\n            'dataSourceChanged']);\n        var basicSettings = JSON.parse(jsonStr);\n        var sheetCount = this.parent.sheets.length;\n        var i = 0;\n        if (sheetCount) {\n            basicSettings.sheets = [];\n        }\n        this.saveJSON = basicSettings;\n    };\n    /**\n     * Process sheets properties.\n     * @hidden\n     */\n    WorkbookSave.prototype.processSheets = function () {\n        var i = 0;\n        var sheetCount = this.parent.sheets.length;\n        while (i < sheetCount) {\n            executeTaskAsync(this, this.processSheet, this.updateSheet, [this.getStringifyObject(this.parent.sheets[i]), i]);\n            i++;\n        }\n    };\n    /**\n     * Update processed sheet data.\n     * @hidden\n     */\n    WorkbookSave.prototype.updateSheet = function (data) {\n        this.saveJSON.sheets[data[0]] = data[1];\n        this.isProcessCompleted = this.getSheetLength(this.saveJSON.sheets) === this.parent.sheets.length;\n        if (this.isProcessCompleted) {\n            this.save(this.saveSettings);\n        }\n    };\n    WorkbookSave.prototype.getSheetLength = function (sheets) {\n        var len = 0;\n        sheets.forEach(function (sheet) {\n            if (sheet) {\n                len++;\n            }\n        });\n        return len;\n    };\n    /**\n     * Save process.\n     * @hidden\n     */\n    WorkbookSave.prototype.save = function (saveSettings) {\n        var args = { cancel: false, jsonObject: this.saveJSON };\n        this.parent.notify(events.onSave, args);\n        if (!args.cancel) {\n            if (this.isFullPost) {\n                this.initiateFullPostSave();\n            }\n            else {\n                executeTaskAsync(this, { 'workerTask': this.processSave }, this.updateSaveResult, [this.saveJSON, saveSettings, this.customParams], true);\n            }\n        }\n        this.saveJSON = {};\n    };\n    /**\n     * Update final save data.\n     * @hidden\n     */\n    WorkbookSave.prototype.updateSaveResult = function (result) {\n        var args = {\n            status: 'Success',\n            message: '',\n            url: this.saveSettings.url,\n            fileName: this.saveSettings.fileName,\n            saveType: this.saveSettings.saveType,\n            blobData: null\n        };\n        if (typeof (result) === 'object' && result.error) {\n            args.status = 'Failure';\n            args.message = result.error.toString();\n        }\n        else if (typeof (result) === 'object' && result.dialog) {\n            this.parent.notify(events.saveError, { content: result.dialog });\n        }\n        else {\n            if (this.needBlobData) {\n                args.blobData = result;\n            }\n            else {\n                this.ClientFileDownload(result, this.saveSettings.fileName);\n            }\n        }\n        this.parent.trigger('saveComplete', args);\n        this.parent.notify(events.saveCompleted, args);\n    };\n    WorkbookSave.prototype.ClientFileDownload = function (blobData, fileName) {\n        var anchor = this.parent.createElement('a', { attrs: { download: this.getFileNameWithExtension() } });\n        var url = URL.createObjectURL(blobData);\n        anchor.href = url;\n        document.body.appendChild(anchor);\n        anchor.click();\n        URL.revokeObjectURL(url);\n        document.body.removeChild(anchor);\n    };\n    WorkbookSave.prototype.initiateFullPostSave = function () {\n        var keys = Object.keys(this.saveSettings);\n        var i;\n        var formElem = this.parent.createElement('form', { attrs: { method: 'POST', action: this.saveSettings.url } });\n        var inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: 'JSONData' } });\n        inputElem.value = JSON.stringify(this.saveJSON);\n        formElem.appendChild(inputElem);\n        for (i = 0; i < keys.length; i++) {\n            inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: keys[i] } });\n            inputElem.value = this.saveSettings[keys[i]];\n            formElem.appendChild(inputElem);\n        }\n        keys = Object.keys(this.customParams);\n        for (i = 0; i < keys.length; i++) {\n            inputElem = this.parent.createElement('input', { attrs: { type: 'hidden', name: keys[i] } });\n            inputElem.value = this.customParams[keys[i]];\n            formElem.appendChild(inputElem);\n        }\n        document.body.appendChild(formElem);\n        formElem.submit();\n        detach(formElem);\n        this.parent.notify(events.saveCompleted, {});\n    };\n    /**\n     * Get stringified workbook object.\n     * @hidden\n     */\n    WorkbookSave.prototype.getStringifyObject = function (value, skipProp) {\n        if (skipProp === void 0) { skipProp = []; }\n        return JSON.stringify(value, function (key, value) {\n            if (skipProp.indexOf(key) > -1) {\n                return undefined;\n            }\n            else {\n                if (value && typeof value === 'object' && value.hasOwnProperty('properties')) {\n                    return value.properties;\n                }\n                else if (value !== null) {\n                    return value;\n                }\n                else {\n                    return undefined;\n                }\n            }\n        });\n    };\n    WorkbookSave.prototype.getFileNameWithExtension = function (filename) {\n        if (!filename) {\n            filename = this.saveSettings.fileName;\n        }\n        var fileExt = this.getFileExtension();\n        var idx = filename.lastIndexOf('.');\n        if (idx > -1) {\n            filename = filename.substr(0, idx);\n        }\n        return (filename + fileExt);\n    };\n    WorkbookSave.prototype.getFileExtension = function () {\n        return ('.' + this.saveSettings.saveType.toLowerCase());\n    };\n    return WorkbookSave;\n}(SaveWorker));\nexport { WorkbookSave };\n","/**\n * @hidden\n */\nexport var CommonErrors;\n(function (CommonErrors) {\n    CommonErrors[CommonErrors[\"na\"] = 0] = \"na\";\n    CommonErrors[CommonErrors[\"value\"] = 1] = \"value\";\n    CommonErrors[CommonErrors[\"ref\"] = 2] = \"ref\";\n    CommonErrors[CommonErrors[\"divzero\"] = 3] = \"divzero\";\n    CommonErrors[CommonErrors[\"num\"] = 4] = \"num\";\n    CommonErrors[CommonErrors[\"name\"] = 5] = \"name\";\n    CommonErrors[CommonErrors[\"null\"] = 6] = \"null\";\n})(CommonErrors || (CommonErrors = {}));\n/**\n * @hidden\n */\nexport var FormulasErrorsStrings;\n(function (FormulasErrorsStrings) {\n    FormulasErrorsStrings[FormulasErrorsStrings[\"operators_cannot_start_with_expression\"] = 0] = \"operators_cannot_start_with_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_And\"] = 1] = \"reservedWord_And\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Xor\"] = 2] = \"reservedWord_Xor\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_If\"] = 3] = \"reservedWord_If\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"number_contains_2_decimal_points\"] = 4] = \"number_contains_2_decimal_points\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Else\"] = 5] = \"reservedWord_Else\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"reservedWord_Not\"] = 6] = \"reservedWord_Not\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_char_in_number\"] = 7] = \"invalid_char_in_number\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_characters_following_with_operator\"] = 6] = \"invalid_characters_following_with_operator\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"mismatched_parentheses\"] = 8] = \"mismatched_parentheses\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"unknown_formula_name\"] = 9] = \"unknown_formula_name\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_a_single_argument\"] = 10] = \"requires_a_single_argument\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_3_args\"] = 11] = \"requires_3_args\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_Math_argument\"] = 12] = \"invalid_Math_argument\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"requires_2_args\"] = 13] = \"requires_2_args\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"bad_index\"] = 14] = \"bad_index\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"too_complex\"] = 15] = \"too_complex\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"circular_reference\"] = 16] = \"circular_reference\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"missing_formula\"] = 17] = \"missing_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"improper_formula\"] = 18] = \"improper_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_expression\"] = 19] = \"invalid_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"cell_empty\"] = 20] = \"cell_empty\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"bad_formula\"] = 21] = \"bad_formula\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"empty_expression\"] = 22] = \"empty_expression\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"virtual_mode_required\"] = 23] = \"virtual_mode_required\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"mismatched_tics\"] = 24] = \"mismatched_tics\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"wrong_number_arguments\"] = 25] = \"wrong_number_arguments\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"invalid_arguments\"] = 26] = \"invalid_arguments\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"iterations_do_not_converge\"] = 27] = \"iterations_do_not_converge\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"calculation_overflow\"] = 29] = \"calculation_overflow\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"already_registered\"] = 28] = \"already_registered\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"missing_sheet\"] = 30] = \"missing_sheet\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"cannot_parse\"] = 31] = \"cannot_parse\";\n    FormulasErrorsStrings[FormulasErrorsStrings[\"expression_cannot_end_with_an_operator\"] = 32] = \"expression_cannot_end_with_an_operator\";\n})(FormulasErrorsStrings || (FormulasErrorsStrings = {}));\n","import { FormulasErrorsStrings, CommonErrors, getSkeletonVal } from '../common/index';\nimport { isNullOrUndefined, getValue, Internationalization } from '@syncfusion/ej2-base';\n/**\n * Represents the basic formulas module.\n */\nvar BasicFormulas = /** @class */ (function () {\n    function BasicFormulas(parent) {\n        this.formulas = [\n            { formulaName: 'SUM', category: 'Math & Trig', description: 'Sums individual values, cell references or ranges.' },\n            {\n                formulaName: 'SUMIFS', category: 'Math & Trig',\n                description: 'Sums the cells specified by a given set of conditionsor criteria.'\n            },\n            {\n                formulaName: 'SUMPRODUCT', category: 'Math & Trig',\n                description: 'Returns sum of the product of given ranges of arrays.'\n            },\n            { formulaName: 'ABS', category: 'Math & Trig', description: 'Returns the absolute value of a number.' },\n            { formulaName: 'RAND', category: 'Math & Trig', description: 'Return a random number between 0 and 1.' },\n            { formulaName: 'FLOOR', category: 'Math & Trig', description: 'Returns the round a number down to the nearest integer.' },\n            { formulaName: 'CEILING', category: 'Math & Trig', description: 'Returns a number rounded up to a multiple of another number.' },\n            {\n                formulaName: 'SUMIF', category: 'Math & Trig',\n                description: 'It will sum up cells that meet the given criteria.'\n            },\n            {\n                formulaName: 'PRODUCT', category: 'Math & Trig',\n                description: 'Multiplies all the numbers given as arguments and returns the product.'\n            },\n            {\n                formulaName: 'AVERAGE', category: 'Statistical',\n                description: 'The sum of the numbers divided by how many numbers are being averaged.'\n            },\n            {\n                formulaName: 'AVERAGEIF', category: 'Statistical',\n                description: 'Computes the average of the numbers in a range that meet the supplied criteria.'\n            },\n            {\n                formulaName: 'COUNT', category: 'Statistical',\n                description: 'Counts the numbers in the list of arguments, exclude text entries.'\n            },\n            { formulaName: 'COUNTA', category: 'Statistical', description: 'Counts the non-empty values in the list of arguments.' },\n            {\n                formulaName: 'COUNTIF', category: 'Statistical',\n                description: 'Counts the number of cells in a range that meet a specified condition.'\n            },\n            {\n                formulaName: 'COUNTIFS', category: 'Statistical',\n                description: 'Counts the number of times each cells in all the ranges that meet the specific conditions.'\n            },\n            {\n                formulaName: 'AVERAGEA', category: 'Statistical',\n                description: 'Calculates the average of values in the list of arguments.Arguments can be numbers, names, arrays or references.'\n            },\n            {\n                formulaName: 'AVERAGEIFS', category: 'Statistical',\n                description: 'Conditionally returns the average of the contents of cells for the set of ranges.'\n            },\n            {\n                formulaName: 'MIN', category: 'Statistical',\n                description: 'Returns the smaller number in set of arguments.'\n            },\n            { formulaName: 'MAX', category: 'Statistical', description: 'Returns the largest number in set of arguments.' },\n            { formulaName: 'DATE', category: 'Date', description: 'Returns the date, given the year, month and day of the month.' },\n            { formulaName: 'DAY', category: 'Date', description: 'Returns the day of a given date.' },\n            { formulaName: 'TODAY', category: 'Date', description: 'Returns the current date as date value.' },\n            { formulaName: 'DAYS', category: 'Date', description: 'Returns the number of days between two dates.' },\n            {\n                formulaName: 'IF', category: 'Logical',\n                description: 'Returns one value if a logical expression is TRUE and another if it is FALSE'\n            },\n            {\n                formulaName: 'AND', category: 'Logical',\n                description: 'Returns TRUE if all the arguments are considered TRUE, and FALSE otherwise.'\n            },\n            {\n                formulaName: 'IFS', category: 'Logical',\n                description: 'Checks multiple conditions and returns a value corresponding to the first TRUE result.'\n            },\n            {\n                formulaName: 'IFERROR', category: 'Logical',\n                description: 'Returns a value you specify if a formula evaluates to an error; otherwise, it returns the result of the formula.'\n            },\n            {\n                formulaName: 'CHOOSE', category: 'Lookup & Reference',\n                description: 'Returns a value from a list, given an index number.'\n            },\n            {\n                formulaName: 'INDEX', category: 'Lookup & Reference',\n                description: 'Returns a value from a table, given a row and column number.'\n            },\n            { formulaName: 'FIND', category: 'Text', description: 'Returns the position of a string of text within another string.' },\n            { formulaName: 'CONCATENATE', category: 'Text', description: ' Used to join two or more strings together.' },\n            { formulaName: 'CONCAT', category: 'Text', description: 'Concatenates a list or range of text strings.' },\n            { formulaName: 'SUBTOTAL', category: 'Lookup & Reference', description: 'Returns a subtotal in a list or database.' },\n            { formulaName: 'RADIANS', category: 'Math & Trig', description: 'Converts degrees to radians.' },\n            {\n                formulaName: 'OR', category: 'Logical',\n                description: 'Returns TRUE if any arguments considered TRUE, and all the arguments are FALSE it will return FALSE.'\n            },\n            {\n                formulaName: 'MATCH', category: 'Lookup & Reference',\n                description: 'Returns the relative position of an checked item in range that matches a specified value in a specified order'\n            },\n            {\n                formulaName: 'RANDBETWEEN', category: 'Math & Trig', description: 'Returns an integer random number in a specified range.'\n            },\n            {\n                formulaName: 'SLOPE', category: 'Statistical',\n                description: 'Returns the slope of the line from linear regression of the data points.'\n            },\n            {\n                formulaName: 'INTERCEPT', category: 'Statistical',\n                description: 'Calculates the point of the Y-intercept line via linear regression.'\n            },\n            {\n                formulaName: 'ROUNDUP', category: 'Math & Trig', description: 'Rounds a number away from zero.'\n            },\n            {\n                formulaName: 'INT', category: 'Math & Trig', description: 'Returns a number to the nearest integer.'\n            },\n            {\n                formulaName: 'LN', category: 'Math & Trig', description: 'Returns the natural logarithm of a number.'\n            },\n            {\n                formulaName: 'ISNUMBER', category: 'Information', description: 'Returns TRUE, if the argument is number and FALSE otherwise.'\n            },\n            {\n                formulaName: 'ROUND', category: 'Math & Trig', description: 'Rounds a number to a specified number of digits.'\n            },\n            {\n                formulaName: 'LOG', category: 'Math & Trig', description: 'Returns the logarithm of a number to the base that you specify.'\n            },\n            {\n                formulaName: 'POWER', category: 'Math & Trig', description: 'Returns the result of a number raised to power.'\n            },\n            {\n                formulaName: 'TRUNC', category: 'Math & Trig',\n                description: 'Returns the truncated value of a number to a specified number of decimal places.'\n            },\n            {\n                formulaName: 'EXP', category: 'Math & Trig', description: 'Returns e raised to the power of the given number.'\n            },\n            {\n                formulaName: 'GEOMEAN', category: 'Statistical',\n                description: 'Returns the geometric mean of an array or range of positive data.'\n            },\n            { formulaName: 'TEXT', category: 'Lookup & Reference', description: 'Returns the value in required format.' }\n        ];\n        this.isConcat = false;\n        this.parent = parent;\n        this.init();\n    }\n    BasicFormulas.prototype.init = function () {\n        var fn;\n        for (var i = 0; i < this.formulas.length; i++) {\n            fn = getValue('Compute' + this.formulas[i].formulaName, this).bind(this);\n            this.addFormulaCollection(this.formulas[i].formulaName.toUpperCase(), fn, this.formulas[i].category, this.formulas[i].description);\n        }\n    };\n    BasicFormulas.prototype.addFormulaCollection = function (formulaName, functionName, formulaCategory, description) {\n        this.parent.libraryFormulas = {\n            fName: formulaName, handler: functionName, category: formulaCategory,\n            description: description\n        };\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUM = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var sum = 0;\n        var val;\n        var orgValue;\n        if (!isNullOrUndefined(args)) {\n            var argArr = args;\n            for (var i = 0; i < argArr.length; i++) {\n                var argValue = argArr[i].toString();\n                if (argValue.indexOf(':') > -1 && this.parent.isCellReference(argValue)) {\n                    var cellCollection = this.parent.getCellCollection(argValue.split(this.parent.tic).join(''));\n                    for (var j = 0; j < cellCollection.length; j++) {\n                        val = this.parent.getValueFromArg(cellCollection[j]);\n                        if (this.parent.getErrorStrings().indexOf(val) > -1) {\n                            return val;\n                        }\n                        if (isNullOrUndefined(val[0]) || isNaN(this.parent.parseFloat(val))) {\n                            continue;\n                        }\n                        sum = sum + this.parent.parseFloat(val);\n                    }\n                }\n                else {\n                    if (argArr[i].split(this.parent.tic).join('') === this.parent.trueValue) {\n                        argArr[i] = '1';\n                    }\n                    if (argArr[i].split(this.parent.tic).join('') === this.parent.falseValue) {\n                        argArr[i] = '0';\n                    }\n                    orgValue = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                    if (isNullOrUndefined(orgValue) || isNaN(this.parent.parseFloat(orgValue))) {\n                        continue;\n                    }\n                    if (orgValue.length > 0) {\n                        sum = sum + this.parent.parseFloat(orgValue + '');\n                    }\n                }\n            }\n        }\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeINT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var str;\n        var num;\n        var index;\n        if (!isNullOrUndefined(args) && args.length !== 1 || args[0] === '') {\n            str = this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (args[0] !== '' && args.length === 1) {\n            str = args[0];\n            index = str.indexOf('\"');\n            str = str.indexOf('\"') > -1 ? str.replace('\"', '') : str;\n            str = str.indexOf('\"') > -1 ? str.replace('\"', '') : str;\n            str = this.parent.getValueFromArg(str);\n            str = str.toUpperCase() === 'TRUE' ? '1' : (str === 'FALSE' ? '0' : str);\n            num = this.parent.parseFloat(str);\n            num = Math.floor(num);\n        }\n        if (isNaN(num)) {\n            str = index > -1 ? this.parent.getErrorStrings()[CommonErrors.value] : this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        return num ? num : str;\n    };\n    ;\n    /** @hidden */\n    BasicFormulas.prototype.ComputeTODAY = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var str;\n        if (args && args[0] !== '') {\n            str = this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        else {\n            var dt = new Date(Date.now());\n            str = dt.getFullYear() + '/' + this.parent.calculateDate((dt.getMonth() + 1).toString()) + '/'\n                + this.parent.calculateDate(dt.getDate().toString());\n        }\n        return str;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUMPRODUCT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var sum = 0;\n        var count = 0;\n        var index;\n        var mulValues = null;\n        var ranges = args;\n        for (var k = 0; k < ranges.length; ++k) {\n            var range = ranges[k];\n            if (!range.startsWith(this.parent.tic) && this.parent.isCellReference(range)) {\n                var i = range.indexOf(':');\n                var startRow = this.parent.rowIndex(range.substr(0, i));\n                var endRow = this.parent.rowIndex(range.substr(i + 1));\n                if (!(startRow !== -1 || endRow === -1) === (startRow === -1 || endRow !== -1)) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                var col1 = this.parent.colIndex(range.substr(0, i));\n                var col2 = this.parent.colIndex(range.substr(i + 1));\n                if (mulValues === null) {\n                    count = (endRow - startRow + 1) * (col2 - col1 + 1);\n                    mulValues = [];\n                    for (i = 0; i < count; ++i) {\n                        mulValues[i] = 1; //To create required index.\n                    }\n                }\n                i = 0;\n                for (var row = startRow; row <= endRow; ++row) {\n                    for (var col = col1; col <= col2; ++col) {\n                        var cellRef = '' + this.parent.convertAlpha(col) + (row);\n                        var result = this.parent.getValueFromArg(cellRef);\n                        if (!isNaN(parseFloat(result))) {\n                            //To return #VALUE! error when array dimensions are mismatched.\n                            if (isNaN(mulValues[i])) {\n                                return this.parent.getErrorStrings()[CommonErrors.name];\n                            }\n                            mulValues[i] = mulValues[i] * parseFloat(result);\n                        }\n                        else {\n                            mulValues[i] = 0;\n                        }\n                        i++;\n                    }\n                }\n            }\n            else {\n                var s1 = this.parent.getValueFromArg(range);\n                index = s1.indexOf('\"');\n                if (this.parent.getErrorStrings().indexOf(s1) > -1) {\n                    return s1;\n                }\n                else if (index > -1) {\n                    return 0;\n                }\n                else {\n                    return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n                }\n            }\n        }\n        for (var i = 0; i < count; ++i) {\n            sum += mulValues[i];\n        }\n        return sum;\n    };\n    ;\n    /** @hidden */\n    BasicFormulas.prototype.ComputeROUNDUP = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var str;\n        var num;\n        var arg1;\n        var arg2;\n        var index;\n        var len = args.length;\n        if (!isNullOrUndefined(args) && len > 2) {\n            str = this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (len === 1 && args[0] !== '') {\n            index = args[0].indexOf('\"');\n            arg1 = args[0].indexOf('\"') > -1 ? args[0].replace('\"', '') : args[0];\n            arg1 = arg1.indexOf('\"') > -1 ? arg1.replace('\"', '') : arg1;\n            arg1 = arg1.toUpperCase() === 'TRUE' ? '1' : (arg1 === 'FALSE' ? '0' : arg1);\n            arg1 = this.parent.getValueFromArg(arg1);\n            num = this.parent.parseFloat(arg1);\n            if (num > 0) {\n                num += .4999999999; // To round the number, we using this value.\n            }\n            else if (num < 0) {\n                num -= .4999999999;\n            }\n            num = this.parent.parseFloat(num.toFixed(0));\n            str = num.toString();\n        }\n        else if (len === 2 && args[0] !== '' && args[1] !== '') {\n            index = args[0].indexOf('\"') > -1 ? args[0].indexOf('\"') : (args[1].indexOf('\"') > -1 ? args[1].indexOf('\"') : -1);\n            arg1 = args[0].indexOf('\"') > -1 ? args[0].replace('\"', '') : args[0];\n            arg1 = arg1.indexOf('\"') > -1 ? arg1.replace('\"', '') : arg1;\n            arg2 = args[1].indexOf('\"') > -1 ? args[1].replace('\"', '') : args[1];\n            arg2 = arg2.indexOf('\"') > -1 ? arg2.replace('\"', '') : arg2;\n            arg1 = arg1.toUpperCase() === 'TRUE' ? '1' : (arg1 === 'FALSE' ? '0' : arg1);\n            arg2 = arg2.toUpperCase() === 'TRUE' ? '1' : (arg2 === 'FALSE' ? '0' : arg2);\n            arg1 = this.parent.getValueFromArg(arg1);\n            arg2 = this.parent.getValueFromArg(arg2);\n            var digits = Math.ceil(this.parent.parseFloat(arg2));\n            num = this.parent.parseFloat(arg1);\n            if (digits > 0) {\n                if (num > 0) {\n                    num += .4999999999 / Math.pow(10, digits);\n                }\n                else if (num < 0) {\n                    num -= .4999999999 / Math.pow(10, digits);\n                }\n                num = this.parent.parseFloat(num.toFixed(digits));\n                str = num.toFixed(digits);\n                if (isNaN(num)) {\n                    if (digits.toString().indexOf('\"') > -1) {\n                        str = this.parent.getErrorStrings()[CommonErrors.value];\n                    }\n                    else {\n                        str = this.parent.getErrorStrings()[CommonErrors.name];\n                    }\n                }\n            }\n            else {\n                if (num > 0) {\n                    num = (num / Math.pow(10, -digits)) + .49999;\n                }\n                else if (num < 0) {\n                    num = (num / Math.pow(10, -digits)) - .49999;\n                }\n                num = this.parent.parseFloat(num.toFixed(0)) * Math.pow(10, -digits);\n                str = num.toString();\n                if (isNaN(num)) {\n                    str = (digits.toString().indexOf('\"') > -1) ? this.parent.getErrorStrings()[CommonErrors.value] :\n                        str = this.parent.getErrorStrings()[CommonErrors.name];\n                }\n            }\n        }\n        else {\n            str = index > -1 ? this.parent.getErrorStrings()[CommonErrors.value] :\n                this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        return str;\n    };\n    ;\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        var argVal;\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        for (var i = 0; i < argArr.length; i++) {\n            argVal = argArr[i];\n            if (argVal.indexOf(':') > -1 && this.parent.isCellReference(argVal)) {\n                cellColl = this.parent.getCellCollection(argVal.split(this.parent.tic).join(''));\n                for (var j = 0; j < cellColl.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellColl[j]);\n                    if (!isNaN(this.parent.parseFloat(cellValue))) {\n                        if (argVal.length > 0 && argVal !== '' && argVal !== ' ') {\n                            result++;\n                        }\n                    }\n                }\n            }\n            else {\n                argVal = argVal.split(this.parent.tic).join('');\n                if (!isNaN(this.parent.parseFloat(this.parent.getValueFromArg(argVal)))) {\n                    if (argVal.length > 0 && argVal !== '' && argVal !== ' ') {\n                        result++;\n                    }\n                }\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeDATE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        if (argArr.length !== 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var i = 0; i < argArr.length; ++i) {\n            argArr[i] = this.parent.getValueFromArg(argArr[i]);\n        }\n        /* tslint:disable */\n        argArr[0] = (argArr[0].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[0].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[0];\n        argArr[1] = (argArr[1].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[1].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[1];\n        argArr[2] = (argArr[2].split(this.parent.tic).join('') === 'TRUE') ? '1' : (argArr[2].split(this.parent.tic).join('') === 'FALSE') ? '0' : argArr[2];\n        /* tslint:enable */\n        var year = this.parent.parseFloat(argArr[0].split(this.parent.tic).join(''));\n        var month = this.parent.parseFloat(argArr[1].split(this.parent.tic).join(''));\n        var day = this.parent.parseFloat(argArr[2].split(this.parent.tic).join(''));\n        var days = 0;\n        if (!isNaN(year) && !isNaN(month) && !isNaN(day)) {\n            if (year < 0) {\n                return this.parent.getErrorStrings()[CommonErrors.num].toString();\n            }\n            while (month > 12) {\n                month -= 12;\n                year++;\n            }\n            days = this.parent.getSerialDateFromDate(year, month, day);\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value].toString();\n        }\n        if (days === 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num].toString();\n        }\n        var date = this.parent.fromOADate(days);\n        if (date.toString() !== 'Invalid Date') {\n            /* tslint:disable-next-line */\n            return date.getFullYear() + '/' + this.parent.calculateDate((date.getMonth() + 1).toString()) + '/' + this.parent.calculateDate(date.getDate().toString());\n        }\n        return days.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeFLOOR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var argCount = argArr.length;\n        var splitArg = argArr[1].split(this.parent.tic).join('');\n        var argValue = [];\n        var fnum;\n        var significance;\n        if (argCount !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        argValue.push(fnum = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''))));\n        argArr[1] = (splitArg === this.parent.trueValue) ? '1' : (splitArg === this.parent.falseValue) ? '0' : argArr[1];\n        argValue.push(significance = this.parent.parseFloat(this.parent.getValueFromArg(argArr[1].split(this.parent.tic).join(''))));\n        if (fnum > 0 && significance < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (fnum > 0 && significance === 0) {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        if (isNaN(fnum)) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        return Math.floor(fnum / significance) * significance;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCEILING = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var orgValue = [];\n        var argCount = argArr.length;\n        var splitArg = argArr[1].split(this.parent.tic).join('');\n        var cnum;\n        var significance;\n        if (argCount !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgValue.push(cnum = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''))));\n        argArr[1] = (splitArg === this.parent.trueValue) ? '1' : (splitArg === this.parent.falseValue) ? '0' : argArr[1];\n        orgValue.push(significance = this.parent.parseFloat(this.parent.getValueFromArg(argArr[1].split(this.parent.tic).join(''))));\n        if (cnum > 0 && significance < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        if (isNaN(cnum)) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        if (significance === 0) {\n            return 0;\n        }\n        return Math.ceil(cnum / significance) * significance;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeDAY = function () {\n        var serialNumber = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            serialNumber[_i] = arguments[_i];\n        }\n        var date = serialNumber;\n        var result;\n        if (isNullOrUndefined(date) || (date.length === 1 && date[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (date.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var dateVal = this.parent.getValueFromArg(date[0].split(this.parent.tic).join(''));\n        if (!isNaN(this.parent.parseFloat(dateVal))) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        else {\n            dateVal = dateVal;\n        }\n        result = this.parent.parseDate(dateVal);\n        if (Object.prototype.toString.call(result) === '[object Date]') {\n            /* tslint:disable-next-line */\n            result = result.getDate();\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeIF = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (this.parent.getErrorStrings().indexOf(args[0]) > 0) {\n            return args[0];\n        }\n        var argArr = args;\n        var condition;\n        var result;\n        if (argArr.length > 3 || argArr.length === 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        else if (argArr.length <= 3) {\n            condition = this.parent.getValueFromArg(argArr[0]);\n            if (this.parent.getErrorStrings().indexOf(condition) > -1) {\n                return condition;\n            }\n            if (condition === this.parent.trueValue || this.parent.parseFloat(condition) > 0 || this.parent.parseFloat(condition) < 0) {\n                result = this.parent.getValueFromArg(argArr[1]);\n            }\n            else if (condition === this.parent.falseValue || this.parent.parseFloat(condition) === 0) {\n                if (isNullOrUndefined(argArr[2])) {\n                    return this.parent.falseValue;\n                }\n                result = this.parent.getValueFromArg(argArr[2]);\n            }\n            else {\n                return this.parent.formulaErrorStrings[FormulasErrorsStrings.requires_3_args];\n            }\n        }\n        if (result.indexOf(this.parent.tic) > -1) {\n            return result.split(this.parent.tic).join('');\n        }\n        else {\n            return result;\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeIFERROR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        var condition;\n        if (argArr.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        condition = this.parent.getValueFromArg(argArr[0]);\n        if (condition === this.parent.trueValue || condition === this.parent.falseValue) {\n            return condition;\n        }\n        if (condition[0] === this.parent.arithMarker) {\n            condition = condition.replace(this.parent.arithMarker, ' ');\n        }\n        condition = this.parent.getValueFromArg(condition).toUpperCase().split(this.parent.tic).join('');\n        if (condition[0] === '#' || condition.indexOf('Infinity') > -1 || this.parent.getErrorStrings().indexOf(condition) > -1) {\n            return this.parent.getValueFromArg(argArr[1]).split(this.parent.tic).join('');\n        }\n        else {\n            return condition;\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputePRODUCT = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(range) || (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var product = 1;\n        var val;\n        var orgValue;\n        var argsHit = true;\n        var parseVal;\n        if (!isNullOrUndefined(range)) {\n            var argArr = range;\n            for (var i = 0; i < argArr.length; i++) {\n                var rangevalue = argArr[i];\n                if (rangevalue.indexOf(':') > -1 && this.parent.isCellReference(rangevalue)) {\n                    var cellCollection = this.parent.getCellCollection(rangevalue);\n                    for (var j = 0; j < cellCollection.length; j++) {\n                        val = this.parent.getValueFromArg(cellCollection[j].split(this.parent.tic).join(''));\n                        if (this.parent.getErrorStrings().indexOf(val) > -1) {\n                            return val;\n                        }\n                        val = (val.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                            (val.split(this.parent.tic).join('') === 'FALSE') ? '0' : val;\n                        parseVal = this.parent.parseFloat(val);\n                        if (!isNaN(parseVal)) {\n                            if (val.length > 0) {\n                                product = product * parseVal;\n                                argsHit = false;\n                            }\n                        }\n                    }\n                }\n                else {\n                    orgValue = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                    orgValue = (orgValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                        (orgValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgValue;\n                    parseVal = this.parent.parseFloat(orgValue);\n                    if (!isNaN(parseVal)) {\n                        if (orgValue.length > 0) {\n                            product = product * parseVal;\n                            argsHit = false;\n                        }\n                    }\n                    if (this.parent.getErrorStrings().indexOf(orgValue) > -1) {\n                        return orgValue;\n                    }\n                }\n            }\n        }\n        return argsHit ? '0' : product.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeDAYS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var result;\n        if (isNullOrUndefined(range) && (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (range.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsArr = range;\n        if (argsArr[0].split(this.parent.tic).join('') === this.parent.trueValue) {\n            argsArr[0] = '1';\n        }\n        if (argsArr[0].split(this.parent.tic).join('') === this.parent.falseValue) {\n            argsArr[0] = '0';\n        }\n        var endDate = this.parent.getValueFromArg(argsArr[0].split(this.parent.tic).join(''));\n        var startDate = this.parent.getValueFromArg(argsArr[1].split(this.parent.tic).join(''));\n        startDate = (startDate === '' || startDate == null) ? new Date(Date.parse('1899-12-31')).toDateString() : startDate;\n        endDate = (endDate === '' || endDate == null) ? new Date(Date.parse('1899-12-31')).toDateString() : endDate;\n        if (endDate[0] === '#') {\n            return endDate;\n        }\n        if (startDate[0] === '#') {\n            return startDate;\n        }\n        var d1 = this.parent.intToDate(endDate);\n        var d2 = this.parent.intToDate(startDate);\n        if (d1.toString()[0] === '#') {\n            return d1.toString();\n        }\n        if (d2.toString()[0] === '#') {\n            return d2.toString();\n        }\n        if (Object.prototype.toString.call(d1) === '[object Date]' && Object.prototype.toString.call(d2) === '[object Date]') {\n            /* tslint:disable-next-line */\n            result = Math.ceil(d1.getTime() - d2.getTime()) / (1000 * 3600 * 24);\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        return Math.round(result);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCHOOSE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        if (args.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsArr = args;\n        if (argsArr[0].indexOf(':') > -1 && this.parent.isCellReference(argsArr[0])) {\n            var cellCollection = this.parent.getCellCollection(argsArr[0]);\n            if (cellCollection.length === 1) {\n                argsArr[0] = cellCollection[0];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var cond = this.parent.getValueFromArg(argsArr[0]);\n        if (this.parent.getErrorStrings().indexOf(cond) > -1) {\n            return cond;\n        }\n        var indexNum = this.parent.parseFloat(this.parent.getValueFromArg(argsArr[0].split(this.parent.tic).join('')));\n        if (indexNum < 1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        indexNum = Math.floor(indexNum);\n        var result;\n        if (isNullOrUndefined(argsArr[indexNum])) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        result = argsArr[indexNum];\n        if (result === '') {\n            result = '0';\n        }\n        if (result.indexOf(':') > -1 && this.parent.isCellReference(result)) {\n            var cellCollection = this.parent.getCellCollection(argsArr[0].split(this.parent.tic).join(''));\n            if (cellCollection.length === 1) {\n                argsArr[0] = cellCollection[0];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        return this.parent.getValueFromArg(result).split(this.parent.tic).join('');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUMIF = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (argArr[0].indexOf(':') < 0 && !this.parent.isCellReference(argArr[0]) ||\n            (argArr[2] && argArr[2].indexOf(':') < 0 && !this.parent.isCellReference(argArr[2]))) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n        }\n        if (argArr.length > 3 || argArr.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var result = this.parent.computeSumIfAndAvgIf(range);\n        if (typeof result === 'string' && (this.parent.formulaErrorStrings.indexOf(result)\n            || this.parent.getErrorStrings().indexOf(result))) {\n            return result;\n        }\n        return result[0];\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeABS = function () {\n        var absValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            absValue[_i] = arguments[_i];\n        }\n        var argArr = absValue;\n        var cellvalue = '';\n        var absVal;\n        if (absValue.length === 0 || absValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argArr[0].toString().split(this.parent.tic).join('').trim() === '' || argArr[0].indexOf(this.parent.tic) > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        if (this.parent.isCellReference(argArr[0])) {\n            cellvalue = this.parent.getValueFromArg(argArr[0]);\n            if (cellvalue === '') {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n            absVal = this.parent.parseFloat(cellvalue);\n            if (isNaN(absVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        else {\n            absVal = this.parent.parseFloat(argArr[0]);\n            if (isNaN(absVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n        }\n        return Math.abs(absVal);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGE = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argArr = args;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1) {\n                if (argArr[i].indexOf(this.parent.tic) > -1) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n        }\n        return this.parent.calculateAvg(argArr);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGEIF = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argList = range;\n        if (argList[0].indexOf(':') < 0 && !this.parent.isCellReference(argList[0])) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n        }\n        var resultVal = this.parent.computeSumIfAndAvgIf(range);\n        if (typeof resultVal === 'string' && (this.parent.formulaErrorStrings.indexOf(resultVal)\n            || this.parent.getErrorStrings().indexOf(resultVal))) {\n            return resultVal;\n        }\n        return this.parent.parseFloat(resultVal[0]) / this.parent.parseFloat(resultVal[1]);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCONCATENATE = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(range) || (range.length === 1 && range[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_arguments];\n        }\n        var argsList = range;\n        var result = '';\n        var tempStr = '';\n        for (var i = 0; i < argsList.length; i++) {\n            if (argsList[i].indexOf(':') > -1 && this.parent.isCellReference(argsList[i])) {\n                if (this.isConcat) {\n                    var cells = this.parent.getCellCollection(argsList[i]);\n                    for (var i_1 = 0; i_1 < cells.length; i_1++) {\n                        tempStr = this.parent.getValueFromArg(cells[i_1]);\n                        result = result + tempStr;\n                    }\n                }\n                else {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n            else {\n                if (argsList.length === 1 && argsList[0].indexOf(this.parent.tic) < 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                else {\n                    tempStr = this.parent.getValueFromArg(argsList[i]);\n                    result = result + tempStr;\n                }\n            }\n            if (this.parent.getErrorStrings().indexOf(tempStr) > -1) {\n                return tempStr;\n            }\n        }\n        return result.split(this.parent.tic).join('');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCONCAT = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        this.isConcat = true;\n        return this.ComputeCONCATENATE.apply(this, range);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeMAX = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeMinMax(args, 'max');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeMIN = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeMinMax(args, 'min');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeRAND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (args.length === 1 && args[0] === '') {\n            args.length = 0;\n        }\n        if (args.length > 0) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        return Math.random().toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeAndOr(args, 'and');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeOR = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return this.parent.computeAndOr(args, 'or');\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeFIND = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argsList = args;\n        if (argsList.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var findText = this.parent.removeTics(this.parent.getValueFromArg(argsList[0]));\n        var withinText = this.parent.removeTics(this.parent.getValueFromArg(argsList[1]));\n        if (this.parent.getErrorStrings().indexOf(findText) > -1 || this.parent.getErrorStrings().indexOf(withinText) > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        var startNum = 1;\n        var loc;\n        if (argsList.length === 3) {\n            startNum = this.parent.removeTics(this.parent.getValueFromArg(argsList[2]));\n            if (this.parent.getErrorStrings().indexOf(startNum) > -1) {\n                return startNum;\n            }\n            startNum = this.parent.parseFloat(startNum);\n            if (isNaN(startNum)) {\n                startNum = 1;\n            }\n        }\n        if (startNum <= 0 || startNum > withinText.length) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        loc = withinText.indexOf(findText, startNum - 1);\n        if (loc < 0) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        return (Number(loc) + Number(1)).toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeINDEX = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var argCount = argArr.length;\n        if (isNullOrUndefined(range) || (argArr.length === 1 && argArr[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argCount > 3) {\n            return this.parent.getErrorStrings()[CommonErrors.ref];\n        }\n        var rangeValue = '';\n        var rangeArr = [];\n        if (argCount > 2) {\n            for (var i_2 = 0; i_2 < argCount; i_2++) {\n                if (this.parent.isCellReference(argArr[i_2]) && argArr[i_2].indexOf(':') < 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.ref];\n                }\n                if (this.parent.isCellReference(argArr[i_2])) {\n                    rangeArr[i_2] = argArr[i_2];\n                }\n            }\n        }\n        rangeValue = argArr[0];\n        argArr[1] = argArr[1] === '' ? '1' : argArr[1];\n        argArr[1] = this.parent.getValueFromArg(argArr[1]);\n        if (this.parent.getErrorStrings().indexOf(argArr[1]) > -1) {\n            return argArr[1];\n        }\n        if (!isNullOrUndefined(argArr[2])) {\n            argArr[2] = argArr[2] === '' ? '1' : argArr[2];\n            argArr[2] = this.parent.getValueFromArg(argArr[2]);\n            if (this.parent.getErrorStrings().indexOf(argArr[2]) > -1) {\n                return argArr[2];\n            }\n            if (argArr[2] === '0') {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        var row = parseFloat(argArr[1]);\n        row = !isNaN(row) ? row : -1;\n        var col = parseFloat(argArr[2] ? argArr[2] : '1');\n        col = !isNaN(col) ? col : -1;\n        if (row === -1 || col === -1) {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var i = argArr[0].indexOf(':');\n        var startRow = this.parent.rowIndex(rangeValue.substring(0, i));\n        var endRow = this.parent.rowIndex(rangeValue.substring(i + 1));\n        var startCol = this.parent.colIndex(rangeValue.substring(0, i));\n        var endCol = this.parent.colIndex(rangeValue.substring(i + 1));\n        if (row > endRow - startRow + 1 || col > endCol - startCol + 1) {\n            return this.parent.getErrorStrings()[CommonErrors.ref];\n        }\n        row = startRow + row - 1;\n        col = startCol + col - 1;\n        var cellRef = '' + this.parent.convertAlpha(col) + row;\n        var result = this.parent.getValueFromArg(cellRef);\n        if (result === '') {\n            return 0;\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeIFS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (isNullOrUndefined(range) || (argArr.length === 1 && argArr[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var condition = '';\n        var result = '';\n        for (var i = 0; i < argArr.length; i++) {\n            condition = this.parent.getValueFromArg(argArr[i]);\n            if (condition !== this.parent.trueValue && condition !== this.parent.falseValue) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n            if (condition === this.parent.trueValue) {\n                if (argArr[i + 1].indexOf(this.parent.arithMarker) > -1) {\n                    return this.parent.trueValue;\n                }\n                if (this.parent.isCellReference(argArr[i + 1].split(this.parent.tic).join(''))) {\n                    result = this.parent.getValueFromArg(argArr[i + 1]);\n                }\n                else {\n                    result = (argArr[i + 1].indexOf(this.parent.tic) > -1) ? argArr[i + 1].split(this.parent.tic).join('') :\n                        this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                i = i + 1;\n                return result;\n            }\n            else if (condition === this.parent.falseValue) {\n                i = i + 1;\n            }\n        }\n        return this.parent.getErrorStrings()[CommonErrors.na];\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNTA = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArr = args;\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        for (var i = 0; i < argArr.length; i++) {\n            if (argArr[i].indexOf(':') > -1 && this.parent.isCellReference(argArr[i])) {\n                cellColl = this.parent.getCellCollection(argArr[i].split(this.parent.tic).join(''));\n                for (var j = 0; j < cellColl.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellColl[j]);\n                    if (cellValue.length > 0) {\n                        result++;\n                    }\n                }\n            }\n            else {\n                var cellValue_1 = this.parent.getValueFromArg(argArr[i].split(this.parent.tic).join(''));\n                if (cellValue_1.length > 0) {\n                    result++;\n                }\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGEA = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (isNullOrUndefined(args) || (args.length === 1 && args[0] === '')) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var argArrs = args;\n        var cellCol;\n        var result = 0;\n        var cellValue;\n        var length = 0;\n        var parseValue;\n        for (var k = 0; k < argArrs.length; k++) {\n            if (argArrs[k].indexOf(':') > -1 && this.parent.isCellReference(argArrs[k])) {\n                cellCol = this.parent.getCellCollection(argArrs[k].split(this.parent.tic).join(''));\n                for (var j = 0; j < cellCol.length; j++) {\n                    cellValue = this.parent.getValueFromArg(cellCol[j]);\n                    if (cellValue.toUpperCase() === this.parent.trueValue) {\n                        cellValue = '1';\n                    }\n                    else if (cellValue.toUpperCase() === this.parent.falseValue || cellValue === '') {\n                        cellValue = '0';\n                    }\n                    else if (this.parent.getErrorStrings().indexOf(cellValue) > -1) {\n                        return cellValue;\n                    }\n                    else if (cellValue.length > 0) {\n                        parseValue = parseFloat(cellValue);\n                        cellValue = !isNaN(parseValue) ? parseValue : 0;\n                        result = result + cellValue;\n                        length = length + 1;\n                    }\n                }\n                length = cellCol.length;\n            }\n            else {\n                if (argArrs[k] === this.parent.trueValue) {\n                    argArrs[k] = '1';\n                }\n                if (argArrs[k] === this.parent.falseValue || argArrs[k] === '') {\n                    argArrs[k] = '0';\n                }\n                cellValue = this.parent.getValueFromArg(argArrs[k].split(this.parent.tic).join(''));\n                if (this.parent.getErrorStrings().indexOf(cellValue) > -1) {\n                    return cellValue;\n                }\n                if (cellValue.length > 0) {\n                    parseValue = parseFloat(cellValue);\n                    cellValue = !isNaN(parseValue) ? parseValue : 0;\n                    result = result + cellValue;\n                    length = length + 1;\n                }\n            }\n            if (length === 0) {\n                return this.parent.getErrorStrings()[CommonErrors.divzero];\n            }\n        }\n        return result / length;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNTIF = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var argArr = args;\n        if (isNullOrUndefined(args) || args[0] === '' || argArr.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellColl;\n        var result = 0;\n        var cellValue;\n        var stack = [];\n        var op = 'equal';\n        var condition = argArr[1].split(this.parent.tic).join('');\n        if (condition.startsWith('<=')) {\n            op = 'lessEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('>=')) {\n            op = 'greaterEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('<>')) {\n            op = 'notEq';\n            condition = condition.substring(2);\n        }\n        else if (condition.startsWith('<')) {\n            op = 'less';\n            condition = condition.substring(1);\n        }\n        else if (condition.startsWith('>')) {\n            op = 'greater';\n            condition = condition.substring(1);\n        }\n        else if (condition.startsWith('=')) {\n            op = 'equal';\n            condition = condition.substring(1);\n        }\n        if (argArr[0].indexOf(':') > -1 && this.parent.isCellReference(argArr[0])) {\n            cellColl = this.parent.getCellCollection(argArr[0].split(this.parent.tic).join(''));\n            for (var j = 0; j < cellColl.length; j++) {\n                cellValue = this.parent.getValueFromArg(cellColl[j]);\n                if (condition.indexOf('*') > -1 || condition.indexOf('?') > -1) {\n                    cellValue = this.parent.findWildCardValue(condition, cellValue);\n                }\n                stack.push(cellValue);\n                stack.push(condition);\n                if (this.parent.processLogical(stack, op) === this.parent.trueValue) {\n                    result++;\n                }\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUMIFS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var sum;\n        sum = this.parent.computeIfsFormulas(range, this.parent.falseValue);\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeTEXT = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var checkArgs;\n        var argsLength = args.length;\n        for (var i = 0; i < argsLength; i++) {\n            if (isNullOrUndefined(checkArgs)) {\n                checkArgs = args[i];\n            }\n            else {\n                checkArgs = checkArgs + ',' + args[i];\n            }\n        }\n        var splitIndex = checkArgs.indexOf(',');\n        var frtArg = checkArgs.slice(0, splitIndex);\n        var scndArg = checkArgs.slice(checkArgs.indexOf('\"') + 1, checkArgs.length);\n        var checkScndArg = scndArg.indexOf('\"');\n        if (splitIndex > -1 && checkScndArg !== scndArg.length - 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var s1 = frtArg;\n        var s2 = scndArg.slice(0, scndArg.length - 1);\n        var dTime = new Date(1900, 0, 1, 0, 0, 0);\n        var checkString = s1 + ',' + s2;\n        var intl = new Internationalization();\n        if (this.parent.getErrorStrings().indexOf(checkString) > -1) {\n            return checkString;\n        }\n        s1 = this.parent.getValueFromArg(s1);\n        s2 = s2.split(this.parent.tic).join('');\n        if (s2 === '') {\n            return '';\n        }\n        if (s1 === '' && (s2.length > 0 && (s2.toUpperCase().indexOf('M') > -1 || s2.toUpperCase().indexOf('D') > -1\n            || s2.toUpperCase().indexOf('Y') > -1 || s2.toUpperCase().indexOf('S') > -1 || s2.toUpperCase().indexOf('T') > -1)\n            || s2.toUpperCase().indexOf('H') > -1)) {\n            s1 = dTime.toString();\n        }\n        var d = this.parseDouble(s1);\n        if (isNaN(d) && this.parent.isDate(new Date(s1)) !== null) {\n            d = this.parent.toOADate(new Date(s1));\n        }\n        dTime = Date.parse(s1.split(this.parent.tic).join(''));\n        if (!isNaN(d) || !isNaN(dTime)) {\n            if (s2[0] === '[') {\n                return this.parent.tic + s1 + this.parent.tic;\n            }\n            if (s2.length > 0 && (s2.toUpperCase().indexOf('M') > -1 || s2.toUpperCase().indexOf('D') > -1\n                || s2.toUpperCase().indexOf('Y') > -1 || s2.toUpperCase().indexOf('S') > -1 || s2.toUpperCase().indexOf('T') > -1)\n                || s2.toUpperCase().indexOf('H') > -1) {\n                s2 = s2.split('Y').join('y').split('D').join('d').split('H').join('h');\n                s2 = s2.split('S').join('s').split('m').join('M').split('AM/PM').join('tt');\n                var formatChar = s2.split('');\n                var isH = false;\n                var isMFound = false;\n                var isFirstM = false;\n                var i = 0;\n                var mcount = 0;\n                var lastCharIndex = 0;\n                var totalCharforM = 0;\n                for (i = 0; i < formatChar.length;) {\n                    var c = formatChar[i];\n                    if (c === 's' && formatChar[lastCharIndex] === 'M') {\n                        formatChar[lastCharIndex] = 'm';\n                        if (formatChar[lastCharIndex - 1] === 'M') {\n                            formatChar[lastCharIndex - 1] = 'm';\n                        }\n                    }\n                    if (this.parent.isChar(c)) {\n                        lastCharIndex = i;\n                        if (c === 'M') {\n                            mcount++;\n                            totalCharforM++;\n                        }\n                    }\n                    else if (totalCharforM > 1) {\n                        totalCharforM++;\n                    }\n                    if (c === 'M' && isH) {\n                        formatChar[i] = 'm';\n                        isMFound = true;\n                        isFirstM = (mcount === 1);\n                    }\n                    if (c === 'h') {\n                        isH = true;\n                    }\n                    else if (this.parent.isChar(c) && c !== 'M' && c !== 'h' && !isMFound) {\n                        isH = false;\n                        isMFound = false;\n                    }\n                    i++;\n                }\n                s2 = String(formatChar);\n                s2 = s2.split(',').join('').split('\\n').join(' ');\n                var dt = this.parent.fromOADate(d);\n                if (d === 0) {\n                    dt = dTime;\n                }\n                var getSkeleton = getSkeletonVal(s2);\n                if (getSkeleton === '') {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                var dFormatter = intl.getDateFormat({ skeleton: getSkeleton, type: 'date' });\n                var formattedString = dFormatter(new Date(dt.toString()));\n                s1 = formattedString;\n            }\n            else {\n                s1 = intl.formatNumber(d, { format: s2 });\n            }\n        }\n        return s1;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeCOUNTIFS = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var sum;\n        sum = this.parent.computeIfsFormulas(args, this.parent.trueValue);\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeAVERAGEIFS = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var sum;\n        sum = this.parent.computeIfsFormulas(args, this.parent.falseValue, this.parent.trueValue);\n        return sum;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeMATCH = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var argArr = args;\n        if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 2 || argArr.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var cellColl;\n        var cellValue = [];\n        var lookupVal = argArr[0].split(this.parent.tic).join('');\n        argArr[2] = isNullOrUndefined(argArr[2]) ? '1' : argArr[2].split(this.parent.tic).join('');\n        if (argArr[2].split(this.parent.tic).join('') === this.parent.trueValue) {\n            argArr[2] = '1';\n        }\n        if (argArr[2].split(this.parent.tic).join('') === this.parent.falseValue) {\n            argArr[2] = '0';\n        }\n        var matchType = parseFloat(argArr[2]);\n        if (matchType !== -1 && matchType !== 0 && matchType !== 1) {\n            return this.parent.getErrorStrings()[CommonErrors.na];\n        }\n        var index = 0;\n        var indexVal = '';\n        if (argArr[1].indexOf(':') > -1 || this.parent.isCellReference(argArr[1])) {\n            cellColl = this.parent.getCellCollection(argArr[1].split(this.parent.tic).join(''));\n            for (var j = 0; j < cellColl.length; j++) {\n                cellValue[j] = this.parent.getValueFromArg(cellColl[j]).split(this.parent.tic).join('');\n            }\n            for (var i = 0; i < cellValue.length; i++) {\n                if (matchType === 1) {\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    else if (lookupVal > cellValue[i]) {\n                        if (!indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                        else if (cellValue[i] > indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                    }\n                }\n                else if (matchType === 0) {\n                    if (lookupVal.indexOf('*') > -1 || lookupVal.indexOf('?') > -1) {\n                        cellValue[i] = this.parent.findWildCardValue(lookupVal, cellValue[i]);\n                    }\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    if (this.parent.parseFloat(lookupVal) === this.parent.parseFloat(cellValue[i])) {\n                        return i + 1;\n                    }\n                }\n                else if (matchType === -1) {\n                    if (lookupVal === cellValue[i]) {\n                        return i + 1;\n                    }\n                    else if (lookupVal < cellValue[i]) {\n                        if (!indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                        else if (cellValue[i] < indexVal) {\n                            index = i + 1;\n                            indexVal = cellValue[i];\n                        }\n                    }\n                }\n            }\n        }\n        return index ? index : this.parent.getErrorStrings()[CommonErrors.na];\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeLOOKUP = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result = '';\n        if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 2 || argArr.length > 3) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        result = this.parent.computeLookup(argArr);\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeVLOOKUP = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result = '';\n        if (isNullOrUndefined(argArr) || (argArr.length === 1 && argArr[0] === '') || argArr.length < 3 || argArr.length > 4) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        result = this.parent.computeVLookup(argArr);\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSUBTOTAL = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result = '';\n        if (argArr.length < 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var formula = this.parent.parseFloat(this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join('')));\n        if (isNaN(formula)) {\n            this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        if ((formula < 1 || formula > 11) && (formula < 101 || formula > 111)) {\n            this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var cellRef = argArr.slice(1, argArr.length);\n        switch (formula) {\n            case 1:\n            case 101:\n                result = this.ComputeAVERAGE.apply(this, cellRef);\n                break;\n            case 2:\n            case 102:\n                result = this.ComputeCOUNT.apply(this, cellRef);\n                break;\n            case 3:\n            case 103:\n                result = this.ComputeCOUNTA.apply(this, cellRef);\n                break;\n            case 4:\n            case 104:\n                result = this.ComputeMAX.apply(this, cellRef);\n                break;\n            case 5:\n            case 105:\n                result = this.ComputeMIN.apply(this, cellRef);\n                break;\n            case 6:\n            case 106:\n                result = this.ComputePRODUCT.apply(this, cellRef);\n                break;\n            case 7:\n            case 107:\n                result = this.ComputeDAY.apply(this, cellRef);\n                break;\n            case 8:\n            case 108:\n                result = this.ComputeCONCAT.apply(this, cellRef);\n                break;\n            case 9:\n            case 109:\n                result = this.ComputeSUM.apply(this, cellRef);\n                break;\n            case 10:\n            case 110:\n                result = this.ComputeAVERAGEA.apply(this, cellRef);\n                break;\n            case 11:\n            case 111:\n                result = this.ComputeABS.apply(this, cellRef);\n                break;\n            default:\n                result = this.parent.getErrorStrings()[CommonErrors.value];\n                break;\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeRADIANS = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        var result;\n        if (argArr[0] === '' || argArr.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (argArr[0].indexOf(':') > -1 || argArr[0].split(this.parent.tic).join('') === '') {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        var val = argArr[0].split(this.parent.tic).join('');\n        argArr[0] = isNaN(this.parent.parseFloat(val)) ? argArr[0] : val;\n        var cellvalue = this.parent.getValueFromArg(argArr[0]);\n        var radVal = this.parent.parseFloat(cellvalue);\n        if (!isNaN(radVal)) {\n            result = Math.PI * (radVal) / 180;\n        }\n        else {\n            if (cellvalue.indexOf(this.parent.tic) > -1) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n            else {\n                return this.parent.getErrorStrings()[CommonErrors.name];\n            }\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeRANDBETWEEN = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argsLength = range.length;\n        var min;\n        var max;\n        var argVal;\n        if (argsLength !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (var i = 0; i < argsLength; i++) {\n            if (range[i] === '') {\n                return this.parent.getErrorStrings()[CommonErrors.na];\n            }\n            if (range[i].indexOf(this.parent.tic) > -1) {\n                if (isNaN(parseFloat(range[i].split(this.parent.tic).join('')))) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n                else {\n                    range[i] = range[i].split(this.parent.tic).join('');\n                }\n            }\n            argVal = parseFloat(this.parent.getValueFromArg(range[i]));\n            if (!this.parent.isCellReference(range[i])) {\n                if (isNaN(argVal)) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                i === 0 ? min = argVal : max = argVal;\n            }\n            else {\n                argVal = this.parent.getValueFromArg(range[i]) === '' ? 0 : argVal;\n                i === 0 ? min = argVal : max = argVal;\n                if (min === 0 && max === 0) {\n                    return '0';\n                }\n                if (isNaN(argVal)) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n            }\n        }\n        if (max < min) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (min === 0) {\n            return Math.floor(Math.random() * (max - (min - 1))) + min;\n        }\n        else {\n            return max - min === 1 ? Math.round((Math.random() * (max - min)) + min) : Math.floor(Math.random() * (max - (min - 1))) + min;\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeSLOPE = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (argArr.length !== 2 || argArr[0] === '') {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var yPoints;\n        var xPoints;\n        var xPointsRange = this.parent.getCellCollection(argArr[1].split(this.parent.tic).join(''));\n        var yPointsRange = this.parent.getCellCollection(argArr[0].split(this.parent.tic).join(''));\n        if (yPointsRange.length !== xPointsRange.length) {\n            return this.parent.getErrorStrings()[CommonErrors.na];\n        }\n        yPoints = this.getDataCollection(yPointsRange);\n        xPoints = this.getDataCollection(xPointsRange);\n        if (xPoints.indexOf('#NAME?') > -1 || yPoints.indexOf('#NAME?') > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        var sumXY = 0;\n        var sumX2 = 0;\n        var sumX = 0;\n        var sumY = 0;\n        for (var i = 0, len = xPoints.length; i < len; ++i) {\n            if (Number(xPoints[i]).toString() !== 'NaN' && Number(yPoints[i]).toString() !== 'NaN') {\n                sumXY += Number(xPoints[i]) * Number(yPoints[i]);\n                sumX += Number(xPoints[i]);\n                sumY += Number(yPoints[i]);\n                sumX2 += Number(xPoints[i]) * Number(xPoints[i]);\n            }\n        }\n        if ((sumXY - sumX * sumY) === 0 || (sumX2 - sumX * sumX) === 0) {\n            this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        var result = ((sumXY - sumX * sumY / xPoints.length) / (sumX2 - sumX * sumX / xPoints.length)).toString();\n        if (result === 'NaN') {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeINTERCEPT = function () {\n        var range = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            range[_i] = arguments[_i];\n        }\n        var argArr = range;\n        if (argArr[0] === '' || argArr.length !== 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        var xValues;\n        var yValues;\n        var yValuesRange = this.parent.getCellCollection(argArr[0].split(this.parent.tic).join(''));\n        var xValuesRange = this.parent.getCellCollection(argArr[1].split(this.parent.tic).join(''));\n        if (yValuesRange.length !== xValuesRange.length) {\n            return this.parent.getErrorStrings()[CommonErrors.na];\n        }\n        xValues = this.getDataCollection(xValuesRange);\n        yValues = this.getDataCollection(yValuesRange);\n        if (xValues.indexOf('#NAME?') > -1 || yValues.indexOf('#NAME?') > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        var sumX = 0;\n        var sumY = 0;\n        for (var i = 0, len = xValues.length; i < len; ++i) {\n            sumX += Number(xValues[i]);\n            sumY += Number(yValues[i]);\n        }\n        sumX = sumX / xValues.length;\n        sumY = sumY / xValues.length;\n        var sumXY = 0;\n        var sumX2 = 0;\n        var diff;\n        for (var i = 0, len = xValues.length; i < len; ++i) {\n            diff = Number(xValues[i]) - sumX;\n            sumXY += diff * (Number(yValues[i]) - sumY);\n            sumX2 += diff * diff;\n        }\n        var result = (sumY - sumXY / sumX2 * sumX).toString();\n        if ((sumY - sumXY) === 0 || (sumX2 * sumX) === 0) {\n            this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        if (result === 'NaN') {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        return result;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeLN = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var cellvalue = '';\n        var logVal;\n        var orgValue;\n        if (logValue.length === 0 || logValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (this.parent.isCellReference(argArr[0])) {\n            cellvalue = this.parent.getValueFromArg(argArr[0]);\n            logVal = this.parent.parseFloat(cellvalue);\n            if (logVal <= 0 || cellvalue === '') {\n                return this.parent.getErrorStrings()[CommonErrors.num];\n            }\n            if (isNaN(logVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        else {\n            orgValue = this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''));\n            logVal = this.parent.parseFloat(orgValue);\n            if (logVal <= 0 || logVal.toString() === '') {\n                return this.parent.getErrorStrings()[CommonErrors.num];\n            }\n            if (isNaN(logVal)) {\n                return this.parent.getErrorStrings()[CommonErrors.value];\n            }\n        }\n        return Math.log(logVal);\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeISNUMBER = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var logVal;\n        var orgValue;\n        if (logValue.length === 0 || logValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgValue = (this.parent.isCellReference(argArr[0])) ? this.parent.getValueFromArg(argArr[0]) :\n            this.parent.getValueFromArg(argArr[0].split(this.parent.tic).join(''));\n        if (orgValue.toString() === '') {\n            return false;\n        }\n        logVal = this.parent.parseFloat(orgValue);\n        return !isNaN(logVal) ? true : false;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeROUND = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgValue;\n        var x = 0;\n        var digits = 0;\n        var round;\n        var numStr;\n        var digStr;\n        var mult;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (logValue.length === 1) {\n            orgValue = (argArr[0].split(this.parent.tic).join('') === 'TRUE')\n                ? '1'\n                : (argArr[0].split(this.parent.tic).join('') === 'FALSE')\n                    ? '0'\n                    : argArr[0];\n            return Math.round(this.parent.parseFloat(orgValue)).toString();\n        }\n        numStr = this.parent.getValueFromArg(argArr[0]);\n        digStr = (argArr[1].split(this.parent.tic).join('')) === '' ? '0' :\n            this.parent.getValueFromArg(argArr[1].split(this.parent.tic).join(''));\n        numStr = (numStr.split(this.parent.tic).join('') === 'TRUE')\n            ? '1'\n            : (numStr.split(this.parent.tic).join('') === 'FALSE')\n                ? '0' : numStr;\n        digStr = (digStr.split(this.parent.tic).join('') === 'TRUE') ? '1'\n            : (digStr.split(this.parent.tic).join('') === 'FALSE')\n                ? '0' : digStr;\n        if (numStr !== '' && digStr !== '') {\n            x = this.parent.parseFloat(numStr);\n            digits = this.parent.parseFloat(digStr);\n            if (!isNaN(digits) && !isNaN(x) && digits > 0) {\n                round = x.toFixed(digits);\n            }\n            else {\n                mult = Math.pow(10, -digits);\n                round = Math.round(x / mult) * mult;\n            }\n        }\n        return round.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputePOWER = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var power;\n        var orgNumValue;\n        var orgPowValue;\n        var logNumValue;\n        var logPowValue;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgPowValue = this.parent.getValueFromArg(argArr[1]);\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        orgPowValue = (orgPowValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgPowValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgPowValue;\n        logNumValue = this.parent.parseFloat(orgNumValue);\n        logPowValue = this.parent.parseFloat(orgPowValue);\n        if (!isNaN(logNumValue) && !isNaN(logPowValue)) {\n            if (logNumValue === 0 && logPowValue < 0) {\n                return this.parent.getErrorStrings()[CommonErrors.divzero];\n            }\n            if (logNumValue === 0 && logPowValue === 0) {\n                return this.parent.getErrorStrings()[CommonErrors.num];\n            }\n            power = Math.pow(logNumValue, logPowValue);\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n        return power.toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeLOG = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgNumValue;\n        var orgBaseValue;\n        var logNumValue;\n        var logBaseValue;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgBaseValue = (logValue.length === 2) ? this.parent.getValueFromArg(argArr[1]) : '10';\n        if ((orgNumValue === '' || orgNumValue === null) || (orgBaseValue === '' || orgBaseValue === null)) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        orgBaseValue = (orgBaseValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgBaseValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgBaseValue;\n        logNumValue = this.parent.parseFloat(orgNumValue);\n        logBaseValue = this.parent.parseFloat(orgBaseValue);\n        if (logNumValue <= 0 || logBaseValue <= 0) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (logBaseValue === 1) {\n            return this.parent.getErrorStrings()[CommonErrors.divzero];\n        }\n        if (!isNaN(logNumValue) && !isNaN(logBaseValue)) {\n            return ((Math.log(logNumValue) / Math.LN10) / (Math.log(logBaseValue) / Math.LN10)).toString();\n        }\n        else {\n            return this.parent.getErrorStrings()[CommonErrors.value];\n        }\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeTRUNC = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgNumValue;\n        var orgDigitValue = 0;\n        var logNumValue;\n        var logDigitValue;\n        var normalizer;\n        if (logValue.length === 0 || logValue.length > 2) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        if (logValue.length === 2) {\n            orgDigitValue = this.parent.getValueFromArg(argArr[1]);\n            orgDigitValue = (orgDigitValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                (orgDigitValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgDigitValue;\n            orgDigitValue = this.parent.parseFloat(orgDigitValue);\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        logNumValue = this.parent.parseFloat(orgNumValue.split(this.parent.tic).join(''));\n        if (isNaN(logNumValue) || isNaN(orgDigitValue)) {\n            return (argArr[0] === this.parent.tic || this.parent.isCellReference(argArr[0]) || (argArr[1] === this.parent.tic\n                || this.parent.isCellReference(argArr[1]))) ? this.parent.getErrorStrings()[CommonErrors.value]\n                : this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        normalizer = Math.pow(10, orgDigitValue);\n        logDigitValue = (logNumValue < 0) ? -1 : 1;\n        return (logDigitValue * Math.floor(normalizer * Math.abs(logNumValue)) / normalizer).toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeEXP = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var orgNumValue;\n        var logNumValue;\n        if (logValue.length === 0 || logValue.length > 1) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        orgNumValue = this.parent.getValueFromArg(argArr[0]);\n        orgNumValue = (orgNumValue.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n            (orgNumValue.split(this.parent.tic).join('') === 'FALSE') ? '0' : orgNumValue;\n        if (orgNumValue === '') {\n            orgNumValue = '0';\n        }\n        logNumValue = this.parent.parseFloat(orgNumValue);\n        if (logNumValue > 709) {\n            return this.parent.getErrorStrings()[CommonErrors.num];\n        }\n        if (isNaN(logNumValue)) {\n            return (argArr[0] === this.parent.tic || this.parent.isCellReference(argArr[0])) ?\n                this.parent.getErrorStrings()[CommonErrors.value]\n                : this.parent.getErrorStrings()[CommonErrors.name];\n        }\n        return Math.exp(logNumValue).toString();\n    };\n    /** @hidden */\n    BasicFormulas.prototype.ComputeGEOMEAN = function () {\n        var logValue = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            logValue[_i] = arguments[_i];\n        }\n        var argArr = logValue;\n        var sum = 1;\n        var count = 0;\n        var cellVal = 0;\n        var dev;\n        var r;\n        var s;\n        var cell;\n        if (logValue.length === 0) {\n            return this.parent.formulaErrorStrings[FormulasErrorsStrings.wrong_number_arguments];\n        }\n        for (r = 0; r < argArr.length; r++) {\n            if (argArr[r].indexOf(':') > -1) {\n                if (argArr[0] === this.parent.tic) {\n                    return this.parent.getErrorStrings()[CommonErrors.value];\n                }\n                cell = this.parent.getCellCollection(argArr[r].split(this.parent.tic).join(''));\n                for (s = 0; s < cell.length; s++) {\n                    cellVal = this.parent.getValueFromArg(cell[s]);\n                    cellVal = (cellVal.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                        (cellVal.split(this.parent.tic).join('') === 'FALSE') ? '0' : cellVal;\n                    dev = this.parent.parseFloat(cellVal);\n                    if (dev <= 0) {\n                        return this.parent.getErrorStrings()[CommonErrors.num];\n                    }\n                    else if (!isNaN(dev)) {\n                        count++;\n                        sum = sum * dev;\n                    }\n                }\n            }\n            else {\n                cellVal = this.parent.getValueFromArg(argArr[r]);\n                if (cellVal.length > 0) {\n                    cellVal = (cellVal.split(this.parent.tic).join('') === 'TRUE') ? '1' :\n                        (cellVal.split(this.parent.tic).join('') === 'FALSE') ? '0' : cellVal;\n                    if (!this.parent.isCellReference(argArr[r])) {\n                        if (isNaN(this.parent.parseFloat(cellVal))) {\n                            return this.parent.getErrorStrings()[CommonErrors.name];\n                        }\n                    }\n                    dev = this.parent.parseFloat(cellVal);\n                    if (dev <= 0) {\n                        return this.parent.getErrorStrings()[CommonErrors.num];\n                    }\n                    else if (!isNaN(dev)) {\n                        count++;\n                        sum = sum * dev;\n                    }\n                }\n            }\n        }\n        if (count > 0) {\n            sum = Math.pow(sum, 1 / count);\n        }\n        return sum.toString();\n    };\n    BasicFormulas.prototype.getDataCollection = function (cells) {\n        var cellsData = [];\n        for (var i = 0, len = cells.length; i < len; i++) {\n            cellsData.push(this.parent.getValueFromArg(cells[i]));\n        }\n        return cellsData;\n    };\n    /** @hidden */\n    BasicFormulas.prototype.parseDouble = function (value) {\n        var val = this.parent.parseFloat(value.toString());\n        return !isNaN(val) ? val : NaN;\n    };\n    ;\n    BasicFormulas.prototype.getModuleName = function () {\n        return 'basic-formulas';\n    };\n    return BasicFormulas;\n}());\nexport { BasicFormulas };\n","import { FormulaError } from './index';\nimport { CommonErrors, FormulasErrorsStrings } from '../common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nvar Parser = /** @class */ (function () {\n    function Parser(parent) {\n        this.emptyStr = '';\n        this.storedStringText = this.emptyStr;\n        this.sheetToken = '!';\n        /** @hidden */\n        this.tokenAdd = 'a';\n        /** @hidden */\n        this.tokenSubtract = 's';\n        /** @hidden */\n        this.tokenMultiply = 'm';\n        /** @hidden */\n        this.tokenDivide = 'd';\n        /** @hidden */\n        this.tokenLess = 'l';\n        this.charEm = 'r';\n        this.charEp = 'x';\n        /** @hidden */\n        this.tokenGreater = 'g';\n        /** @hidden */\n        this.tokenEqual = 'e';\n        /** @hidden */\n        this.tokenLessEq = 'k';\n        /** @hidden */\n        this.tokenGreaterEq = 'j';\n        /** @hidden */\n        this.tokenNotEqual = 'o';\n        /** @hidden */\n        this.tokenAnd = 'c';\n        this.tokenEm = 'v';\n        this.tokenEp = 't';\n        /** @hidden */\n        this.tokenOr = String.fromCharCode(126);\n        this.charAnd = 'i';\n        this.charLess = '<';\n        this.charGreater = '>';\n        this.charEqual = '=';\n        this.charLessEq = 'f';\n        this.charGreaterEq = 'h';\n        this.charNoEqual = 'z';\n        this.stringGreaterEq = '>=';\n        this.stringLessEq = '<=';\n        this.stringNoEqual = '<>';\n        this.stringAnd = '&';\n        this.stringOr = '^';\n        this.charOr = 'w';\n        this.charAdd = '+';\n        this.charSubtract = '-';\n        this.charMultiply = '*';\n        this.charDivide = '/';\n        this.fixedReference = '$';\n        this.spaceString = ' ';\n        this.ignoreBracet = false;\n        /** @hidden */\n        this.isError = false;\n        /** @hidden */\n        this.isFormulaParsed = false;\n        this.findNamedRange = false;\n        this.stringsColl = new Map();\n        this.tokens = [\n            this.tokenAdd, this.tokenSubtract, this.tokenMultiply, this.tokenDivide, this.tokenLess,\n            this.tokenGreater, this.tokenEqual, this.tokenLessEq, this.tokenGreaterEq, this.tokenNotEqual, this.tokenAnd, this.tokenOr\n        ];\n        this.charNOTop = String.fromCharCode(167);\n        this.specialSym = ['~', '@', '#', '?'];\n        this.isFailureTriggered = false;\n        this.parent = parent;\n    }\n    /** @hidden */\n    Parser.prototype.parse = function (text, fkey) {\n        if (this.parent.isTextEmpty(text)) {\n            return text;\n        }\n        if (this.parent.getFormulaCharacter() !== String.fromCharCode(0) && this.parent.getFormulaCharacter() === text[0]) {\n            text = text.substring(1);\n        }\n        if (this.parent.namedRanges.size > 0 || this.parent.storedData.size > 0) {\n            text = this.checkForNamedRangeAndKeyValue(text);\n            this.findNamedRange = false;\n        }\n        text = text.split('-+').join('-');\n        text = text.split('--').join('+');\n        text = text.split('+-').join('-');\n        text = text.split('-' + '(' + '-').join('(');\n        var formulaString = this.storeStrings(text);\n        text = this.storedStringText;\n        var i = 0;\n        if (isNullOrUndefined(formulaString)) {\n            text = text.split(' ').join('');\n        }\n        text = text.split('=>').join('>=');\n        text = text.split('=<').join('<=');\n        if (text[text.length - 1] !== this.parent.arithMarker || this.indexOfAny(text, this.tokens) !== (text.length - 2)) {\n            text = text.toUpperCase();\n        }\n        if (text.indexOf(this.sheetToken) > -1) {\n            var family = this.parent.getSheetFamilyItem(this.parent.grid);\n            if (family.sheetNameToParentObject != null && family.sheetNameToParentObject.size > 0) {\n                if (text[0] !== this.sheetToken.toString()) {\n                    text = this.parent.setTokensForSheets(text);\n                }\n                var sheetToken = this.parent.getSheetToken(text.split(this.parent.tic).join(this.emptyStr));\n                var scopedRange = this.checkScopedRange(text.split('\"').join(this.emptyStr).split(this.sheetToken).join(''));\n                if (isNullOrUndefined(sheetToken) && sheetToken !== '' && this.parent.namedRanges.size > 0 && scopedRange !== '') {\n                    text = scopedRange;\n                }\n            }\n        }\n        text = this.markLibraryFormulas(text);\n        try {\n            text = this.formulaAutoCorrection(text);\n        }\n        catch (ex) {\n            var args = {\n                message: ex.message, exception: ex, isForceCalculable: ex.formulaCorrection,\n                computeForceCalculate: false\n            };\n            if (!args.isForceCalculable) {\n                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression];\n            }\n            if (!this.isFailureTriggered) {\n                this.parent.trigger('onFailure', args);\n                this.isFailureTriggered = true;\n            }\n            if (args.isForceCalculable && args.computeForceCalculate) {\n                text = this.formulaAutoCorrection(text, args);\n                this.parent.storedData.get(fkey).formulaText = '=' + text;\n            }\n            else {\n                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression];\n            }\n        }\n        if (!this.ignoreBracet) {\n            i = text.indexOf(')');\n            while (i > -1) {\n                var k = text.substring(0, i).lastIndexOf('(');\n                if (k === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n                }\n                if (k === i - 1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.empty_expression]);\n                }\n                var s = this.emptyStr;\n                if (this.ignoreBracet) {\n                    s = this.parent.substring(text, k, i - k + 1);\n                }\n                else {\n                    s = this.parent.substring(text, k + 1, i - k - 1);\n                }\n                try {\n                    text = text.substring(0, k) + this.parseSimple(s) + text.substring(i + 1);\n                }\n                catch (ex) {\n                    var args = this.exceptionArgs(ex);\n                    if (!this.isFailureTriggered) {\n                        this.parent.trigger('onFailure', args);\n                        this.isFailureTriggered = true;\n                    }\n                    var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n                    return (this.parent.getErrorLine(ex) ? '' : '#' + this.parent.getErrorLine(ex) + ': ') + errorMessage;\n                }\n                i = text.indexOf(')');\n            }\n        }\n        if (!this.ignoreBracet && text.indexOf('(') > -1) {\n            throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n        }\n        text = this.parseSimple(text);\n        if (formulaString !== null && formulaString.size > 0) {\n            text = this.setStrings(text, formulaString);\n        }\n        return text;\n    };\n    /* tslint:disable-next-line:no-any */\n    Parser.prototype.exceptionArgs = function (ex) {\n        return {\n            message: ex.message, exception: ex, isForceCalculable: ex.formulaCorrection,\n            computeForceCalculate: false\n        };\n    };\n    Parser.prototype.formulaAutoCorrection = function (formula, args) {\n        var arithemeticArr = ['*', '+', '-', '/', '^', '&'];\n        var logicalSym = ['>', '=', '<'];\n        var i = 0;\n        var form = '';\n        var op = '';\n        var firstOp = '';\n        var secondprevOp = '';\n        var secondnextOp = '';\n        var firstDigit = '';\n        var secondDigit = '';\n        var countDigit = 0;\n        if (this.parent.formulaErrorStrings.indexOf(formula) > -1) {\n            return formula;\n        }\n        else {\n            if (this.indexOfAny(formula, this.specialSym) > -1) {\n                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression], false);\n            }\n            while (i < formula.length) {\n                formula = formula.split('-*').join('-').split('/*').join('/').split('*/').join('*').split('-/').join('-').\n                    split('*+').join('*').split('+*').join('+');\n                if (formula.indexOf('*-') > -1 || formula.indexOf('/-') > -1) {\n                    formula = '-' + formula.split('*-').join('*').split('/-').join('/');\n                }\n                if ((this.parent.isDigit(formula[i]) && ((formula.length > i + 1)\n                    && (this.indexOfAny(formula[i + 1], arithemeticArr) > -1)) && ((formula.length > i + 2)\n                    && (!isNullOrUndefined(formula[i + 2]) && this.indexOfAny(formula[i + 2], arithemeticArr) > -1)))) {\n                    if (isNullOrUndefined(args)) {\n                        throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.invalid_expression], true);\n                    }\n                    if (args.computeForceCalculate) {\n                        if (this.parent.isDigit(formula[i])) {\n                            if (countDigit < 1) {\n                                firstDigit = formula[i];\n                                firstOp = formula[i + 1];\n                                if (isNullOrUndefined(firstOp)) {\n                                    firstOp = this.emptyStr;\n                                }\n                                firstOp = firstOp === '&' ? '' : firstOp;\n                                countDigit = countDigit + 1;\n                                form = form + firstDigit + firstOp;\n                            }\n                            else if (countDigit < 2) {\n                                secondDigit = formula[i];\n                                secondprevOp = formula[i - 1];\n                                secondnextOp = formula[i + 1];\n                                countDigit = 0;\n                                if (secondprevOp === '-') {\n                                    secondnextOp = isNullOrUndefined(secondnextOp) ? this.emptyStr : secondnextOp;\n                                    secondnextOp = secondnextOp === '&' ? '' : secondnextOp;\n                                    form = form + secondprevOp + secondDigit + secondnextOp;\n                                }\n                                else {\n                                    secondnextOp = isNullOrUndefined(secondnextOp) ? this.emptyStr : secondnextOp;\n                                    form = form + secondDigit + secondnextOp;\n                                }\n                            }\n                            i = i + 2;\n                        }\n                        else {\n                            form = (formula[i] === '-') ? form + formula[i] : form;\n                            i = i + 1;\n                        }\n                    }\n                    else {\n                        throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                    }\n                    /* tslint:disable-next-line */\n                }\n                else if ((this.parent.isDigit(formula[i]) || formula[i] === this.parent.rightBracket || this.parent.storedData.has(formula[i].toUpperCase())) && (isNullOrUndefined(formula[i + 1]) || this.indexOfAny(formula[i + 1], arithemeticArr)) > -1) {\n                    op = isNullOrUndefined(formula[i + 1]) ? this.emptyStr : formula[i + 1];\n                    op = op === '&' ? '' : op;\n                    form = formula[i - 1] === '-' ? form + formula[i - 1] + formula[i] + op : form + formula[i] + op;\n                    i = i + 2;\n                    /* tslint:disable-next-line */\n                }\n                else if (this.indexOfAny(formula[i], logicalSym) > -1 && !isNullOrUndefined(formula[i - 1]) && !isNullOrUndefined(formula[i + 1])) {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else if (formula[i] === 'q') {\n                    while (formula[i] !== this.parent.leftBracket) {\n                        form = form + formula[i];\n                        i = i + 1;\n                    }\n                    /* tslint:disable-next-line */\n                }\n                else if (formula[i] === this.parent.leftBracket || formula[i] === this.parent.rightBracket || formula[i] === '{' || formula[i] === '}' || formula[i] === '(' || formula[i] === ')') {\n                    form = form + formula[i];\n                    i = i + 1;\n                    /* tslint:disable-next-line */\n                }\n                else if (this.parent.isUpperChar(formula[i]) || formula[i].indexOf(':') > -1 || formula[i] === this.parent.getParseArgumentSeparator() || ((formula[i] === '%') && (this.parent.isDigit(formula[i - 1])))) {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else if (formula[i] === this.parent.tic || formula[i] === ' ' || formula[i] === '.' || formula[i] === this.sheetToken ||\n                    formula[i] === '$') {\n                    form = form + formula[i];\n                    i = i + 1;\n                }\n                else {\n                    if (this.parent.isDigit(formula[i])) {\n                        form = formula[i - 1] === '-' ? form + formula[i - 1] + formula[i] : form + formula[i];\n                    }\n                    if (formula[i] === '-' || formula[i] === '+') {\n                        form = form + formula[i];\n                        form = form.split('++').join('+').split('+-').join('-').split('-+').join('-');\n                    }\n                    if (formula[i] === '/' || formula[i] === '*') {\n                        form = form + formula[i];\n                    }\n                    i = i + 1;\n                }\n            }\n        }\n        form = form === this.emptyStr ? formula : form;\n        if (this.indexOfAny(form[form.length - 1], arithemeticArr) > -1) {\n            form = form.substring(0, form.length - 1);\n        }\n        form = form.split('--').join('-').split('-+').join('-').split('+-').join('-');\n        return form;\n    };\n    Parser.prototype.checkScopedRange = function (text) {\n        var _this = this;\n        var scopedRange = this.emptyStr;\n        var b = 'NaN';\n        var id = this.parent.getSheetID(this.parent.grid);\n        var sheet = this.parent.getSheetFamilyItem(this.parent.grid);\n        if (text[0] === this.sheetToken.toString()) {\n            var i = text.indexOf(this.sheetToken, 1);\n            var v = parseInt(text.substr(1, i - 1), 10);\n            if (i > 1 && !this.parent.isNaN(v)) {\n                text = text.substring(i + 1);\n                id = v;\n            }\n        }\n        var token = '!' + id.toString() + '!';\n        if (sheet === null || sheet.sheetNameToToken == null) {\n            return b;\n        }\n        sheet.sheetNameToToken.forEach(function (value, key) {\n            if (sheet.sheetNameToToken.get(key).toString() === token) {\n                var s_1 = _this.emptyStr;\n                _this.parent.namedRanges.forEach(function (value, key) {\n                    /* tslint:disable-next-line:no-any */\n                    if (!isNullOrUndefined(_this.parent.parentObject)) {\n                        /* tslint:disable-next-line:no-any */\n                        s_1 = (_this.parent.parentObject.getActiveSheet().name + _this.sheetToken + text).toUpperCase();\n                    }\n                    else {\n                        s_1 = sheet.sheetNameToToken.get(key).toUpperCase();\n                    }\n                    if (_this.parent.getNamedRanges().has(s_1)) {\n                        scopedRange = (_this.parent.getNamedRanges().get(s_1)).toUpperCase();\n                        b = scopedRange;\n                    }\n                });\n            }\n        });\n        return b;\n    };\n    Parser.prototype.storeStrings = function (tempString) {\n        var i = 0;\n        var j = 0;\n        var id = 0;\n        var key = '';\n        var storedString = null;\n        var condition;\n        var ticLoc = tempString.indexOf(this.parent.tic);\n        if (ticLoc > -1) {\n            i = tempString.indexOf(this.parent.tic);\n            while (i > -1 && tempString.length > 0) {\n                if (storedString === null) {\n                    storedString = this.stringsColl;\n                }\n                j = i + 1 < tempString.length ? tempString.indexOf(this.parent.tic, i + 1) : -1;\n                if (j === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_tics]);\n                }\n                condition = this.parent.substring(tempString, i, j - i + 1);\n                key = this.parent.tic + this.spaceString + id.toString() + this.parent.tic;\n                storedString = storedString.set(key, condition);\n                tempString = tempString.substring(0, i) + key + tempString.substring(j + 1);\n                i = i + key.length;\n                if (i < tempString.length) {\n                    i = tempString.indexOf(this.parent.tic, i);\n                }\n                id++;\n            }\n        }\n        this.storedStringText = tempString;\n        return storedString;\n    };\n    Parser.prototype.setStrings = function (text, formulaString) {\n        for (var i = 0; i < formulaString.size; i++) {\n            formulaString.forEach(function (value, key) {\n                text = text.split(key).join(value);\n            });\n        }\n        return text;\n    };\n    /** @hidden */\n    Parser.prototype.parseSimple = function (formulaText) {\n        var needToContinue = true;\n        var text = formulaText;\n        if (text.length > 0 && text[0] === '+') {\n            text = text.substring(1);\n        }\n        if (text === '#DIV/0!') {\n            return '#DIV/0!';\n        }\n        if (text === '#NAME?') {\n            return '#NAME?';\n        }\n        if (text === '') {\n            return text;\n        }\n        if (this.parent.formulaErrorStrings.indexOf(text) > -1) {\n            return text;\n        }\n        text = text.split(this.stringLessEq).join(this.charLessEq);\n        text = text.split(this.stringGreaterEq).join(this.charGreaterEq);\n        text = text.split(this.stringNoEqual).join(this.charNoEqual);\n        text = text.split(this.stringAnd).join(this.charAnd);\n        text = text.split(this.stringOr).join(this.charOr);\n        text = text.split(this.fixedReference).join(this.emptyStr);\n        needToContinue = true;\n        var expTokenArray = [this.tokenEp, this.tokenEm];\n        var mulTokenArray = [this.tokenMultiply, this.tokenDivide];\n        var addTokenArray = [this.tokenAdd, this.tokenSubtract];\n        var mulCharArray = [this.charMultiply, this.charDivide];\n        var addCharArray = [this.charAdd, this.charSubtract];\n        var compareTokenArray = [this.tokenLess, this.tokenGreater, this.tokenEqual, this.tokenLessEq,\n            this.tokenGreaterEq, this.tokenNotEqual];\n        var compareCharArray = [this.charLess, this.charGreater, this.charEqual, this.charLessEq,\n            this.charGreaterEq, this.charNoEqual];\n        var expCharArray = [this.charEp, this.charEm];\n        var andTokenArray = [this.tokenAnd];\n        var andCharArray = [this.charAnd];\n        var orCharArray = [this.charOr];\n        var orTokenArray = [this.tokenOr];\n        text = this.parseSimpleOperators(text, expTokenArray, expCharArray);\n        text = this.parseSimpleOperators(text, orTokenArray, orCharArray);\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, mulTokenArray, mulCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, addTokenArray, addCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, compareTokenArray, compareCharArray);\n        }\n        if (needToContinue) {\n            text = this.parseSimpleOperators(text, andTokenArray, andCharArray);\n        }\n        return text;\n    };\n    /** @hidden */\n    // tslint:disable-next-line:max-func-body-length\n    Parser.prototype.parseSimpleOperators = function (formulaText, markers, operators) {\n        if (this.parent.getErrorStrings().indexOf(formulaText) > -1) {\n            return formulaText;\n        }\n        var text = formulaText;\n        var i = 0;\n        var op = '';\n        for (var c = 0; c < operators.length; c++) {\n            op = op + operators[c];\n        }\n        /* tslint:disable */\n        text = text.split(\"---\").join(\"-\").split(\"--\").join(\"+\").split(this.parent.getParseArgumentSeparator() + \"-\").join(this.parent.getParseArgumentSeparator() + \"u\").split(this.parent.leftBracket + \"-\").join(this.parent.leftBracket + \"u\").split(\"=-\").join(\"=u\");\n        text = text.split(',+').join(',').split(this.parent.leftBracket + '+').join(this.parent.leftBracket).split('=+').join('=').split('>+').join('>').split('<+').join('<').split('/+').join('/').split('*+').join('*').split('++').join('+').split(\"*-\").join(\"*u\").toString();\n        ;\n        /* tslint:enable */\n        if (text.length > 0 && text[0] === '-') {\n            text = text.substring(1).split('-').join(this.tokenOr);\n            text = '0-' + text;\n            text = this.parseSimpleOperators(text, [this.tokenSubtract], [this.charSubtract]);\n            text = text.split(this.tokenOr).join('-');\n        }\n        else if (text.length > 0 && text[0] === '+') {\n            text = text.substring(1);\n        }\n        else if (text.length > 0 && text[text.length - 1] === '+') {\n            text = text.substring(0, text.length - 1);\n        }\n        try {\n            if (this.indexOfAny(text, operators) > -1) {\n                i = this.indexOfAny(text, operators);\n                while (i > -1) {\n                    var left = '';\n                    var right = '';\n                    var leftIndex = 0;\n                    var rightIndex = 0;\n                    var isNotOperator = text[i] === this.charNOTop;\n                    var j = 0;\n                    if (!isNotOperator) {\n                        j = i - 1;\n                        if (text[j] === this.parent.arithMarker) {\n                            var k = this.findLeftMarker(text.substring(0, j - 1));\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, k + 1, j - k - 1);\n                            leftIndex = k + 1;\n                        }\n                        else if (text[j] === this.parent.rightBracket) {\n                            var bracketCount = 0;\n                            var k = j - 1;\n                            while (k > 0 && (text[k] !== 'q' || bracketCount !== 0)) {\n                                if (text[k] === 'q') {\n                                    bracketCount--;\n                                }\n                                else if (text[k] === this.parent.rightBracket) {\n                                    bracketCount++;\n                                }\n                                k--;\n                            }\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, k, j - k + 1);\n                            leftIndex = k;\n                        }\n                        else if (text[j] === this.parent.tic[0]) {\n                            var l = text.substring(0, j - 1).lastIndexOf(this.parent.tic);\n                            if (l < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            left = this.parent.substring(text, l, j - l + 1);\n                            leftIndex = l;\n                        }\n                        else {\n                            var period = false;\n                            while (j > -1 && (this.parent.isDigit(text[j]) ||\n                                (!period && text[j] === this.parent.getParseDecimalSeparator()))) {\n                                if (text[j] === this.parent.getParseDecimalSeparator()) {\n                                    period = true;\n                                }\n                                j = j - 1;\n                            }\n                            if (j > -1 && period && text[j] === this.parent.getParseDecimalSeparator()) {\n                                /* tslint:disable-next-line */\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.number_contains_2_decimal_points]);\n                            }\n                            j = j + 1;\n                            if (j === 0 || (j > 0 && !this.parent.isUpperChar(text[j - 1]))) {\n                                left = 'n' + this.parent.substring(text, j, i - j);\n                                leftIndex = j;\n                            }\n                            else {\n                                j = j - 1;\n                                while (j > -1 && (this.parent.isUpperChar(text[j]) || this.parent.isDigit(text[j]))) {\n                                    j = j - 1;\n                                }\n                                if (j > -1 && text[j] === this.sheetToken) {\n                                    j = j - 1;\n                                    while (j > -1 && text[j] !== this.sheetToken) {\n                                        j = j - 1;\n                                    }\n                                    if (j > -1 && text[j] === this.sheetToken) {\n                                        j = j - 1;\n                                    }\n                                }\n                                if (j > -1 && text[j] === ':') {\n                                    //// handle range operands\n                                    j = j - 1;\n                                    while (j > -1 && this.parent.isDigit(text[j])) {\n                                        j = j - 1;\n                                    }\n                                    while (j > -1 && this.parent.isUpperChar(text[j])) {\n                                        j = j - 1;\n                                    }\n                                    if (j > -1 && text[j] === this.sheetToken) {\n                                        j--;\n                                        while (j > -1 && text[j] !== this.sheetToken) {\n                                            j--;\n                                        }\n                                        if (j > -1 && text[j] === this.sheetToken) {\n                                            j--;\n                                        }\n                                    }\n                                    j = j + 1;\n                                    left = this.parent.substring(text, j, i - j);\n                                    left = this.parent.getCellFrom(left);\n                                }\n                                else {\n                                    j = j + 1;\n                                    left = this.parent.substring(text, j, i - j);\n                                }\n                                this.parent.updateDependentCell(left);\n                                leftIndex = j;\n                            }\n                            if ((this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(left.toUpperCase())) ||\n                                (this.parent.storedData.has(left.toUpperCase()))) {\n                                left = 'n' + this.checkForNamedRangeAndKeyValue(left);\n                            }\n                        }\n                    }\n                    else {\n                        leftIndex = i;\n                    }\n                    if (i === text.length - 1) {\n                        /* tslint:disable-next-line */\n                        throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.expression_cannot_end_with_an_operator]);\n                    }\n                    else {\n                        j = i + 1;\n                        var uFound = text[j] === 'u'; // for 3*-2\n                        if (uFound) {\n                            j = j + 1;\n                        }\n                        if (text[j] === this.parent.tic[0]) {\n                            var k = text.substring(j + 1).indexOf(this.parent.tic);\n                            if (k < 0) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse];\n                            }\n                            right = this.parent.substring(text, j, k + 2);\n                            rightIndex = k + j + 2;\n                        }\n                        else if (text[j] === this.parent.arithMarker) {\n                            var k = this.findRightMarker(text.substring(j + 1));\n                            if (k < 0) {\n                                throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse]);\n                            }\n                            right = this.parent.substring(text, j + 1, k);\n                            rightIndex = k + j + 2;\n                        }\n                        else if (text[j] === 'q') {\n                            var bracketCount = 0;\n                            var k = j + 1;\n                            while (k < text.length && (text[k] !== this.parent.rightBracket || bracketCount !== 0)) {\n                                if (text[k] === this.parent.rightBracket) {\n                                    bracketCount++;\n                                }\n                                else if (text[k] === 'q') {\n                                    bracketCount--;\n                                }\n                                k++;\n                            }\n                            if (k === text.length) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.cannot_parse];\n                            }\n                            right = this.parent.substring(text, j, k - j + 1);\n                            if (uFound) {\n                                right = 'u' + right;\n                            }\n                            rightIndex = k + 1;\n                            /* tslint:disable-next-line */\n                        }\n                        else if (this.parent.isDigit(text[j]) || text[j] === this.parent.getParseDecimalSeparator()) {\n                            var period = (text[j] === this.parent.getParseDecimalSeparator());\n                            j = j + 1;\n                            /* tslint:disable-next-line */\n                            while (j < text.length && (this.parent.isDigit(text[j]) || (!period && text[j] === this.parent.getParseDecimalSeparator()))) {\n                                if (text[j] === this.parent.getParseDecimalSeparator()) {\n                                    period = true;\n                                }\n                                j = j + 1;\n                            }\n                            if (j < text.length && text[j] === '%') {\n                                j += 1;\n                            }\n                            if (period && j < text.length && text[j] === this.parent.getParseDecimalSeparator()) {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.number_contains_2_decimal_points];\n                            }\n                            right = 'n' + this.parent.substring(text, i + 1, j - i - 1);\n                            rightIndex = j;\n                        }\n                        else if (this.parent.isUpperChar(text[j]) || text[j] === this.sheetToken || text[j] === 'u') {\n                            if (text[j] === this.sheetToken) {\n                                j = j + 1;\n                                while (j < text.length && text[j] !== this.sheetToken) {\n                                    j = j + 1;\n                                }\n                            }\n                            j = j + 1;\n                            var jTemp = 0;\n                            var inbracket = false;\n                            while (j < text.length && (this.parent.isUpperChar(text[j]) || text[j] === '_'\n                                || text[j] === '.' || text[j] === '[' || text[j] === ']' || text[j] === '#' || text[j] === ' '\n                                || text[j] === '%' || text[j] === this.parent.getParseDecimalSeparator() && inbracket)) {\n                                if (j !== text.length - 1 && text[j] === '[' && text[j + 1] === '[') {\n                                    inbracket = true;\n                                }\n                                if (j !== text.length - 1 && text[j] === ']' && text[j + 1] === ']') {\n                                    inbracket = false;\n                                }\n                                j++;\n                                jTemp++;\n                            }\n                            var noCellReference = (j === text.length) || !this.parent.isDigit(text[j]);\n                            if (jTemp > 1) {\n                                while (j < text.length && (this.parent.isUpperChar(text[j]) || this.parent.isDigit(text[j])\n                                    || text[j] === ' ' || text[j] === '_')) {\n                                    j++;\n                                }\n                                noCellReference = true;\n                            }\n                            while (j < text.length && this.parent.isDigit(text[j])) {\n                                j = j + 1;\n                            }\n                            if (j < text.length && text[j] === ':') {\n                                j = j + 1;\n                                if (j < text.length && text[j] === this.sheetToken) {\n                                    j++;\n                                    while (j < text.length && text[j] !== this.sheetToken) {\n                                        j = j + 1;\n                                    }\n                                    if (j < text.length && text[j] === this.sheetToken) {\n                                        j++;\n                                    }\n                                }\n                                while (j < text.length && this.parent.isUpperChar(text[j])) {\n                                    j = j + 1;\n                                }\n                                while (j < text.length && this.parent.isDigit(text[j])) {\n                                    j = j + 1;\n                                }\n                                j = j - 1;\n                                right = this.parent.substring(text, i + 1, j - i);\n                                right = this.parent.getCellFrom(right);\n                            }\n                            else {\n                                j = j - 1;\n                                right = this.parent.substring(text, i + 1, j - i);\n                                uFound = text[j] === 'u';\n                                if (uFound) {\n                                    right = 'u' + right;\n                                }\n                            }\n                            if (noCellReference && right.startsWith(this.sheetToken)) {\n                                noCellReference = !this.parent.isCellReference(right);\n                            }\n                            if (!noCellReference) {\n                                this.parent.updateDependentCell(right);\n                            }\n                            if ((this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(right.toUpperCase()))\n                                || (this.parent.storedData.has(right.toUpperCase()))) {\n                                right = 'n' + this.checkForNamedRangeAndKeyValue(right);\n                            }\n                            rightIndex = j + 1;\n                        }\n                    }\n                    var p = op.indexOf(text[i]);\n                    var s = this.parent.arithMarker + left + right + markers[p] + this.parent.arithMarker;\n                    if (leftIndex > 0) {\n                        s = text.substring(0, leftIndex) + s;\n                    }\n                    if (rightIndex < text.length) {\n                        s = s + text.substring(rightIndex);\n                    }\n                    s = s.split(this.parent.arithMarker2).join(this.parent.arithMarker.toString());\n                    text = s;\n                    i = this.indexOfAny(text, operators);\n                }\n            }\n            else {\n                if (text.length > 0 && (this.parent.isUpperChar(text[0]) || text[0] === this.sheetToken)) {\n                    var isCharacter = true;\n                    var checkLetter = true;\n                    var oneTokenFound = false;\n                    var textLen = text.length;\n                    for (var k = 0; k < textLen; ++k) {\n                        if (text[k] === this.sheetToken) {\n                            if (k > 0 && !oneTokenFound) {\n                                throw this.parent.getErrorStrings()[CommonErrors.ref];\n                            }\n                            oneTokenFound = true;\n                            k++;\n                            while (k < textLen && this.parent.isDigit(text[k])) {\n                                k++;\n                            }\n                            if (k === textLen || text[k] !== this.sheetToken) {\n                                isCharacter = false;\n                                break;\n                            }\n                        }\n                        else {\n                            if (!checkLetter && this.parent.isChar(text[k])) {\n                                isCharacter = false;\n                                break;\n                            }\n                            if (this.parent.isChar(text[k]) || this.parent.isDigit(text[k]) || text[k] === this.sheetToken) {\n                                checkLetter = this.parent.isUpperChar(text[k]);\n                            }\n                            else {\n                                isCharacter = false;\n                                break;\n                            }\n                        }\n                    }\n                    if (isCharacter) {\n                        this.parent.updateDependentCell(text);\n                    }\n                }\n            }\n            return text;\n        }\n        catch (ex) {\n            return ex;\n        }\n    };\n    /** @hidden */\n    Parser.prototype.indexOfAny = function (text, operators) {\n        for (var i = 0; i < text.length; i++) {\n            if (operators.indexOf(text[i]) > -1) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    /** @hidden */\n    Parser.prototype.findLeftMarker = function (text) {\n        var ret = -1;\n        if (text.indexOf(this.parent.arithMarker) > -1) {\n            var bracketLevel = 0;\n            for (var i = text.length - 1; i >= 0; --i) {\n                if (text[i] === this.parent.rightBracket) {\n                    bracketLevel--;\n                }\n                else if (text[i] === this.parent.leftBracket) {\n                    bracketLevel++;\n                }\n                else if (text[i] === this.parent.arithMarker && bracketLevel === 0) {\n                    ret = i;\n                    break;\n                }\n            }\n        }\n        return ret;\n    };\n    /** @hidden */\n    Parser.prototype.findRightMarker = function (text) {\n        var ret = -1;\n        if (text.indexOf(this.parent.arithMarker) > -1) {\n            var bracketLevel = 0;\n            for (var j = 0; j < text.length; ++j) {\n                if (text[j] === this.parent.rightBracket) {\n                    bracketLevel--;\n                }\n                else if (text[j] === this.parent.leftBracket) {\n                    bracketLevel++;\n                }\n                else if (text[j] === this.parent.arithMarker && bracketLevel === 0) {\n                    ret = j;\n                    break;\n                }\n            }\n        }\n        return ret;\n    };\n    /** @hidden */\n    Parser.prototype.parseFormula = function (formula, fKey) {\n        if (formula.length > 0 && formula[0] === this.parent.getFormulaCharacter()) {\n            formula = formula.substring(1);\n        }\n        if (formula.indexOf('#REF!') > -1) {\n            return this.parent.getErrorStrings()[CommonErrors.ref];\n        }\n        if (formula.length > 0 && formula[0] === '+') {\n            formula = formula.substring(1);\n        }\n        try {\n            this.isFailureTriggered = false;\n            this.isError = false;\n            formula = this.parse(formula.trim(), fKey);\n            this.isFormulaParsed = true;\n        }\n        catch (ex) {\n            var args = this.exceptionArgs(ex);\n            if (!this.isFailureTriggered) {\n                this.parent.trigger('onFailure', args);\n                this.isFailureTriggered = true;\n            }\n            var errorMessage = (typeof args.exception === 'string') ? args.exception : args.message;\n            formula = (isNullOrUndefined(this.parent.getErrorLine(ex)) ? '' : '#' + this.parent.getErrorLine(ex) + ': ') + errorMessage;\n            this.isError = true;\n        }\n        return formula;\n    };\n    /** @hidden */\n    Parser.prototype.markLibraryFormulas = function (formula) {\n        var bracCount = 0;\n        var rightParens = formula.indexOf(')');\n        if (rightParens === -1) {\n            formula = this.markNamedRanges(formula);\n        }\n        else {\n            while (rightParens > -1) {\n                var parenCount = 0;\n                var leftParens = rightParens - 1;\n                while (leftParens > -1 && (formula[leftParens] !== '(' || parenCount !== 0)) {\n                    if (formula[leftParens] === ')') {\n                        parenCount++;\n                    }\n                    else if (formula[leftParens] === ')') {\n                        parenCount--;\n                    }\n                    leftParens--;\n                }\n                if (leftParens === -1) {\n                    throw new FormulaError(this.parent.formulaErrorStrings[FormulasErrorsStrings.mismatched_parentheses]);\n                }\n                var i = leftParens - 1;\n                while (i > -1 && (this.parent.isChar(formula[i]))) {\n                    i--;\n                }\n                var len = leftParens - i - 1;\n                var libFormula = this.parent.substring(formula, i + 1, len);\n                if (len > 0 && !isNullOrUndefined(this.parent.getFunction(libFormula))) {\n                    if (this.parent.substring(formula, i + 1, len) === 'AREAS') {\n                        this.ignoreBracet = true;\n                    }\n                    else {\n                        this.ignoreBracet = false;\n                    }\n                    var substr = this.parent.substring(formula, leftParens, rightParens - leftParens + 1);\n                    try {\n                        var args = void 0;\n                        substr = substr.split('(').join('').split(')').join('');\n                        substr = '(' + this.formulaAutoCorrection(substr, args) + ')';\n                    }\n                    catch (ex) {\n                        var args = {\n                            message: ex.message, exception: ex,\n                            isForceCalculable: ex.formulaCorrection, computeForceCalculate: false\n                        };\n                        if (!args.isForceCalculable) {\n                            throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                        }\n                        if (!this.isFailureTriggered) {\n                            this.parent.trigger('onFailure', args);\n                            this.isFailureTriggered = true;\n                            bracCount = bracCount + 1;\n                        }\n                        args.computeForceCalculate = bracCount > 0 ? true : args.computeForceCalculate;\n                        if (args.isForceCalculable) {\n                            if (args.computeForceCalculate) {\n                                substr = substr.split('(').join('').split(')').join('');\n                                substr = '(' + this.formulaAutoCorrection(substr, args) + ')';\n                            }\n                            else {\n                                throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                            }\n                        }\n                        else {\n                            throw this.parent.formulaErrorStrings[FormulasErrorsStrings.improper_formula];\n                        }\n                    }\n                    substr = this.markNamedRanges(substr);\n                    substr = this.swapInnerParens(substr);\n                    substr = this.addParensToArgs(substr);\n                    var id = substr.lastIndexOf(this.parent.getParseArgumentSeparator());\n                    var k = 0;\n                    if (id === -1) {\n                        if (substr.length > 2 && substr[0] === '(' && substr[substr.length - 1] === ')') {\n                            if (substr[1] !== '{' && substr[1] !== '(') {\n                                substr = substr.substring(0, substr.length - 1) + '}' + substr.substring(substr.length - 1);\n                                substr = substr[0] + '{' + substr.substring(1);\n                            }\n                        }\n                    }\n                    formula = formula.substring(0, i + 1) + 'q' + this.parent.substring(formula, i + 1, len) +\n                        (substr.split('(').join(this.parent.leftBracket))\n                            .split(')').join(this.parent.rightBracket) + formula.substring(rightParens + 1);\n                }\n                else if (len > 0) {\n                    return this.parent.getErrorStrings()[CommonErrors.name];\n                }\n                else {\n                    var s = this.emptyStr;\n                    if (leftParens > 0) {\n                        s = formula.substring(0, leftParens);\n                    }\n                    s = s + '{' + this.parent.substring(formula, leftParens + 1, rightParens - leftParens - 1) + '}';\n                    if (rightParens < formula.length) {\n                        s = s + formula.substring(rightParens + 1);\n                    }\n                    s = this.markNamedRanges(s);\n                    formula = s;\n                }\n                rightParens = formula.indexOf(')');\n            }\n        }\n        formula = (formula.split('{').join('(')).split('}').join(')');\n        return formula;\n    };\n    /** @hidden */\n    Parser.prototype.swapInnerParens = function (fSubstr) {\n        if (fSubstr.length > 2) {\n            /* tslint:disable-next-line */\n            fSubstr = fSubstr[0] + fSubstr.substr(1, fSubstr.length - 2).split('(').join('{').split(')').join('}') + fSubstr[fSubstr.length - 1];\n        }\n        return fSubstr;\n    };\n    /** @hidden */\n    Parser.prototype.addParensToArgs = function (fSubstr) {\n        if (fSubstr.length === 0) {\n            return this.emptyStr;\n        }\n        var rightSides = [];\n        rightSides.push(this.parent.getParseArgumentSeparator());\n        rightSides.push(this.parent.rightBracket);\n        var id = fSubstr.lastIndexOf(this.parent.getParseArgumentSeparator());\n        var k = 0;\n        if (id === -1) {\n            if (fSubstr.length > 2 && fSubstr[0] === '(' && fSubstr[fSubstr.length - 1] === ')') {\n                if (fSubstr[1] !== '{' && fSubstr[1] !== '(') {\n                    fSubstr = fSubstr.substring(0, fSubstr.length - 1) + '}' + fSubstr.substring(fSubstr.length - 1);\n                    fSubstr = fSubstr[0] + '{' + fSubstr.substring(1);\n                }\n                else {\n                    var marker = ['+', '-', '*', '/'];\n                    id = this.lastIndexOfAny(fSubstr, marker);\n                    if (k === 0 && fSubstr[fSubstr.length - 1] === ')') {\n                        k = fSubstr.length - 1;\n                    }\n                    if (k > 0) {\n                        if (fSubstr[id + 1] !== '{' && fSubstr[id - 1] === '}') {\n                            fSubstr = fSubstr.substr(0, k) + '}' + fSubstr.substr(k);\n                            fSubstr = fSubstr.substr(0, id + 1) + '{' + fSubstr.substr(id + 1);\n                        }\n                    }\n                }\n            }\n        }\n        else {\n            var oneTimeOnly = true;\n            while (id > -1) {\n                var j = this.indexOfAny(fSubstr.substring(id + 1, fSubstr.length), rightSides);\n                if (j >= 0) {\n                    j = id + j + 1;\n                }\n                else if (j === -1 && fSubstr[fSubstr.length - 1] === ')') {\n                    j = fSubstr.length - 1;\n                }\n                if (j > 0) {\n                    if (fSubstr[id + 1] !== '{' && fSubstr[j - 1] !== '}') {\n                        fSubstr = fSubstr.substr(0, j) + '}' + fSubstr.substr(j);\n                        fSubstr = fSubstr.substr(0, id + 1) + '{' + fSubstr.substr(id + 1);\n                    }\n                }\n                id = fSubstr.substr(0, id).lastIndexOf(this.parent.getParseArgumentSeparator());\n                if (oneTimeOnly && id === -1 && fSubstr[0] === '(') {\n                    id = 0;\n                    oneTimeOnly = false;\n                }\n            }\n        }\n        fSubstr = fSubstr.split('{}').join(this.emptyStr);\n        return fSubstr;\n    };\n    /** @hidden */\n    Parser.prototype.lastIndexOfAny = function (text, operators) {\n        for (var i = text.length - 1; i > -1; i--) {\n            if (operators.indexOf(text[i]) > -1) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    /** @hidden */\n    Parser.prototype.markNamedRanges = function (formula) {\n        var markers = [')', this.parent.getParseArgumentSeparator(), '}', '+', '-', '*', '/', '<', '>', '=', '&'];\n        var i = (formula.length > 0 && (formula[0] === '(' || formula[0] === '{')) ? 1 : 0;\n        if (formula.indexOf('#N/A') > -1) {\n            formula = formula.split('#N/A').join('#N~A');\n        }\n        if (formula.indexOf('#DIV/0!') > -1) {\n            formula = formula.split('#DIV/0!').join('#DIV~0!');\n        }\n        var end = this.indexOfAny(formula.substring(i), markers);\n        while (end > -1 && end + i < formula.length) {\n            var scopedRange = this.emptyStr;\n            var s = null;\n            if ((this.parent.substring(formula, i, end)).indexOf('[') > -1) {\n                s = this.getTableRange(this.parent.substring(formula, i, end));\n            }\n            else if (this.parent.storedData.has(this.parent.substring(formula, i, end))) {\n                s = this.checkForNamedRangeAndKeyValue(this.parent.substring(formula, i, end));\n            }\n            else if (this.parent.namedRanges.has(this.parent.substring(formula, i, end))) {\n                s = this.checkForNamedRangeAndKeyValue(this.parent.substring(formula, i, end));\n            }\n            if (isNullOrUndefined(s)) {\n                scopedRange = this.checkScopedRange(this.parent.substring(formula, i, end));\n                if (scopedRange !== 'NaN') {\n                    this.findNamedRange = true;\n                    s = scopedRange;\n                }\n                else if (this.parent.substring(formula, i, end).startsWith(this.sheetToken.toString())) {\n                    var formulaStr = this.parent.substring(formula, i, end).indexOf(this.sheetToken, 1);\n                    // if (formulaStr > 1) {\n                    //     s = this.parent.namedRanges.get(this.parent.substring\n                    // (formula.substring(i), formulaStr + 1, end - formulaStr - 1));\n                    // }\n                }\n                if (!isNullOrUndefined(s) && this.findNamedRange) {\n                    if (s.indexOf(this.fixedReference) > -1) {\n                        s = s.split(this.fixedReference).join(this.emptyStr);\n                    }\n                }\n            }\n            if (!isNullOrUndefined(s)) {\n                s = s.toUpperCase();\n                s = this.parent.setTokensForSheets(s);\n                s = this.markLibraryFormulas(s);\n            }\n            if (!isNullOrUndefined(s) && s !== this.emptyStr) {\n                formula = formula.substring(0, i) + s + formula.substring(i + end);\n                i += s.length + 1;\n            }\n            else {\n                i += end + 1;\n                while (i < formula.length && !this.parent.isUpperChar(formula[i]) && formula[i] !== this.sheetToken) {\n                    i++;\n                }\n            }\n            end = i;\n            if (i < formula.length - 1 && formula[i] === '{') {\n                i = i + 1;\n            }\n            end = this.indexOfAny(formula.substring(i), markers);\n            while (end === 0 && i < formula.length - 1) {\n                i++;\n                end = this.indexOfAny(formula.substring(i), markers);\n            }\n            if ((end === -1 || formula.substring(i).indexOf('[') > -1) && i < formula.length) {\n                if (formula.substring(i).indexOf('[') > -1) {\n                    s = this.getTableRange(formula.substring(i));\n                }\n                else {\n                    if (this.parent.storedData.has(formula.substring(i))) {\n                        s = this.parent.storedData.size > 0 ? this.checkForNamedRangeAndKeyValue(formula.substring(i)) : s;\n                    }\n                    else {\n                        s = this.parent.namedRanges.size > 0 ? this.checkForNamedRangeAndKeyValue(formula.substring(i)) : s;\n                    }\n                }\n                if (isNullOrUndefined(s)) {\n                    scopedRange = this.checkScopedRange(formula.substring(i));\n                    if (scopedRange !== 'NaN') {\n                        s = scopedRange;\n                    }\n                }\n                if (!isNullOrUndefined(s) && s !== this.emptyStr) {\n                    s = s.toUpperCase();\n                    s = this.parent.setTokensForSheets(s);\n                    s = this.markLibraryFormulas(s);\n                    if (s != null) {\n                        var val = formula.substring(i);\n                        if (val[val.length - 1] === ')') {\n                            formula = formula.substring(0, i) + s + ')';\n                        }\n                        else {\n                            formula = formula.substring(0, i) + s;\n                        }\n                        i += s.toString().length + 1;\n                    }\n                }\n                end = (i < formula.length) ? this.indexOfAny(formula.substring(i), markers) : -1;\n            }\n        }\n        if (formula.indexOf('#N~A') > -1) {\n            formula = formula.split('#N~A').join('#N/A');\n        }\n        if (formula.indexOf('#DIV~0!') > -1) {\n            formula = formula.split('#DIV~0!').join('#DIV/0!');\n        }\n        return formula;\n    };\n    /** @hidden */\n    Parser.prototype.checkForNamedRangeAndKeyValue = function (text) {\n        var scopedRange = this.emptyStr;\n        if (text.indexOf('[') > -1) {\n            var namerangeValue = this.getTableRange(text);\n            if (!isNullOrUndefined(namerangeValue)) {\n                this.findNamedRange = true;\n                text = namerangeValue;\n            }\n        }\n        scopedRange = this.checkScopedRange(text);\n        if (scopedRange !== 'NaN') {\n            this.findNamedRange = true;\n            text = scopedRange;\n        }\n        else {\n            if (text.indexOf(this.sheetToken) > -1) {\n                var sheet = this.parent.getSheetFamilyItem(this.parent.grid);\n                /* tslint:disable-next-line */\n                var value = text.split('\"').join(this.emptyStr);\n                value = value.substr(0, value.indexOf(this.sheetToken));\n                if (sheet.sheetNameToToken.has(value.toUpperCase())) {\n                    /* tslint:disable */\n                    var sheetIndex = parseInt(sheet.sheetNameToToken.get(value.toUpperCase()).split(this.sheetToken).join(this.emptyStr));\n                    // if (!ej.isNullOrUndefined(this.parentObject) && this.parentObject.pluginName == \"ejSpreadsheet\") {\n                    //     var name = text.replace(value, this.parentObject.model.sheets[(sheetIndex + 1)].sheetInfo.text.toUpperCase()).split(\"'\").join(this._string_empty);\n                    //     if (this.getNamedRanges().length > 0 && this.getNamedRanges().contains(name.toUpperCase())) {\n                    //         text = name;\n                    //     }\n                    // }\n                    /* tslint-enable */\n                }\n            }\n            if (this.parent.storedData.size > 0 && this.parent.storedData.has(text)) {\n                text = 'A' + this.parent.colIndex(text);\n            }\n            if (this.parent.namedRanges.size > 0 && this.parent.namedRanges.has(text.toUpperCase())) {\n                /* tslint:disable-next-line:no-any */\n                if (!isNullOrUndefined(this.parent.parentObject)) {\n                    text = this.parse(this.parent.namedRanges.get(text.toUpperCase()));\n                }\n                else {\n                    text = this.parse(this.parent.namedRanges.get(text.toUpperCase()));\n                    text = this.parent.setTokensForSheets(text);\n                    if (text.indexOf(this.fixedReference) > -1) {\n                        text.split(this.fixedReference).join(this.emptyStr);\n                    }\n                    this.findNamedRange = true;\n                }\n            }\n            if (this.findNamedRange) {\n                if (text[0] !== '!' && text[0] !== 'q' && text[0] !== 'bq') {\n                    text = this.parent.setTokensForSheets(text);\n                    if (text.indexOf(this.fixedReference) > -1) {\n                        text = text.split(this.fixedReference).join(this.emptyStr);\n                    }\n                }\n            }\n        }\n        return text;\n    };\n    Parser.prototype.getTableRange = function (text) {\n        text = text.replace(' ', this.emptyStr).toUpperCase();\n        var name = text.replace(']', this.emptyStr).replace('#DATA', this.emptyStr);\n        var tableName = name;\n        if (name.indexOf(this.parent.getParseArgumentSeparator()) > -1) {\n            tableName = name.substring(0, name.indexOf(this.parent.getParseArgumentSeparator())).replace('[', this.emptyStr);\n            name = name.replace('[', this.emptyStr).replace(this.parent.getParseArgumentSeparator(), '_');\n        }\n        var range = this.emptyStr;\n        return name.toUpperCase();\n    };\n    Parser.prototype.findNextEndIndex = function (formula, loc) {\n        var count = 0;\n        var l = loc;\n        var found = false;\n        while (!found && loc < formula.length) {\n            if (formula[l] === '[') {\n                count++;\n            }\n            else if (formula[l] === ']') {\n                count--;\n                if (count === 0) {\n                    found = true;\n                }\n            }\n            loc++;\n        }\n        loc = loc - l;\n        return loc;\n    };\n    ;\n    return Parser;\n}());\nexport { Parser };\n","/* tslint:disable-next-line:max-line-length */\nimport { getSheetName, getSheetIndex, getSheet, getSheetIndexByName, getCell } from '../base/index';\nimport { workbookFormulaOperation, getColumnHeaderText, aggregateComputation, getRangeIndexes } from '../common/index';\nimport { Calculate, ValueChangedArgs, CommonErrors, getAlphalabel } from '../../calculate/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getCellAddress, getFormattedCellObject, isNumber, checkIsFormula } from '../common/index';\nimport { workbookEditOperation, getRangeAddress, getRangeFromAddress, isCellReference } from '../common/index';\n/**\n * @hidden\n * The `WorkbookFormula` module is used to handle the formula operation in Workbook.\n */\nvar WorkbookFormula = /** @class */ (function () {\n    /**\n     * Constructor for formula module in Workbook.\n     * @private\n     */\n    function WorkbookFormula(workbook) {\n        this.uniqueOBracket = String.fromCharCode(129);\n        this.uniqueCBracket = String.fromCharCode(130);\n        this.uniqueCSeparator = String.fromCharCode(131);\n        this.uniqueCOperator = String.fromCharCode(132);\n        this.uniquePOperator = String.fromCharCode(133);\n        this.uniqueSOperator = String.fromCharCode(134);\n        this.uniqueMOperator = String.fromCharCode(135);\n        this.uniqueDOperator = String.fromCharCode(136);\n        this.uniqueModOperator = String.fromCharCode(137);\n        this.uniqueConcateOperator = String.fromCharCode(138);\n        this.uniqueEqualOperator = String.fromCharCode(139);\n        this.uniqueExpOperator = String.fromCharCode(140);\n        this.uniqueGTOperator = String.fromCharCode(141);\n        this.uniqueLTOperator = String.fromCharCode(142);\n        this.sheetInfo = [];\n        this.parent = workbook;\n        this.init();\n    }\n    WorkbookFormula.prototype.init = function () {\n        this.addEventListener();\n        this.initCalculate();\n        this.registerSheet();\n    };\n    /**\n     * To destroy the formula module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookFormula.prototype.destroy = function () {\n        this.removeEventListener();\n        this.calculateInstance.dispose();\n        this.calculateInstance = null;\n        this.parent = null;\n    };\n    WorkbookFormula.prototype.addEventListener = function () {\n        this.parent.on(workbookFormulaOperation, this.performFormulaOperation, this);\n        this.parent.on(aggregateComputation, this.aggregateComputation, this);\n    };\n    WorkbookFormula.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookFormulaOperation, this.performFormulaOperation);\n            this.parent.off(aggregateComputation, this.aggregateComputation);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookFormula.prototype.getModuleName = function () {\n        return 'workbookFormula';\n    };\n    WorkbookFormula.prototype.initCalculate = function () {\n        this.calculateInstance = new Calculate(this.parent);\n        this.calcID = this.calculateInstance.createSheetFamilyID();\n        this.calculateInstance.setTreatEmptyStringAsZero(true);\n        this.calculateInstance.grid = this.parent.getActiveSheet().id.toString();\n    };\n    WorkbookFormula.prototype.performFormulaOperation = function (args) {\n        var action = args.action;\n        var formulas = this.calculateInstance.getLibraryFormulas();\n        var formulaInfo = (Array.from(formulas.values()));\n        switch (action) {\n            case 'getLibraryFormulas':\n                args.formulaCollection = Array.from(formulas.keys());\n                break;\n            case 'getFormulaCategory':\n                var collection = ['All'];\n                for (var i = 1; i < Array.from(formulas.values()).length; i++) {\n                    if (collection.indexOf(formulaInfo[i].category) < 0) {\n                        collection.push(formulaInfo[i].category);\n                    }\n                }\n                args.categoryCollection = collection;\n                break;\n            case 'dropDownSelectFormulas':\n                for (var i = 0; i < Array.from(formulas.values()).length; i++) {\n                    if (args.selectCategory === formulaInfo[i].category) {\n                        args.formulaCollection[i] = Array.from(formulas.keys())[i];\n                    }\n                }\n                break;\n            case 'getFormulaDescription':\n                for (var i = 0; i < Array.from(formulas.values()).length; i++) {\n                    if (args.selectedList === Array.from(formulas.keys())[i]) {\n                        args.description = formulaInfo[i].description;\n                    }\n                }\n                break;\n            case 'registerSheet':\n                this.registerSheet(args.sheetIndex, args.sheetCount);\n                if (args.isImport) {\n                    this.updateSheetInfo();\n                }\n                break;\n            case 'unRegisterSheet':\n                this.unRegisterSheet(args.sheetIndex, args.sheetCount);\n                break;\n            case 'refreshCalculate':\n                args.value = this.autoCorrectFormula(args.value, args.rowIndex, args.colIndex);\n                this.refreshCalculate(args.rowIndex, args.colIndex, args.value, args.isFormula, args.sheetIndex);\n                args.value = args.value ? args.value.toString().split('-*').join('-').split('/*').join('/').split('*/').\n                    join('*').split('-/').join('-').split('*+').join('*').split('+*').join('+') : args.value;\n                break;\n            case 'getArgumentSeparator':\n                args.argumentSeparator = this.calculateInstance.getParseArgumentSeparator();\n                break;\n            case 'addDefinedName':\n                args.isAdded = this.addDefinedName(args.definedName);\n                break;\n            case 'removeDefinedName':\n                args.isRemoved = this.removeDefinedName(args.definedName, args.scope);\n                break;\n            case 'initiateDefinedNames':\n                this.initiateDefinedNames();\n                break;\n            case 'renameUpdation':\n                this.renameUpdation(args.value, args.sheetId);\n                break;\n            case 'addSheet':\n                this.sheetInfo.push({ visibleName: args.visibleName, sheet: args.sheetName, index: args.index });\n                break;\n            case 'getSheetInfo':\n                args.sheetInfo = this.sheetInfo;\n                break;\n            case 'deleteSheetTab':\n                var length_1 = this.sheetInfo.length;\n                for (var i = 0; i < length_1; i++) {\n                    if (this.sheetInfo[i].index === args.index) {\n                        args.sheetName = this.sheetInfo[i].sheet;\n                        this.sheetInfo.splice(i, 1);\n                        break;\n                    }\n                }\n                this.calculateInstance.unregisterGridAsSheet((args.index - 1).toString(), args.index);\n                this.calculateInstance.tokenCount = this.calculateInstance.tokenCount - 1;\n                this.sheetDeletion(args.sheetName, args.index, args.index);\n                break;\n            case 'getReferenceError':\n                args.refError = this.referenceError();\n                break;\n            case 'getAlpha':\n                args.col = getAlphalabel(args.col);\n                break;\n            case 'addCustomFunction':\n                this.addCustomFunction(args.functionHandler, args.functionName);\n                break;\n            case 'computeExpression':\n                args.calcValue = this.calculateInstance.computeExpression(args.formula);\n                break;\n            case 'registerGridInCalc':\n                this.calculateInstance.grid = args.sheetID;\n                break;\n            case 'refreshInsDelFormula':\n                this.refreshInsDelFormula(args.insertArgs);\n                break;\n            case 'refreshNamedRange':\n                this.refreshNamedRange(args.insertArgs, action);\n                break;\n        }\n    };\n    WorkbookFormula.prototype.referenceError = function () {\n        return this.calculateInstance.getErrorStrings()[CommonErrors.ref];\n    };\n    WorkbookFormula.prototype.getSheetInfo = function () {\n        return this.sheetInfo;\n    };\n    WorkbookFormula.prototype.addCustomFunction = function (functionHandler, functionName) {\n        this.calculateInstance.defineFunction(functionName, functionHandler);\n    };\n    WorkbookFormula.prototype.updateSheetInfo = function () {\n        var _this = this;\n        this.sheetInfo = [];\n        this.parent.sheets.forEach(function (sheet, idx) {\n            _this.sheetInfo.push({ visibleName: sheet.name, sheet: 'Sheet' + sheet.id, index: idx });\n        });\n    };\n    WorkbookFormula.prototype.sheetDeletion = function (delSheetName, sheetId, index) {\n        var dependentCell = this.calculateInstance.getDependentCells();\n        var cellRef = [];\n        var fInfo = null;\n        var formulaVal = '';\n        var rowId;\n        var colId;\n        dependentCell.forEach(function (value, key) {\n            cellRef.push(key);\n        });\n        this.removeSheetTokenIndex(formulaVal, index);\n        for (var i = 0; i < cellRef.length; i++) {\n            var dependentCellRef = this.calculateInstance.getDependentCells().get(cellRef[i]);\n            for (var j = 0; j < dependentCellRef.length; j++) {\n                fInfo = this.calculateInstance.getFormulaInfoTable().get(dependentCellRef[j]);\n                sheetId = parseInt(dependentCellRef[j].split('!')[1], 10) + 1;\n                if (!isNullOrUndefined(fInfo) && sheetId > -1) {\n                    formulaVal = fInfo.formulaText;\n                    if (formulaVal.toUpperCase().indexOf(delSheetName.toUpperCase()) > -1) {\n                        formulaVal = formulaVal.toUpperCase().split(delSheetName.toUpperCase() +\n                            this.calculateInstance.sheetToken).join(this.referenceError());\n                        rowId = this.calculateInstance.rowIndex(dependentCellRef[j]);\n                        colId = this.calculateInstance.colIndex(dependentCellRef[j]);\n                        this.updateDataContainer([rowId - 1, colId - 1], { value: formulaVal, sheetId: sheetId, visible: false });\n                        this.calculateInstance.refresh(fInfo.getParsedFormula());\n                    }\n                }\n                if (delSheetName.split('Sheet')[1] === cellRef[i].split('!')[1]) {\n                    this.calculateInstance.getFormulaInfoTable().delete(cellRef[i]);\n                    this.calculateInstance.clearFormulaDependentCells(cellRef[i]);\n                }\n            }\n        }\n    };\n    WorkbookFormula.prototype.removeSheetTokenIndex = function (value, index) {\n        var family = this.calculateInstance.getSheetFamilyItem(this.calculateInstance.grid);\n        family.sheetNameToToken.delete(index.toString());\n        family.sheetNameToParentObject.delete(index.toString());\n        family.parentObjectToToken.delete(index.toString());\n        family.tokenToParentObject.delete('!' + (index - 1).toString() + '!');\n        return value;\n    };\n    WorkbookFormula.prototype.renameUpdation = function (name, sheetIdx) {\n        var dependentCellRef = this.calculateInstance.getDependentCells();\n        var cellRef = [];\n        var fInfo;\n        var formulaVal = '';\n        var savedTokens = [];\n        var isSheetRenamed = false;\n        var rowIndex;\n        var colIndex;\n        var sheetIndex;\n        dependentCellRef.forEach(function (value, key) {\n            cellRef.push(key);\n        });\n        for (var i = 0; i < this.sheetInfo.length; i++) {\n            if (this.sheetInfo[i].index === sheetIdx) {\n                this.sheetInfo[i].visibleName = name;\n                break;\n            }\n        }\n        var sheetNames = this.sheetInfo;\n        for (var i = 0; i < cellRef.length; i++) {\n            var dependentCells = this.calculateInstance.getDependentCells().get(cellRef[i]);\n            for (var j = 0; j < dependentCells.length; j++) {\n                fInfo = this.calculateInstance.getFormulaInfoTable().get(dependentCells[j]);\n                formulaVal = fInfo.formulaText;\n                for (var s = 0; s < sheetNames.length; s++) {\n                    if (sheetNames[s].visibleName !== sheetNames[s].sheet) {\n                        var name_1 = sheetNames[s].sheet.toUpperCase();\n                        if (formulaVal.toUpperCase().indexOf(name_1) > -1) {\n                            formulaVal = formulaVal.toUpperCase().split(name_1).join(s + '/');\n                            savedTokens.push(s);\n                            isSheetRenamed = true;\n                        }\n                    }\n                }\n                if (isSheetRenamed) {\n                    for (var k = 0; k < savedTokens.length; k++) {\n                        formulaVal = formulaVal.split(savedTokens[k].toString() + '/').join(sheetNames[savedTokens[k]].visibleName);\n                    }\n                    rowIndex = this.calculateInstance.rowIndex(dependentCells[j]);\n                    colIndex = this.calculateInstance.colIndex(dependentCells[j]);\n                    sheetIndex = getSheetIndexByName(this.parent, ('Sheet') + (parseInt(dependentCells[j].split('!')[1], 10) + 1), this.sheetInfo);\n                    this.updateDataContainer([rowIndex - 1, colIndex - 1], { value: formulaVal, sheetId: sheetIndex, visible: true });\n                }\n            }\n        }\n    };\n    WorkbookFormula.prototype.updateDataContainer = function (indexes, data) {\n        var rowIndex = indexes[0];\n        var colIndex = indexes[1];\n        var sheetData;\n        var rowData;\n        var colObj;\n        var len = this.parent.sheets.length;\n        for (var i = 0; i < len; i++) {\n            if (this.parent.sheets[i].id === data.sheetId) {\n                sheetData = this.parent.sheets[i].rows;\n                break;\n            }\n        }\n        if (!isNullOrUndefined(data)) {\n            if (rowIndex in sheetData) {\n                rowData = sheetData[rowIndex];\n                if (colIndex in rowData.cells) {\n                    colObj = rowData.cells[colIndex];\n                    colObj.formula = data.value;\n                    colObj.value = data.visible ? colObj.value : this.referenceError();\n                }\n                else {\n                    rowData.cells[colIndex] = colObj = {};\n                }\n            }\n            else {\n                rowData = sheetData[rowIndex] = {};\n                rowData[colIndex] = colObj = {};\n            }\n        }\n    };\n    WorkbookFormula.prototype.parseSheetRef = function (value) {\n        var regx;\n        var escapeRegx = new RegExp('[!@#$%^&()+=\\';,.{}|\\\":<>~_-]', 'g');\n        var i = 0;\n        var sheetCount = this.parent.sheets.length;\n        var temp = [];\n        temp.length = 0;\n        var sheetInfo = this.getSheetInfo();\n        var exp = '(?=[\\'!])(?=[^\"]*(?:\"[^\"]*\"[^\"]*)*$)';\n        for (i = 0; i < sheetCount; i++) {\n            if (sheetInfo[i].sheet !== sheetInfo[i].visibleName) {\n                regx = new RegExp(sheetInfo[i].visibleName.replace(escapeRegx, '\\\\$&') + exp, 'gi');\n                if (value.match(regx)) {\n                    value = value.replace(regx, i + '/');\n                    temp.push(i);\n                }\n            }\n        }\n        i = 0;\n        while (i < temp.length) {\n            regx = new RegExp(temp[i] + '/' + exp, 'gi');\n            value = value.replace(regx, sheetInfo[temp[i]].sheet);\n            i++;\n        }\n        return value;\n    };\n    WorkbookFormula.prototype.registerSheet = function (sheetIndex, sheetCount) {\n        if (sheetIndex === void 0) { sheetIndex = 0; }\n        if (sheetCount === void 0) { sheetCount = this.parent.sheets.length; }\n        var id;\n        while (sheetIndex < sheetCount) {\n            id = getSheet(this.parent, sheetIndex).id + '';\n            this.calculateInstance.registerGridAsSheet(id, id, this.calcID);\n            sheetIndex++;\n        }\n    };\n    WorkbookFormula.prototype.unRegisterSheet = function (sheetIndex, sheetCount) {\n        if (sheetIndex === void 0) { sheetIndex = 0; }\n        if (sheetCount === void 0) { sheetCount = this.parent.sheets.length; }\n        var id;\n        this.calculateInstance.tokenCount = 0;\n        while (sheetIndex < sheetCount) {\n            id = getSheet(this.parent, sheetIndex).id + '';\n            this.calculateInstance.unregisterGridAsSheet(id, id);\n            sheetIndex++;\n        }\n    };\n    WorkbookFormula.prototype.refreshCalculate = function (rowIdx, colIdx, value, isFormula, sheetIdx) {\n        if (sheetIdx === undefined) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var sheetName = getSheet(this.parent, sheetIdx).id + '';\n        if (isFormula) {\n            value = this.parseSheetRef(value);\n            var cellArgs = new ValueChangedArgs(rowIdx + 1, colIdx + 1, value);\n            var usedRangeCol = [this.parent.getActiveSheet().usedRange.rowIndex, this.parent.getActiveSheet().usedRange.colIndex];\n            this.calculateInstance.valueChanged(sheetName, cellArgs, true, usedRangeCol);\n            var referenceCollection = this.calculateInstance.randCollection;\n            if (this.calculateInstance.isRandomVal === true) {\n                var rowId = void 0;\n                var colId = void 0;\n                var refValue = '';\n                if (this.calculateInstance.randomValues.size > 1 && this.calculateInstance.randomValues.size ===\n                    referenceCollection.length) {\n                    for (var i = 0; i < this.calculateInstance.randomValues.size; i++) {\n                        rowId = this.calculateInstance.rowIndex(referenceCollection[i]);\n                        colId = this.calculateInstance.colIndex(referenceCollection[i]);\n                        refValue = this.calculateInstance.randomValues.get(referenceCollection[i]);\n                        sheetName = (parseFloat(this.calculateInstance.getSheetToken(referenceCollection[i]).split(this.calculateInstance.sheetToken).join('')) + 1).toString();\n                        var tempArgs = new ValueChangedArgs(rowId, colId, refValue);\n                        this.calculateInstance.valueChanged(sheetName, tempArgs, true);\n                    }\n                }\n            }\n        }\n        else {\n            var family = this.calculateInstance.getSheetFamilyItem(sheetName);\n            var cellRef = getColumnHeaderText(colIdx + 1) + (rowIdx + 1);\n            if (family.isSheetMember && !isNullOrUndefined(family.parentObjectToToken)) {\n                cellRef = family.parentObjectToToken.get(sheetName) + cellRef;\n            }\n            if (this.calculateInstance.getFormulaInfoTable().has(cellRef)) {\n                this.calculateInstance.getFormulaInfoTable().delete(cellRef);\n                if (this.calculateInstance.getDependentCells().has(cellRef)) {\n                    this.calculateInstance.clearFormulaDependentCells(cellRef);\n                }\n            }\n            this.calculateInstance.getComputedValue().clear();\n            this.calculateInstance.refresh(cellRef);\n            this.calculateInstance.refreshRandValues(cellRef);\n        }\n        this.calculateInstance.cell = '';\n    };\n    WorkbookFormula.prototype.autoCorrectFormula = function (formula, rowIdx, colIdx) {\n        if (!isNullOrUndefined(formula)) {\n            formula = formula.toString();\n            if (formula.split('(').length === 2 && formula.indexOf(')') < 0) {\n                formula += ')';\n            }\n            var isEqual = void 0;\n            if (formula.indexOf('=') === 0) {\n                formula = formula.slice(1);\n                isEqual = true;\n            }\n            var lessEq = formula.match(/</g);\n            var greaterEq = formula.match(/>/g);\n            var equal = formula.match(/=/g);\n            if (lessEq) {\n                var lessOp = '';\n                for (var i = 0; i < lessEq.length; i++) {\n                    lessOp = lessOp + lessEq[i];\n                }\n                formula = formula.replace(lessOp, '<');\n            }\n            if (greaterEq) {\n                var greaterOp = '';\n                for (var j = 0; j < greaterEq.length; j++) {\n                    greaterOp = greaterOp + greaterEq[j];\n                }\n                formula = formula.replace(greaterOp, '>');\n            }\n            if (equal) {\n                var equalOp = '';\n                for (var c = 0; c < equal.length; c++) {\n                    equalOp = equalOp + equal[c];\n                }\n                formula = formula.split(equalOp).join('=');\n            }\n            formula = isEqual ? '=' + formula : formula;\n            if (lessEq || greaterEq || equal) {\n                getCell(rowIdx, colIdx, this.parent.getActiveSheet()).formula = formula;\n            }\n        }\n        return formula;\n    };\n    WorkbookFormula.prototype.initiateDefinedNames = function () {\n        var definedNames = this.parent.definedNames;\n        var i = 0;\n        while (i < definedNames.length) {\n            var definedname = definedNames[i];\n            var refersTo = this.parseSheetRef(definedname.refersTo);\n            var range = getRangeFromAddress(refersTo);\n            var cellRef = false;\n            var isLink = refersTo.indexOf('http:') > -1 ? true : (refersTo.indexOf('https:') > -1 ? true : false);\n            range = range.split('$').join('');\n            range = range.split('=').join('');\n            if (range.indexOf(':') > -1) {\n                var rangeSplit = range.split(':');\n                if (isCellReference(rangeSplit[0]) && isCellReference(rangeSplit[1])) {\n                    cellRef = true;\n                }\n            }\n            else if (range.indexOf(':') < 0) {\n                if (isCellReference(range)) {\n                    cellRef = true;\n                }\n            }\n            if (isLink) {\n                cellRef = false;\n            }\n            if (cellRef) {\n                this.addDefinedName(definedname, true);\n            }\n            else {\n                this.removeDefinedName(definedname.name, definedname.scope);\n                i--;\n            }\n            i++;\n        }\n    };\n    /**\n     * @hidden\n     * Used to add defined name to workbook.\n     * @param {DefineNameModel} name - Define named range.\n     */\n    WorkbookFormula.prototype.addDefinedName = function (definedName, isValidate) {\n        var isAdded = true;\n        var sheetIdx;\n        var name = definedName.name;\n        if (definedName.refersTo.indexOf('!') < 0) {\n            var sheetName = getSheetName(this.parent);\n            sheetName = sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName;\n            definedName.refersTo = sheetName + '!' + ((definedName.refersTo.indexOf('=') < 0) ?\n                definedName.refersTo : definedName.refersTo.split('=')[1]);\n        }\n        var visibleRefersTo = definedName.refersTo;\n        var refersTo = this.parseSheetRef(definedName.refersTo);\n        if (definedName.scope) {\n            sheetIdx = getSheetIndex(this.parent, definedName.scope);\n            if (sheetIdx > -1) {\n                name = getSheetName(this.parent, sheetIdx) + '!' + name;\n            }\n        }\n        else {\n            definedName.scope = '';\n        }\n        if (!definedName.comment) {\n            definedName.comment = '';\n        }\n        //need to extend once internal sheet value changes done.\n        if (!isValidate && this.checkIsNameExist(definedName.name, definedName.scope)) {\n            isAdded = false;\n        }\n        else {\n            this.calculateInstance.addNamedRange(name, refersTo[0] === '=' ? refersTo.substr(1) : refersTo);\n            if (refersTo[0] !== '=') {\n                definedName.refersTo = '=' + visibleRefersTo;\n            }\n            if (this.parent.definedNames.indexOf(definedName) < 0) {\n                this.parent.definedNames.push(definedName);\n            }\n        }\n        return isAdded;\n    };\n    /**\n     * @hidden\n     * Used to remove defined name from workbook.\n     * @param {string} name - Specifies the defined name.\n     * @param {string} scope - Specifies the scope of the define name.\n     */\n    WorkbookFormula.prototype.removeDefinedName = function (name, scope) {\n        var isRemoved = false;\n        var index = this.getIndexFromNameColl(name, scope);\n        if (index > -1) {\n            var calcName = name;\n            if (scope) {\n                var sheetIdx = getSheetIndex(this.parent, scope);\n                if (sheetIdx) {\n                    calcName = getSheetName(this.parent, sheetIdx) + '!' + name;\n                }\n            }\n            this.calculateInstance.removeNamedRange(calcName);\n            this.parent.definedNames.splice(index, 1);\n            isRemoved = true;\n        }\n        return isRemoved;\n    };\n    WorkbookFormula.prototype.checkIsNameExist = function (name, sheetName) {\n        var isExist = this.parent.definedNames.some(function (key) {\n            return key.name === name && (sheetName ? key.scope === sheetName : key.scope === '');\n        });\n        return isExist;\n    };\n    WorkbookFormula.prototype.getIndexFromNameColl = function (definedName, scope) {\n        if (scope === void 0) { scope = ''; }\n        var index = -1;\n        this.parent.definedNames.filter(function (name, idx) {\n            if (name.name === definedName && name.scope === scope) {\n                index = idx;\n            }\n        });\n        return index;\n    };\n    WorkbookFormula.prototype.toFixed = function (value) {\n        var num = Number(value);\n        if (Math.round(num) !== num) {\n            value = num.toFixed(2);\n        }\n        return value;\n    };\n    WorkbookFormula.prototype.aggregateComputation = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var range = sheet.selectedRange;\n        var indexes = getRangeIndexes(range.split(':')[1]);\n        var i;\n        var calcValue;\n        var formulaVal = ['SUM', 'AVERAGE', 'MIN', 'MAX'];\n        var formatedValues = [];\n        if (indexes[0] + 1 === sheet.rowCount && indexes[1] + 1 === sheet.colCount) {\n            range = \"A1:\" + getCellAddress(sheet.usedRange.rowIndex, sheet.usedRange.colIndex);\n        }\n        var actCell = getRangeIndexes(sheet.activeCell);\n        var actCellModel = sheet.rows[actCell[0]] ? sheet.rows[actCell[0]].cells ?\n            sheet.rows[actCell[0]].cells[actCell[1]] : {} : {};\n        var actCellfrmt = (actCellModel) ? actCellModel.format : '';\n        var cellValue;\n        var cellCol = this.calculateInstance.getCellCollection(range);\n        for (i = 0; i < cellCol.length; i++) {\n            cellValue = this.calculateInstance.getValueFromArg(cellCol[i]);\n            if (isNumber(cellValue)) {\n                args.countOnly = false;\n                break;\n            }\n        }\n        args.Count = this.calculateInstance.getFunction('COUNTA')(range);\n        if (!args.Count || args.countOnly) {\n            return;\n        }\n        for (i = 0; i < 4; i++) {\n            calcValue = this.toFixed(this.calculateInstance.getFunction(formulaVal[i])(range));\n            var eventArgs = {\n                formattedText: calcValue,\n                value: calcValue,\n                format: actCellfrmt,\n                onLoad: true\n            };\n            if (actCellfrmt) {\n                this.parent.notify(getFormattedCellObject, eventArgs);\n                calcValue = eventArgs.formattedText;\n            }\n            formatedValues.push(calcValue);\n        }\n        args.Sum = formatedValues[0];\n        args.Avg = formatedValues[1];\n        args.Min = formatedValues[2];\n        args.Max = formatedValues[3];\n    };\n    WorkbookFormula.prototype.clearFormula = function (args) {\n        if (this.parent.activeSheetIndex === args.sheetIdx) {\n            args.rowIdx = (args.type === 'Row') ? (args.status === 'insert') ? (args.rowIdx >= args.startIdx)\n                ? args.rowIdx - args.count : args.rowIdx : args.rowIdx + args.count : args.rowIdx;\n            args.colIdx = (args.type === 'Column') ? (args.status === 'insert') ? (args.colIdx >= args.startIdx) ?\n                args.colIdx - args.count : args.colIdx : args.colIdx + args.count : args.colIdx;\n        }\n        var cellRef = '!' + args.sheetIdx + '!' + getAlphalabel((args.colIdx === -1 ?\n            (args.colIdx + 2) : (args.colIdx + 1))) + (args.rowIdx === -1 ? (args.rowIdx + 2) : (args.rowIdx + 1));\n        this.calculateInstance.getFormulaInfoTable().delete(cellRef);\n        this.calculateInstance.clearFormulaDependentCells(cellRef);\n    };\n    WorkbookFormula.prototype.refreshFormula = function (formulaValue, count, status, type, startIdx, sheetIdx) {\n        var diff;\n        var diff1;\n        var val = formulaValue;\n        var nAlpha;\n        var range = [];\n        var actSheet = this.parent.getActiveSheet();\n        var deleteIdxs = [];\n        var i;\n        var splitFormula = [];\n        var fArg;\n        var ridx;\n        var hasREFVal = false;\n        var pVal;\n        if (checkIsFormula(val)) {\n            if (status === 'delete') {\n                for (i = 1; i <= count; i++) {\n                    deleteIdxs.push(startIdx + i);\n                }\n            }\n            splitFormula = this.parseFormula(val);\n            for (i = 0; i < splitFormula.length; i++) {\n                fArg = splitFormula[i].trim();\n                if (this.calculateInstance.isCellReference(fArg)) {\n                    pVal = i && splitFormula[i - 1].trim();\n                    if (pVal && pVal[pVal.length - 1] === '!') {\n                        pVal = pVal.replace(/['!]/g, '');\n                        if (pVal !== actSheet.name) {\n                            continue;\n                        }\n                    }\n                    else if (parseInt(pVal, 10) === 0 && pVal[pVal.length - 1] === undefined) {\n                        if ((actSheet.id - 1) !== sheetIdx) {\n                            continue;\n                        }\n                    }\n                    range = getRangeIndexes(fArg);\n                    diff = (type === 'Column') ? (status === 'insert') ? range[3] + count : range[3] - count :\n                        (status === 'insert') ? range[2] + count : range[2] - count;\n                    diff1 = (type === 'Column') ? (status === 'insert') ? range[1] + count : range[1] - count :\n                        (status === 'insert') ? range[0] + count : range[0] - count;\n                    diff1 = (type === 'Column') ? (startIdx > range[1]) ? range[1] : diff1 : (startIdx > range[0]) ? range[0] : diff1;\n                    diff = (type === 'Column') ? (startIdx > range[3]) ? range[3] : diff : (startIdx > range[2]) ? range[2] : diff;\n                    if (diff1 > -1) {\n                        nAlpha = (type === 'Column') ? getRangeAddress([range[0], diff1, range[2], diff]).split(':')[0] :\n                            getRangeAddress([diff1, range[1], diff, range[3]]).split(':')[0];\n                    }\n                    else {\n                        nAlpha = '#REF!';\n                        hasREFVal = true;\n                    }\n                    if (status === 'delete') {\n                        ridx = parseInt(type === 'Row' ? fArg.replace(/[A-Z]/g, '') : (fArg.replace(/[0-9]/g, '')), 10);\n                        if (deleteIdxs.indexOf(ridx) > -1) {\n                            nAlpha = '#REF!';\n                            hasREFVal = true;\n                        }\n                    }\n                    splitFormula[i] = nAlpha;\n                }\n            }\n            val = '=' + splitFormula.join('');\n        }\n        return val;\n    };\n    WorkbookFormula.prototype.refreshInsDelFormula = function (args) {\n        var count;\n        var sheet;\n        var sheets = this.parent.sheets;\n        var sheetLen = sheets.length;\n        var address;\n        var cell;\n        var s;\n        var updatedFormulaVal;\n        for (s = 0; s < sheetLen; s++) {\n            count = args.model.length;\n            sheet = this.parent.sheets[s];\n            address = [0, 0, sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n            for (var i = address[2]; i >= address[0]; i--) {\n                for (var j = address[1]; j <= address[3]; j++) {\n                    cell = getCell(i, j, sheet);\n                    if (cell && cell.formula && checkIsFormula(cell.formula)) {\n                        this.clearFormula({\n                            rowIdx: i, colIdx: j, sheetIdx: s, count: count, status: args.name,\n                            type: args.modelType, startIdx: args.startIndex\n                        });\n                        updatedFormulaVal = this.refreshFormula(cell.formula, count, args.name, args.modelType, args.startIndex, s);\n                        this.parent.notify(workbookEditOperation, {\n                            action: 'updateCellValue', address: [i, j, i,\n                                j], value: updatedFormulaVal, sheetIndex: s\n                        });\n                    }\n                }\n            }\n        }\n    };\n    WorkbookFormula.prototype.parseFormula = function (formula) {\n        var temp;\n        var str;\n        var len;\n        var i = 0;\n        var arr = [];\n        var formulaVal = [];\n        formulaVal = this.markSpecialChar(formula.replace('=', ''));\n        formulaVal = formulaVal.split(/\\(|\\)|=|\\^|>|<|,|:|\\+|-|\\*|\\/|%|&/g);\n        len = formulaVal.length;\n        while (i < len) {\n            temp = formulaVal[i];\n            if (!temp) {\n                i++;\n                continue;\n            }\n            if (temp.length === 1) {\n                arr.push(this.isUniqueChar(temp) ? this.getUniqueCharVal(temp) : temp);\n            }\n            else {\n                str = temp[0];\n                if (temp.indexOf('!') > 0) {\n                    if (this.isUniqueChar(str)) {\n                        arr.push(this.getUniqueCharVal(str));\n                        temp = temp.substr(1);\n                    }\n                    str = temp.indexOf('!') + 1;\n                    arr.push(temp.substr(0, str));\n                    arr.push(temp.substr(str));\n                }\n                else if (this.isUniqueChar(str)) {\n                    arr.push(this.getUniqueCharVal(str));\n                    arr.push(temp.substr(1));\n                }\n                else {\n                    arr.push(temp);\n                }\n            }\n            i++;\n        }\n        return arr;\n    };\n    WorkbookFormula.prototype.getUniqueCharVal = function (formula) {\n        switch (formula) {\n            case this.uniqueOBracket:\n                return '(';\n            case this.uniqueCBracket:\n                return ')';\n            case this.uniqueCSeparator:\n                return ',';\n            case this.uniqueCOperator:\n                return ':';\n            case this.uniquePOperator:\n                return '+';\n            case this.uniqueSOperator:\n                return '-';\n            case this.uniqueMOperator:\n                return '*';\n            case this.uniqueDOperator:\n                return '/';\n            case this.uniqueModOperator:\n                return '%';\n            case this.uniqueConcateOperator:\n                return '&';\n            case this.uniqueEqualOperator:\n                return '=';\n            case this.uniqueExpOperator:\n                return '^';\n            case this.uniqueGTOperator:\n                return '>';\n            case this.uniqueLTOperator:\n                return '<';\n        }\n        return '';\n    };\n    WorkbookFormula.prototype.isUniqueChar = function (formula) {\n        var code = formula.charCodeAt(formula);\n        return code >= 129 && code <= 142;\n    };\n    WorkbookFormula.prototype.markSpecialChar = function (formula) {\n        formula = formula.replace(/\\(/g, '(' + this.uniqueOBracket).replace(/\\)/g, ')' + this.uniqueCBracket);\n        formula = formula.replace(/,/g, ',' + this.uniqueCSeparator).replace(/:/g, ':' + this.uniqueCOperator);\n        formula = formula.replace(/\\+/g, '+' + this.uniquePOperator).replace(/-/g, '-' + this.uniqueSOperator);\n        formula = formula.replace(/\\*/g, '*' + this.uniqueMOperator).replace(/\\//g, '/' + this.uniqueDOperator);\n        formula = formula.replace(/&/g, '&' + this.uniqueConcateOperator);\n        formula = formula.replace(/=/g, '=' + this.uniqueEqualOperator);\n        formula = formula.replace(/\\^/g, '^' + this.uniqueExpOperator);\n        formula = formula.replace(/>/g, '>' + this.uniqueGTOperator).replace(/</g, '<' + this.uniqueLTOperator);\n        return formula.replace(/%/g, '%' + this.uniqueModOperator);\n    };\n    WorkbookFormula.prototype.refreshNamedRange = function (args, action) {\n        var isChanged = false;\n        var modelDefinedNames = this.parent.definedNames;\n        var definedNames = Object.assign({}, modelDefinedNames);\n        var definedName;\n        var definedNameCnt = modelDefinedNames.length;\n        var range;\n        var rangeIndex;\n        var count;\n        var startIndex;\n        var endIndex;\n        var newIndex;\n        var newRange;\n        var sheetName;\n        var sheetIndex;\n        var sheet;\n        for (var idx = 0; idx < definedNameCnt; idx++) {\n            definedName = definedNames[idx];\n            range = definedNames[idx].refersTo.split('!')[1];\n            rangeIndex = getRangeIndexes(range);\n            sheetName = definedName.refersTo.split('!')[0].split('=')[1];\n            sheetIndex = getSheetIndex(this.parent, sheetName.replace(/'/g, ''));\n            sheet = getSheet(this.parent, sheetIndex);\n            if (sheetIndex === this.parent.activeSheetIndex) {\n                if (args.name === 'insert') {\n                    count = args.model.length;\n                    startIndex = args.index;\n                    endIndex = args.index + count;\n                    if (args.modelType === 'Row') { // for above the named range index\n                        if ((rangeIndex[0] >= endIndex) || (rangeIndex[0] >= startIndex && rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0] + count, rangeIndex[1], rangeIndex[2] + count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[0] <= startIndex && rangeIndex[2] >= startIndex) || (rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2] + count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                    }\n                    else if (args.modelType === 'Column') {\n                        if ((rangeIndex[1] >= endIndex) || (rangeIndex[1] >= startIndex && rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1] + count, rangeIndex[2], rangeIndex[3] + count];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[1] <= startIndex && rangeIndex[3] >= startIndex) || (rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2], rangeIndex[3] + count];\n                            isChanged = true;\n                        }\n                    }\n                }\n                else {\n                    count = args.deletedModel.length;\n                    startIndex = args.startIndex;\n                    endIndex = args.endIndex;\n                    if (args.modelType === 'Row') { // for above the named range index\n                        if ((rangeIndex[0] >= endIndex) || (rangeIndex[0] >= startIndex && rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0] - count, rangeIndex[1], rangeIndex[2] - count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[0] <= startIndex && rangeIndex[2] >= startIndex) || (rangeIndex[2] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2] - count, rangeIndex[3]];\n                            isChanged = true;\n                        }\n                    }\n                    else if (args.modelType === 'Column') {\n                        if ((rangeIndex[1] >= endIndex) || (rangeIndex[1] >= startIndex && rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1] - count, rangeIndex[2], rangeIndex[3] - count];\n                            isChanged = true;\n                        }\n                        else if ((rangeIndex[1] <= startIndex && rangeIndex[3] >= startIndex) || (rangeIndex[3] >= endIndex)) {\n                            newIndex = [rangeIndex[0], rangeIndex[1], rangeIndex[2], rangeIndex[3] - count];\n                            isChanged = true;\n                        }\n                    }\n                }\n                if (isChanged) {\n                    newRange = getRangeAddress(newIndex);\n                    definedName.refersTo = sheetName + '!' + newRange;\n                    this.parent.removeDefinedName(definedName.name, definedName.scope);\n                    var eventArgs = {\n                        action: 'addDefinedName', definedName: definedName, isAdded: false\n                    };\n                    this.parent.notify(workbookFormulaOperation, eventArgs);\n                }\n            }\n            modelDefinedNames = definedNames;\n        }\n    };\n    return WorkbookFormula;\n}());\nexport { WorkbookFormula };\n","import { getCell, setCell, getData } from '../base/index';\nimport { DataManager, Query, DataUtil, Deferred } from '@syncfusion/ej2-data';\nimport { getCellIndexes, getIndexesFromAddress, getColumnHeaderText, getRangeAddress, workbookLocale, isNumber } from '../common/index';\nimport { getSwapRange } from '../common/index';\nimport { parseIntValue } from '../common/index';\nimport { initiateSort } from '../common/event';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookSort` module is used to handle sort action in Spreadsheet.\n */\nvar WorkbookSort = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookSort module.\n     */\n    function WorkbookSort(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     */\n    WorkbookSort.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookSort.prototype.addEventListener = function () {\n        this.parent.on(initiateSort, this.initiateSortHandler, this);\n    };\n    WorkbookSort.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateSort, this.initiateSortHandler);\n        }\n    };\n    /**\n     * Sorts range of cells in the sheet.\n     * @param args - arguments for sorting.\n     */\n    WorkbookSort.prototype.initiateSortHandler = function (eventArgs) {\n        var _this = this;\n        var args = eventArgs.args;\n        var deferred = new Deferred();\n        var sheet = this.parent.getActiveSheet();\n        var range = getSwapRange(getIndexesFromAddress(args.range));\n        var sortOptions = args.sortOptions || { sortDescriptors: {}, containsHeader: true };\n        var isSingleCell = false;\n        eventArgs.promise = deferred.promise;\n        if (range[0] > sheet.usedRange.rowIndex || range[1] > sheet.usedRange.colIndex) {\n            deferred.reject(this.parent.serviceLocator.getService(workbookLocale).getConstant('SortOutOfRangeError'));\n            return;\n        }\n        var containsHeader = sortOptions.containsHeader;\n        if (range[0] === range[2]) { //if selected range is a single cell \n            range = this.getSortDataRange(range[0], range[1], sheet);\n            isSingleCell = true;\n            if (isNullOrUndefined(sortOptions.containsHeader)) {\n                if (typeof getCell(range[0], range[1], sheet, null, true).value ===\n                    typeof getCell(range[0] + 1, range[1], sheet, null, true).value) {\n                    containsHeader = this.isSameStyle(getCell(range[0], range[1], sheet, null, true).style, getCell(range[0] + 1, range[1], sheet, null, true).style) ? false : true;\n                }\n                else {\n                    containsHeader = true;\n                }\n            }\n        }\n        if ((isNullOrUndefined(args.sortOptions) || isNullOrUndefined(args.sortOptions.containsHeader)) && !isSingleCell) {\n            if (!isNullOrUndefined(getCell(range[0], range[1], sheet)) && !isNullOrUndefined(getCell(range[0] + 1, range[1], sheet))) {\n                if (typeof getCell(range[0], range[1], sheet).value === typeof getCell(range[0] + 1, range[1], sheet).value) {\n                    containsHeader = false;\n                }\n                else {\n                    containsHeader = true;\n                }\n            }\n        }\n        var sRIdx = range[0] = containsHeader ? range[0] + 1 : range[0];\n        var sCIdx;\n        var eCIdx;\n        var cell = getCellIndexes(sheet.activeCell);\n        var header = getColumnHeaderText(cell[1] + 1);\n        var sortDescriptors = sortOptions.sortDescriptors;\n        var address = getRangeAddress(range);\n        getData(this.parent, sheet.name + \"!\" + address, true).then(function (jsonData) {\n            var dataManager = new DataManager(jsonData);\n            var query = new Query();\n            if (Array.isArray(sortDescriptors)) { //multi-column sorting.\n                if (!sortDescriptors || sortDescriptors.length === 0) {\n                    sortDescriptors = [{ field: header }];\n                }\n                for (var length_1 = sortDescriptors.length, i = length_1 - 1; i > -1; i--) {\n                    if (!sortDescriptors[length_1 - 1].field) {\n                        sortDescriptors[length_1 - 1].field = header;\n                    }\n                    if (!sortDescriptors[i].field) {\n                        continue;\n                    }\n                    var comparerFn = sortDescriptors[i].sortComparer\n                        || _this.sortComparer.bind(_this, sortDescriptors[i], sortOptions.caseSensitive);\n                    query.sortBy(sortDescriptors[i].field, comparerFn);\n                }\n            }\n            else { //single column sorting.\n                if (!sortDescriptors) {\n                    sortDescriptors = { field: header };\n                }\n                if (!sortDescriptors.field) {\n                    sortDescriptors.field = header;\n                }\n                var comparerFn = sortDescriptors.sortComparer\n                    || _this.sortComparer.bind(_this, sortDescriptors, sortOptions.caseSensitive);\n                query.sortBy(sortDescriptors.field, comparerFn);\n            }\n            dataManager.executeQuery(query).then(function (e) {\n                var colName;\n                var cell = {};\n                var rowKey = '__rowIndex';\n                Array.prototype.forEach.call(e.result, function (data, index) {\n                    if (!data) {\n                        return;\n                    }\n                    sCIdx = range[1];\n                    eCIdx = range[3];\n                    sRIdx = parseInt(jsonData[index][rowKey], 10) - 1;\n                    for (sCIdx; sCIdx <= eCIdx; sCIdx++) {\n                        colName = getColumnHeaderText(sCIdx + 1);\n                        cell = data[colName];\n                        setCell(sRIdx, sCIdx, sheet, cell);\n                    }\n                });\n                var eventArgs = { range: sheet.name + \"!\" + address, sortOptions: args.sortOptions };\n                deferred.resolve(eventArgs);\n            });\n        });\n    };\n    WorkbookSort.prototype.isSameStyle = function (firstCellStyle, secondCellStyle) {\n        if (firstCellStyle === void 0) { firstCellStyle = {}; }\n        if (secondCellStyle === void 0) { secondCellStyle = {}; }\n        var sameStyle = true;\n        var keys = Object.keys(firstCellStyle);\n        for (var i = 0; i < keys.length; i++) {\n            if (firstCellStyle[keys[i]] === secondCellStyle[keys[i]] || this.parent.cellStyle[keys[i]] === firstCellStyle[keys[i]]) {\n                sameStyle = true;\n            }\n            else {\n                sameStyle = false;\n                break;\n            }\n        }\n        return sameStyle;\n    };\n    WorkbookSort.prototype.getSortDataRange = function (rowIdx, colIdx, sheet) {\n        var topIdx = rowIdx;\n        var btmIdx = rowIdx;\n        var leftIdx = colIdx;\n        var prevleftIdx;\n        var rightIdx = colIdx;\n        var prevrightIdx;\n        var topReached;\n        var btmReached;\n        var leftReached;\n        var rightReached;\n        for (var i = 1;; i++) {\n            if (!btmReached && getCell(rowIdx + i, colIdx, sheet, null, true).value) {\n                btmIdx = rowIdx + i;\n            }\n            else {\n                btmReached = true;\n            }\n            if (!topReached && getCell(rowIdx - i, colIdx, sheet, null, true).value) {\n                topIdx = rowIdx - i;\n            }\n            else {\n                topReached = true;\n            }\n            if (topReached && btmReached) {\n                break;\n            }\n        }\n        for (var j = 1;; j++) {\n            prevleftIdx = leftIdx;\n            prevrightIdx = rightIdx;\n            for (var i = topIdx; i <= btmIdx; i++) {\n                if (!leftReached && getCell(i, leftIdx - 1, sheet, null, true).value) {\n                    leftIdx = prevleftIdx - 1;\n                }\n                if (!rightReached && getCell(i, rightIdx + 1, sheet, null, true).value) {\n                    rightIdx = prevrightIdx + 1;\n                }\n                if (i === btmIdx) {\n                    if (leftIdx === prevleftIdx) {\n                        leftReached = true;\n                    }\n                    if (rightIdx === prevrightIdx) {\n                        rightReached = true;\n                    }\n                }\n                if (rightReached && leftReached) {\n                    return [topIdx, leftIdx, btmIdx, rightIdx];\n                }\n            }\n        }\n    };\n    /**\n     * Compares the two cells for sorting.\n     * @param sortDescriptor - protocol for sorting.\n     * @param caseSensitive - value for case sensitive.\n     * @param x - first cell\n     * @param y - second cell\n     */\n    WorkbookSort.prototype.sortComparer = function (sortDescriptor, caseSensitive, x, y) {\n        var direction = sortDescriptor.order || '';\n        var comparer = DataUtil.fnSort(direction);\n        var caseOptions = { sensitivity: caseSensitive ? 'case' : 'base' };\n        if (x && y && (typeof x.value === 'string' || typeof y.value === 'string')) {\n            if (isNumber(x.value)) { // Imported number values are of string type, need to handle this case in server side\n                x.value = parseIntValue(x.value);\n            }\n            if (isNumber(y.value)) {\n                y.value = parseIntValue(y.value);\n            }\n            var collator = new Intl.Collator(this.parent.locale, caseOptions);\n            if (!direction || direction.toLowerCase() === 'ascending') {\n                return collator.compare(x.value, y.value);\n            }\n            else {\n                return collator.compare(x.value, y.value) * -1;\n            }\n        }\n        if ((x === null || isNullOrUndefined(x.value)) && (y === null || isNullOrUndefined(y.value))) {\n            return -1;\n        }\n        if (x === null || isNullOrUndefined(x.value)) {\n            return 1;\n        }\n        if (y === null || isNullOrUndefined(y.value)) {\n            return -1;\n        }\n        return comparer(x ? x.value : x, y ? y.value : y);\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookSort.prototype.getModuleName = function () {\n        return 'workbookSort';\n    };\n    return WorkbookSort;\n}());\nexport { WorkbookSort };\n","import { getData } from '../base/index';\nimport { DataManager, Query, Deferred, Predicate } from '@syncfusion/ej2-data';\nimport { getCellIndexes, getIndexesFromAddress, getSwapRange, getRangeAddress } from '../common/index';\nimport { initiateFilter, clearAllFilter } from '../common/event';\n/**\n * The `WorkbookFilter` module is used to handle filter action in Spreadsheet.\n */\nvar WorkbookFilter = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookFilter module.\n     */\n    function WorkbookFilter(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the filter module.\n     */\n    WorkbookFilter.prototype.destroy = function () {\n        this.removeEventListener();\n        this.filterRange = null;\n        this.parent = null;\n    };\n    WorkbookFilter.prototype.addEventListener = function () {\n        this.parent.on(initiateFilter, this.initiateFilterHandler, this);\n        this.parent.on(clearAllFilter, this.clearAllFilterHandler, this);\n    };\n    WorkbookFilter.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateFilter, this.initiateFilterHandler);\n            this.parent.off(clearAllFilter, this.clearAllFilterHandler);\n        }\n    };\n    /**\n     * Filters a range of cells in the sheet.\n     * @param args - arguments for filtering.\n     */\n    WorkbookFilter.prototype.initiateFilterHandler = function (eventArgs) {\n        var _this = this;\n        var args = eventArgs.args;\n        var deferred = new Deferred();\n        var sheet = this.parent.getActiveSheet();\n        var filterOptions = args.filterOptions || {};\n        eventArgs.promise = deferred.promise;\n        this.filterRange = args.range;\n        if (filterOptions.datasource) {\n            this.setFilter(filterOptions.datasource, filterOptions.predicates);\n            var filterEventArgs = { range: args.range, filterOptions: filterOptions };\n            deferred.resolve(filterEventArgs);\n        }\n        else {\n            var range = getSwapRange(getIndexesFromAddress(args.range));\n            if (range[0] > sheet.usedRange.rowIndex || range[1] > sheet.usedRange.colIndex) {\n                deferred.reject('Select a cell or range inside the used range and try again.');\n                return;\n            }\n            if (range[0] === range[2] && (range[2] - range[0]) === 0) { //if selected range is a single cell \n                range[0] = 0;\n                range[1] = 0;\n                range[3] = sheet.usedRange.colIndex;\n            }\n            range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n            range[0] = range[0] + 1; //ignore first row        \n            var address_1 = getRangeAddress(range);\n            getData(this.parent, sheet.name + \"!\" + address_1, true, true).then(function (jsonData) {\n                var dataManager = new DataManager(jsonData);\n                _this.setFilter(dataManager, filterOptions.predicates);\n                var filterEventArgs = { range: address_1, filterOptions: filterOptions };\n                deferred.resolve(filterEventArgs);\n            });\n        }\n    };\n    /**\n     * Hides or unhides the rows based on the filter predicates.\n     */\n    WorkbookFilter.prototype.setFilter = function (dataManager, predicates) {\n        var _this = this;\n        if (dataManager && predicates) {\n            var jsonData = dataManager.dataSource.json;\n            var query = new Query();\n            if (predicates.length) {\n                query.where(Predicate.and(predicates));\n            }\n            var result_1 = dataManager.executeLocal(query);\n            var rowKey_1 = '__rowIndex';\n            jsonData.forEach(function (data, index) {\n                if (!data) {\n                    return;\n                }\n                _this.parent.hideRow(parseInt(data[rowKey_1], 10) - 1, undefined, result_1.indexOf(data) < 0);\n            });\n        }\n    };\n    /**\n     * Clears all the filters in the sheet.\n     */\n    WorkbookFilter.prototype.clearAllFilterHandler = function () {\n        if (this.filterRange) {\n            var range = getCellIndexes(this.filterRange);\n            var sheet = this.parent.getActiveSheet();\n            this.parent.hideRow(range[0], sheet.usedRange.rowIndex - 1, false);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookFilter.prototype.getModuleName = function () {\n        return 'workbookFilter';\n    };\n    return WorkbookFilter;\n}());\nexport { WorkbookFilter };\n","import { getRangeIndexes } from '../common/index';\nimport { getCell, setCell, getSheetIndex } from '../base/index';\nimport { setImage } from '../common/event';\n/**\n * Specifies image.\n */\nvar WorkbookImage = /** @class */ (function () {\n    function WorkbookImage(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookImage.prototype.setImage = function (args) {\n        var imgRange = args.range ? (args.range.indexOf('!') > 0) ? args.range.split('!')[1] : args.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIdx = (args.range && args.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, args.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var indexes = getRangeIndexes(imgRange);\n        var sheet = sheetIdx ? this.parent.sheets[sheetIdx] : this.parent.getActiveSheet();\n        var cell = getCell(indexes[0], indexes[1], sheet);\n        var oldImgData;\n        var imgData = args.options;\n        if (cell && cell.image) {\n            oldImgData = cell.image;\n            for (var i = 0; i < imgData.length; i++) {\n                oldImgData.push(imgData[i]);\n            }\n        }\n        setCell(indexes[0], indexes[1], sheet, { image: (cell && cell.image) ? oldImgData : imgData }, true);\n    };\n    /**\n     * Adding event listener for number format.\n     */\n    WorkbookImage.prototype.addEventListener = function () {\n        this.parent.on(setImage, this.setImage, this);\n    };\n    /**\n     * Removing event listener for number format.\n     */\n    WorkbookImage.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setImage, this.setImage);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    WorkbookImage.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook number format module name.\n     */\n    WorkbookImage.prototype.getModuleName = function () {\n        return 'workbookImage';\n    };\n    return WorkbookImage;\n}());\nexport { WorkbookImage };\n","import { getRangeIndexes, inRange } from '../common/index';\nimport { setCell, getSheetIndex, getCell, getSheetNameFromAddress } from '../base/index';\nimport { setChart, initiateChart, refreshChart, updateChart, deleteChartColl, refreshChartSize, focusChartBorder } from '../common/event';\nimport { closest, isNullOrUndefined, getComponent } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookChart` module is used to handle chart action in Spreadsheet.\n */\nvar WorkbookChart = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookChart module.\n     */\n    function WorkbookChart(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookChart.prototype.addEventListener = function () {\n        this.parent.on(setChart, this.setChartHandler, this);\n        this.parent.on(refreshChart, this.refreshChartData, this);\n        this.parent.on(deleteChartColl, this.deleteChartColl, this);\n        this.parent.on(refreshChartSize, this.refreshChartSize, this);\n        this.parent.on(focusChartBorder, this.focusChartBorder, this);\n    };\n    WorkbookChart.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setChart, this.setChartHandler);\n            this.parent.off(refreshChart, this.refreshChartData);\n            this.parent.off(deleteChartColl, this.deleteChartColl);\n            this.parent.off(refreshChartSize, this.refreshChartSize);\n            this.parent.off(focusChartBorder, this.focusChartBorder);\n        }\n    };\n    WorkbookChart.prototype.setChartHandler = function (args) {\n        var i = 0;\n        args.isInitCell = isNullOrUndefined(args.isInitCell) ? false : args.isInitCell;\n        args.isUndoRedo = isNullOrUndefined(args.isUndoRedo) ? true : args.isUndoRedo;\n        args.isPaste = isNullOrUndefined(args.isPaste) ? false : args.isPaste;\n        var chart = args.chart;\n        if (chart.length > 0) {\n            while (i < chart.length) {\n                if (args.isCut === false) {\n                    if (document.getElementById(args.chart[i].id)) {\n                        chart[i] = {\n                            range: chart[i].range, id: 'e_spreadsheet_chart_' + this.parent.chartCount,\n                            isSeriesInRows: chart[i].isSeriesInRows, theme: chart[i].theme, type: chart[i].type\n                        };\n                        chart[i].id = 'e_spreadsheet_chart_' + this.parent.chartCount;\n                        args.isIdAvailabe = false;\n                    }\n                }\n                if (document.getElementById(args.chart[i].id)) {\n                    return;\n                }\n                var idAvailable = isNullOrUndefined(args.isIdAvailabe) ? true : args.isIdAvailabe;\n                chart[i].theme = chart[i].theme || 'Material';\n                chart[i].type = chart[i].type || 'Line';\n                chart[i].isSeriesInRows = chart[i].isSeriesInRows || false;\n                chart[i].range = chart[i].range || this.parent.getActiveSheet().selectedRange;\n                if (chart[i].range.indexOf('!') < 0) {\n                    chart[i].range = this.parent.getActiveSheet().name + '!' + chart[i].range;\n                }\n                if (isNullOrUndefined(chart[i].id)) {\n                    chart[i].id = 'e_spreadsheet_chart_' + this.parent.chartCount;\n                    idAvailable = false;\n                }\n                chart[i].height = chart[i].height || 290;\n                chart[i].width = chart[i].width || 480;\n                this.parent.notify(initiateChart, {\n                    option: chart[i], chartCount: this.parent.chartCount, isInitCell: args.isInitCell, isUndoRedo: args.isUndoRedo,\n                    dataSheetIdx: args.dataSheetIdx, range: args.range, isPaste: args.isPaste\n                });\n                this.parent.chartColl.push(chart[i]);\n                if (!idAvailable) {\n                    this.parent.chartCount++;\n                }\n                if (!args.isInitCell || args.isPaste) {\n                    var sheetIdx = (chart[i].range && chart[i].range.indexOf('!') > 0) ?\n                        getSheetIndex(this.parent, chart[i].range.split('!')[0]) : this.parent.activeSheetIndex;\n                    var indexes = args.isPaste ? getRangeIndexes(args.range) : getRangeIndexes(chart[i].range);\n                    var sheet = sheetIdx ? this.parent.sheets[sheetIdx] : this.parent.getActiveSheet();\n                    var cell = getCell(indexes[0], indexes[1], sheet);\n                    if (cell && cell.chart) {\n                        cell.chart.push(chart[i]);\n                    }\n                    else {\n                        setCell(indexes[0], indexes[1], sheet, { chart: [chart[i]] }, true);\n                    }\n                }\n                i++;\n            }\n        }\n    };\n    WorkbookChart.prototype.refreshChartData = function (args) {\n        var i;\n        var j = 1;\n        var cnt = this.parent.sheets.length + 1;\n        while (j < cnt) {\n            var charts = this.parent.chartColl;\n            i = charts ? charts.length : 0;\n            if (i) {\n                while (i--) {\n                    var chart = this.parent.chartColl[i];\n                    var isInRange = inRange(getRangeIndexes(chart.range), args.rIdx, args.cIdx);\n                    var rangeSheetIdx = chart.range.indexOf('!') > -1 ?\n                        getSheetIndex(this.parent, getSheetNameFromAddress(chart.range)) : this.parent.activeSheetIndex;\n                    if (isInRange && rangeSheetIdx === this.parent.activeSheetIndex) {\n                        this.parent.notify(updateChart, { chart: chart });\n                    }\n                }\n            }\n            j++;\n        }\n    };\n    WorkbookChart.prototype.refreshChartSize = function (args) {\n        var chartCnt;\n        var j = 1;\n        var sheetCnt = this.parent.sheets.length + 1;\n        while (j < sheetCnt) {\n            var charts = this.parent.chartColl;\n            chartCnt = charts ? charts.length : 0;\n            if (chartCnt) {\n                while (chartCnt--) {\n                    var chart = this.parent.chartColl[chartCnt];\n                    if (!isNullOrUndefined(args.overlayEle.querySelector('#' + chart.id))) {\n                        var chartObj = this.parent.element.querySelector('.' + chart.id);\n                        var excelFilter = getComponent(chartObj, 'chart');\n                        excelFilter.height = args.height;\n                        excelFilter.width = args.width;\n                    }\n                }\n            }\n            j++;\n        }\n    };\n    WorkbookChart.prototype.focusChartBorder = function (args) {\n        for (var idx = 0; idx < this.parent.chartColl.length; idx++) {\n            var overlayEle = document.getElementById(args.id);\n            var chartEle = document.getElementById(this.parent.chartColl[idx].id);\n            if (overlayEle && chartEle && closest(chartEle, '.' + overlayEle.classList[1]) === overlayEle) {\n                this.parent.notify(initiateChart, {\n                    option: this.parent.chartColl[idx], chartCount: this.parent.chartCount, isRefresh: true\n                });\n            }\n        }\n    };\n    WorkbookChart.prototype.deleteChartColl = function (args) {\n        for (var idx = 0; idx < this.parent.chartColl.length; idx++) {\n            var chartElement = document.getElementById(this.parent.chartColl[idx].id);\n            var overlayElement = document.getElementById(args.id);\n            if (overlayElement && chartElement && closest(chartElement, '.' + overlayElement.classList[1]) === overlayElement) {\n                this.parent.chartColl.splice(idx, 1);\n            }\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    WorkbookChart.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook chart module name.\n     */\n    WorkbookChart.prototype.getModuleName = function () {\n        return 'workbookChart';\n    };\n    return WorkbookChart;\n}());\nexport { WorkbookChart };\n","import { getRangeIndexes, setCellFormat, applyCellFormat, activeCellChanged } from '../common/index';\nimport { getSwapRange, textDecorationUpdate } from '../common/index';\nimport { clear, getIndexesFromAddress } from '../common/index';\nimport { getSheetIndex, isHiddenRow, getSheet, getCell, setCell } from '../base/index';\n/**\n * Workbook Cell format.\n */\nvar WorkbookCellFormat = /** @class */ (function () {\n    function WorkbookCellFormat(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookCellFormat.prototype.format = function (args) {\n        var sheet;\n        var rng = args.range;\n        var eventArgs;\n        if (rng && typeof rng === 'string' && rng.indexOf('!') > -1) {\n            rng = rng.split('!')[1];\n            sheet = this.parent.sheets[getSheetIndex(this.parent, args.range.split('!')[0])];\n        }\n        else {\n            sheet = this.parent.getActiveSheet();\n        }\n        if (rng === undefined) {\n            rng = sheet.selectedRange;\n        }\n        var triggerEvent = typeof (rng) !== 'object' && args.onActionUpdate;\n        eventArgs = { range: rng, style: args.style, requestType: 'CellFormat' };\n        if (triggerEvent) {\n            this.parent.trigger('beforeCellFormat', eventArgs);\n            this.parent.notify('actionBegin', { eventArgs: eventArgs, action: 'format' });\n            if (eventArgs.cancel) {\n                args.cancel = true;\n                return;\n            }\n        }\n        var indexes = typeof (eventArgs.range) === 'object' ? eventArgs.range :\n            getSwapRange(getRangeIndexes(eventArgs.range));\n        if (args.borderType) {\n            this.setTypedBorder(sheet, args.style.border, indexes, args.borderType, args.onActionUpdate);\n            delete args.style.border;\n        }\n        if (eventArgs.style.borderTop !== undefined) {\n            for (var i = indexes[1]; i <= indexes[3]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderBottom', indexes[0] - 1, i);\n                this.checkFullBorder(sheet, 'borderBottom', indexes[0] - 1, i);\n                this.checkFullBorder(sheet, 'borderTop', indexes[0], i);\n                this.setCellBorder(sheet, { borderTop: eventArgs.style.borderTop }, indexes[0], i, args.onActionUpdate, i === indexes[3]);\n            }\n            delete eventArgs.style.borderTop;\n        }\n        if (eventArgs.style.borderBottom !== undefined) {\n            for (var i = indexes[1]; i <= indexes[3]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderTop', indexes[2] + 1, i);\n                this.checkFullBorder(sheet, 'borderTop', indexes[2] + 1, i);\n                this.checkFullBorder(sheet, 'borderBottom', indexes[2], i);\n                this.setCellBorder(sheet, { borderBottom: eventArgs.style.borderBottom }, indexes[2], i, args.onActionUpdate, i === indexes[3]);\n                this.setBottomBorderPriority(sheet, indexes[2], i);\n            }\n            delete eventArgs.style.borderBottom;\n        }\n        if (eventArgs.style.borderLeft !== undefined) {\n            for (var i = indexes[0]; i <= indexes[2]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderRight', i, indexes[1] - 1);\n                this.checkFullBorder(sheet, 'borderRight', i, indexes[1] - 1);\n                this.checkFullBorder(sheet, 'borderLeft', i, indexes[1]);\n                this.setCellBorder(sheet, { borderLeft: eventArgs.style.borderLeft }, i, indexes[1], args.onActionUpdate);\n            }\n            delete eventArgs.style.borderLeft;\n        }\n        if (eventArgs.style.borderRight !== undefined) {\n            for (var i = indexes[0]; i <= indexes[2]; i++) {\n                this.checkAdjustantBorder(sheet, 'borderLeft', i, indexes[3] - 1);\n                this.checkFullBorder(sheet, 'borderLeft', i, indexes[3] - 1);\n                this.checkFullBorder(sheet, 'borderRight', i, indexes[3]);\n                this.setCellBorder(sheet, { borderRight: eventArgs.style.borderRight }, i, indexes[3], args.onActionUpdate);\n            }\n            delete eventArgs.style.borderRight;\n        }\n        var border;\n        var isFullBorder;\n        if (Object.keys(args.style).length) {\n            for (var i = indexes[0]; i <= indexes[2]; i++) {\n                for (var j = indexes[1]; j <= indexes[3]; j++) {\n                    if (isFullBorder === undefined) {\n                        if (eventArgs.style.border !== undefined) {\n                            border = eventArgs.style.border;\n                            eventArgs.style.border = undefined;\n                            isFullBorder = true;\n                        }\n                        else {\n                            isFullBorder = false;\n                        }\n                    }\n                    if (isFullBorder) {\n                        this.setFullBorder(sheet, border, indexes, i, j, args.onActionUpdate);\n                    }\n                    this.setCellStyle(sheet, i, j, eventArgs.style);\n                    if (this.parent.getActiveSheet().id === sheet.id) {\n                        this.parent.notify(applyCellFormat, { style: eventArgs.style, rowIdx: i, colIdx: j,\n                            lastCell: j === indexes[3], isHeightCheckNeeded: true, manualUpdate: true, onActionUpdate: args.onActionUpdate\n                        });\n                    }\n                }\n            }\n        }\n        if (isFullBorder) {\n            eventArgs.style.border = border;\n        }\n        this.parent.setUsedRange(indexes[2], indexes[3]);\n        if (args.refreshRibbon) {\n            this.parent.notify(activeCellChanged, null);\n        }\n        if (triggerEvent) {\n            eventArgs.range = sheet.name + \"!\" + rng;\n            this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'format' });\n        }\n    };\n    WorkbookCellFormat.prototype.setBottomBorderPriority = function (sheet, rowIdx, colIdx) {\n        if (isHiddenRow(sheet, rowIdx + 1)) {\n            var pIdx = this.skipHiddenRows(sheet, rowIdx + 1);\n            var pCellStyle = this.parent.getCellStyleValue(['borderTop'], [pIdx, colIdx]).borderTop;\n            if (pCellStyle !== '') {\n                sheet.rows[rowIdx].cells[colIdx].style.bottomPriority = true;\n            }\n        }\n    };\n    WorkbookCellFormat.prototype.setFullBorder = function (sheet, border, indexes, i, j, actionUpdate) {\n        var style = {};\n        if (i === indexes[0]) {\n            this.checkAdjustantBorder(sheet, 'borderBottom', i - 1, j);\n            this.checkFullBorder(sheet, 'borderBottom', i - 1, j);\n        }\n        if (j === indexes[1]) {\n            this.checkAdjustantBorder(sheet, 'borderRight', i, j - 1);\n            this.checkFullBorder(sheet, 'borderRight', i, j - 1);\n        }\n        if (j === indexes[3]) {\n            this.checkAdjustantBorder(sheet, 'borderLeft', i, j + 1);\n            this.checkFullBorder(sheet, 'borderLeft', i, j + 1);\n        }\n        else {\n            this.checkAdjustantBorder(sheet, 'border', i, j + 1);\n        }\n        style.borderRight = border;\n        style.borderTop = border;\n        style.borderLeft = border;\n        style.borderBottom = border;\n        this.setCellBorder(sheet, style, i, j, actionUpdate, j === indexes[3]);\n        if (i === indexes[2]) {\n            this.checkAdjustantBorder(sheet, 'borderTop', i + 1, j);\n            this.checkFullBorder(sheet, 'borderTop', i + 1, j);\n            this.setBottomBorderPriority(sheet, i, j);\n        }\n        else {\n            this.checkAdjustantBorder(sheet, 'border', i + 1, j);\n        }\n    };\n    WorkbookCellFormat.prototype.checkAdjustantBorder = function (sheet, prop, rowIdx, colIdx) {\n        var style = {};\n        if (this.parent.getCellStyleValue([prop], [rowIdx, colIdx])[prop] !== '') {\n            style[prop] = undefined;\n            this.setCellStyle(sheet, rowIdx, colIdx, style);\n        }\n    };\n    WorkbookCellFormat.prototype.checkFullBorder = function (sheet, prop, rowIdx, colIdx) {\n        var border = this.parent.getCellStyleValue(['border'], [rowIdx, colIdx]).border;\n        if (border !== '') {\n            var style_1 = { border: undefined };\n            ['borderBottom', 'borderTop', 'borderLeft', 'borderRight'].forEach(function (value) {\n                if (value !== prop) {\n                    style_1[value] = border;\n                }\n            });\n            this.setCellStyle(sheet, rowIdx, colIdx, style_1);\n        }\n    };\n    WorkbookCellFormat.prototype.textDecorationActionUpdate = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var eventArgs = { range: sheet.selectedRange, style: args.style, requestType: 'CellFormat' };\n        this.parent.trigger('beforeCellFormat', eventArgs);\n        this.parent.notify('actionBegin', { eventArgs: eventArgs, action: 'format' });\n        if (eventArgs.cancel) {\n            args.cancel = true;\n            return;\n        }\n        var indexes = getSwapRange(getRangeIndexes(sheet.selectedRange));\n        var value = args.style.textDecoration;\n        var changedValue = value;\n        var activeCellIndexes = getRangeIndexes(sheet.activeCell);\n        var cellValue = this.parent.getCellStyleValue(['textDecoration'], activeCellIndexes).textDecoration;\n        var changedStyle;\n        var removeProp = false;\n        if (cellValue === 'underline') {\n            changedValue = value === 'underline' ? 'none' : 'underline line-through';\n        }\n        else if (cellValue === 'line-through') {\n            changedValue = value === 'line-through' ? 'none' : 'underline line-through';\n        }\n        else if (cellValue === 'underline line-through') {\n            changedValue = value === 'underline' ? 'line-through' : 'underline';\n            removeProp = true;\n        }\n        if (changedValue === 'none') {\n            removeProp = true;\n        }\n        this.format({\n            style: { textDecoration: changedValue }, range: activeCellIndexes, refreshRibbon: args.refreshRibbon,\n            onActionUpdate: true\n        });\n        for (var i = indexes[0]; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                if (i === activeCellIndexes[0] && j === activeCellIndexes[1]) {\n                    continue;\n                }\n                changedStyle = {};\n                cellValue = this.parent.getCellStyleValue(['textDecoration'], [i, j]).textDecoration;\n                if (cellValue === 'none') {\n                    if (removeProp) {\n                        continue;\n                    }\n                    changedStyle.textDecoration = value;\n                }\n                else if (cellValue === 'underline' || cellValue === 'line-through') {\n                    if (removeProp) {\n                        if (value === cellValue) {\n                            changedStyle.textDecoration = 'none';\n                        }\n                        else {\n                            continue;\n                        }\n                    }\n                    else {\n                        changedStyle.textDecoration = value !== cellValue ? 'underline line-through' : value;\n                    }\n                }\n                else if (cellValue === 'underline line-through') {\n                    if (removeProp) {\n                        changedStyle.textDecoration = value === 'underline' ? 'line-through' : 'underline';\n                    }\n                    else {\n                        continue;\n                    }\n                }\n                this.format({\n                    style: changedStyle, range: [i, j, i, j], refreshRibbon: args.refreshRibbon,\n                    onActionUpdate: true\n                });\n            }\n        }\n        eventArgs.range = sheet.name + '!' + eventArgs.range;\n        this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'format' });\n    };\n    WorkbookCellFormat.prototype.setTypedBorder = function (sheet, border, range, type, actionUpdate) {\n        var prevBorder;\n        if (type === 'Outer') {\n            for (var colIdx = range[1]; colIdx <= range[3]; colIdx++) {\n                this.checkAdjustantBorder(sheet, 'borderBottom', range[0] - 1, colIdx);\n                this.checkFullBorder(sheet, 'borderBottom', range[0] - 1, colIdx);\n                this.setCellBorder(sheet, { borderTop: border }, range[0], colIdx, actionUpdate, colIdx === range[3]);\n                this.checkAdjustantBorder(sheet, 'borderTop', range[2] + 1, colIdx);\n                this.checkFullBorder(sheet, 'borderTop', range[2] + 1, colIdx);\n                this.setCellBorder(sheet, { borderBottom: border }, range[2], colIdx, actionUpdate, colIdx === range[3]);\n                this.setBottomBorderPriority(sheet, range[2], colIdx);\n            }\n            for (var rowIdx = range[0]; rowIdx <= range[2]; rowIdx++) {\n                this.checkAdjustantBorder(sheet, 'borderRight', rowIdx, range[1] - 1);\n                this.checkFullBorder(sheet, 'borderRight', rowIdx, range[1] - 1);\n                this.setCellBorder(sheet, { borderLeft: border }, rowIdx, range[1], actionUpdate);\n                this.checkAdjustantBorder(sheet, 'borderLeft', rowIdx, range[3] + 1);\n                this.checkFullBorder(sheet, 'borderLeft', rowIdx, range[3] + 1);\n                this.setCellBorder(sheet, { borderRight: border }, rowIdx, range[3], actionUpdate);\n            }\n        }\n        else if (type === 'Inner') {\n            for (var i = range[0]; i <= range[2]; i++) {\n                for (var j = range[1]; j <= range[3]; j++) {\n                    var style = {};\n                    prevBorder = this.parent.getCellStyleValue(['border'], [i, j]).border;\n                    if (prevBorder !== '') {\n                        style.border = undefined;\n                        if (j === range[3] || j === range[1] || i === range[0] || i === range[2]) {\n                            if (i === range[0]) {\n                                style.borderTop = prevBorder;\n                            }\n                            if (i === range[2]) {\n                                style.borderBottom = prevBorder;\n                            }\n                            if (j === range[3]) {\n                                style.borderRight = prevBorder;\n                            }\n                            if (j === range[1]) {\n                                style.borderLeft = prevBorder;\n                            }\n                        }\n                    }\n                    if (j !== range[3]) {\n                        style.borderRight = border;\n                    }\n                    if (i !== range[0]) {\n                        style.borderTop = border;\n                    }\n                    if (i !== range[2]) {\n                        style.borderBottom = border;\n                    }\n                    if (j !== range[1]) {\n                        style.borderLeft = border;\n                    }\n                    this.setCellBorder(sheet, style, i, j, actionUpdate, j === range[3]);\n                }\n            }\n        }\n        else if (type === 'Vertical') {\n            for (var i = range[0]; i <= range[2]; i++) {\n                for (var j = range[1]; j <= range[3]; j++) {\n                    var style = { borderRight: border, borderLeft: border };\n                    if (j === range[1]) {\n                        this.checkAdjustantBorder(sheet, 'borderRight', i, j - 1);\n                        this.checkFullBorder(sheet, 'borderRight', i, j - 1);\n                    }\n                    if (j === range[3]) {\n                        this.checkAdjustantBorder(sheet, 'borderLeft', i, j + 1);\n                        this.checkFullBorder(sheet, 'borderLeft', i, j + 1);\n                    }\n                    this.setCellBorder(sheet, style, i, j, actionUpdate);\n                }\n            }\n        }\n        else {\n            for (var i = range[0]; i <= range[2]; i++) {\n                for (var j = range[1]; j <= range[3]; j++) {\n                    var style = { borderTop: border, borderBottom: border };\n                    if (i === range[0]) {\n                        this.checkAdjustantBorder(sheet, 'borderBottom', i - 1, j);\n                        this.checkFullBorder(sheet, 'borderBottom', i - 1, j);\n                    }\n                    this.setCellBorder(sheet, style, i, j, actionUpdate, j === range[3]);\n                    if (i === range[2]) {\n                        this.checkAdjustantBorder(sheet, 'borderTop', i + 1, j);\n                        this.checkFullBorder(sheet, 'borderTop', i + 1, j);\n                        this.setBottomBorderPriority(sheet, i, j);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookCellFormat.prototype.setCellBorder = function (sheet, style, rowIdx, colIdx, actionUpdate, lastCell) {\n        this.setCellStyle(sheet, rowIdx, colIdx, style);\n        if (this.parent.getActiveSheet().id === sheet.id) {\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: rowIdx, colIdx: colIdx, onActionUpdate: actionUpdate, first: '', lastCell: lastCell,\n                isHeightCheckNeeded: true, manualUpdate: true\n            });\n        }\n    };\n    WorkbookCellFormat.prototype.setCellStyle = function (sheet, rowIdx, colIdx, style) {\n        if (!sheet.rows[rowIdx]) {\n            sheet.rows[rowIdx] = { cells: [] };\n        }\n        else if (!sheet.rows[rowIdx].cells) {\n            sheet.rows[rowIdx].cells = [];\n        }\n        if (!sheet.rows[rowIdx].cells[colIdx]) {\n            sheet.rows[rowIdx].cells[colIdx] = {};\n        }\n        if (!sheet.rows[rowIdx].cells[colIdx].style) {\n            sheet.rows[rowIdx].cells[colIdx].style = {};\n        }\n        Object.assign(sheet.rows[rowIdx].cells[colIdx].style, style, null, true);\n    };\n    WorkbookCellFormat.prototype.skipHiddenRows = function (sheet, startIdx) {\n        startIdx++;\n        if (isHiddenRow(sheet, startIdx)) {\n            startIdx = this.skipHiddenRows(sheet, startIdx);\n        }\n        return startIdx;\n    };\n    WorkbookCellFormat.prototype.addEventListener = function () {\n        this.parent.on(setCellFormat, this.format, this);\n        this.parent.on(textDecorationUpdate, this.textDecorationActionUpdate, this);\n        this.parent.on(clear, this.clearCellObj, this);\n    };\n    WorkbookCellFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setCellFormat, this.format);\n            this.parent.off(textDecorationUpdate, this.textDecorationActionUpdate);\n            this.parent.off(clear, this.clearCellObj);\n        }\n    };\n    WorkbookCellFormat.prototype.clearCellObj = function (options) {\n        var clrRange = options.range ? (options.range.indexOf('!') > 0) ? options.range.split('!')[1] : options.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIdx = (options.range && options.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, options.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var sheet = getSheet(this.parent, sheetIdx);\n        var range = getIndexesFromAddress(clrRange);\n        var sRowIdx = range[0];\n        var eRowIdx = range[2];\n        var sColIdx;\n        var eColIdx;\n        for (sRowIdx; sRowIdx <= eRowIdx; sRowIdx++) {\n            sColIdx = range[1];\n            eColIdx = range[3];\n            for (sColIdx; sColIdx <= eColIdx; sColIdx++) {\n                var cell = getCell(sRowIdx, sColIdx, sheet);\n                if (cell) {\n                    switch (options.type) {\n                        case 'Clear Formats':\n                            delete cell.format;\n                            delete cell.rowSpan;\n                            delete cell.style;\n                            delete cell.wrap;\n                            delete cell.colSpan;\n                            break;\n                        case 'Clear Contents':\n                            delete cell.value;\n                            delete cell.formula;\n                            break;\n                        case 'Clear Hyperlinks':\n                            delete cell.hyperlink;\n                            break;\n                        case 'Clear All':\n                            setCell(sRowIdx, sColIdx, sheet, {}, false);\n                            break;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * To destroy workbook cell format.\n     */\n    WorkbookCellFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook cell format module name.\n     */\n    WorkbookCellFormat.prototype.getModuleName = function () {\n        return 'workbookcellformat';\n    };\n    return WorkbookCellFormat;\n}());\nexport { WorkbookCellFormat };\n","import { getCell, getSheet } from '../base/index';\nimport { workbookEditOperation, checkDateFormat, workbookFormulaOperation, refreshChart } from '../common/event';\nimport { getRangeIndexes, parseIntValue } from '../common/index';\nimport { isNullOrUndefined, getNumericObject } from '@syncfusion/ej2-base';\nimport { checkIsFormula } from '../../workbook/common/index';\nimport { getTypeFromFormat } from '../integrations/index';\n/**\n * The `WorkbookEdit` module is used to handle the editing functionalities in Workbook.\n */\nvar WorkbookEdit = /** @class */ (function () {\n    /**\n     * Constructor for edit module in Workbook.\n     * @private\n     */\n    function WorkbookEdit(workbook) {\n        this.parent = workbook;\n        this.localeObj = getNumericObject(this.parent.locale);\n        /* tslint:disable:no-any */\n        this.decimalSep = this.localeObj.decimal;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the edit module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookEdit.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookEdit.prototype.addEventListener = function () {\n        this.parent.on(workbookEditOperation, this.performEditOperation, this);\n    };\n    WorkbookEdit.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(workbookEditOperation, this.performEditOperation);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookEdit.prototype.getModuleName = function () {\n        return 'workbookEdit';\n    };\n    WorkbookEdit.prototype.performEditOperation = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'updateCellValue':\n                this.updateCellValue(args.address, args.value, args.sheetIndex, args.isValueOnly);\n                break;\n        }\n    };\n    WorkbookEdit.prototype.checkDecimalPoint = function (value) {\n        if (Number(value)) {\n            var decIndex = value.toString().indexOf(this.decimalSep) + 1;\n            var checkDec = value.toString().substr(decIndex).length <= 6;\n            value = checkDec ? decIndex < 7 ? value : (parseFloat(value)).toFixed(0) : decIndex > 7 ? (parseFloat(value)).toFixed(0) :\n                (parseFloat(value)).toFixed(6 - decIndex + 2);\n        }\n        return value;\n    };\n    WorkbookEdit.prototype.updateCellValue = function (address, value, sheetIdx, isValueOnly) {\n        if (isValueOnly === void 0) { isValueOnly = false; }\n        if (sheetIdx === undefined) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var range;\n        if (typeof address === 'string') {\n            range = getRangeIndexes(address);\n        }\n        else {\n            range = address;\n        }\n        var sheet = getSheet(this.parent, sheetIdx);\n        if (!sheet.rows[range[0]]) {\n            sheet.rows[range[0]] = {};\n            sheet.rows[range[0]].cells = [];\n        }\n        if (!sheet.rows[range[0]].cells) {\n            sheet.rows[range[0]].cells = [];\n        }\n        if (!sheet.rows[range[0]].cells[range[1]]) {\n            sheet.rows[range[0]].cells[range[1]] = {};\n        }\n        var cell = getCell(range[0], range[1], sheet);\n        if (!isValueOnly) {\n            var isFormula = checkIsFormula(value);\n            if (!isFormula) {\n                cell.formula = '';\n                cell.value = parseIntValue(value);\n            }\n            var eventArgs = {\n                action: 'refreshCalculate',\n                value: value,\n                rowIndex: range[0],\n                colIndex: range[1],\n                sheetIndex: sheetIdx,\n                isFormula: isFormula\n            };\n            if (getTypeFromFormat(cell.format) !== 'Text') {\n                var dateEventArgs = {\n                    value: value,\n                    rowIndex: range[0],\n                    colIndex: range[1],\n                    sheetIndex: sheetIdx,\n                    updatedVal: ''\n                };\n                this.parent.notify(checkDateFormat, dateEventArgs);\n                if (!isNullOrUndefined(dateEventArgs.updatedVal) && dateEventArgs.updatedVal.length > 0) {\n                    cell.value = dateEventArgs.updatedVal;\n                }\n            }\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            if (isFormula) {\n                cell.formula = eventArgs.value;\n                value = cell.value;\n            }\n        }\n        else {\n            if (value && value.toString().indexOf(this.decimalSep) > -1) {\n                value = this.checkDecimalPoint(value);\n            }\n            cell.value = value;\n        }\n        this.parent.setUsedRange(range[0], range[1]);\n        if (this.parent.allowChart) {\n            this.parent.notify(refreshChart, { cell: cell, rIdx: range[0], cIdx: range[1], sheetIdx: sheetIdx });\n        }\n    };\n    return WorkbookEdit;\n}());\nexport { WorkbookEdit };\n","import { setLinkModel } from '../common/event';\nimport { getRangeIndexes } from '../common/address';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookHyperlink` module is used to handle Hyperlink action in Spreadsheet.\n */\nvar WorkbookHyperlink = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookSort module.\n     */\n    function WorkbookHyperlink(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     */\n    WorkbookHyperlink.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookHyperlink.prototype.addEventListener = function () {\n        this.parent.on(setLinkModel, this.setLinkHandler, this);\n    };\n    WorkbookHyperlink.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setLinkModel, this.setLinkHandler);\n        }\n    };\n    WorkbookHyperlink.prototype.setLinkHandler = function (args) {\n        var hyperlink = args.hyperlink;\n        var cellAddr = args.cell;\n        var range;\n        var sheetIdx;\n        var cellIdx;\n        var sheet = this.parent.getActiveSheet();\n        var address;\n        if (cellAddr && cellAddr.indexOf('!') !== -1) {\n            range = cellAddr.split('!');\n            var sheets = this.parent.sheets;\n            for (var idx = 0; idx < sheets.length; idx++) {\n                if (sheets[idx].name === range[0]) {\n                    sheetIdx = idx;\n                }\n            }\n            sheet = this.parent.sheets[sheetIdx];\n            cellAddr = range[1];\n        }\n        cellAddr = cellAddr ? cellAddr : this.parent.getActiveSheet().activeCell;\n        cellIdx = getRangeIndexes(cellAddr);\n        var rowIdx = cellIdx[0];\n        var colIdx = cellIdx[1];\n        if (!sheet) {\n            return;\n        }\n        if (isNullOrUndefined(sheet.rows[rowIdx])) {\n            sheet.rows[rowIdx] = {};\n        }\n        if (isNullOrUndefined(sheet.rows[rowIdx].cells)) {\n            sheet.rows[rowIdx].cells = [];\n        }\n        if (isNullOrUndefined(sheet.rows[rowIdx].cells[colIdx])) {\n            sheet.rows[rowIdx].cells[colIdx] = {};\n        }\n        if (typeof (hyperlink) === 'string') {\n            if (hyperlink.indexOf('http://') !== 0 && hyperlink.indexOf('https://') !== 0 && hyperlink.indexOf('ftp://') !== 0) {\n                hyperlink = hyperlink.toLowerCase().indexOf('www.') === 0 ? 'http://' + hyperlink : hyperlink;\n                address = hyperlink;\n            }\n            sheet.rows[rowIdx].cells[colIdx].hyperlink = hyperlink;\n        }\n        else {\n            address = hyperlink.address;\n            if (address.indexOf('http://') !== 0 && address.indexOf('https://') !== 0 && address.indexOf('ftp://') !== 0) {\n                address = address.toLowerCase().indexOf('www.') === 0 ? 'http://' + address : address;\n            }\n            sheet.rows[rowIdx].cells[colIdx].hyperlink = {\n                address: address,\n            };\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookHyperlink.prototype.getModuleName = function () {\n        return 'workbookHyperlink';\n    };\n    return WorkbookHyperlink;\n}());\nexport { WorkbookHyperlink };\n","import { insert, insertModel, workbookFormulaOperation, } from '../../workbook/common/index';\nimport { insertMerge } from '../../workbook/common/index';\n/**\n * The `WorkbookInsert` module is used to insert cells, rows, columns and sheets in to workbook.\n */\nvar WorkbookInsert = /** @class */ (function () {\n    /**\n     * Constructor for the workbook insert module.\n     * @private\n     */\n    function WorkbookInsert(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    // tslint:disable-next-line\n    WorkbookInsert.prototype.insertModel = function (args) {\n        var _this = this;\n        var _a, _b, _c;\n        if (!args.model) {\n            return;\n        }\n        var index;\n        var model = [];\n        var mergeCollection;\n        var isModel;\n        if (typeof (args.start) === 'number') {\n            index = args.start;\n            args.end = args.end || index;\n            if (index > args.end) {\n                index = args.end;\n                args.end = args.start;\n            }\n            for (var i = index; i <= args.end; i++) {\n                model.push({});\n            }\n        }\n        else {\n            if (args.start) {\n                index = args.start[0].index || 0;\n                model = args.start;\n                isModel = true;\n            }\n            else {\n                index = 0;\n                model.push({});\n            }\n        }\n        if (args.modelType === 'Row') {\n            args.model = args.model;\n            if (!args.model.rows) {\n                args.model.rows = [];\n            }\n            if (isModel && args.model.usedRange.rowIndex > -1 && index > args.model.usedRange.rowIndex) {\n                for (var i = args.model.usedRange.rowIndex; i < index - 1; i++) {\n                    model.splice(0, 0, {});\n                }\n            }\n            (_a = args.model.rows).splice.apply(_a, [index, 0].concat(model));\n            //this.setInsertInfo(args.model, index, model.length, 'count');\n            if (index > args.model.usedRange.rowIndex) {\n                this.parent.setUsedRange(index + (model.length - 1), args.model.usedRange.colIndex, args.model);\n            }\n            else {\n                this.parent.setUsedRange(args.model.usedRange.rowIndex + model.length, args.model.usedRange.colIndex, args.model);\n            }\n            var curIdx = index + model.length;\n            for (var i = 0; i <= args.model.usedRange.colIndex; i++) {\n                if (args.model.rows[curIdx] && args.model.rows[curIdx].cells && args.model.rows[curIdx].cells[i] &&\n                    args.model.rows[curIdx].cells[i].rowSpan !== undefined && args.model.rows[curIdx].cells[i].rowSpan < 0 &&\n                    args.model.rows[curIdx].cells[i].colSpan === undefined) {\n                    this.parent.notify(insertMerge, {\n                        range: [curIdx, i, curIdx, i], insertCount: model.length,\n                        insertModel: 'Row'\n                    });\n                }\n            }\n        }\n        else if (args.modelType === 'Column') {\n            args.model = args.model;\n            if (!args.model.columns) {\n                args.model.columns = [];\n            }\n            (_b = args.model.columns).splice.apply(_b, [index, 0].concat(model));\n            //this.setInsertInfo(args.model, index, model.length, 'fldLen', 'Column');\n            if (index > args.model.usedRange.colIndex) {\n                this.parent.setUsedRange(args.model.usedRange.rowIndex, index + (model.length - 1), args.model);\n            }\n            else {\n                this.parent.setUsedRange(args.model.usedRange.rowIndex, args.model.usedRange.colIndex + model.length, args.model);\n            }\n            if (!args.model.rows) {\n                args.model.rows = [];\n            }\n            var cellModel = [];\n            if (!args.columnCellsModel) {\n                args.columnCellsModel = [];\n            }\n            for (var i = 0; i < model.length; i++) {\n                cellModel.push(null);\n            }\n            mergeCollection = [];\n            for (var i = 0; i <= args.model.usedRange.rowIndex; i++) {\n                if (!args.model.rows[i]) {\n                    args.model.rows[i] = { cells: [] };\n                }\n                else if (!args.model.rows[i].cells) {\n                    args.model.rows[i].cells = [];\n                }\n                if (index && !args.model.rows[i].cells[index - 1]) {\n                    args.model.rows[i].cells[index - 1] = {};\n                }\n                (_c = args.model.rows[i].cells).splice.apply(_c, [index, 0].concat((args.columnCellsModel[i] && args.columnCellsModel[i].cells ?\n                    args.columnCellsModel[i].cells : cellModel)));\n                var curIdx = index + model.length;\n                if (args.model.rows[i].cells[curIdx] && args.model.rows[i].cells[curIdx].colSpan !== undefined &&\n                    args.model.rows[i].cells[curIdx].colSpan < 0 && args.model.rows[i].cells[curIdx].rowSpan === undefined) {\n                    mergeCollection.push({\n                        range: [i, curIdx, i, curIdx], insertCount: cellModel.length,\n                        insertModel: 'Column'\n                    });\n                }\n            }\n            mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(insertMerge, mergeArgs); });\n        }\n        else {\n            if (args.checkCount !== undefined && args.checkCount === this.parent.sheets.length) {\n                return;\n            }\n            var sheetModel = model;\n            for (var i = 0; i < sheetModel.length; i++) {\n                if (sheetModel[i].name) {\n                    for (var j = 0; j < this.parent.sheets.length; j++) {\n                        if (sheetModel[i].name === this.parent.sheets[j].name) {\n                            sheetModel.splice(i, 1);\n                            i--;\n                            break;\n                        }\n                    }\n                }\n            }\n            if (!sheetModel.length) {\n                return;\n            }\n            delete model[0].index;\n            this.parent.createSheet(index, model);\n            var id_1;\n            if (args.activeSheetIndex) {\n                this.parent.setProperties({ activeSheetIndex: args.activeSheetIndex }, true);\n            }\n            else if (!args.isAction && args.start < this.parent.activeSheetIndex) {\n                this.parent.setProperties({ activeSheetIndex: this.parent.skipHiddenSheets(this.parent.activeSheetIndex) }, true);\n            }\n            model.forEach(function (sheet) {\n                if (isModel) {\n                    _this.updateRangeModel(sheet.ranges);\n                }\n                id_1 = sheet.id;\n                _this.parent.notify(workbookFormulaOperation, {\n                    action: 'addSheet', visibleName: sheet.name, sheetName: 'Sheet' + id_1, index: id_1\n                });\n            });\n        }\n        var insertArgs = {\n            action: 'refreshNamedRange', insertArgs: {\n                model: model, index: index, modelType: args.modelType, isAction: args.isAction, activeSheetIndex: args.activeSheetIndex, sheetCount: this.parent.sheets.length, name: 'insert'\n            }\n        };\n        var eventArgs = {\n            action: 'refreshInsDelFormula', insertArgs: {\n                model: model, startIndex: args.start, endIndex: args.end, modelType: args.modelType, name: 'insert', activeSheetIndex: args.activeSheetIndex, sheetCount: this.parent.sheets.length\n            }\n        };\n        if (args.modelType !== 'Sheet') {\n            this.parent.notify(workbookFormulaOperation, insertArgs);\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            if (args.model !== this.parent.getActiveSheet()) {\n                return;\n            }\n        }\n        this.parent.notify(insert, {\n            model: model, index: index, modelType: args.modelType, isAction: args.isAction, activeSheetIndex: args.activeSheetIndex, sheetCount: this.parent.sheets.length, insertType: args.insertType\n        });\n    };\n    WorkbookInsert.prototype.updateRangeModel = function (ranges) {\n        ranges.forEach(function (range) {\n            if (range.dataSource) {\n                range.startCell = range.startCell || 'A1';\n                range.showFieldAsHeader = range.showFieldAsHeader === undefined || range.showFieldAsHeader;\n                range.template = range.template || '';\n                range.address = range.address || 'A1';\n            }\n        });\n    };\n    WorkbookInsert.prototype.setInsertInfo = function (sheet, startIndex, count, totalKey, modelType) {\n        if (modelType === void 0) { modelType = 'Row'; }\n        var endIndex = count = startIndex + (count - 1);\n        sheet.ranges.forEach(function (range) {\n            if (range.info && startIndex < range.info[totalKey]) {\n                if (!range.info[\"insert\" + modelType + \"Range\"]) {\n                    range.info[\"insert\" + modelType + \"Range\"] = [[startIndex, endIndex]];\n                }\n                else {\n                    range.info[\"insert\" + modelType + \"Range\"].push([startIndex, endIndex]);\n                }\n                range.info[totalKey] += ((endIndex - startIndex) + 1);\n            }\n        });\n    };\n    WorkbookInsert.prototype.addEventListener = function () {\n        this.parent.on(insertModel, this.insertModel, this);\n    };\n    /**\n     * Destroy workbook insert module.\n     */\n    WorkbookInsert.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookInsert.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(insertModel, this.insertModel);\n        }\n    };\n    /**\n     * Get the workbook insert module name.\n     */\n    WorkbookInsert.prototype.getModuleName = function () {\n        return 'workbookinsert';\n    };\n    return WorkbookInsert;\n}());\nexport { WorkbookInsert };\n","import { getCell, setCell } from '../base/index';\nimport { deleteModel, deleteAction, updateUsedRange } from '../../workbook/common/index';\nimport { activeCellMergedRange, setMerge, workbookFormulaOperation } from '../../workbook/common/index';\n/**\n * The `WorkbookDelete` module is used to delete cells, rows, columns and sheets from workbook.\n */\nvar WorkbookDelete = /** @class */ (function () {\n    /**\n     * Constructor for the workbook delete module.\n     * @private\n     */\n    function WorkbookDelete(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    // tslint:disable-next-line\n    WorkbookDelete.prototype.deleteModel = function (args) {\n        var _this = this;\n        var sheetLength = this.parent.sheets.length;\n        if (args.modelType === 'Sheet' && sheetLength === 1) {\n            return;\n        }\n        var modelName = args.modelType.toLowerCase() + \"s\";\n        args.start = args.start;\n        if (args.start > args.end) {\n            var temp = args.start;\n            args.start = args.end;\n            args.end = temp;\n        }\n        var deletedCells;\n        var mergeArgsCollection = [];\n        var count = (args.end - args.start) + 1;\n        var range;\n        var prevCell;\n        if (args.modelType === 'Row') {\n            args.model = args.model;\n            if (args.start > args.model.usedRange.rowIndex) {\n                return;\n            }\n            if (args.end > args.model.usedRange.rowIndex) {\n                args.end -= (args.end - args.model.usedRange.rowIndex);\n            }\n            args.model.usedRange.rowIndex -= ((args.end - args.start) + 1);\n            if (args.model.usedRange.rowIndex < 0) {\n                args.model.usedRange.rowIndex = 0;\n            }\n            if (args.model !== this.parent.getActiveSheet()) {\n                this.parent.notify(updateUsedRange, { index: args.model.usedRange.rowIndex, update: 'row' });\n            }\n            var curIdx = args.end + 1;\n            var cell = void 0;\n            var mergeArgs = void 0;\n            if (args.model.rows[args.start] && args.model.rows[args.start].cells) {\n                for (var i = 0; i <= args.model.usedRange.colIndex; i++) {\n                    if (args.model.rows[args.start].cells[i] && args.model.rows[args.start].cells[i].rowSpan !== undefined &&\n                        args.model.rows[args.start].cells[i].rowSpan < 0 && args.model.rows[args.start].cells[i].colSpan === undefined) {\n                        mergeArgs = { range: [args.start, i, args.start, i] };\n                        this.parent.notify(activeCellMergedRange, mergeArgs);\n                        mergeArgs.range = mergeArgs.range;\n                        if (mergeArgs.range[2] <= args.end) {\n                            prevCell = getCell(mergeArgs.range[0], i, args.model);\n                            if (prevCell && prevCell.rowSpan > 1) {\n                                if (prevCell.rowSpan - ((mergeArgs.range[2] - args.start) + 1) > 1) {\n                                    setCell(mergeArgs.range[0], i, args.model, { colSpan: prevCell.rowSpan - ((mergeArgs.range[2] - args.start) + 1) }, true);\n                                }\n                                else {\n                                    delete args.model.rows[mergeArgs.range[0]].cells[i].rowSpan;\n                                }\n                            }\n                            mergeArgs = null;\n                        }\n                    }\n                    if (args.model.rows[curIdx] && args.model.rows[curIdx].cells && args.model.rows[curIdx].cells[i] &&\n                        args.model.rows[curIdx].cells[i].rowSpan !== undefined &&\n                        args.model.rows[curIdx].cells[i].rowSpan < 0 && args.model.rows[curIdx].cells[i].colSpan === undefined) {\n                        if (!mergeArgs) {\n                            mergeArgs = { range: [curIdx, i, curIdx, i] };\n                            this.parent.notify(activeCellMergedRange, mergeArgs);\n                        }\n                        cell = new Object();\n                        mergeArgs.range = mergeArgs.range;\n                        Object.assign(cell, getCell(mergeArgs.range[0], mergeArgs.range[1], args.model));\n                        if (cell && cell.rowSpan && (cell.rowSpan > 1 || cell.colSpan > 1)) {\n                            var indexes = [];\n                            indexes[1] = i;\n                            indexes[3] = cell.colSpan > 1 ? i + (cell.colSpan - 1) : i;\n                            mergeArgs.range = mergeArgs.range;\n                            if (mergeArgs.range[0] < args.start) {\n                                indexes[0] = indexes[2] = mergeArgs.range[0];\n                                if (cell.rowSpan - count > 1) {\n                                    indexes[2] += (cell.rowSpan - count - 1);\n                                }\n                            }\n                            else {\n                                indexes[0] = indexes[2] = args.start;\n                                if (cell.rowSpan - ((args.end - mergeArgs.range[0]) + 1) > 1) {\n                                    indexes[2] += ((cell.rowSpan - ((args.end - mergeArgs.range[0]) + 1)) - 1);\n                                }\n                            }\n                            mergeArgsCollection.push({\n                                range: indexes, isAction: false, preventRefresh: true, merge: true,\n                                type: 'All', skipChecking: true\n                            });\n                        }\n                    }\n                    mergeArgs = null;\n                }\n            }\n        }\n        else if (args.modelType === 'Column') {\n            args.model = args.model;\n            if (args.start > args.model.usedRange.colIndex) {\n                return;\n            }\n            if (args.end > args.model.usedRange.colIndex) {\n                args.end -= (args.end - args.model.usedRange.colIndex);\n            }\n            args.model.usedRange.colIndex -= count;\n            if (args.model.usedRange.colIndex < 0) {\n                args.model.usedRange.colIndex = 0;\n            }\n            //this.setDeleteInfo(args.start, args.end, 'fldLen', 'Column');\n            if (args.model !== this.parent.getActiveSheet()) {\n                this.parent.notify(updateUsedRange, { index: args.model.usedRange.colIndex, update: 'col' });\n            }\n            deletedCells = [];\n            var curIdx = args.end + 1;\n            var cell = void 0;\n            var mergeArgs = void 0;\n            for (var i = 0; i <= args.model.usedRange.rowIndex; i++) {\n                deletedCells.push({});\n                if (args.model.rows[i] && args.model.rows[i].cells) {\n                    if (args.model.rows[i].cells[args.start] && args.model.rows[i].cells[args.start].colSpan !== undefined &&\n                        args.model.rows[i].cells[args.start].colSpan < 0 && args.model.rows[i].cells[args.start].rowSpan === undefined) {\n                        mergeArgs = { range: [i, args.start, i, args.start] };\n                        this.parent.notify(activeCellMergedRange, mergeArgs);\n                        mergeArgs.range = mergeArgs.range;\n                        if (mergeArgs.range[3] <= args.end) {\n                            var prevCell_1 = getCell(i, mergeArgs.range[1], args.model);\n                            if (prevCell_1 && prevCell_1.colSpan > 1) {\n                                if (prevCell_1.colSpan - ((mergeArgs.range[3] - args.start) + 1) > 1) {\n                                    setCell(i, mergeArgs.range[1], args.model, { colSpan: prevCell_1.colSpan - ((mergeArgs.range[3] - args.start) + 1) }, true);\n                                }\n                                else {\n                                    delete args.model.rows[i].cells[mergeArgs.range[1]].colSpan;\n                                }\n                            }\n                            mergeArgs = null;\n                        }\n                    }\n                    if (args.model.rows[i].cells[curIdx] && args.model.rows[i].cells[curIdx].colSpan !== undefined &&\n                        args.model.rows[i].cells[curIdx].colSpan < 0 && args.model.rows[i].cells[curIdx].rowSpan === undefined) {\n                        if (!mergeArgs) {\n                            mergeArgs = { range: [i, curIdx, i, curIdx] };\n                            this.parent.notify(activeCellMergedRange, mergeArgs);\n                        }\n                        cell = new Object();\n                        mergeArgs.range = mergeArgs.range;\n                        Object.assign(cell, getCell(mergeArgs.range[0], mergeArgs.range[1], args.model));\n                        if (cell && cell.colSpan && (cell.colSpan > 1 || cell.rowSpan > 1)) {\n                            var indexes = [];\n                            indexes[0] = i;\n                            indexes[2] = cell.rowSpan > 1 ? i + (cell.rowSpan - 1) : i;\n                            mergeArgs.range = mergeArgs.range;\n                            if (mergeArgs.range[1] < args.start) {\n                                indexes[1] = indexes[3] = mergeArgs.range[1];\n                                if (cell.colSpan - count > 1) {\n                                    indexes[3] += (cell.colSpan - count - 1);\n                                }\n                            }\n                            else {\n                                indexes[1] = indexes[3] = args.start;\n                                if (cell.colSpan - ((args.end - mergeArgs.range[1]) + 1) > 1) {\n                                    indexes[3] += ((cell.colSpan - ((args.end - mergeArgs.range[1]) + 1)) - 1);\n                                }\n                            }\n                            mergeArgsCollection.push({\n                                range: indexes, isAction: false, preventRefresh: true, merge: true,\n                                type: 'All', skipChecking: true\n                            });\n                        }\n                    }\n                    deletedCells[i].cells = args.model.rows[i].cells.splice(args.start, count);\n                    mergeArgs = null;\n                }\n            }\n        }\n        else {\n            if (args.end - args.start === this.parent.sheets.length - 1) {\n                return;\n            }\n        }\n        var deletedModel = [];\n        for (var i = args.start; i <= args.end; i++) {\n            if (args.model[modelName][args.start]) {\n                deletedModel.push(args.model[modelName][args.start]);\n                args.model[modelName].splice(args.start, 1);\n            }\n            else {\n                deletedModel.push({});\n            }\n            if (i === args.start) {\n                deletedModel[0].index = args.start;\n            }\n        }\n        mergeArgsCollection.forEach(function (merge) { _this.parent.notify(setMerge, merge); });\n        var insertArgs = {\n            action: 'refreshNamedRange', insertArgs: {\n                startIndex: args.start, endIndex: args.end, modelType: args.modelType,\n                isAction: args.isAction, deletedModel: deletedModel, deletedCellsModel: deletedCells,\n                activeSheetIndex: this.parent.activeSheetIndex, name: 'delete'\n            }\n        };\n        var eventArgs = {\n            action: 'refreshInsDelFormula', insertArgs: {\n                model: deletedModel, startIndex: args.start, endIndex: args.end, modelType: args.modelType,\n                name: 'delete', activeSheetIndex: args.activeSheetIndex, sheetCount: this.parent.sheets.length\n            }\n        };\n        this.parent.notify(workbookFormulaOperation, insertArgs);\n        this.parent.notify(workbookFormulaOperation, eventArgs);\n        if (args.modelType !== 'Sheet' && args.model !== this.parent.getActiveSheet()) {\n            return;\n        }\n        this.parent.notify(deleteAction, {\n            startIndex: args.start, endIndex: args.end, modelType: args.modelType,\n            isAction: args.isAction, deletedModel: deletedModel, deletedCellsModel: deletedCells,\n            activeSheetIndex: this.parent.activeSheetIndex\n        });\n    };\n    WorkbookDelete.prototype.setDeleteInfo = function (startIndex, endIndex, totalKey, modelType) {\n        if (modelType === void 0) { modelType = 'Row'; }\n        var total = (endIndex - startIndex) + 1;\n        var newRange = [];\n        var insertRange;\n        this.parent.getActiveSheet().ranges.forEach(function (range) {\n            if (range.info && startIndex < range.info[totalKey]) {\n                if (range.info[\"delete\" + modelType + \"Range\"]) {\n                    range.info[\"delete\" + modelType + \"Range\"].push([startIndex, endIndex]);\n                }\n                else {\n                    range.info[\"delete\" + modelType + \"Range\"] = [[startIndex, endIndex]];\n                }\n                range.info[totalKey] -= total;\n                if (range.info[\"insert\" + modelType + \"Range\"]) {\n                    range.info[\"insert\" + modelType + \"Range\"] = newRange;\n                }\n            }\n        });\n    };\n    WorkbookDelete.prototype.addEventListener = function () {\n        this.parent.on(deleteModel, this.deleteModel, this);\n    };\n    /**\n     * Destroy workbook delete module.\n     */\n    WorkbookDelete.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookDelete.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(deleteModel, this.deleteModel);\n        }\n    };\n    /**\n     * Get the workbook delete module name.\n     */\n    WorkbookDelete.prototype.getModuleName = function () {\n        return 'workbookdelete';\n    };\n    return WorkbookDelete;\n}());\nexport { WorkbookDelete };\n","import { setCell, setRow, getSheet } from '../base/index';\nimport { setValidation, applyCellFormat, isValidation, removeValidation, addHighlight } from '../common/index';\nimport { removeHighlight } from '../common/index';\nimport { getRangeIndexes } from '../common/index';\n/**\n * The `WorkbookHyperlink` module is used to handle Hyperlink action in Spreadsheet.\n */\nvar WorkbookDataValidation = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookSort module.\n     */\n    function WorkbookDataValidation(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     */\n    WorkbookDataValidation.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookDataValidation.prototype.addEventListener = function () {\n        this.parent.on(setValidation, this.addValidationHandler, this);\n        this.parent.on(removeValidation, this.removeValidationHandler, this);\n        this.parent.on(addHighlight, this.addHighlightHandler, this);\n        this.parent.on(removeHighlight, this.removeHighlightHandler, this);\n    };\n    WorkbookDataValidation.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setValidation, this.addValidationHandler);\n            this.parent.off(removeValidation, this.removeValidationHandler);\n            this.parent.off(addHighlight, this.addHighlightHandler);\n            this.parent.off(removeHighlight, this.removeHighlightHandler);\n        }\n    };\n    WorkbookDataValidation.prototype.addValidationHandler = function (args) {\n        this.ValidationHandler(args.rules, args.range, false);\n    };\n    WorkbookDataValidation.prototype.removeValidationHandler = function (args) {\n        this.ValidationHandler(args.rules, args.range, true);\n    };\n    WorkbookDataValidation.prototype.ValidationHandler = function (rules, range, isRemoveValidation) {\n        var cell;\n        var sheet = getSheet(this.parent, this.parent.getAddressInfo(range).sheetIndex);\n        range = range || sheet.selectedRange;\n        var indexes = getRangeIndexes(range);\n        for (var rowIdx = indexes[0]; rowIdx <= indexes[2]; rowIdx++) {\n            if (!sheet.rows[rowIdx]) {\n                setRow(sheet, rowIdx, {});\n            }\n            for (var colIdx = indexes[1]; colIdx <= indexes[3]; colIdx++) {\n                if (!sheet.rows[rowIdx].cells || !sheet.rows[rowIdx].cells[colIdx]) {\n                    setCell(rowIdx, colIdx, sheet, {});\n                }\n                cell = sheet.rows[rowIdx].cells[colIdx];\n                if (isRemoveValidation) {\n                    if (cell.validation) {\n                        delete (cell.validation);\n                        var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [rowIdx, colIdx]);\n                        this.parent.notify(applyCellFormat, {\n                            style: style, rowIdx: rowIdx, colIdx: colIdx\n                        });\n                    }\n                }\n                else {\n                    cell.validation = {\n                        type: rules.type,\n                        operator: rules.operator,\n                        value1: (rules.type === 'List' && rules.value1.length > 256) ?\n                            rules.value1.substring(0, 255) : rules.value1,\n                        value2: rules.value2,\n                        ignoreBlank: rules.ignoreBlank,\n                        inCellDropDown: rules.inCellDropDown,\n                    };\n                }\n            }\n        }\n    };\n    WorkbookDataValidation.prototype.addHighlightHandler = function (args) {\n        this.InvalidDataHandler(args.range, false);\n    };\n    WorkbookDataValidation.prototype.removeHighlightHandler = function (args) {\n        this.InvalidDataHandler(args.range, true);\n    };\n    WorkbookDataValidation.prototype.InvalidDataHandler = function (range, isRemoveHighlightedData) {\n        var isCell = false;\n        var cell;\n        var value;\n        var sheet = this.parent.getActiveSheet();\n        range = range || sheet.selectedRange;\n        var indexes = range ? getRangeIndexes(range) : [];\n        var rowIdx = range ? indexes[0] : 0;\n        var lastRowIdx = range ? indexes[2] : sheet.rows.length;\n        for (rowIdx; rowIdx <= lastRowIdx; rowIdx++) {\n            if (sheet.rows[rowIdx]) {\n                var colIdx = range ? indexes[1] : 0;\n                var lastColIdx = range ? indexes[3] : sheet.rows[rowIdx].cells.length;\n                for (colIdx; colIdx <= lastColIdx; colIdx++) {\n                    if (sheet.rows[rowIdx].cells[colIdx]) {\n                        cell = sheet.rows[rowIdx].cells[colIdx];\n                        value = cell.value ? cell.value : '';\n                        var range_1 = [rowIdx, colIdx];\n                        var sheetIdx = this.parent.activeSheetIndex;\n                        if (cell.validation && this.parent.allowDataValidation) {\n                            this.parent.notify(isValidation, { value: value, range: range_1, sheetIdx: sheetIdx, isCell: isCell });\n                            var isValid = this.parent.allowDataValidation;\n                            this.parent.allowDataValidation = true;\n                            if (!isValid) {\n                                if (!isRemoveHighlightedData) {\n                                    this.parent.notify(applyCellFormat, {\n                                        style: { backgroundColor: '#ffff00', color: '#ff0000' }, rowIdx: rowIdx, colIdx: colIdx\n                                    });\n                                }\n                                else if (isRemoveHighlightedData) {\n                                    var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [rowIdx, colIdx]);\n                                    this.parent.notify(applyCellFormat, {\n                                        style: style, rowIdx: rowIdx, colIdx: colIdx\n                                    });\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookDataValidation.prototype.getModuleName = function () {\n        return 'workbookDataValidation';\n    };\n    return WorkbookDataValidation;\n}());\nexport { WorkbookDataValidation };\n","import { getCellIndexes, getCellAddress, findNext, findPrevious, count, } from '../common/index';\nimport { goto, replaceHandler, replaceAllHandler, showDialog, findUndoRedo, replaceAllDialog } from '../common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { findAllValues, workBookeditAlert } from '../common/index';\n/**\n * `WorkbookFindAndReplace` module is used to handle the search action in Spreadsheet.\n */\nvar WorkbookFindAndReplace = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookFindAndReplace module.\n     */\n    function WorkbookFindAndReplace(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the FindAndReplace module.\n     */\n    WorkbookFindAndReplace.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookFindAndReplace.prototype.addEventListener = function () {\n        this.parent.on(findNext, this.findNext, this);\n        this.parent.on(findPrevious, this.findPrevious, this);\n        this.parent.on(replaceHandler, this.replace, this);\n        this.parent.on(replaceAllHandler, this.replaceAll, this);\n        this.parent.on(count, this.totalCount, this);\n        this.parent.on(findAllValues, this.findAllValues, this);\n    };\n    WorkbookFindAndReplace.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(findNext, this.findNext);\n            this.parent.off(findPrevious, this.findPrevious);\n            this.parent.off(replaceHandler, this.replace);\n            this.parent.off(replaceAllHandler, this.replaceAll);\n            this.parent.off(count, this.totalCount);\n            this.parent.off(findAllValues, this.findAllValues);\n        }\n    };\n    WorkbookFindAndReplace.prototype.findNext = function (args) {\n        var sheets = this.parent.sheets;\n        var val;\n        var sheetIndex = args.sheetIndex;\n        var sheet = sheets[this.parent.activeSheetIndex];\n        var activecell = getCellIndexes(sheet.activeCell);\n        var usedRange = sheet.usedRange;\n        var endColumn = usedRange.colIndex;\n        var stringValue = args.value.toString();\n        var cidx;\n        var ridx;\n        var count = 0;\n        var endRow = usedRange.rowIndex;\n        var loopCount = 0;\n        var cellFormat;\n        var valueOfCell;\n        cidx = activecell[1];\n        ridx = activecell[0];\n        var startColumn = cidx;\n        var startRow = ridx;\n        if (sheet.rows[ridx]) {\n            if (sheet.rows[ridx].cells[cidx]) {\n                cellFormat = sheet.rows[ridx].cells[cidx].format;\n                if (cellFormat) {\n                    var dispTxt = this.parent.getDisplayText(sheet.rows[ridx].cells[cidx]);\n                    valueOfCell = dispTxt.toString();\n                }\n                else {\n                    if (sheet.rows[ridx].cells[cidx].value) {\n                        valueOfCell = sheet.rows[ridx].cells[cidx].value.toString();\n                    }\n                }\n            }\n        }\n        if (valueOfCell) {\n            var lcValueOfCell = valueOfCell.toLowerCase();\n            var ivalueOfCell = valueOfCell.indexOf(args.value) > -1;\n            var lowerCaseIndex = lcValueOfCell.indexOf(args.value.toString().toLowerCase()) > -1;\n            if ((stringValue === valueOfCell) || (stringValue === lcValueOfCell) || (ivalueOfCell) || (lowerCaseIndex)) {\n                if (args.searchBy === 'By Column') {\n                    ridx++;\n                }\n                else {\n                    cidx++;\n                }\n                count++;\n            }\n        }\n        if (activecell[0] > sheet.usedRange.rowIndex || activecell[1] > sheet.usedRange.colIndex) {\n            if (activecell[0] > sheet.usedRange.rowIndex && activecell[1] <= sheet.usedRange.colIndex) {\n                ridx = 0;\n                cidx = activecell[1];\n            }\n            else if (activecell[0] <= sheet.usedRange.rowIndex && activecell[1] > sheet.usedRange.colIndex) {\n                ridx = activecell[0];\n                cidx = 0;\n            }\n            else {\n                ridx = 0;\n                cidx = 0;\n            }\n        }\n        var findNextArgs = {\n            rowIndex: ridx, colIndex: cidx, usedRange: usedRange, endRow: endRow, endColumn: endColumn, startRow: startRow,\n            mode: args.mode, loopCount: loopCount, count: count, args: args, val: val, stringValue: stringValue,\n            sheetIndex: this.parent.activeSheetIndex, startColumn: startColumn, sheets: sheets\n        };\n        if (args.searchBy === 'By Row') {\n            this.findNxtRow(findNextArgs);\n        }\n        if (args.searchBy === 'By Column') {\n            this.findNxtCol(findNextArgs);\n        }\n    };\n    WorkbookFindAndReplace.prototype.findNxtRow = function (findNextArgs) {\n        var usedRange;\n        var sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n        var sheetsLen = this.parent.sheets.length;\n        var activecell = getCellIndexes(sheet.activeCell);\n        if (findNextArgs.colIndex >= findNextArgs.usedRange.colIndex + 1) {\n            findNextArgs.colIndex = 0;\n            findNextArgs.rowIndex++;\n        }\n        for (findNextArgs.rowIndex; findNextArgs.rowIndex <= findNextArgs.endRow + 1; findNextArgs.rowIndex++) {\n            if (findNextArgs.rowIndex > findNextArgs.endRow) {\n                if (findNextArgs.mode === 'Workbook') {\n                    var noCellfound = this.parent.activeSheetIndex;\n                    findNextArgs.sheetIndex++;\n                    if (sheetsLen === findNextArgs.sheetIndex) {\n                        findNextArgs.sheetIndex = 0;\n                    }\n                    if (noCellfound === findNextArgs.sheetIndex) {\n                        if (findNextArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n                    usedRange = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findNextArgs.rowIndex = 0;\n                    findNextArgs.colIndex = 0;\n                    findNextArgs.endColumn = usedRange.colIndex;\n                    findNextArgs.endRow = usedRange.rowIndex;\n                }\n                if (findNextArgs.colIndex === 0 && findNextArgs.rowIndex > findNextArgs.endRow) {\n                    if ((activecell[0] === 0 && activecell[1] === 0) ||\n                        (activecell[0] > sheet.usedRange.rowIndex || activecell[1] > sheet.usedRange.colIndex)) {\n                        if (findNextArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    else if ((activecell[0] !== 0 && activecell[1] !== 0) || (activecell[0] !== 0 || activecell[1] !== 0)) {\n                        findNextArgs.startColumn = 0;\n                        findNextArgs.startRow = 0;\n                        findNextArgs.endColumn = findNextArgs.usedRange.colIndex;\n                        findNextArgs.endRow = activecell[0];\n                        findNextArgs.rowIndex = findNextArgs.startRow;\n                        findNextArgs.colIndex = findNextArgs.startColumn;\n                        findNextArgs.loopCount++;\n                    }\n                }\n            }\n            if (findNextArgs.count > 0) {\n                if (findNextArgs.usedRange.rowIndex < findNextArgs.rowIndex) {\n                    findNextArgs.rowIndex = 0;\n                    if (findNextArgs.rowIndex === 0) {\n                        findNextArgs.colIndex = 0;\n                    }\n                }\n            }\n            if (sheet.rows[findNextArgs.rowIndex]) {\n                var row = sheet.rows[findNextArgs.rowIndex];\n                for (findNextArgs.colIndex; findNextArgs.colIndex <= findNextArgs.endColumn; findNextArgs.colIndex++) {\n                    if (row) {\n                        if (row.cells[findNextArgs.colIndex]) {\n                            var checkTrue = this.nextCommon(findNextArgs);\n                            if (checkTrue) {\n                                return;\n                            }\n                        }\n                    }\n                }\n                if (findNextArgs.colIndex > findNextArgs.endColumn) {\n                    findNextArgs.colIndex = 0;\n                }\n                if (findNextArgs.loopCount > 0) {\n                    if (activecell[0] === findNextArgs.rowIndex) {\n                        this.parent.notify(showDialog, null);\n                        return;\n                    }\n                }\n            }\n        }\n        if (findNextArgs.count === 0) {\n            this.parent.notify(showDialog, null);\n            return;\n        }\n    };\n    WorkbookFindAndReplace.prototype.findNxtCol = function (findNextArgs) {\n        var sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n        var noFound;\n        var activecell = getCellIndexes(sheet.activeCell);\n        var sheetsLen = this.parent.sheets.length;\n        if (findNextArgs.rowIndex >= findNextArgs.usedRange.rowIndex) {\n            findNextArgs.rowIndex = 0;\n            findNextArgs.colIndex++;\n        }\n        for (findNextArgs.colIndex; findNextArgs.colIndex <= findNextArgs.usedRange.colIndex + 1; findNextArgs.colIndex++) {\n            if (findNextArgs.colIndex >= findNextArgs.endColumn + 1) {\n                if (findNextArgs.mode === 'Workbook') {\n                    noFound = this.parent.activeSheetIndex;\n                    findNextArgs.sheetIndex++;\n                    if (sheetsLen === findNextArgs.sheetIndex) {\n                        findNextArgs.sheetIndex = 0;\n                    }\n                    if (noFound === findNextArgs.sheetIndex) {\n                        if (findNextArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n                    findNextArgs.usedRange = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findNextArgs.colIndex = 0;\n                    findNextArgs.rowIndex = 0;\n                    findNextArgs.endColumn = findNextArgs.usedRange.colIndex;\n                    findNextArgs.endRow = findNextArgs.usedRange.rowIndex;\n                }\n            }\n            if (findNextArgs.colIndex >= findNextArgs.endColumn + 1) {\n                findNextArgs.colIndex = 0;\n            }\n            if (findNextArgs.rowIndex > findNextArgs.endRow && findNextArgs.colIndex === 0) {\n                if ((activecell[0] === 0 && activecell[1] === 0) ||\n                    (activecell[1] > sheet.usedRange.rowIndex || activecell[0] > sheet.usedRange.colIndex)) {\n                    if (findNextArgs.count === 0) {\n                        this.parent.notify(showDialog, null);\n                        return;\n                    }\n                }\n                else if ((activecell[1] !== 0 || activecell[0] !== 0) || (activecell[1] !== 0 && activecell[0] !== 0)) {\n                    findNextArgs.startRow = 0;\n                    findNextArgs.startColumn = 0;\n                    findNextArgs.endRow = activecell[0];\n                    findNextArgs.endColumn = findNextArgs.usedRange.colIndex;\n                    findNextArgs.colIndex = findNextArgs.startColumn;\n                    findNextArgs.rowIndex = findNextArgs.startRow;\n                    findNextArgs.loopCount++;\n                }\n            }\n            if (findNextArgs.count > 0) {\n                if (findNextArgs.usedRange.colIndex + 1 < findNextArgs.colIndex) {\n                    findNextArgs.colIndex = 0;\n                    findNextArgs.rowIndex = 0;\n                }\n            }\n            if (findNextArgs.rowIndex >= findNextArgs.endRow) {\n                findNextArgs.rowIndex = 0;\n            }\n            if (findNextArgs.colIndex <= findNextArgs.usedRange.colIndex) {\n                for (findNextArgs.rowIndex; findNextArgs.rowIndex <= findNextArgs.usedRange.rowIndex; findNextArgs.rowIndex++) {\n                    if (sheet.rows[findNextArgs.rowIndex]) {\n                        if (sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex]) {\n                            var checkTrue = this.nextCommon(findNextArgs);\n                            if (checkTrue) {\n                                return;\n                            }\n                        }\n                    }\n                }\n                if (findNextArgs.loopCount > 0) {\n                    if (activecell[1] === findNextArgs.colIndex) {\n                        this.parent.notify(showDialog, null);\n                        return;\n                    }\n                }\n            }\n        }\n        if (findNextArgs.count === 0) {\n            this.parent.notify(showDialog, null);\n            return;\n        }\n    };\n    WorkbookFindAndReplace.prototype.nextCommon = function (findNextArgs) {\n        var sheet = findNextArgs.sheets[findNextArgs.sheetIndex];\n        if (sheet.rows[findNextArgs.rowIndex]) {\n            var rowCol = sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex];\n            if (rowCol && rowCol.value) {\n                var cellType = sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex];\n                if (cellType) {\n                    var cellval = void 0;\n                    if (cellType.format) {\n                        var displayTxt = this.parent.getDisplayText(sheet.rows[findNextArgs.rowIndex].\n                            cells[findNextArgs.colIndex]);\n                        cellval = displayTxt;\n                    }\n                    else {\n                        cellval = sheet.rows[findNextArgs.rowIndex].cells[findNextArgs.colIndex].value.toString();\n                    }\n                    if (findNextArgs.args.isCSen && findNextArgs.args.isEMatch) {\n                        if (cellval === findNextArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (findNextArgs.args.isCSen && !findNextArgs.args.isEMatch) {\n                        var index = cellval.indexOf(findNextArgs.args.value) > -1;\n                        if ((cellval === findNextArgs.stringValue) || (index)) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findNextArgs.args.isCSen && findNextArgs.args.isEMatch) {\n                        findNextArgs.val = cellval.toString().toLowerCase();\n                        if (findNextArgs.val === findNextArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findNextArgs.args.isCSen && !findNextArgs.args.isEMatch) {\n                        findNextArgs.val = cellval.toString().toLowerCase();\n                        var index = findNextArgs.val.indexOf(findNextArgs.args.value.toString().toLowerCase()) > -1;\n                        var lowerCaseIndex = findNextArgs.val.indexOf(findNextArgs.args.value) > -1;\n                        if ((findNextArgs.val === findNextArgs.stringValue) || ((cellval === findNextArgs.stringValue) || (index)) ||\n                            (cellval === findNextArgs.stringValue) || (lowerCaseIndex)) {\n                            var address = sheet.name + '!' + getCellAddress(findNextArgs.rowIndex, findNextArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findNextArgs.count++;\n                            return true;\n                        }\n                    }\n                }\n            }\n        }\n        return false;\n    };\n    WorkbookFindAndReplace.prototype.findPrevious = function (args) {\n        var sheets = this.parent.sheets;\n        var sheetIndex = args.sheetIndex;\n        var sheet = sheets[sheetIndex];\n        var valueOfCell;\n        var cellFormat;\n        var val;\n        var activecell = getCellIndexes(sheet.activeCell);\n        var loopCount = 0;\n        var count = 0;\n        var endRow = sheet.usedRange.rowIndex;\n        var endColumn = sheet.usedRange.colIndex;\n        var stringValue = args.value.toString();\n        var cidx = activecell[1];\n        var ridx = activecell[0];\n        var startColumn = cidx;\n        var startRow = ridx;\n        if (sheet.rows[ridx]) {\n            if (sheet.rows[ridx].cells[cidx]) {\n                cellFormat = sheet.rows[ridx].cells[cidx].format;\n                if (cellFormat) {\n                    var displayTxt = this.parent.getDisplayText(sheet.rows[ridx].cells[cidx]);\n                    valueOfCell = displayTxt.toString();\n                }\n                else {\n                    if (sheet.rows[ridx].cells[cidx].value) {\n                        valueOfCell = sheet.rows[ridx].cells[cidx].value.toString();\n                    }\n                }\n            }\n        }\n        if (valueOfCell) {\n            var lcValue = valueOfCell.toLowerCase();\n            var ivalue = valueOfCell.indexOf(args.value) > -1;\n            var lowerCaseIndex = lcValue.indexOf(args.value.toString().toLowerCase()) > -1;\n            if ((stringValue === valueOfCell) || (stringValue === lcValue) || (ivalue) || (lowerCaseIndex)) {\n                if (args.searchBy === 'By Row') {\n                    cidx--;\n                }\n                if (args.searchBy === 'By Column') {\n                    ridx--;\n                }\n                count++;\n            }\n        }\n        if (activecell[0] > sheet.usedRange.rowIndex || activecell[1] > sheet.usedRange.colIndex) {\n            if (activecell[0] > sheet.usedRange.rowIndex && activecell[1] <= sheet.usedRange.colIndex) {\n                ridx = sheet.usedRange.rowIndex;\n                cidx = activecell[1];\n            }\n            else if (activecell[0] <= sheet.usedRange.rowIndex && activecell[1] > sheet.usedRange.colIndex) {\n                ridx = activecell[0];\n                cidx = sheet.usedRange.colIndex;\n            }\n            else {\n                ridx = sheet.usedRange.rowIndex;\n                cidx = sheet.usedRange.colIndex;\n            }\n        }\n        var findPrevArgs = {\n            rowIndex: ridx, colIndex: cidx, endRow: endRow, endColumn: endColumn, startRow: startRow,\n            loopCount: loopCount, count: count, args: args, val: val, stringValue: stringValue,\n            sheets: sheets, sheetIndex: sheetIndex, startColumn: startColumn,\n        };\n        if (args.searchBy === 'By Row') {\n            this.findPreRow(findPrevArgs);\n        }\n        if (args.searchBy === 'By Column') {\n            this.findPreCol(findPrevArgs);\n        }\n    };\n    WorkbookFindAndReplace.prototype.findPreRow = function (findPrevArgs) {\n        var usedRan;\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        var sheetsLength = this.parent.sheets.length;\n        var noValueBoolean = false;\n        var activecell = getCellIndexes(sheet.activeCell);\n        if (findPrevArgs.colIndex === -1) {\n            findPrevArgs.colIndex = findPrevArgs.endColumn;\n            findPrevArgs.rowIndex--;\n        }\n        for (findPrevArgs.rowIndex; findPrevArgs.rowIndex >= -1; findPrevArgs.rowIndex--) {\n            if (findPrevArgs.rowIndex < 0 && findPrevArgs.colIndex < 0) {\n                if (findPrevArgs.args.mode === 'Workbook') {\n                    var noCellfound = this.parent.activeSheetIndex;\n                    findPrevArgs.sheetIndex--;\n                    if (findPrevArgs.sheetIndex === -1) {\n                        findPrevArgs.sheetIndex = sheetsLength - 1;\n                    }\n                    if (noCellfound === findPrevArgs.sheetIndex) {\n                        if (findPrevArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n                    usedRan = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findPrevArgs.rowIndex = usedRan.rowIndex;\n                    findPrevArgs.colIndex = usedRan.colIndex;\n                    findPrevArgs.endColumn = 0;\n                    findPrevArgs.endRow = 0;\n                }\n                noValueBoolean = this.commonCondition(findPrevArgs, activecell);\n            }\n            if (!noValueBoolean) {\n                if (findPrevArgs.args.mode !== 'Workbook') {\n                    if (findPrevArgs.count > 0) {\n                        if (findPrevArgs.rowIndex === -1) {\n                            findPrevArgs.rowIndex = findPrevArgs.endRow;\n                        }\n                    }\n                }\n                if (findPrevArgs.rowIndex === -1) {\n                    findPrevArgs.rowIndex = sheet.usedRange.rowIndex;\n                    findPrevArgs.colIndex = sheet.usedRange.colIndex;\n                }\n                if (sheet.rows[findPrevArgs.rowIndex]) {\n                    if (findPrevArgs.colIndex === -1) {\n                        findPrevArgs.colIndex = sheet.usedRange.colIndex;\n                    }\n                    for (findPrevArgs.colIndex; findPrevArgs.colIndex >= 0; findPrevArgs.colIndex--) {\n                        if (sheet.rows[findPrevArgs.rowIndex]) {\n                            if (sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex]) {\n                                var checkTrue = this.prevCommon(findPrevArgs);\n                                if (checkTrue) {\n                                    return;\n                                }\n                            }\n                        }\n                    }\n                    if (findPrevArgs.loopCount > 0) {\n                        if (activecell[0] === findPrevArgs.rowIndex) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                }\n            }\n        }\n        if (!noValueBoolean) {\n            if (findPrevArgs.count === 0) {\n                this.parent.notify(showDialog, null);\n                return;\n            }\n        }\n    };\n    WorkbookFindAndReplace.prototype.findPreCol = function (findPrevArgs) {\n        var usedRange;\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        var sheetsLen = this.parent.sheets.length;\n        var noValueBoolean = false;\n        var activecell = getCellIndexes(sheet.activeCell);\n        for (findPrevArgs.colIndex; findPrevArgs.colIndex >= -1; findPrevArgs.colIndex--) {\n            if (findPrevArgs.rowIndex < 0 && findPrevArgs.colIndex < 0) {\n                if (findPrevArgs.args.mode === 'Workbook') {\n                    var noCellfound = this.parent.activeSheetIndex;\n                    findPrevArgs.sheetIndex--;\n                    if (findPrevArgs.sheetIndex === -1) {\n                        findPrevArgs.sheetIndex = sheetsLen - 1;\n                    }\n                    if (noCellfound === findPrevArgs.sheetIndex) {\n                        if (findPrevArgs.count === 0) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                    sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n                    usedRange = sheet.usedRange;\n                    activecell = getCellIndexes(sheet.activeCell);\n                    findPrevArgs.rowIndex = usedRange.rowIndex;\n                    findPrevArgs.colIndex = usedRange.colIndex;\n                    findPrevArgs.endColumn = 0;\n                    findPrevArgs.endRow = 0;\n                }\n                noValueBoolean = this.commonCondition(findPrevArgs, activecell);\n            }\n            if (!noValueBoolean) {\n                if (findPrevArgs.count > 0) {\n                    if (findPrevArgs.colIndex < 0) {\n                        findPrevArgs.colIndex = findPrevArgs.endColumn;\n                    }\n                }\n                if (findPrevArgs.rowIndex < 0) {\n                    findPrevArgs.rowIndex = sheet.usedRange.rowIndex;\n                }\n                if (findPrevArgs.colIndex < -1) {\n                    findPrevArgs.colIndex = sheet.usedRange.colIndex;\n                    findPrevArgs.rowIndex--;\n                }\n                if (sheet.rows[findPrevArgs.rowIndex]) {\n                    if (sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex]) {\n                        if (findPrevArgs.rowIndex === -1) {\n                            findPrevArgs.rowIndex = sheet.usedRange.rowIndex;\n                        }\n                    }\n                }\n                for (findPrevArgs.rowIndex; findPrevArgs.rowIndex >= 0; findPrevArgs.rowIndex--) {\n                    if (sheet.rows[findPrevArgs.rowIndex]) {\n                        if (sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex]) {\n                            var check = this.prevCommon(findPrevArgs);\n                            if (check) {\n                                return;\n                            }\n                        }\n                    }\n                    if (findPrevArgs.loopCount > 0) {\n                        if (activecell[1] === findPrevArgs.colIndex) {\n                            this.parent.notify(showDialog, null);\n                            return;\n                        }\n                    }\n                }\n            }\n        }\n        if (!noValueBoolean) {\n            if (findPrevArgs.count === 0) {\n                this.parent.notify(showDialog, null);\n                return;\n            }\n        }\n    };\n    WorkbookFindAndReplace.prototype.commonCondition = function (findPrevArgs, activecell) {\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        var isTrue;\n        if ((activecell[0] !== findPrevArgs.endRow && activecell[1] !== findPrevArgs.endColumn) ||\n            (activecell[0] !== findPrevArgs.endRow || activecell[1] !== findPrevArgs.endColumn)) {\n            findPrevArgs.startColumn = sheet.usedRange.colIndex;\n            findPrevArgs.startRow = sheet.usedRange.rowIndex;\n            findPrevArgs.endColumn = 0;\n            findPrevArgs.endRow = activecell[0];\n            findPrevArgs.rowIndex = findPrevArgs.startRow;\n            findPrevArgs.colIndex = findPrevArgs.startColumn;\n            findPrevArgs.loopCount++;\n            isTrue = false;\n        }\n        else if ((activecell[0] === sheet.usedRange.rowIndex && activecell[1] === sheet.usedRange.colIndex) ||\n            (activecell[0] > sheet.usedRange.rowIndex || activecell[1] > sheet.usedRange.colIndex)) {\n            this.parent.notify(showDialog, null);\n            isTrue = true;\n        }\n        return isTrue;\n    };\n    WorkbookFindAndReplace.prototype.prevCommon = function (findPrevArgs) {\n        var sheet = findPrevArgs.sheets[findPrevArgs.sheetIndex];\n        if (sheet.rows[findPrevArgs.rowIndex]) {\n            var rowCol = sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex];\n            if (rowCol && rowCol.value) {\n                var cellType = sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex];\n                if (cellType) {\n                    var cellvalue = void 0;\n                    if (cellType.format) {\n                        var displayTxt = this.parent.getDisplayText(sheet.rows[findPrevArgs.rowIndex]\n                            .cells[findPrevArgs.colIndex]);\n                        cellvalue = displayTxt;\n                    }\n                    else {\n                        cellvalue = sheet.rows[findPrevArgs.rowIndex].cells[findPrevArgs.colIndex].value.toString();\n                    }\n                    if (findPrevArgs.args.isCSen && findPrevArgs.args.isEMatch) {\n                        if (cellvalue === findPrevArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (findPrevArgs.args.isCSen && !findPrevArgs.args.isEMatch) {\n                        var index = cellvalue.indexOf(findPrevArgs.args.value) > -1;\n                        if ((cellvalue === findPrevArgs.stringValue) || (index)) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findPrevArgs.args.isCSen && findPrevArgs.args.isEMatch) {\n                        findPrevArgs.val = cellvalue.toString().toLowerCase();\n                        if (findPrevArgs.val === findPrevArgs.stringValue) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                    else if (!findPrevArgs.args.isCSen && !findPrevArgs.args.isEMatch) {\n                        findPrevArgs.val = cellvalue.toString().toLowerCase();\n                        var index = findPrevArgs.val.indexOf(findPrevArgs.args.value.toString().toLowerCase()) > -1;\n                        var lowerCaseIndex = findPrevArgs.val.indexOf(findPrevArgs.args.value) > -1;\n                        if ((cellvalue === findPrevArgs.stringValue) || ((cellvalue === findPrevArgs.stringValue) ||\n                            (index)) || (findPrevArgs.val === findPrevArgs.stringValue) || (lowerCaseIndex)) {\n                            var address = sheet.name + '!' + getCellAddress(findPrevArgs.rowIndex, findPrevArgs.colIndex);\n                            this.parent.notify(goto, { address: address });\n                            findPrevArgs.count++;\n                            return true;\n                        }\n                    }\n                }\n            }\n        }\n        return false;\n    };\n    WorkbookFindAndReplace.prototype.replace = function (args) {\n        if (this.parent.getActiveSheet().isProtected) {\n            this.parent.notify(workBookeditAlert, null);\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        var activecell = getCellIndexes(sheet.activeCell);\n        var currentCell = sheet.rows[activecell[0]].cells[activecell[1]].value.toString();\n        var index = currentCell.indexOf(args.value) > -1;\n        var lowerCaseIndex = currentCell.toLowerCase().indexOf(args.value.toString().toLowerCase()) > -1;\n        var val = currentCell.toString().toLowerCase();\n        if ((currentCell !== args.value) && (!index) && (val !== args.value) && (!lowerCaseIndex)) {\n            args.findOpt = 'next';\n            this.findNext(args);\n        }\n        this.parent.getActiveSheet();\n        var activecel = getCellIndexes(sheet.activeCell);\n        var address = sheet.activeCell;\n        var cell = sheet.rows[activecel[0]].cells[activecel[1]];\n        var cellFormat = sheet.rows[activecel[0]].cells[activecel[1]].format;\n        var compareVal;\n        var replaceAddress = sheet.name + '!' + getCellAddress(activecel[0], activecel[1]);\n        if (cellFormat) {\n            var dispTxt = this.parent.getDisplayText(sheet.rows[activecel[0]].cells[activecel[1]]);\n            compareVal = dispTxt.toString();\n        }\n        else {\n            compareVal = sheet.rows[activecel[0]].cells[activecel[1]].value.toString();\n        }\n        var replaceAllCollection = { undoRedoOpt: 'before', address: replaceAddress, compareVal: compareVal };\n        this.parent.notify(findUndoRedo, replaceAllCollection);\n        var lcValueOfCell = compareVal.toLowerCase();\n        var ivalueOfCell = compareVal.indexOf(args.value) > -1;\n        var caseInSensitive = lcValueOfCell.indexOf(args.value) > -1;\n        if ((args.value === compareVal) || (args.value === lcValueOfCell)) {\n            sheet.rows[activecel[0]].cells[activecel[1]].value = args.replaceValue;\n            this.parent.updateCell(cell, address);\n            var replaceAllCollection_1 = { address: replaceAddress, compareVal: args.replaceValue, undoRedoOpt: 'after' };\n            this.parent.notify(findUndoRedo, replaceAllCollection_1);\n        }\n        else if (ivalueOfCell) {\n            var newValue = compareVal.replace(args.value, args.replaceValue);\n            sheet.rows[activecel[0]].cells[activecel[1]].value = newValue;\n            this.parent.updateCell(cell, address);\n            var replaceAllCollection_2 = { address: replaceAddress, compareVal: args.replaceValue, undoRedoOpt: 'after' };\n            this.parent.notify(findUndoRedo, replaceAllCollection_2);\n        }\n        else if (caseInSensitive) {\n            var regx = new RegExp(args.value.toString().replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'), 'ig');\n            var updateValue = compareVal.replace(regx, args.replaceValue);\n            sheet.rows[activecel[0]].cells[activecel[1]].value = updateValue;\n            this.parent.updateCell(cell, address);\n            var replaceAllCollection_3 = { address: replaceAddress, compareVal: args.replaceValue, undoRedoOpt: 'after' };\n            this.parent.notify(findUndoRedo, replaceAllCollection_3);\n        }\n    };\n    WorkbookFindAndReplace.prototype.replaceAll = function (args) {\n        var startSheet = 0;\n        var sheet = this.parent.sheets[startSheet];\n        var endRow = sheet.usedRange.rowIndex;\n        var count = 0;\n        var undoRedoOpt = 'beforeReplaceAll';\n        var startRow = 0;\n        var endColumn = sheet.usedRange.colIndex;\n        var startColumn = 0;\n        var addressCollection = [];\n        var address;\n        for (startRow; startRow <= endRow; startRow++) {\n            if (startColumn > endColumn && startRow === endRow) {\n                if (args.mode === 'Workbook') {\n                    startSheet++;\n                    sheet = this.parent.sheets[startSheet];\n                    if (sheet) {\n                        startColumn = 0;\n                        startRow = 0;\n                        endColumn = sheet.usedRange.colIndex;\n                        endRow = sheet.usedRange.rowIndex;\n                        sheet = sheet;\n                    }\n                }\n            }\n            if (sheet) {\n                if (sheet.rows[startRow]) {\n                    var row = sheet.rows[startRow];\n                    if (startColumn === endColumn + 1) {\n                        startColumn = 0;\n                    }\n                    for (startColumn; startColumn <= endColumn; startColumn++) {\n                        var cell = sheet.rows[startRow].cells[startColumn];\n                        if (row) {\n                            if (row.cells[startColumn] && row.cells[startColumn].value) {\n                                var cellType = sheet.rows[startRow].cells[startColumn];\n                                if (cellType) {\n                                    var cellTypeVal = cellType.format;\n                                    var cellval = void 0;\n                                    if (cellTypeVal) {\n                                        var displayTxt = this.parent.getDisplayText(sheet.rows[startRow].\n                                            cells[startColumn]);\n                                        cellval = displayTxt.toString();\n                                    }\n                                    else {\n                                        cellval = sheet.rows[startRow].cells[startColumn].value.toString();\n                                    }\n                                    if (args.isCSen && args.isEMatch) {\n                                        if (cellval === args.value) {\n                                            sheet.rows[startRow].cells[startColumn].value = args.replaceValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (args.isCSen && !args.isEMatch) {\n                                        var index = cellval.indexOf(args.value) > -1;\n                                        if ((cellval === args.value) || (index)) {\n                                            var newValue = cellval.replace(args.value, args.replaceValue);\n                                            sheet.rows[startRow].cells[startColumn].value = newValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!args.isCSen && args.isEMatch) {\n                                        var val = cellval.toString().toLowerCase();\n                                        if (val === args.value) {\n                                            sheet.rows[startRow].cells[startColumn].value = args.replaceValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!args.isCSen && !args.isEMatch) {\n                                        var val = cellval.toString().toLowerCase();\n                                        var index = val.indexOf(args.value.toString().toLowerCase()) > -1;\n                                        var lowerCaseValue = val.indexOf(args.value) > -1;\n                                        if (((cellval === args.value) || (index)) || (val === args.value) || (cellval === args.value) ||\n                                            (lowerCaseValue)) {\n                                            var regExepression = new RegExp(args.value.toString().replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'), 'ig');\n                                            var newValue = cellval.replace(regExepression, args.replaceValue);\n                                            sheet.rows[startRow].cells[startColumn].value = newValue;\n                                            address = sheet.name + '!' + getCellAddress(startRow, startColumn);\n                                            this.parent.updateCell(cell, address);\n                                            addressCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        var replaceAllCollection = {\n            undoRedoOpt: undoRedoOpt, Collection: addressCollection,\n            replaceValue: args.value\n        };\n        this.parent.notify(findUndoRedo, replaceAllCollection);\n        replaceAllCollection = {\n            undoRedoOpt: 'afterReplaceAll', Collection: addressCollection,\n            replaceValue: args.replaceValue\n        };\n        this.parent.notify(findUndoRedo, replaceAllCollection);\n        var countNumber = count;\n        this.parent.notify(replaceAllDialog, { count: countNumber, replaceValue: args.replaceValue });\n    };\n    WorkbookFindAndReplace.prototype.totalCount = function (args) {\n        var startSheet = 0;\n        var sheet = this.parent.sheets[startSheet];\n        var endRow = sheet.usedRange.rowIndex;\n        var count = 0;\n        var rowIndex = 0;\n        var endColumn = sheet.usedRange.colIndex;\n        var columnIndex = 0;\n        for (rowIndex; rowIndex <= endRow; rowIndex++) {\n            if (sheet.rows[rowIndex]) {\n                var row = sheet.rows[rowIndex];\n                if (columnIndex === endColumn + 1) {\n                    columnIndex = 0;\n                }\n                for (columnIndex; columnIndex <= endColumn; columnIndex++) {\n                    if (row) {\n                        if (row.cells[columnIndex] && row.cells[columnIndex].value) {\n                            var cellType = sheet.rows[rowIndex].cells[columnIndex];\n                            if (cellType) {\n                                var cellFormat = cellType.format;\n                                var cellvalue = void 0;\n                                if (cellFormat) {\n                                    var displayTxt = this.parent.getDisplayText(sheet.rows[rowIndex].\n                                        cells[columnIndex]);\n                                    cellvalue = displayTxt.toString();\n                                }\n                                else {\n                                    cellvalue = cellType.value.toString();\n                                }\n                                if (args.isCSen && args.isEMatch) {\n                                    if (cellvalue === args.value) {\n                                        count++;\n                                    }\n                                }\n                                else if (args.isCSen && !args.isEMatch) {\n                                    var index = cellvalue.indexOf(args.value) > -1;\n                                    if ((cellvalue === args.value) || (index)) {\n                                        count++;\n                                    }\n                                }\n                                else if (!args.isCSen && args.isEMatch) {\n                                    var val = cellvalue.toString().toLowerCase();\n                                    if (val === args.value) {\n                                        count++;\n                                    }\n                                }\n                                else if (!args.isCSen && !args.isEMatch) {\n                                    var val = cellvalue.toString().toLowerCase();\n                                    var index = val.indexOf(args.value.toString().toLowerCase()) > -1;\n                                    var lowerCaseValue = val.indexOf(args.value) > -1;\n                                    if ((val === args.value) || ((cellvalue === args.value) || (index)) || (cellvalue === args.value) ||\n                                        (lowerCaseValue)) {\n                                        count++;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        var totalCount = count;\n        var requiredCount = this.requiredCount(args) - 1;\n        count = totalCount - requiredCount;\n        if (count > totalCount) {\n            count = totalCount;\n        }\n        if (count !== 0) {\n            var activecel = getCellIndexes(sheet.activeCell);\n            var val = this.parent.getDisplayText(sheet.rows[activecel[0]].cells[activecel[1]]).toString().toLowerCase();\n            if (val.indexOf(args.value.toString().toLowerCase()) === -1) {\n                count = count - 1;\n            }\n        }\n        args.findCount = count + ' ' + 'of' + ' ' + totalCount;\n        return;\n    };\n    WorkbookFindAndReplace.prototype.requiredCount = function (args) {\n        var sheetIndex = this.parent.activeSheetIndex;\n        var sheet = this.parent.sheets[sheetIndex];\n        var activecel = getCellIndexes(sheet.activeCell);\n        var endRow = sheet.usedRange.rowIndex;\n        var requiredCount = 0;\n        var startRow = activecel[0];\n        var endColumn = sheet.usedRange.colIndex;\n        var startColumn = activecel[1];\n        for (startRow; startRow <= endRow; startRow++) {\n            if (sheet.rows[startRow]) {\n                var row = sheet.rows[startRow];\n                if (startColumn === endColumn + 1) {\n                    startColumn = 0;\n                }\n                for (startColumn; startColumn <= endColumn; startColumn++) {\n                    if (row) {\n                        if (row.cells[startColumn] && row.cells[startColumn].value) {\n                            if (sheet.rows[startRow].cells[startColumn]) {\n                                var cellval = void 0;\n                                if (sheet.rows[startRow].cells[startColumn].format) {\n                                    var displayTxt = this.parent.getDisplayText(sheet.rows[startRow].\n                                        cells[startColumn]);\n                                    cellval = displayTxt.toString();\n                                }\n                                else {\n                                    cellval = sheet.rows[startRow].cells[startColumn].value.toString();\n                                }\n                                if (args.isCSen && !args.isEMatch) {\n                                    var index = cellval.indexOf(args.value) > -1;\n                                    if ((cellval === args.value) || (index)) {\n                                        requiredCount++;\n                                    }\n                                }\n                                else if (args.isCSen && args.isEMatch) {\n                                    if (cellval === args.value) {\n                                        requiredCount++;\n                                    }\n                                }\n                                else if (!args.isCSen && args.isEMatch) {\n                                    var val = cellval.toString().toLowerCase();\n                                    if (val === args.value) {\n                                        requiredCount++;\n                                    }\n                                }\n                                else if (!args.isCSen && !args.isEMatch) {\n                                    var val = cellval.toString().toLowerCase();\n                                    var argsVal = args.value.toString().toLowerCase();\n                                    var index = val.indexOf(argsVal) > -1;\n                                    var lowerCaseVal = val.indexOf(args.value) > -1;\n                                    if ((cellval === args.value) || ((val === argsVal) || (index)) || (val === args.value) ||\n                                        (lowerCaseVal)) {\n                                        requiredCount++;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return requiredCount;\n    };\n    WorkbookFindAndReplace.prototype.findAllValues = function (findAllArguments) {\n        var startSheet = findAllArguments.sheetIndex;\n        var sheet = this.parent.sheets[startSheet - 1];\n        var endRow = sheet.usedRange.rowIndex;\n        var rowIndex = 0;\n        var count = 0;\n        var address;\n        var endColumn = sheet.usedRange.colIndex;\n        var columnIndex = 0;\n        var sheetName;\n        var sheetLength = this.parent.sheets.length;\n        var initialSheet = findAllArguments.sheetIndex;\n        for (rowIndex; rowIndex <= endRow + 1; rowIndex++) {\n            if ((initialSheet !== 1) && (findAllArguments.sheetIndex === sheetLength)) {\n                startSheet = 1;\n            }\n            if (rowIndex > endRow && columnIndex > endColumn) {\n                if (findAllArguments.mode === 'Workbook') {\n                    startSheet++;\n                    if (initialSheet === startSheet) {\n                        if (count === 0) {\n                            return;\n                        }\n                        return;\n                    }\n                    if (startSheet > sheetLength - 1) {\n                        startSheet = 0;\n                    }\n                    sheet = this.parent.sheets[startSheet];\n                    if (sheet) {\n                        rowIndex = 0;\n                        columnIndex = 0;\n                        endColumn = sheet.usedRange.colIndex;\n                        endRow = sheet.usedRange.rowIndex;\n                        sheet = sheet;\n                    }\n                }\n            }\n            if (!isNullOrUndefined(sheet)) {\n                if (sheet.rows[rowIndex]) {\n                    var row = sheet.rows[rowIndex];\n                    if (columnIndex === endColumn + 2) {\n                        columnIndex = 0;\n                    }\n                    for (columnIndex; columnIndex <= endColumn + 1; columnIndex++) {\n                        if (row) {\n                            if (row.cells[columnIndex]) {\n                                var cell = sheet.rows[rowIndex].cells[columnIndex];\n                                if (cell) {\n                                    var cellFormat = cell.format;\n                                    var cellvalue = void 0;\n                                    if (cellFormat) {\n                                        var displayTxt = this.parent.getDisplayText(sheet.rows[rowIndex].\n                                            cells[columnIndex]);\n                                        cellvalue = displayTxt.toString();\n                                    }\n                                    else {\n                                        cellvalue = cell.value.toString();\n                                    }\n                                    if (findAllArguments.isCSen && findAllArguments.isEMatch) {\n                                        if (cellvalue === findAllArguments.value) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (findAllArguments.isCSen && !findAllArguments.isEMatch) {\n                                        var index = cellvalue.indexOf(findAllArguments.value) > -1;\n                                        if ((cellvalue === findAllArguments.value) || (index)) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!findAllArguments.isCSen && findAllArguments.isEMatch) {\n                                        var val = cellvalue.toString().toLowerCase();\n                                        if (val === findAllArguments.value) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                    else if (!findAllArguments.isCSen && !findAllArguments.isEMatch) {\n                                        var val = cellvalue.toString().toLowerCase();\n                                        var index = val.indexOf(findAllArguments.value.toLowerCase()) > -1;\n                                        if ((val === findAllArguments.value) || ((cellvalue === findAllArguments.value) || (index)) ||\n                                            ((cellvalue === findAllArguments.value))) {\n                                            address = sheet.name + '!' + getCellAddress(rowIndex, columnIndex);\n                                            findAllArguments.findCollection.push(address);\n                                            count++;\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        if (count === 0) {\n            return;\n        }\n        return;\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookFindAndReplace.prototype.getModuleName = function () {\n        return 'workbookfindAndReplace';\n    };\n    return WorkbookFindAndReplace;\n}());\nexport { WorkbookFindAndReplace };\n","import { setColumn } from '../base/index';\nimport { applyLockCells } from '../common/index';\nimport { protectsheetHandler, protectSheetWorkBook, updateToggle, setLockCells } from '../common/index';\nimport { unprotectsheetHandler } from '../common/index';\nimport { getRangeIndexes, getSwapRange } from '../common/index';\nimport { isUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookSpreadSheet` module is used to handle the Protecting functionalities in Workbook.\n */\nvar WorkbookProtectSheet = /** @class */ (function () {\n    /**\n     * Constructor for edit module in Workbook.\n     * @private\n     */\n    function WorkbookProtectSheet(workbook) {\n        this.parent = workbook;\n        this.addEventListener();\n    }\n    WorkbookProtectSheet.prototype.protectsheetHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        this.parent.setSheetPropertyOnMute(sheet, 'protectSettings', {\n            selectCells: args.selectCells, formatCells: args.formatCells,\n            formatColumns: args.formatColumns, formatRows: args.formatRows, insertLink: args.insertLink\n        });\n        this.parent.notify(protectSheetWorkBook, sheet.protectSettings);\n        this.parent.notify(updateToggle, { props: 'Protect' });\n        sheet.columns.forEach(function (column) {\n            if (column && isUndefined(column.isLocked)) {\n                column.isLocked = true;\n            }\n        });\n    };\n    WorkbookProtectSheet.prototype.unprotectsheetHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        if (args.sheet) {\n            sheet = this.parent.sheets[args.sheet];\n        }\n        sheet.protectSettings.formatCells = sheet.protectSettings.formatColumns = false;\n        sheet.protectSettings.formatRows = sheet.protectSettings.selectCells = false;\n        this.parent.setSheetPropertyOnMute(sheet, 'isProtected', false);\n        this.parent.notify(protectSheetWorkBook, sheet.protectSettings);\n        this.parent.notify(updateToggle, { props: 'Protect' });\n    };\n    /**\n     * To destroy the edit module.\n     * @return {void}\n     * @hidden\n     */\n    WorkbookProtectSheet.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookProtectSheet.prototype.addEventListener = function () {\n        this.parent.on(protectsheetHandler, this.protectsheetHandler, this);\n        this.parent.on(unprotectsheetHandler, this.unprotectsheetHandler, this);\n        this.parent.on(setLockCells, this.lockCells, this);\n    };\n    WorkbookProtectSheet.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(protectsheetHandler, this.protectsheetHandler);\n            this.parent.off(setLockCells, this.lockCells);\n            this.parent.off(protectsheetHandler, this.unprotectsheetHandler);\n        }\n    };\n    WorkbookProtectSheet.prototype.lockCells = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var range;\n        if (args) {\n            range = args.range;\n        }\n        else {\n            range = sheet.selectedRange;\n        }\n        var indexes = typeof (range) === 'object' ? range :\n            getSwapRange(getRangeIndexes(range));\n        if (indexes[0] === 0 && indexes[2] === sheet.rowCount - 1) {\n            for (var i = indexes[1]; i <= indexes[3]; i++) {\n                setColumn(sheet, i, { isLocked: args.isLocked });\n            }\n        }\n        for (var i = indexes[0]; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                if (this.parent.getActiveSheet().id === sheet.id) {\n                    this.parent.notify(applyLockCells, { rowIdx: i, colIdx: j, isLocked: args.isLocked\n                    });\n                }\n            }\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    WorkbookProtectSheet.prototype.getModuleName = function () {\n        return 'workbookProtectSheet';\n    };\n    return WorkbookProtectSheet;\n}());\nexport { WorkbookProtectSheet };\n","import { getCell, setCell } from '../base/index';\nimport { setMerge, getSwapRange, getRangeIndexes, mergedRange, applyMerge, activeCellMergedRange } from './../common/index';\nimport { insertMerge, activeCellChanged, pasteMerge, getCellIndexes, checkIsFormula, setCellFormat } from './../common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookMerge` module is used to merge the range of cells.\n */\nvar WorkbookMerge = /** @class */ (function () {\n    /**\n     * Constructor for the workbook merge module.\n     * @private\n     */\n    function WorkbookMerge(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WorkbookMerge.prototype.merge = function (args) {\n        if (args.isAction) {\n            this.parent.notify('actionBegin', { eventArgs: args, action: 'merge' });\n            if (!args.model) {\n                args.model = [];\n            }\n        }\n        if (typeof (args.range) === 'string') {\n            args.range = getRangeIndexes(args.range);\n        }\n        args.range = getSwapRange(args.range);\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        if (!args.skipChecking) {\n            this.mergedRange(args);\n        }\n        if (!args.merge || args.type === 'All') {\n            this.mergeAll(args);\n            if (args.refreshRibbon) {\n                this.parent.notify(activeCellChanged, null);\n            }\n        }\n        else if (args.type === 'Horizontally') {\n            this.mergeHorizontally(args);\n        }\n        else if (args.type === 'Vertically') {\n            this.mergeVertically(args);\n        }\n        this.parent.setUsedRange(args.range[2], args.range[3]);\n        if (args.isAction) {\n            this.parent.notify('actionComplete', { eventArgs: args, action: 'merge' });\n        }\n        if (this.parent.sheets.indexOf(sheet) === this.parent.activeSheetIndex) {\n            this.parent.notify('selectRange', { indexes: getRangeIndexes(sheet.selectedRange), skipChecking: true });\n        }\n    };\n    WorkbookMerge.prototype.mergeAll = function (args) {\n        var rowSpan = 0;\n        var cell;\n        args.range = args.range;\n        var colSpan;\n        var value;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var curCell;\n        var startCell = getCell(args.range[0], args.range[1], sheet);\n        var border = startCell ? (startCell.style ? startCell.style.borderLeft : null) : null;\n        if (border === 'none') {\n            border = startCell.style.borderRight !== 'none' ? startCell.style.borderRight :\n                (startCell.style.borderTop ? startCell.style.borderTop : null);\n        }\n        if (border === 'none') {\n            border = startCell.style.borderBottom !== 'none' ? startCell.style.borderBottom : null;\n        }\n        if (!isNullOrUndefined(startCell) && !isNullOrUndefined(border)) {\n            startCell.style.borderBottom = '';\n            startCell.style.borderLeft = '';\n            startCell.style.borderTop = '';\n            startCell.style.borderRight = '';\n        }\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            colSpan = 0;\n            if (args.isAction) {\n                args.model.push({ cells: [] });\n            }\n            for (var j = args.range[1]; j <= args.range[3]; j++) {\n                cell = getCell(i, j, sheet);\n                if (cell && (cell.value || cell.formula) && !value) {\n                    value = cell.formula || cell.value;\n                }\n                if (args.isAction && args.merge) {\n                    args.model[i - args.range[0]].cells[j - args.range[1]] = {};\n                    Object.assign(args.model[i - args.range[0]].cells[j - args.range[1]], cell);\n                }\n                if (sheet.rows[i] && sheet.rows[i].cells && sheet.rows[i].cells[j]) {\n                    delete sheet.rows[i].cells[j].rowSpan;\n                    delete sheet.rows[i].cells[j].colSpan;\n                    if (!args.merge && !args.isAction && args.model && args.model[i - args.range[0]] && args.model[i - args.range[0]].\n                        cells[j - args.range[1]] && args.model[i - args.range[0]].cells[j - args.range[1]] !== {}) {\n                        setCell(i, j, sheet, args.model[i - args.range[0]].cells[j - args.range[1]]);\n                    }\n                }\n                if (args.merge) {\n                    cell = new Object();\n                    if (i === args.range[0] && j === args.range[1]) {\n                        if (args.range[3] - args.range[1] > 0) {\n                            cell.colSpan = (args.range[3] - args.range[1]) + 1;\n                        }\n                        if (args.range[2] - args.range[0] > 0) {\n                            cell.rowSpan = (args.range[2] - args.range[0]) + 1;\n                        }\n                        setCell(args.range[0], args.range[1], sheet, cell, true);\n                        continue;\n                    }\n                    else {\n                        if (i !== args.range[0]) {\n                            cell.rowSpan = -rowSpan;\n                        }\n                        if (j !== args.range[1]) {\n                            colSpan++;\n                            cell.colSpan = -colSpan;\n                        }\n                        if (sheet.rows[i] && sheet.rows[i].cells && sheet.rows[i].cells[j]) {\n                            delete sheet.rows[i].cells[j].value;\n                            delete sheet.rows[i].cells[j].formula;\n                        }\n                        curCell = getCell(i, j, sheet) || {};\n                        setCell(i, j, sheet, Object.assign(cell, curCell));\n                    }\n                }\n                if (!args.preventRefresh) {\n                    this.parent.notify(applyMerge, { rowIdx: i, colIdx: j });\n                }\n            }\n            rowSpan++;\n        }\n        if (args.merge) {\n            cell = this.getCellValue(args.range[0], args.range[1], value, sheet);\n            setCell(args.range[0], args.range[1], sheet, cell, true);\n            if (!args.preventRefresh) {\n                this.parent.notify(applyMerge, { rowIdx: args.range[0], colIdx: args.range[1] });\n            }\n        }\n        if (!isNullOrUndefined(border)) {\n            this.parent.notify(setCellFormat, { style: { border: border }, range: args.range, onActionUpdate: true });\n        }\n    };\n    WorkbookMerge.prototype.mergeHorizontally = function (args) {\n        var mergeCount;\n        args.range = args.range;\n        var cell;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var newValue;\n        var rowIdx;\n        var curCell;\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            mergeCount = 0;\n            if (args.isAction) {\n                args.model.push({ cells: [] });\n            }\n            for (var j = args.range[1]; j <= args.range[3]; j++) {\n                curCell = getCell(i, j, sheet);\n                cell = new Object();\n                if (args.isAction) {\n                    args.model[i - args.range[0]].cells[j - args.range[1]] = {};\n                    Object.assign(args.model[i - args.range[0]].cells[j - args.range[1]], curCell);\n                }\n                if (j === args.range[1]) {\n                    if (i === args.range[0]) {\n                        continue;\n                    }\n                    rowIdx = i - 1;\n                    if (sheet.rows[rowIdx] && sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[j]) {\n                        delete sheet.rows[rowIdx].cells[j].rowSpan;\n                    }\n                    cell = this.getCellValue(rowIdx, j, newValue, sheet);\n                    if (args.range[3] - args.range[1] > 0) {\n                        cell.colSpan = (args.range[3] - args.range[1]) + 1;\n                    }\n                    newValue = null;\n                    setCell(rowIdx, j, sheet, cell, true);\n                }\n                else {\n                    if (curCell && (curCell.value || curCell.formula) && !newValue) {\n                        newValue = curCell.formula || curCell.value;\n                    }\n                    rowIdx = i;\n                    if (sheet.rows[rowIdx] && sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[j]) {\n                        delete sheet.rows[rowIdx].cells[j].rowSpan;\n                        delete sheet.rows[rowIdx].cells[j].value;\n                        delete sheet.rows[rowIdx].cells[j].formula;\n                    }\n                    mergeCount++;\n                    cell.colSpan = -mergeCount;\n                    setCell(rowIdx, j, sheet, cell, true);\n                }\n                this.parent.notify(applyMerge, { rowIdx: rowIdx, colIdx: j });\n            }\n        }\n        if (sheet.rows[args.range[2]] && sheet.rows[args.range[2]].cells && sheet.rows[args.range[2]].cells[args.range[1]]) {\n            delete sheet.rows[args.range[2]].cells[args.range[1]].rowSpan;\n        }\n        cell = this.getCellValue(args.range[2], args.range[1], newValue, sheet);\n        if (args.range[3] - args.range[1] > 0) {\n            cell.colSpan = (args.range[3] - args.range[1]) + 1;\n        }\n        setCell(args.range[2], args.range[1], sheet, cell, true);\n        this.parent.notify(applyMerge, { rowIdx: args.range[2], colIdx: args.range[1] });\n    };\n    WorkbookMerge.prototype.getCellValue = function (rowIdx, colIdx, value, sheet) {\n        var cell = new Object();\n        var curCell = getCell(rowIdx, colIdx, sheet);\n        if (value && (!curCell || (!curCell.value && !curCell.formula))) {\n            if (checkIsFormula(value)) {\n                cell.formula = value;\n            }\n            else {\n                cell.value = value;\n            }\n        }\n        return cell;\n    };\n    WorkbookMerge.prototype.mergeVertically = function (args) {\n        var rowSpan = 0;\n        args.range = args.range;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var cell;\n        var newValue;\n        var colIdx;\n        var curCell;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            for (var j = args.range[0]; j <= args.range[2]; j++) {\n                curCell = getCell(j, i, sheet);\n                if (args.isAction) {\n                    if (args.model[j - args.range[0]] === undefined) {\n                        args.model[j - args.range[0]] = { cells: [] };\n                    }\n                    args.model[j - args.range[0]].cells[i - args.range[1]] = {};\n                    Object.assign(args.model[j - args.range[0]].cells[i - args.range[1]], curCell);\n                }\n                if (j === args.range[0]) {\n                    rowSpan = 0;\n                    if (i === args.range[1]) {\n                        continue;\n                    }\n                    colIdx = i - 1;\n                    if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[colIdx]) {\n                        delete sheet.rows[j].cells[colIdx].colSpan;\n                    }\n                    cell = this.getCellValue(j, colIdx, newValue, sheet);\n                    if (args.range[2] - args.range[0] > 0) {\n                        cell.rowSpan = (args.range[2] - args.range[0]) + 1;\n                    }\n                    newValue = null;\n                    setCell(j, colIdx, sheet, cell, true);\n                }\n                else {\n                    cell = new Object();\n                    if (curCell && (curCell.value || curCell.formula) && !newValue) {\n                        newValue = curCell.formula || curCell.value;\n                    }\n                    rowSpan++;\n                    colIdx = i;\n                    if (sheet.rows[j] && sheet.rows[j].cells && sheet.rows[j].cells[colIdx]) {\n                        delete sheet.rows[j].cells[colIdx].colSpan;\n                        delete sheet.rows[j].cells[colIdx].value;\n                        delete sheet.rows[j].cells[colIdx].formula;\n                    }\n                    cell.rowSpan = -rowSpan;\n                    setCell(j, colIdx, sheet, cell, true);\n                }\n                this.parent.notify(applyMerge, { rowIdx: j, colIdx: colIdx });\n            }\n        }\n        if (sheet.rows[args.range[0]] && sheet.rows[args.range[0]].cells && sheet.rows[args.range[0]].cells[args.range[3]]) {\n            delete sheet.rows[args.range[0]].cells[args.range[3]].colSpan;\n        }\n        cell = this.getCellValue(args.range[0], args.range[1], newValue, sheet);\n        if (args.range[2] - args.range[0] > 0) {\n            cell.rowSpan = (args.range[2] - args.range[0]) + 1;\n        }\n        setCell(args.range[0], args.range[3], sheet, cell, true);\n        this.parent.notify(applyMerge, { rowIdx: args.range[0], colIdx: args.range[3] });\n    };\n    WorkbookMerge.prototype.activeCellRange = function (args) {\n        args.range = args.range;\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        if (cell) {\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                args.range[0] += cell.rowSpan;\n                if (args.insertCount) {\n                    args.range[0] -= args.insertCount;\n                }\n            }\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                args.range[1] += cell.colSpan;\n                if (args.insertCount) {\n                    args.range[1] -= args.insertCount;\n                }\n            }\n            cell = getCell(args.range[0], args.range[1], sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && (args.range[0] + (cell.rowSpan - 1) >= args.range[2] || args.insertCount)) {\n                    args.range[2] = args.range[0] + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && (args.range[1] + (cell.colSpan - 1) >= args.range[3] || args.insertCount)) {\n                    args.range[3] = args.range[1] + (cell.colSpan - 1);\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.mergedRange = function (args) {\n        if (typeof (args.range) === 'string') {\n            args.range = getRangeIndexes(args.range);\n        }\n        if (args.range[0] <= args.range[2] && args.range[1] <= args.range[3]) {\n            this.forward(args);\n        }\n        else if (args.range[0] >= args.range[2] && args.range[1] >= args.range[3]) {\n            this.reverse(args);\n        }\n        else if (args.range[0] < args.range[2] && args.range[1] > args.range[3]) {\n            this.forwardReverse(args);\n        }\n        else if (args.range[0] > args.range[2] && args.range[1] < args.range[3]) {\n            this.reverseForward(args);\n        }\n    };\n    WorkbookMerge.prototype.forward = function (args) {\n        args.range = args.range;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var endRowIdx;\n        var endColIdx;\n        var rowIdx = endRowIdx = args.range[0];\n        var colIdx = endColIdx = args.range[1];\n        if (cell) {\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rowIdx = endRowIdx = args.range[0] + cell.rowSpan;\n            }\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                colIdx = endColIdx = args.range[1] + cell.colSpan;\n            }\n            cell = getCell(rowIdx, colIdx, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1) {\n                    endRowIdx += (cell.rowSpan - 1);\n                    if (rowIdx + (cell.rowSpan - 1) >= args.range[2]) {\n                        args.range[2] = args.range[0];\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                }\n                if (cell.colSpan > 1) {\n                    endColIdx += (cell.colSpan - 1);\n                    if (colIdx + (cell.colSpan - 1) >= args.range[3]) {\n                        args.range[3] = args.range[1];\n                        args.range[3] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        args.range[0] = rowIdx;\n        args.range[1] = colIdx;\n        if (args.range[0] === rowIdx && args.range[1] === colIdx && args.range[2] === endRowIdx && args.range[3] === endColIdx) {\n            args.isActiveCell = true;\n        }\n        if (args.skipChecking) {\n            return;\n        }\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                rowIdx = args.range[2];\n                colIdx = i;\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[1]) {\n                        args.range[1] = colIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[0]) {\n                        args.range[0] = rowIdx;\n                    }\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[3]) {\n                        args.range[3] = colIdx;\n                        args.range[3] = colIdx + (cell.colSpan - 1);\n                    }\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = rowIdx;\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                }\n            }\n        }\n        var startRowIdx;\n        var startColIdx;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                startColIdx = i;\n                startRowIdx = args.range[0];\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    startColIdx += cell.colSpan;\n                    if (startColIdx < args.range[1]) {\n                        args.range[1] = startColIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    startRowIdx += cell.rowSpan;\n                    if (startRowIdx < args.range[0]) {\n                        args.range[0] = startRowIdx;\n                    }\n                }\n            }\n        }\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                rowIdx = i;\n                colIdx = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[0]) {\n                        args.range[0] = rowIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[1]) {\n                        args.range[1] = colIdx;\n                    }\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = rowIdx;\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[3]) {\n                        args.range[3] = colIdx;\n                        args.range[3] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.forwardReverse = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        args.range = args.range;\n        var colIndex = args.range[1];\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var rowIndex = args.range[0];\n        if (cell) {\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                colIndex += cell.colSpan;\n                if (args.range[3] >= colIndex) {\n                    args.range[3] = colIndex;\n                }\n            }\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rowIndex += cell.rowSpan;\n                if (rowIndex < args.range[0]) {\n                    args.range[0] = rowIndex;\n                }\n            }\n            cell = getCell(rowIndex, colIndex, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && rowIndex + (cell.rowSpan - 1) >= args.range[2]) {\n                    args.range[2] = rowIndex + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && colIndex + (cell.colSpan - 1) >= args.range[1]) {\n                    args.range[1] = colIndex + (cell.colSpan - 1);\n                }\n            }\n        }\n        args.range[0] = rowIndex;\n        if (args.skipChecking) {\n            return;\n        }\n        var rowIdx;\n        var cellIdx;\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                cellIdx = i;\n                rowIdx = args.range[2];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[0]) {\n                        args.range[0] = rowIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIdx += cell.colSpan;\n                    if (cellIdx < args.range[3]) {\n                        args.range[3] = cellIdx;\n                    }\n                }\n                cell = getCell(rowIdx, cellIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = rowIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && cellIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = cellIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        var startRowIndex;\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                cellIdx = i;\n                startRowIndex = args.range[0];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    startRowIndex += cell.rowSpan;\n                    if (startRowIndex < args.range[0]) {\n                        args.range[0] = startRowIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIdx += cell.colSpan;\n                }\n                cell = getCell(startRowIndex, cellIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && startRowIndex + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = startRowIndex + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && cellIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = cellIdx;\n                        args.range[1] = cellIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        var colIdx;\n        for (var i = args.range[0]; i <= args.range[2]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                startRowIndex = i;\n                colIdx = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    startRowIndex += cell.rowSpan;\n                    if (startRowIndex < args.range[0]) {\n                        args.range[0] = startRowIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[3]) {\n                        args.range[3] = colIdx;\n                    }\n                }\n                cell = getCell(startRowIndex, colIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && startRowIndex + (cell.rowSpan - 1) > args.range[2]) {\n                        args.range[2] = startRowIndex;\n                        args.range[2] = startRowIndex + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = colIdx;\n                        args.range[1] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.reverse = function (args) {\n        args.range = args.range;\n        var colnIdx = args.range[1];\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var rowIdx = args.range[0];\n        if (cell) {\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                colnIdx += cell.colSpan;\n            }\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rowIdx += cell.rowSpan;\n            }\n            if (args.range[2] >= rowIdx) {\n                args.range[2] = rowIdx;\n                args.isActiveCell = true;\n            }\n            if (args.range[3] >= colnIdx) {\n                args.range[3] = colnIdx;\n                if (args.range[2] === rowIdx) {\n                    args.isActiveCell = true;\n                }\n            }\n            else if (args.isActiveCell) {\n                args.isActiveCell = false;\n            }\n            cell = getCell(rowIdx, colnIdx, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) >= args.range[0]) {\n                    args.range[0] = rowIdx;\n                    args.range[0] = rowIdx + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && colnIdx + (cell.colSpan - 1) >= args.range[1]) {\n                    args.range[1] = colnIdx;\n                    args.range[1] = colnIdx + (cell.colSpan - 1);\n                }\n            }\n        }\n        var colIdx = args.range[3];\n        if (args.skipChecking) {\n            return;\n        }\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                colIdx = i;\n                rowIdx = args.range[2];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                    if (rowIdx < args.range[2]) {\n                        args.range[2] = rowIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                    if (colIdx < args.range[3]) {\n                        args.range[3] = colIdx;\n                    }\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = rowIdx;\n                        args.range[0] = rowIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = colIdx;\n                        args.range[1] = colIdx + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n        colIdx = args.range[3];\n        for (var i = args.range[3]; i <= args.range[1]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                colIdx = i;\n                rowIdx = args.range[0];\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    colIdx += cell.colSpan;\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rowIdx += cell.rowSpan;\n                }\n                cell = getCell(rowIdx, colIdx, sheet);\n                if (cell) {\n                    if (cell.colSpan > 1 && colIdx + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = colIdx;\n                        args.range[1] = colIdx + (cell.colSpan - 1);\n                    }\n                    if (cell.rowSpan > 1 && rowIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = rowIdx;\n                        args.range[0] = rowIdx + (cell.rowSpan - 1);\n                    }\n                }\n            }\n        }\n        var cellIndex;\n        var rIdx;\n        for (var i = args.range[2]; i <= args.range[0]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                rIdx = i;\n                cellIndex = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rIdx += cell.rowSpan;\n                    if (rIdx < args.range[2]) {\n                        args.range[2] = rIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIndex += cell.colSpan;\n                    if (cellIndex < args.range[3]) {\n                        args.range[3] = cellIndex;\n                    }\n                }\n                cell = getCell(rIdx, cellIndex, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && rIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = rIdx;\n                        args.range[0] = rIdx + (cell.rowSpan - 1);\n                    }\n                    if (cell.colSpan > 1 && cellIndex + (cell.colSpan - 1) > args.range[1]) {\n                        args.range[1] = cellIndex;\n                        args.range[1] = cellIndex + (cell.colSpan - 1);\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.reverseForward = function (args) {\n        args.range = args.range;\n        var sheet = args.sheet || this.parent.getActiveSheet();\n        var rIdx = args.range[0];\n        var cIdx = args.range[1];\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        if (cell) {\n            if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                rIdx += cell.rowSpan;\n                if (args.range[2] >= rIdx) {\n                    args.range[2] = rIdx;\n                }\n            }\n            if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                cIdx += cell.colSpan;\n            }\n            cell = getCell(rIdx, cIdx, sheet);\n            if (cell) {\n                if (cell.rowSpan > 1 && rIdx + (cell.rowSpan - 1) >= args.range[0]) {\n                    args.range[0] = rIdx;\n                    args.range[0] = rIdx + (cell.rowSpan - 1);\n                }\n                if (cell.colSpan > 1 && cIdx + (cell.colSpan - 1) >= args.range[3]) {\n                    args.range[3] = args.range[1];\n                    args.range[3] = cIdx + (cell.colSpan - 1);\n                }\n            }\n        }\n        if (args.skipChecking) {\n            return;\n        }\n        var cIndex = args.range[3];\n        var rIndex;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[2], i, sheet);\n            if (cell) {\n                rIndex = args.range[2];\n                cIndex = i;\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rIndex += cell.rowSpan;\n                    if (rIndex < args.range[2]) {\n                        args.range[2] = rIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cIndex += cell.colSpan;\n                    if (cIndex < args.range[1]) {\n                        args.range[1] = cIndex;\n                    }\n                }\n                cell = getCell(rIndex, cIndex, sheet);\n                if (cell) {\n                    if (cell.colSpan > 1 && cIndex + (cell.colSpan - 1) > args.range[3]) {\n                        args.range[3] = cIndex + (cell.colSpan - 1);\n                    }\n                    if (cell.rowSpan > 1 && (cell.rowSpan - 1) + rIndex > args.range[0]) {\n                        args.range[0] = (cell.rowSpan - 1) + rIndex;\n                    }\n                }\n            }\n        }\n        var sRowIdx;\n        var sColIdx;\n        for (var i = args.range[1]; i <= args.range[3]; i++) {\n            cell = getCell(args.range[0], i, sheet);\n            if (cell) {\n                sColIdx = i;\n                sRowIdx = args.range[0];\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    sColIdx += cell.colSpan;\n                    if (sColIdx < args.range[1]) {\n                        args.range[1] = sColIdx;\n                    }\n                }\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    sRowIdx += cell.rowSpan;\n                }\n                cell = getCell(sRowIdx, sColIdx, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && sRowIdx + (cell.rowSpan - 1) > args.range[0]) {\n                        args.range[0] = sRowIdx + (cell.rowSpan - 1);\n                    }\n                }\n            }\n        }\n        var cellIndex;\n        for (var i = args.range[2]; i <= args.range[0]; i++) {\n            cell = getCell(i, args.range[3], sheet);\n            if (cell) {\n                rIndex = i;\n                cellIndex = args.range[3];\n                if (!isNullOrUndefined(cell.rowSpan) && cell.rowSpan < 0) {\n                    rIndex += cell.rowSpan;\n                    if (rIndex < args.range[2]) {\n                        args.range[2] = rIndex;\n                    }\n                }\n                if (!isNullOrUndefined(cell.colSpan) && cell.colSpan < 0) {\n                    cellIndex += cell.colSpan;\n                    if (cellIndex < args.range[1]) {\n                        args.range[1] = cellIndex;\n                    }\n                }\n                cell = getCell(rIndex, cellIndex, sheet);\n                if (cell) {\n                    if (cell.rowSpan > 1 && (cell.rowSpan - 1) + rIndex > args.range[0]) {\n                        args.range[0] = (cell.rowSpan - 1) + rIndex;\n                    }\n                    if (cell.colSpan > 1 && (cell.colSpan - 1) + cellIndex > args.range[3]) {\n                        args.range[3] = cellIndex;\n                        args.range[3] = (cell.colSpan - 1) + cellIndex;\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.insertHandler = function (args) {\n        this.activeCellRange(args);\n        args.range = args.range;\n        if (args.insertModel === 'Row') {\n            args.range[2] += args.insertCount;\n        }\n        else {\n            args.range[3] += args.insertCount;\n        }\n        args.preventRefresh = true;\n        args.merge = true;\n        this.mergeAll(args);\n    };\n    WorkbookMerge.prototype.pasteHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var cell;\n        var nextCell;\n        var prevCell;\n        var activeCell = getCellIndexes(sheet.activeCell);\n        for (var i = args.range[0], l = 0; i <= args.range[2]; i++, l++) {\n            for (var j = args.range[1], k = 0; j <= args.range[3]; j++, k++) {\n                cell = getCell(i, j, args.prevSheet) || {};\n                if (cell.rowSpan > 1) {\n                    prevCell = getCell(activeCell[0] + (cell.rowSpan - 1), activeCell[1], sheet) || {};\n                    nextCell = getCell(activeCell[0] + 1, activeCell[1], sheet) || {};\n                    if ((prevCell.colSpan !== undefined && prevCell.colSpan < 0) || (nextCell.colSpan !== undefined &&\n                        nextCell.colSpan < 0)) {\n                        args.cancel = true;\n                        this.parent.notify(applyMerge, { showDialog: true });\n                        return;\n                    }\n                }\n                if (cell.colSpan > 1) {\n                    prevCell = getCell(activeCell[0], activeCell[1] + (cell.colSpan - 1), sheet) || {};\n                    nextCell = getCell(activeCell[0], activeCell[1] + 1, sheet) || {};\n                    if ((prevCell.rowSpan !== undefined && prevCell.rowSpan < 0) || (nextCell.rowSpan !== undefined &&\n                        nextCell.rowSpan < 0)) {\n                        args.cancel = true;\n                        this.parent.notify(applyMerge, { showDialog: true });\n                        return;\n                    }\n                }\n            }\n        }\n    };\n    WorkbookMerge.prototype.addEventListener = function () {\n        this.parent.on(setMerge, this.merge, this);\n        this.parent.on(mergedRange, this.mergedRange, this);\n        this.parent.on(activeCellMergedRange, this.activeCellRange, this);\n        this.parent.on(insertMerge, this.insertHandler, this);\n        this.parent.on(pasteMerge, this.pasteHandler, this);\n    };\n    /**\n     * Destroy workbook merge module.\n     */\n    WorkbookMerge.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookMerge.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setMerge, this.merge);\n            this.parent.off(mergedRange, this.mergedRange);\n            this.parent.off(activeCellMergedRange, this.activeCellRange);\n            this.parent.off(insertMerge, this.insertHandler);\n            this.parent.off(pasteMerge, this.pasteHandler);\n        }\n    };\n    /**\n     * Get the workbook merge module name.\n     */\n    WorkbookMerge.prototype.getModuleName = function () {\n        return 'workbookmerge';\n    };\n    return WorkbookMerge;\n}());\nexport { WorkbookMerge };\n","import { setCell, setRow, getSheet } from '../base/index';\nimport { setCFRule, clearCFRule, getRangeAddress, applyCellFormat } from '../common/index';\nimport { getRangeIndexes } from '../common/index';\nimport { cFInitialCheck, clearCF } from '../common/index';\nimport { completeAction } from '../../spreadsheet/common/event';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The `WorkbookConditionalFormat` module is used to handle conditional formatting action in Spreadsheet.\n */\nvar WorkbookConditionalFormat = /** @class */ (function () {\n    /**\n     * Constructor for WorkbookConditionalFormat module.\n     */\n    function WorkbookConditionalFormat(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the conditional format module.\n     */\n    WorkbookConditionalFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    WorkbookConditionalFormat.prototype.addEventListener = function () {\n        this.parent.on(setCFRule, this.setCFrulHandler, this);\n        this.parent.on(clearCFRule, this.clearRules, this);\n    };\n    WorkbookConditionalFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(setCFRule, this.setCFrulHandler);\n            this.parent.off(clearCFRule, this.clearRules);\n        }\n    };\n    WorkbookConditionalFormat.prototype.setCFrulHandler = function (args) {\n        var conditionalFormat = args.conditionalFormat;\n        var range = conditionalFormat.range;\n        var sheetIndex = this.parent.getAddressInfo(range).sheetIndex;\n        var sheet = getSheet(this.parent, sheetIndex);\n        range = range || sheet.selectedRange;\n        conditionalFormat.range = range;\n        var indexes = getRangeIndexes(range);\n        var cfrCount;\n        if (!sheet.conditionalFormats) {\n            this.parent.setSheetPropertyOnMute(sheet, 'conditionalFormats', []);\n        }\n        cfrCount = sheet.conditionalFormats.length;\n        sheet.conditionalFormats[cfrCount] = conditionalFormat;\n        for (var rIdx = indexes[0]; rIdx <= indexes[2]; rIdx++) {\n            if (!sheet.rows[rIdx]) {\n                setRow(sheet, rIdx, {});\n            }\n            for (var cIdx = indexes[1]; cIdx <= indexes[3]; cIdx++) {\n                if (!sheet.rows[rIdx].cells || !sheet.rows[rIdx].cells[cIdx]) {\n                    setCell(rIdx, cIdx, sheet, {});\n                }\n                if (sheetIndex === this.parent.activeSheetIndex) {\n                    var cell = sheet.rows[rIdx].cells[cIdx];\n                    this.parent.notify(cFInitialCheck, { rowIdx: rIdx, colIdx: cIdx, cell: cell, conditionalFormat: conditionalFormat });\n                }\n            }\n        }\n    };\n    // tslint:disable-next-line:max-func-body-length\n    WorkbookConditionalFormat.prototype.clearRules = function (args) {\n        var isPublic = isNullOrUndefined(args.isPublic) ? true : false;\n        var cFormats = [];\n        var oldRange = [];\n        var isFirst = true;\n        var top;\n        var bottom;\n        var left;\n        var right;\n        var frontColIdx;\n        var backColIdx;\n        var topRowIdx;\n        var bottomRowIdx;\n        var range = args.range;\n        var sheetIndex = this.parent.getAddressInfo(range).sheetIndex;\n        var sheet = getSheet(this.parent, sheetIndex);\n        var cFRules = sheet.conditionalFormats;\n        var rangeIndexes = getRangeIndexes(range);\n        if (sheetIndex === this.parent.activeSheetIndex) {\n            for (var rIdx = rangeIndexes[0]; rIdx <= rangeIndexes[2]; rIdx++) {\n                for (var cIdx = rangeIndexes[1]; cIdx <= rangeIndexes[3]; cIdx++) {\n                    this.parent.notify(clearCF, { rIdx: rIdx, cIdx: cIdx });\n                }\n            }\n        }\n        if (!cFRules) {\n            return;\n        }\n        for (var cFRulesIdx = cFRules.length - 1; cFRulesIdx >= 0; cFRulesIdx--) {\n            var isPresent = false;\n            var result = '';\n            var cFRule = cFRules[cFRulesIdx];\n            var cFRanges = cFRule.range.split(',');\n            if (sheetIndex === this.parent.activeSheetIndex) {\n                for (var cFRangeIdx = 0; cFRangeIdx < cFRanges.length; cFRangeIdx++) {\n                    var isFull = false;\n                    var cFRange = cFRanges[cFRangeIdx];\n                    var cFRangeIndexes = getRangeIndexes(cFRange);\n                    topRowIdx = cFRangeIndexes[0];\n                    bottomRowIdx = cFRangeIndexes[0];\n                    frontColIdx = cFRangeIndexes[1];\n                    backColIdx = cFRangeIndexes[1];\n                    if (cFRangeIndexes[0] >= rangeIndexes[0] && cFRangeIndexes[2] <= rangeIndexes[2] &&\n                        cFRangeIndexes[1] >= rangeIndexes[1] && cFRangeIndexes[3] <= rangeIndexes[3]) {\n                        isFull = true;\n                    }\n                    for (var cFRRowIdx = cFRangeIndexes[0]; cFRRowIdx <= cFRangeIndexes[2]; cFRRowIdx++) {\n                        var isTrue = 0;\n                        for (var cFRColIdx = cFRangeIndexes[1]; cFRColIdx <= cFRangeIndexes[3]; cFRColIdx++) {\n                            for (var rRowIdx = rangeIndexes[0]; rRowIdx <= rangeIndexes[2]; rRowIdx++) {\n                                for (var rColIdx = rangeIndexes[1]; rColIdx <= rangeIndexes[3]; rColIdx++) {\n                                    if (rRowIdx === cFRRowIdx && rColIdx === cFRColIdx) {\n                                        var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [rRowIdx, rColIdx]);\n                                        this.parent.notify(applyCellFormat, {\n                                            style: style, rowIdx: rRowIdx, colIdx: rColIdx,\n                                            lastCell: true, isHeightCheckNeeded: true, manualUpdate: true\n                                        });\n                                        isTrue = isTrue + 1;\n                                        isPresent = true;\n                                        if (rRowIdx === cFRangeIndexes[0]) {\n                                            if (rColIdx === cFRangeIndexes[3]) {\n                                                if (frontColIdx === cFRangeIndexes[1]) {\n                                                    if (backColIdx === rColIdx) {\n                                                        backColIdx = rColIdx;\n                                                    }\n                                                    else {\n                                                        frontColIdx = rColIdx - 1;\n                                                    }\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx + 1 === rColIdx) {\n                                                    backColIdx = cFRangeIndexes[1];\n                                                    frontColIdx = frontColIdx - 1;\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rangeIndexes[1] - 1;\n                                                }\n                                            }\n                                            else if (rColIdx === cFRangeIndexes[1]) {\n                                                if (backColIdx === cFRangeIndexes[1]) {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                            }\n                                            else {\n                                                if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rColIdx;\n                                                    backColIdx = rColIdx;\n                                                }\n                                                else if (frontColIdx === cFRangeIndexes[1] && backColIdx !== cFRangeIndexes[1]) {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                                else {\n                                                    backColIdx = rColIdx;\n                                                }\n                                            }\n                                        }\n                                        else {\n                                            if (rColIdx === cFRangeIndexes[1]) {\n                                                if (backColIdx === cFRangeIndexes[1] && cFRangeIndexes[1] !== cFRangeIndexes[3]) {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                            }\n                                            else if (rColIdx === cFRangeIndexes[3]) {\n                                                if (frontColIdx === cFRangeIndexes[1]) {\n                                                    if (backColIdx === rColIdx) {\n                                                        backColIdx = rColIdx;\n                                                    }\n                                                    else {\n                                                        frontColIdx = rColIdx - 1;\n                                                    }\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rangeIndexes[1] - 1;\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx + 1 === rColIdx) {\n                                                    backColIdx = cFRangeIndexes[1];\n                                                    frontColIdx = rangeIndexes[1] - 1;\n                                                }\n                                                else {\n                                                    bottomRowIdx = rRowIdx;\n                                                }\n                                            }\n                                            else {\n                                                if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rColIdx;\n                                                    backColIdx = rColIdx;\n                                                }\n                                                else if (backColIdx !== cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                                    backColIdx = rColIdx;\n                                                }\n                                                else if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                                    frontColIdx = rColIdx;\n                                                }\n                                                else {\n                                                    backColIdx = rColIdx + 1;\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                        if (isTrue > 0 && !isFull) {\n                            if (isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx;\n                                left = frontColIdx;\n                                right = backColIdx;\n                            }\n                            if (frontColIdx === cFRangeIndexes[1] && backColIdx !== cFRangeIndexes[1]) {\n                                if (backColIdx === cFRangeIndexes[3]) {\n                                    if (topRowIdx !== cFRRowIdx) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, left, bottom, cFRangeIndexes[3]]);\n                                    }\n                                    if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[3]) {\n                                        if (cFRRowIdx === cFRangeIndexes[2]) {\n                                            if (cFRangeIndexes[1] === rangeIndexes[3]) {\n                                                result = result + ' ' + getRangeAddress([cFRRowIdx, backColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                            }\n                                        }\n                                        else {\n                                            if (rangeIndexes[2] === cFRangeIndexes[0] && backColIdx !== cFRangeIndexes[3]) {\n                                                result = result + ' ' + getRangeAddress([cFRRowIdx, backColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                            }\n                                            topRowIdx = cFRRowIdx + 1;\n                                            bottomRowIdx = cFRRowIdx + 1;\n                                            backColIdx = cFRangeIndexes[1];\n                                        }\n                                    }\n                                }\n                                else if (right !== backColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, right, cFRRowIdx - 1, cFRangeIndexes[3]]);\n                                    if (backColIdx === cFRangeIndexes[3] && frontColIdx === cFRangeIndexes[1]) {\n                                        topRowIdx = cFRRowIdx + 1;\n                                        bottomRowIdx = cFRRowIdx + 1;\n                                        backColIdx = cFRangeIndexes[1];\n                                    }\n                                    else {\n                                        topRowIdx = cFRRowIdx;\n                                        bottomRowIdx = cFRRowIdx;\n                                    }\n                                    if (backColIdx === cFRangeIndexes[3] && frontColIdx !== cFRangeIndexes[1]) {\n                                        frontColIdx = cFRangeIndexes[1];\n                                    }\n                                }\n                                else if (left !== frontColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], cFRRowIdx - 1, left]);\n                                    topRowIdx = cFRRowIdx + 1;\n                                    bottomRowIdx = cFRRowIdx + 1;\n                                    frontColIdx = cFRangeIndexes[1];\n                                    backColIdx = cFRangeIndexes[1];\n                                }\n                                else if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                }\n                                else {\n                                    if (bottomRowIdx < cFRRowIdx || (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[3])) {\n                                        bottomRowIdx = cFRRowIdx;\n                                    }\n                                }\n                            }\n                            else if (backColIdx === cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                if (right !== backColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, right, cFRRowIdx - 1, cFRangeIndexes[3]]);\n                                    topRowIdx = cFRRowIdx;\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                                if (left !== frontColIdx) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, left, cFRRowIdx - 1, cFRangeIndexes[3]]);\n                                    topRowIdx = cFRRowIdx;\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                                if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, cFRRowIdx, frontColIdx]);\n                                }\n                                else {\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                            }\n                            else if (backColIdx !== cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                if (cFRRowIdx === cFRangeIndexes[2] && cFRangeIndexes[2] === rangeIndexes[0]) {\n                                    if (cFRangeIndexes[0] === cFRangeIndexes[2]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], bottomRowIdx, frontColIdx - 1]);\n                                        result = result + ' ' +\n                                            getRangeAddress([topRowIdx, backColIdx + 1, bottomRowIdx, cFRangeIndexes[3]]);\n                                    }\n                                    else {\n                                        result =\n                                            result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], bottomRowIdx, cFRangeIndexes[3]]);\n                                        result = result + ' ' +\n                                            getRangeAddress([cFRangeIndexes[2], cFRangeIndexes[1], cFRangeIndexes[2], frontColIdx - 1]);\n                                        result = result + ' ' +\n                                            getRangeAddress([cFRangeIndexes[2], backColIdx + 1, cFRangeIndexes[2], cFRangeIndexes[3]]);\n                                    }\n                                }\n                                else if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], cFRRowIdx, frontColIdx - 1]);\n                                    result = result + ' ' + getRangeAddress([topRowIdx, backColIdx + 1, cFRRowIdx, cFRangeIndexes[3]]);\n                                }\n                                else {\n                                    if (left === cFRangeIndexes[1] && right === cFRangeIndexes[1]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, left, bottomRowIdx, cFRangeIndexes[3]]);\n                                        topRowIdx = cFRRowIdx;\n                                    }\n                                    bottomRowIdx = cFRRowIdx;\n                                }\n                            }\n                            else if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                if (rangeIndexes[2] !== cFRangeIndexes[0]) {\n                                    if (cFRangeIndexes[2] >= rangeIndexes[2] && cFRRowIdx > rangeIndexes[2]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, bottomRowIdx, cFRangeIndexes[3]]);\n                                    }\n                                    if (cFRangeIndexes[1] === cFRangeIndexes[3] &&\n                                        cFRRowIdx <= cFRangeIndexes[2] && top !== cFRangeIndexes[2] && cFRRowIdx !== top) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, bottomRowIdx, cFRangeIndexes[3]]);\n                                    }\n                                    if (cFRangeIndexes[1] === cFRangeIndexes[3]) {\n                                        topRowIdx = cFRRowIdx + 1;\n                                        bottomRowIdx = cFRRowIdx + 1;\n                                    }\n                                }\n                                else {\n                                    if (cFRRowIdx === cFRangeIndexes[2] || cFRRowIdx === cFRangeIndexes[0] &&\n                                        cFRangeIndexes[1] !== cFRangeIndexes[3]) {\n                                        result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, bottomRowIdx, backColIdx]);\n                                    }\n                                    topRowIdx = cFRRowIdx + 1;\n                                    bottomRowIdx = cFRRowIdx + 1;\n                                }\n                                if (cFRRowIdx === cFRangeIndexes[2] && cFRangeIndexes[0] !== cFRangeIndexes[2] &&\n                                    cFRangeIndexes[1] !== cFRangeIndexes[3]) {\n                                    result = result + ' ' + getRangeAddress([cFRRowIdx, frontColIdx, cFRRowIdx, backColIdx]);\n                                }\n                            }\n                            if (!isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx <= cFRangeIndexes[2] ? bottomRowIdx : cFRangeIndexes[2];\n                                left = frontColIdx;\n                                right = backColIdx <= cFRangeIndexes[3] ? backColIdx : cFRangeIndexes[3];\n                            }\n                            isFirst = false;\n                        }\n                        else if (!isFull) {\n                            if (isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx;\n                                left = frontColIdx;\n                                right = backColIdx;\n                            }\n                            if (frontColIdx === cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                if (cFRRowIdx === cFRangeIndexes[2]) {\n                                    result = result + ' ' + getRangeAddress([topRowIdx, frontColIdx, cFRRowIdx, cFRangeIndexes[3]]);\n                                }\n                                bottomRowIdx = cFRRowIdx;\n                            }\n                            if (backColIdx !== cFRangeIndexes[1] && frontColIdx !== cFRangeIndexes[1]) {\n                                result = result + ' ' + getRangeAddress([topRowIdx, cFRangeIndexes[1], (cFRRowIdx - 1), frontColIdx - 1]);\n                                result = result + ' ' + getRangeAddress([topRowIdx, backColIdx + 1, (cFRRowIdx - 1), cFRangeIndexes[3]]);\n                                topRowIdx = cFRRowIdx;\n                                bottomRowIdx = cFRRowIdx;\n                                frontColIdx = cFRangeIndexes[1];\n                                backColIdx = cFRangeIndexes[1];\n                            }\n                            if (backColIdx !== cFRangeIndexes[1] && frontColIdx === cFRangeIndexes[1]) {\n                                result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, (cFRRowIdx - 1), cFRangeIndexes[3]]);\n                                topRowIdx = cFRRowIdx;\n                                bottomRowIdx = cFRRowIdx;\n                                frontColIdx = cFRangeIndexes[1];\n                                backColIdx = cFRangeIndexes[1];\n                            }\n                            if (frontColIdx !== cFRangeIndexes[1] && backColIdx === cFRangeIndexes[1]) {\n                                result = result + ' ' + getRangeAddress([topRowIdx, backColIdx, (cFRRowIdx - 1), frontColIdx]);\n                                topRowIdx = cFRRowIdx;\n                                bottomRowIdx = cFRRowIdx;\n                                frontColIdx = cFRangeIndexes[1];\n                                backColIdx = cFRangeIndexes[1];\n                            }\n                            if (!isFirst) {\n                                top = topRowIdx;\n                                bottom = bottomRowIdx <= cFRangeIndexes[2] ? bottomRowIdx : cFRangeIndexes[2];\n                                left = frontColIdx;\n                                right = backColIdx <= cFRangeIndexes[3] ? backColIdx : cFRangeIndexes[3];\n                            }\n                            isFirst = false;\n                        }\n                    }\n                }\n            }\n            if (result === '') {\n                oldRange.push(sheet.conditionalFormats[cFRulesIdx].range);\n                sheet.conditionalFormats.splice(cFRulesIdx, 1);\n            }\n            else {\n                oldRange.push(sheet.conditionalFormats[cFRulesIdx].range);\n                sheet.conditionalFormats[cFRulesIdx].range = result.trim().replace(' ', ',');\n            }\n            if (isPresent && !isPublic) {\n                cFRule.range = result.trim().replace(' ', ',');\n                cFormats.push(cFRule);\n            }\n        }\n        if (!isPublic) {\n            var eventArgs = { cFormats: cFormats, oldRange: oldRange, selectedRange: range };\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'clearCF' });\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    WorkbookConditionalFormat.prototype.getModuleName = function () {\n        return 'workbookConditionalFormatting';\n    };\n    return WorkbookConditionalFormat;\n}());\nexport { WorkbookConditionalFormat };\n","import { Workbook, DataBind } from '../index';\nimport { WorkbookSave, WorkbookFormula, WorkbookOpen, WorkbookSort, WorkbookFilter, WorkbookImage } from '../integrations/index';\nimport { WorkbookNumberFormat } from '../integrations/number-format';\nimport { WorkbookEdit, WorkbookCellFormat, WorkbookHyperlink, WorkbookInsert, WorkbookDelete } from '../actions/index';\nimport { WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge } from '../actions/index';\nimport { WorkbookConditionalFormat } from '../actions/conditional-formatting';\nimport { WorkbookChart } from '../integrations/index';\n/**\n * Workbook basic module.\n * @private\n */\nvar WorkbookBasicModule = /** @class */ (function () {\n    /**\n     * Constructor for Workbook basic module.\n     * @private\n     */\n    function WorkbookBasicModule() {\n        Workbook.Inject(DataBind, WorkbookSave, WorkbookOpen, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula, WorkbookSort, WorkbookHyperlink, WorkbookFilter, WorkbookInsert, WorkbookDelete, WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge, WorkbookConditionalFormat, WorkbookImage, WorkbookChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    WorkbookBasicModule.prototype.getModuleName = function () {\n        return 'workbookBasic';\n    };\n    /**\n     * Destroys the Workbook basic module.\n     * @return {void}\n     */\n    WorkbookBasicModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return WorkbookBasicModule;\n}());\nexport { WorkbookBasicModule };\n","import { Workbook, DataBind } from '../../workbook/index';\nimport { WorkbookSave, WorkbookNumberFormat, WorkbookFormula, WorkbookOpen, WorkbookChart } from '../integrations/index';\nimport { WorkbookSort, WorkbookFilter, WorkbookImage } from '../integrations/index';\nimport { WorkbookEdit, WorkbookCellFormat, WorkbookHyperlink, WorkbookInsert, WorkbookDelete } from '../actions/index';\nimport { WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge } from '../actions/index';\nimport { WorkbookConditionalFormat } from '../actions/conditional-formatting';\n/**\n * Workbook all module.\n * @private\n */\nvar WorkbookAllModule = /** @class */ (function () {\n    /**\n     * Constructor for Workbook all module.\n     * @private\n     */\n    function WorkbookAllModule() {\n        Workbook.Inject(DataBind, WorkbookSave, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula, WorkbookOpen, WorkbookSort, WorkbookHyperlink, WorkbookFilter, WorkbookInsert, WorkbookDelete, WorkbookFindAndReplace, WorkbookProtectSheet, WorkbookDataValidation, WorkbookMerge, WorkbookConditionalFormat, WorkbookImage, WorkbookChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    WorkbookAllModule.prototype.getModuleName = function () {\n        return 'workbook-all';\n    };\n    /**\n     * Destroys the Workbook all module.\n     * @return {void}\n     */\n    WorkbookAllModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return WorkbookAllModule;\n}());\nexport { WorkbookAllModule };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { ChildProperty, Property, Complex } from '@syncfusion/ej2-base';\n/**\n * Represents the cell style.\n */\nvar CellStyle = /** @class */ (function (_super) {\n    __extends(CellStyle, _super);\n    function CellStyle() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Calibri')\n    ], CellStyle.prototype, \"fontFamily\", void 0);\n    __decorate([\n        Property('bottom')\n    ], CellStyle.prototype, \"verticalAlign\", void 0);\n    __decorate([\n        Property('left')\n    ], CellStyle.prototype, \"textAlign\", void 0);\n    __decorate([\n        Property('0pt')\n    ], CellStyle.prototype, \"textIndent\", void 0);\n    __decorate([\n        Property('#000000')\n    ], CellStyle.prototype, \"color\", void 0);\n    __decorate([\n        Property('#ffffff')\n    ], CellStyle.prototype, \"backgroundColor\", void 0);\n    __decorate([\n        Property('normal')\n    ], CellStyle.prototype, \"fontWeight\", void 0);\n    __decorate([\n        Property('normal')\n    ], CellStyle.prototype, \"fontStyle\", void 0);\n    __decorate([\n        Property('11pt')\n    ], CellStyle.prototype, \"fontSize\", void 0);\n    __decorate([\n        Property('none')\n    ], CellStyle.prototype, \"textDecoration\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"border\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderTop\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderBottom\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderLeft\", void 0);\n    __decorate([\n        Property('')\n    ], CellStyle.prototype, \"borderRight\", void 0);\n    return CellStyle;\n}(ChildProperty));\nexport { CellStyle };\n/**\n * Represents the Filter Collection.\n */\nvar FilterCollection = /** @class */ (function (_super) {\n    __extends(FilterCollection, _super);\n    function FilterCollection() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"sheetIdx\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"filterRange\", void 0);\n    __decorate([\n        Property(false)\n    ], FilterCollection.prototype, \"hasFilter\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"column\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"criteria\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"value\", void 0);\n    __decorate([\n        Property()\n    ], FilterCollection.prototype, \"dataType\", void 0);\n    return FilterCollection;\n}(ChildProperty));\nexport { FilterCollection };\n/**\n * Represents the DefineName.\n */\nvar DefineName = /** @class */ (function (_super) {\n    __extends(DefineName, _super);\n    function DefineName() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"name\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"scope\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"comment\", void 0);\n    __decorate([\n        Property('')\n    ], DefineName.prototype, \"refersTo\", void 0);\n    return DefineName;\n}(ChildProperty));\nexport { DefineName };\n/**\n * Configures the Protect behavior for the spreadsheet.\n */\nvar ProtectSettings = /** @class */ (function (_super) {\n    __extends(ProtectSettings, _super);\n    function ProtectSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"selectCells\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"formatCells\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"formatRows\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"formatColumns\", void 0);\n    __decorate([\n        Property(false)\n    ], ProtectSettings.prototype, \"insertLink\", void 0);\n    return ProtectSettings;\n}(ChildProperty));\nexport { ProtectSettings };\n/**\n * Represents the Hyperlink.\n */\nvar Hyperlink = /** @class */ (function (_super) {\n    __extends(Hyperlink, _super);\n    function Hyperlink() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], Hyperlink.prototype, \"address\", void 0);\n    return Hyperlink;\n}(ChildProperty));\nexport { Hyperlink };\n/**\n * Represents the DataValidation.\n */\nvar Validation = /** @class */ (function (_super) {\n    __extends(Validation, _super);\n    function Validation() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('WholeNumber')\n    ], Validation.prototype, \"type\", void 0);\n    __decorate([\n        Property('Between')\n    ], Validation.prototype, \"operator\", void 0);\n    __decorate([\n        Property('0')\n    ], Validation.prototype, \"value1\", void 0);\n    __decorate([\n        Property('0')\n    ], Validation.prototype, \"value2\", void 0);\n    __decorate([\n        Property(true)\n    ], Validation.prototype, \"ignoreBlank\", void 0);\n    __decorate([\n        Property(true)\n    ], Validation.prototype, \"inCellDropDown\", void 0);\n    __decorate([\n        Property(false)\n    ], Validation.prototype, \"isHighlighted\", void 0);\n    return Validation;\n}(ChildProperty));\nexport { Validation };\n/**\n * Represents the Format.\n */\nvar Format = /** @class */ (function (_super) {\n    __extends(Format, _super);\n    function Format() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('General')\n    ], Format.prototype, \"format\", void 0);\n    __decorate([\n        Complex({}, CellStyle)\n    ], Format.prototype, \"style\", void 0);\n    __decorate([\n        Property(true)\n    ], Format.prototype, \"isLocked\", void 0);\n    return Format;\n}(ChildProperty));\nexport { Format };\n/**\n * Represents the Conditional Formatting.\n */\nvar ConditionalFormat = /** @class */ (function (_super) {\n    __extends(ConditionalFormat, _super);\n    function ConditionalFormat() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('GreaterThan')\n    ], ConditionalFormat.prototype, \"type\", void 0);\n    __decorate([\n        Complex({}, Format)\n    ], ConditionalFormat.prototype, \"format\", void 0);\n    __decorate([\n        Property('RedFT')\n    ], ConditionalFormat.prototype, \"cFColor\", void 0);\n    __decorate([\n        Property('')\n    ], ConditionalFormat.prototype, \"value\", void 0);\n    __decorate([\n        Property('')\n    ], ConditionalFormat.prototype, \"range\", void 0);\n    return ConditionalFormat;\n}(ChildProperty));\nexport { ConditionalFormat };\n/**\n * Represents the Chart.\n */\nvar Chart = /** @class */ (function (_super) {\n    __extends(Chart, _super);\n    function Chart() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Line')\n    ], Chart.prototype, \"type\", void 0);\n    __decorate([\n        Property('Material')\n    ], Chart.prototype, \"theme\", void 0);\n    __decorate([\n        Property(false)\n    ], Chart.prototype, \"isSeriesInRows\", void 0);\n    __decorate([\n        Property('')\n    ], Chart.prototype, \"range\", void 0);\n    __decorate([\n        Property('')\n    ], Chart.prototype, \"id\", void 0);\n    __decorate([\n        Property(290)\n    ], Chart.prototype, \"height\", void 0);\n    __decorate([\n        Property(480)\n    ], Chart.prototype, \"width\", void 0);\n    __decorate([\n        Property(0)\n    ], Chart.prototype, \"top\", void 0);\n    __decorate([\n        Property(0)\n    ], Chart.prototype, \"left\", void 0);\n    return Chart;\n}(ChildProperty));\nexport { Chart };\n/**\n * Represents the Image.\n */\nvar Image = /** @class */ (function (_super) {\n    __extends(Image, _super);\n    function Image() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], Image.prototype, \"src\", void 0);\n    __decorate([\n        Property('')\n    ], Image.prototype, \"id\", void 0);\n    __decorate([\n        Property(300)\n    ], Image.prototype, \"height\", void 0);\n    __decorate([\n        Property(400)\n    ], Image.prototype, \"width\", void 0);\n    __decorate([\n        Property(0)\n    ], Image.prototype, \"top\", void 0);\n    __decorate([\n        Property(0)\n    ], Image.prototype, \"left\", void 0);\n    return Image;\n}(ChildProperty));\nexport { Image };\n","/** @hidden */\nexport var workbookLocale = 'spreadsheetLocale';\n/**\n * Workbook locale text\n * @hidden\n */\nexport var localeData = {\n    SortOutOfRangeError: 'Select a cell or range inside the used range and try again.'\n};\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * ServiceLocator\n * @hidden\n */\nvar ServiceLocator = /** @class */ (function () {\n    function ServiceLocator() {\n        this.services = {};\n    }\n    ServiceLocator.prototype.getService = function (name) {\n        if (isNullOrUndefined(this.services[name])) {\n            throw \"The service \" + name + \" is not registered\";\n        }\n        return this.services[name];\n    };\n    ServiceLocator.prototype.register = function (name, type) {\n        if (isNullOrUndefined(this.services[name])) {\n            this.services[name] = type;\n        }\n    };\n    return ServiceLocator;\n}());\nexport { ServiceLocator };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, Property, NotifyPropertyChanges, Collection, Complex } from '@syncfusion/ej2-base';\nimport { initSheet, getSheet, getSheetIndexFromId, getSheetIndexByName, getSheetIndex, Sheet } from './sheet';\nimport { Event, merge, L10n, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getWorkbookRequiredModules } from '../common/module';\nimport { getData, clearRange } from './index';\nimport { DefineName, CellStyle, updateUsedRange, getIndexesFromAddress, localeData, workbookLocale } from '../common/index';\nimport * as events from '../common/event';\nimport { insertModel, getAddressInfo } from '../common/index';\nimport { setCellFormat, sheetCreated, deleteModel, setLockCells } from '../common/index';\nimport { setMerge } from '../common/index';\nimport { getCell, skipDefaultValue, setCell, wrap as wrapText } from './cell';\nimport { DataBind, setRow, setColumn } from '../index';\nimport { WorkbookSave, WorkbookFormula, WorkbookOpen, WorkbookSort, WorkbookFilter, WorkbookImage } from '../integrations/index';\nimport { WorkbookChart } from '../integrations/index';\nimport { WorkbookNumberFormat } from '../integrations/number-format';\nimport { WorkbookEdit, WorkbookCellFormat, WorkbookHyperlink, WorkbookInsert, WorkbookProtectSheet } from '../actions/index';\nimport { WorkbookDataValidation, WorkbookMerge } from '../actions/index';\nimport { ServiceLocator } from '../services/index';\nimport { setLinkModel, setImage, setChart } from '../common/event';\nimport { beginAction, completeAction, deleteChart } from '../../spreadsheet/common/event';\nimport { WorkbookFindAndReplace } from '../actions/find-and-replace';\nimport { WorkbookConditionalFormat } from '../actions/conditional-formatting';\n/**\n * Represents the Workbook.\n */\nvar Workbook = /** @class */ (function (_super) {\n    __extends(Workbook, _super);\n    /**\n     * Constructor for initializing the library.\n     * @param options - Configures Workbook model.\n     */\n    function Workbook(options) {\n        var _this = _super.call(this, options) || this;\n        /** @hidden */\n        _this.isEdit = false;\n        /**\n         * To generate sheet name based on sheet count.\n         * @hidden\n         */\n        _this.sheetNameCount = 1;\n        /**\n         * @hidden\n         */\n        _this.isOpen = false;\n        /**\n         * @hidden\n         */\n        _this.chartColl = [];\n        /**\n         * @hidden\n         */\n        _this.chartCount = 1;\n        Workbook_1.Inject(DataBind, WorkbookSave, WorkbookOpen, WorkbookNumberFormat, WorkbookCellFormat, WorkbookEdit, WorkbookFormula, WorkbookSort, WorkbookHyperlink, WorkbookFilter, WorkbookInsert, WorkbookFindAndReplace, WorkbookDataValidation, WorkbookProtectSheet, WorkbookMerge, WorkbookConditionalFormat, WorkbookImage, WorkbookChart);\n        _this.commonCellStyle = {};\n        if (options && options.cellStyle) {\n            _this.commonCellStyle = options.cellStyle;\n        }\n        if (_this.getModuleName() === 'workbook') {\n            _this.serviceLocator = new ServiceLocator;\n            _this.initWorkbookServices();\n            _this.dataBind();\n            _this.initEmptySheet();\n        }\n        return _this;\n    }\n    Workbook_1 = Workbook;\n    /**\n     * For internal use only.\n     * @returns void\n     * @hidden\n     */\n    Workbook.prototype.preRender = function () {\n        if (!Object.keys(this.commonCellStyle).length) {\n            this.commonCellStyle = skipDefaultValue(this.cellStyle, true);\n        }\n        if (this.getModuleName() === 'spreadsheet' && !this.refreshing) {\n            this.initEmptySheet();\n        }\n    };\n    Workbook.prototype.initWorkbookServices = function () {\n        this.serviceLocator.register(workbookLocale, new L10n(this.getModuleName(), localeData, this.locale));\n    };\n    /**\n     * For internal use only.\n     * @returns void\n     * @hidden\n     */\n    Workbook.prototype.render = function () {\n        /** code snippets */\n    };\n    /**\n     * To provide the array of modules needed for workbook.\n     * @return {ModuleDeclaration[]}\n     * @hidden\n     */\n    Workbook.prototype.requiredModules = function () {\n        return getWorkbookRequiredModules(this);\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     * @returns string\n     * @hidden\n     */\n    Workbook.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     * Applies the style (font family, font weight, background color, etc...) to the specified range of cells.\n     * {% codeBlock src='spreadsheet/cellFormat/index.md' %}{% endcodeBlock %}\n     * @param {CellStyleModel} style - Specifies the cell style.\n     * @param {string} range? - Specifies the address for the range of cells.\n     */\n    Workbook.prototype.cellFormat = function (style, range) {\n        var sheet = this.getActiveSheet();\n        range = range || sheet.selectedRange;\n        this.notify(setCellFormat, { style: style, range: range, refreshRibbon: range.indexOf(sheet.activeCell) > -1 ? true : false });\n    };\n    /**\n     * Applies cell lock to the specified range of cells.\n     * {% codeBlock src='spreadsheet/lockCells/index.md' %}{% endcodeBlock %}\n     * @param {string} range? - Specifies the address for the range of cells.\n     * @param {boolean} isLocked -Specifies the cell is locked or not.\n     */\n    Workbook.prototype.lockCells = function (range, isLocked) {\n        var sheet = this.getActiveSheet();\n        range = range || sheet.selectedRange;\n        this.notify(setLockCells, { range: range, isLocked: isLocked });\n    };\n    /** @hidden */\n    Workbook.prototype.getCellStyleValue = function (cssProps, indexes) {\n        var _this = this;\n        var cell = getCell(indexes[0], indexes[1], this.getActiveSheet());\n        var style = {};\n        cssProps.forEach(function (cssProp) {\n            style[cssProp] = _this.cellStyle[cssProp];\n            if (cell && cell.style && cell.style[cssProp]) {\n                style[cssProp] = cell.style[cssProp];\n            }\n        });\n        return style;\n    };\n    /**\n     * Applies the number format (number, currency, percentage, short date, etc...) to the specified range of cells.\n     * {% codeBlock src='spreadsheet/numberFormat/index.md' %}{% endcodeBlock %}\n     * @param {string} format - Specifies the number format code.\n     * @param {string} range? - Specifies the address for the range of cells.\n     */\n    Workbook.prototype.numberFormat = function (format, range) {\n        this.notify(events.applyNumberFormatting, { format: format, range: range });\n    };\n    /**\n     * Used to create new sheet.\n     * @hidden\n     */\n    Workbook.prototype.createSheet = function (index, sheets) {\n        if (index === void 0) { index = this.sheets.length; }\n        if (sheets === void 0) { sheets = [{}]; }\n        var _a;\n        (_a = this.sheets).splice.apply(_a, [index, 0].concat(sheets));\n        initSheet(this, sheets);\n        this.notify(sheetCreated, { sheetIndex: index || 0, sheets: sheets });\n        this.notify(events.workbookFormulaOperation, {\n            action: 'registerSheet', sheetIndex: index || 0, sheetCount: index + sheets.length\n        });\n    };\n    /**\n     * Used to remove sheet.\n     * @hidden\n     */\n    Workbook.prototype.removeSheet = function (idx) {\n        this.sheets.splice(idx, 1);\n    };\n    /**\n     * Destroys the Workbook library.\n     */\n    Workbook.prototype.destroy = function () {\n        this.notify(events.workbookDestroyed, null);\n        _super.prototype.destroy.call(this);\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @param  {WorkbookModel} newProp\n     * @param  {WorkbookModel} oldProp\n     * @returns void\n     * @hidden\n     */\n    Workbook.prototype.onPropertyChanged = function (newProp, oldProp) {\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'cellStyle':\n                    merge(this.commonCellStyle, skipDefaultValue(newProp.cellStyle));\n                    break;\n                case 'sheets':\n                    initSheet(this);\n                    break;\n            }\n        }\n    };\n    /**\n     * Not applicable for workbook.\n     * @hidden\n     */\n    Workbook.prototype.appendTo = function (selector) {\n        _super.prototype.appendTo.call(this, selector);\n    };\n    /**\n     * Used to hide/show the rows in spreadsheet.\n     * @param {number} startRow - Specifies the start row index.\n     * @param {number} endRow? - Specifies the end row index.\n     * @param {boolean} hide? - To hide/show the rows in specified range.\n     * @returns void\n     */\n    Workbook.prototype.hideRow = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        var sheet = this.getActiveSheet();\n        for (var i = startIndex; i <= endIndex; i++) {\n            setRow(sheet, i, { hidden: hide });\n        }\n    };\n    /**\n     * Used to hide/show the columns in spreadsheet.\n     * @param {number} startIndex - Specifies the start column index.\n     * @param {number} endIndex? - Specifies the end column index.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the columns.\n     * @returns void\n     */\n    Workbook.prototype.hideColumn = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        var sheet = this.getActiveSheet();\n        for (var i = startIndex; i <= endIndex; i++) {\n            setColumn(sheet, i, { hidden: hide });\n        }\n    };\n    /**\n     * Sets the border to specified range of cells.\n     * {% codeBlock src='spreadsheet/setBorder/index.md' %}{% endcodeBlock %}\n     * @param {CellStyleModel} style? - Specifies the style property which contains border value.\n     * @param {string} range? - Specifies the range of cell reference. If not specified, it will considered the active cell reference.\n     * @param {BorderType} type? - Specifies the range of cell reference. If not specified, it will considered the active cell reference.\n     * @returns void\n     */\n    Workbook.prototype.setBorder = function (style, range, type) {\n        this.notify(setCellFormat, {\n            style: style, borderType: type, range: range || this.getActiveSheet().selectedRange\n        });\n    };\n    /**\n     * Used to insert rows in to the spreadsheet.\n     * {% codeBlock src='spreadsheet/insertRow/index.md' %}{% endcodeBlock %}\n     * @param {number | RowModel[]} startRow? - Specifies the start row index / row model which needs to be inserted.\n     * @param {number} endRow? - Specifies the end row index.\n     * @param {number | string} sheet? - Specifies the sheet name or index in which the insert operation will perform. By default,\n     * active sheet will be considered.\n     * @returns void\n     */\n    Workbook.prototype.insertRow = function (startRow, endRow, sheet) {\n        this.notify(insertModel, { model: this.getSheetModel(sheet), start: startRow, end: endRow,\n            modelType: 'Row' });\n    };\n    /**\n     * Used to insert columns in to the spreadsheet.\n     * {% codeBlock src='spreadsheet/insertColumn/index.md' %}{% endcodeBlock %}\n     * @param {number | ColumnModel[]} startColumn? - Specifies the start column index / column model which needs to be inserted.\n     * @param {number} endColumn? - Specifies the end column index.\n     * @param {number | string} sheet? - Specifies the sheet name or index in which the insert operation will perform. By default,\n     * active sheet will be considered.\n     * @returns void\n     */\n    Workbook.prototype.insertColumn = function (startColumn, endColumn, sheet) {\n        this.notify(insertModel, { model: this.getSheetModel(sheet), start: startColumn, end: endColumn,\n            modelType: 'Column' });\n    };\n    /**\n     * Used to insert sheets in to the spreadsheet.\n     * {% codeBlock src='spreadsheet/insertSheet/index.md' %}{% endcodeBlock %}\n     * @param {number | SheetModel[]} startSheet? - Specifies the start sheet index / sheet model which needs to be inserted.\n     * @param {number} endSheet? - Specifies the end sheet index.\n     * @returns void\n     */\n    Workbook.prototype.insertSheet = function (startSheet, endSheet) {\n        this.notify(insertModel, { model: this, start: startSheet, end: endSheet, modelType: 'Sheet' });\n    };\n    /**\n     * Used to delete rows, columns and sheets from the spreadsheet.\n     * {% codeBlock src='spreadsheet/delete/index.md' %}{% endcodeBlock %}\n     * @param {number} startIndex? - Specifies the start sheet / row / column index.\n     * @param {number} endIndex? - Specifies the end sheet / row / column index.\n     * @param {ModelType} model? - Specifies the delete model type. By default, the model is considered as `Sheet`. The possible values are,\n     * - Row: To delete rows.\n     * - Column: To delete columns.\n     * - Sheet: To delete sheets.\n     * @param {number | string} sheet? - Specifies the sheet name or index in which the delete operation will perform. By default,\n     * active sheet will be considered. It is applicable only for model type Row and Column.\n     * @returns void\n     */\n    Workbook.prototype.delete = function (startIndex, endIndex, model, sheet) {\n        startIndex = startIndex || 0;\n        var sheetModel;\n        if (!model || model === 'Sheet') {\n            sheetModel = this;\n        }\n        else {\n            sheetModel = this.getSheetModel(sheet);\n            if (!sheetModel) {\n                return;\n            }\n        }\n        this.notify(deleteModel, {\n            model: sheetModel, start: startIndex, end: isNullOrUndefined(endIndex) ? startIndex : endIndex, modelType: model || 'Sheet'\n        });\n    };\n    Workbook.prototype.getSheetModel = function (sheet) {\n        if (isNullOrUndefined(sheet)) {\n            return this.getActiveSheet();\n        }\n        else {\n            var index = typeof sheet === 'string' ? getSheetIndex(this, sheet) : sheet;\n            if (isNullOrUndefined(index) || index >= this.sheets.length) {\n                return null;\n            }\n            return this.sheets[index];\n        }\n    };\n    /**\n     * Used to merge the range of cells.\n     * {% codeBlock src='spreadsheet/merge/index.md' %}{% endcodeBlock %}\n     * @param {string} range? - Specifies the rnage of cells as address.\n     * @param {MergeType} type? - Specifies the merge type. The possible values are,\n     * - All: Merge all the cells between provided range.\n     * - Horizontally: Merge the cells row-wise.\n     * - Vertically: Merge the cells column-wise.\n     * @returns void\n     */\n    Workbook.prototype.merge = function (range, type) {\n        var sheetIdx = this.getAddressInfo(range).sheetIndex;\n        var sheet = getSheet(this, sheetIdx);\n        range = range || sheet.selectedRange;\n        this.notify(setMerge, { merge: true, range: range, type: type || 'All', sheet: sheet, refreshRibbon: range.indexOf(sheet.activeCell) > -1 ? true : false, preventRefresh: this.activeSheetIndex !== sheetIdx });\n    };\n    /** Used to compute the specified expression/formula.\n     * {% codeBlock src='spreadsheet/computeExpression/index.md' %}{% endcodeBlock %}\n     * @param {string} formula - Specifies the formula(=SUM(A1:A3)) or expression(2+3).\n     * @returns string | number\n     */\n    Workbook.prototype.computeExpression = function (formula) {\n        var args = {\n            action: 'computeExpression', formula: formula\n        };\n        this.notify(events.workbookFormulaOperation, args);\n        return args.calcValue;\n    };\n    Workbook.prototype.initEmptySheet = function () {\n        if (!this.sheets.length) {\n            this.createSheet();\n        }\n        else {\n            initSheet(this);\n        }\n    };\n    /** @hidden */\n    Workbook.prototype.getActiveSheet = function () {\n        return this.sheets[this.activeSheetIndex];\n    };\n    /** @hidden */\n    Workbook.prototype.skipHiddenSheets = function (index, initIdx, hiddenCount) {\n        if (hiddenCount === void 0) { hiddenCount = 0; }\n        if (this.sheets[index] && this.sheets[index].state !== 'Visible') {\n            if (initIdx === undefined) {\n                initIdx = index;\n            }\n            if (index && index + 1 === this.sheets.length) {\n                index = initIdx - 1;\n            }\n            else {\n                index < initIdx ? index-- : index++;\n            }\n            index = this.skipHiddenSheets(index, initIdx, ++hiddenCount);\n        }\n        if (hiddenCount === this.sheets.length) {\n            this.setSheetPropertyOnMute(this.sheets[0], 'state', 'Visible');\n            return 0;\n        }\n        return index;\n    };\n    /**\n     * Used for setting the used range row and column index.\n     * @hidden\n     */\n    Workbook.prototype.setUsedRange = function (rowIdx, colIdx, sheet) {\n        if (sheet === void 0) { sheet = this.getActiveSheet(); }\n        if (rowIdx > sheet.usedRange.rowIndex) {\n            sheet.usedRange.rowIndex = rowIdx;\n            if (sheet === this.getActiveSheet()) {\n                this.notify(updateUsedRange, { index: rowIdx, update: 'row' });\n            }\n        }\n        if (colIdx > sheet.usedRange.colIndex) {\n            sheet.usedRange.colIndex = colIdx;\n            if (sheet === this.getActiveSheet()) {\n                this.notify(updateUsedRange, { index: colIdx, update: 'col' });\n            }\n        }\n    };\n    /**\n     * Gets the range of data as JSON from the specified address.\n     * {% codeBlock src='spreadsheet/getData/index.md' %}{% endcodeBlock %}\n     * @param {string} address - Specifies the address for range of cells.\n     */\n    Workbook.prototype.getData = function (address) {\n        return getData(this, address);\n    };\n    /**\n     * Get component name.\n     * @returns string\n     * @hidden\n     */\n    Workbook.prototype.getModuleName = function () {\n        return 'workbook';\n    };\n    /** @hidden */\n    Workbook.prototype.getValueRowCol = function (sheetIndex, rowIndex, colIndex) {\n        var args = {\n            action: 'getSheetInfo', sheetInfo: []\n        };\n        this.notify(events.workbookFormulaOperation, args);\n        var id = getSheetIndexByName(this, 'Sheet' + (sheetIndex + 1), args.sheetInfo);\n        if (id === -1) {\n            var errArgs = { action: 'getReferenceError', refError: '' };\n            this.notify(events.workbookFormulaOperation, errArgs);\n            return errArgs.refError;\n        }\n        sheetIndex = getSheetIndexFromId(this, sheetIndex + 1);\n        var sheet = getSheet(this, sheetIndex);\n        var cell = getCell(rowIndex - 1, colIndex - 1, sheet);\n        return (cell && cell.value) || '';\n    };\n    /** @hidden */\n    Workbook.prototype.setValueRowCol = function (sheetIndex, value, rowIndex, colIndex) {\n        sheetIndex = getSheetIndexFromId(this, sheetIndex);\n        this.notify(events.workbookEditOperation, {\n            action: 'updateCellValue', address: [rowIndex - 1, colIndex - 1], value: value,\n            sheetIndex: sheetIndex, isValueOnly: true\n        });\n    };\n    /**\n     * Opens the specified excel file or stream.\n     * @param {OpenOptions} options - Options for opening the excel file.\n     */\n    Workbook.prototype.open = function (options) {\n        this.notify(events.workbookOpen, options);\n    };\n    /**\n     * Opens the specified JSON object.\n     * {% codeBlock src='spreadsheet/openFromJson/index.md' %}{% endcodeBlock %}\n     * <br><br>\n     * The available arguments in options are:\n     * * file: Specifies the spreadsheet model as object or string. And the object contains the jsonObject,\n     * which is saved from spreadsheet using saveAsJson method.\n     *\n     * @param options - Options for opening the JSON object.\n     */\n    Workbook.prototype.openFromJson = function (options) {\n        this.isOpen = true;\n        var jsonObject = typeof options.file === 'object' ? JSON.stringify(options.file) : options.file;\n        this.notify(events.workbookOpen, { jsonObject: jsonObject });\n    };\n    /**\n     * Saves the Spreadsheet data to Excel file.\n     * <br><br>\n     * The available arguments in saveOptions are:\n     * * url: Specifies the save URL.\n     * * fileName: Specifies the file name.\n     * * saveType: Specifies the file type need to be saved.\n     *\n     * {% codeBlock src='spreadsheet/save/index.md' %}{% endcodeBlock %}\n     * @param {SaveOptions} saveOptions - Options for saving the excel file.\n     */\n    Workbook.prototype.save = function (saveOptions) {\n        if (saveOptions === void 0) { saveOptions = {}; }\n        if (this.allowSave) {\n            var defaultProps = {\n                url: this.saveUrl,\n                fileName: saveOptions.fileName || 'Sample',\n                saveType: 'Xlsx'\n            };\n            var eventArgs = __assign({}, defaultProps, saveOptions, { customParams: {}, isFullPost: true, needBlobData: false, cancel: false });\n            this.trigger('beforeSave', eventArgs);\n            this.notify(beginAction, { eventArgs: eventArgs, action: 'beforeSave' });\n            if (!eventArgs.cancel) {\n                this.notify(events.beginSave, {\n                    saveSettings: eventArgs, isFullPost: eventArgs.isFullPost,\n                    needBlobData: eventArgs.needBlobData, customParams: eventArgs.customParams\n                });\n            }\n        }\n    };\n    /**\n     * Saves the Spreadsheet data as JSON object.\n     * {% codeBlock src='spreadsheet/saveAsJson/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.saveAsJson = function () {\n        var _this = this;\n        return new Promise(function (resolve) {\n            _this.on(events.onSave, function (args) {\n                args.cancel = true;\n                _this.off(events.onSave);\n                resolve({ jsonObject: { Workbook: args.jsonObject } });\n                _this.notify(events.saveCompleted, args);\n            });\n            _this.save();\n        });\n    };\n    Workbook.prototype.addHyperlink = function (hyperlink, cellAddress) {\n        var args = { hyperlink: hyperlink, cell: cellAddress };\n        this.notify(setLinkModel, args);\n    };\n    /**\n     * To find the specified cell value.\n     * @hidden\n     * @param args - options for find.\n     */\n    Workbook.prototype.findHandler = function (args) {\n        if (args.findOpt === 'next') {\n            this.notify(events.findNext, args);\n        }\n        else if (args.findOpt === 'prev') {\n            this.notify(events.findPrevious, args);\n        }\n    };\n    /**\n     * @hidden\n     */\n    Workbook.prototype.replaceHandler = function (args) {\n        if (args.replaceBy === 'replace') {\n            this.notify(events.replaceHandler, args);\n        }\n        else {\n            this.notify(events.replaceAllHandler, args);\n        }\n    };\n    /**\n     * Protect the active sheet based on the protect sheetings.\n     * @param protectSettings - Specifies the protect settings of the sheet.\n     */\n    Workbook.prototype.protectSheet = function (sheet, protectSettings) {\n        this.notify(events.protectsheetHandler, protectSettings);\n    };\n    /**\n     * Unprotect the active sheet.\n     * @param sheet - Specifies the sheet to Unprotect.\n     */\n    Workbook.prototype.unprotectSheet = function (sheet) {\n        var args = { sheet: sheet };\n        this.notify(events.unprotectsheetHandler, args);\n    };\n    /**\n     * Sorts the range of cells in the active Spreadsheet.\n     * @param sortOptions - options for sorting.\n     * @param range - address of the data range.\n     */\n    Workbook.prototype.sort = function (sortOptions, range) {\n        if (!this.allowSorting) {\n            return Promise.reject();\n        }\n        var eventArgs = {\n            range: range || this.getActiveSheet().selectedRange,\n            sortOptions: sortOptions || { sortDescriptors: {} },\n            cancel: false\n        };\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        var sortArgs = { args: eventArgs, promise: promise };\n        this.notify(events.initiateSort, sortArgs);\n        return sortArgs.promise;\n    };\n    Workbook.prototype.addDataValidation = function (rules, range) {\n        range = range ? range : this.getActiveSheet().selectedRange;\n        var eventArgs = {\n            range: range, type: rules.type, operator: rules.operator, value1: rules.value1,\n            value2: rules.value2, ignoreBlank: rules.ignoreBlank, inCellDropDown: rules.inCellDropDown, cancel: false\n        };\n        this.notify(beginAction, { eventArgs: eventArgs, action: 'validation' });\n        if (!eventArgs.cancel) {\n            range = eventArgs.range;\n            rules.type = eventArgs.type;\n            rules.operator = eventArgs.operator;\n            rules.value1 = eventArgs.value1;\n            rules.value2 = eventArgs.value2;\n            rules.ignoreBlank = eventArgs.ignoreBlank;\n            rules.inCellDropDown = eventArgs.inCellDropDown;\n            this.notify(events.setValidation, { rules: rules, range: range });\n            delete eventArgs.cancel;\n            this.notify(completeAction, { eventArgs: eventArgs, action: 'validation' });\n        }\n    };\n    Workbook.prototype.removeDataValidation = function (range) {\n        this.notify(events.removeValidation, { range: range });\n    };\n    Workbook.prototype.addInvalidHighlight = function (range) {\n        this.notify(events.addHighlight, { range: range });\n    };\n    Workbook.prototype.removeInvalidHighlight = function (range) {\n        this.notify(events.removeHighlight, { range: range });\n    };\n    Workbook.prototype.conditionalFormat = function (conditionalFormat) {\n        conditionalFormat.range = conditionalFormat.range || this.getActiveSheet().selectedRange;\n        this.notify(events.setCFRule, { conditionalFormat: conditionalFormat });\n    };\n    Workbook.prototype.clearConditionalFormat = function (range) {\n        range = range || this.getActiveSheet().selectedRange;\n        this.notify(events.clearCFRule, { range: range });\n    };\n    /**\n     * To update a cell properties.\n     * @param {CellModel} cell - Cell properties.\n     * @param {string} address - Address to update.\n     */\n    Workbook.prototype.updateCell = function (cell, address) {\n        var sheetIdx;\n        var range = getIndexesFromAddress(address);\n        if (address.includes('!')) {\n            sheetIdx = getSheetIndex(this, address.split('!')[0]);\n            if (sheetIdx === undefined) {\n                sheetIdx = this.activeSheetIndex;\n            }\n        }\n        else {\n            sheetIdx = this.activeSheetIndex;\n        }\n        setCell(range[0], range[1], this.sheets[sheetIdx], cell, true);\n        if (cell.value) {\n            this.notify(events.workbookEditOperation, {\n                action: 'updateCellValue', address: range, value: cell.value,\n                sheetIndex: sheetIdx\n            });\n        }\n    };\n    /**\n     * This method is used to wrap/unwrap the text content of the cell.\n     * {% codeBlock src='spreadsheet/wrap/index.md' %}{% endcodeBlock %}\n     * @param address - Address of the cell to be wrapped.\n     * @param wrap - Set `false` if the text content of the cell to be unwrapped.\n     * @returns void\n     */\n    Workbook.prototype.wrap = function (address, wrap) {\n        if (wrap === void 0) { wrap = true; }\n        wrapText(address, wrap, this);\n    };\n    /**\n     * Adds the defined name to the Spreadsheet.\n     * @param {DefineNameModel} definedName - Specifies the name.\n     * @return {boolean} - Return the added status of the defined name.\n     */\n    Workbook.prototype.addDefinedName = function (definedName) {\n        var eventArgs = {\n            action: 'addDefinedName',\n            isAdded: false,\n            definedName: definedName\n        };\n        this.notify(events.workbookFormulaOperation, eventArgs);\n        return eventArgs.isAdded;\n    };\n    /**\n     * Removes the defined name from the Spreadsheet.\n     * @param {string} definedName - Specifies the name.\n     * @param {string} scope - Specifies the scope of the defined name.\n     * @return {boolean} - Return the removed status of the defined name.\n     */\n    Workbook.prototype.removeDefinedName = function (definedName, scope) {\n        if (scope === void 0) { scope = ''; }\n        var eventArgs = {\n            action: 'removeDefinedName',\n            isRemoved: false,\n            definedName: definedName,\n            scope: scope\n        };\n        this.notify(events.workbookFormulaOperation, eventArgs);\n        return eventArgs.isRemoved;\n    };\n    /** @hidden */\n    Workbook.prototype.clearRange = function (address, sheetIndex, valueOnly) {\n        if (valueOnly === void 0) { valueOnly = true; }\n        clearRange(this, address || this.getActiveSheet().selectedRange, isNullOrUndefined(sheetIndex) ? this.activeSheetIndex : sheetIndex, valueOnly);\n    };\n    /**\n     * Used to set the image in spreadsheet.\n     * @param {ImageModel} images - Specifies the options to insert image in spreadsheet.\n     * @param {string} range - Specifies the range in spreadsheet.\n     * @returns void\n     */\n    Workbook.prototype.insertImage = function (images, range) {\n        this.notify(setImage, { options: images, range: range ? range : this.getActiveSheet().selectedRange });\n    };\n    /**\n     * Used to set the chart in spreadsheet.\n     * {% codeBlock src='spreadsheet/insertChart/index.md' %}{% endcodeBlock %}\n     * @param {ChartModel} chart - Specifies the options to insert chart in spreadsheet.\n     * @returns void\n     */\n    Workbook.prototype.insertChart = function (chart) {\n        this.notify(setChart, { chart: chart });\n    };\n    /**\n     * Used to delete the chart from spreadsheet.\n     * {% codeBlock src='spreadsheet/deleteChart/index.md' %}{% endcodeBlock %}\n     * @param {string} id - Specifies the chart element id.\n     * @returns void\n     */\n    Workbook.prototype.deleteChart = function (id) {\n        this.notify(deleteChart, { id: id });\n    };\n    /**\n     * Filters the range of cells in the sheet.\n     */\n    Workbook.prototype.filter = function (filterOptions, range) {\n        if (!this.allowFiltering) {\n            return Promise.reject();\n        }\n        var eventArgs = {\n            range: range || this.getActiveSheet().selectedRange,\n            filterOptions: filterOptions,\n            cancel: false\n        };\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        var filterArgs = { args: eventArgs, promise: promise };\n        this.notify(events.initiateFilter, filterArgs);\n        return filterArgs.promise;\n    };\n    /**\n     * Clears the filter changes of the sheet.\n     */\n    Workbook.prototype.clearFilter = function () {\n        this.notify(events.clearAllFilter, null);\n    };\n    /**\n     * To add custom library function.\n     * @param {string} functionHandler - Custom function handler name\n     * @param {string} functionName - Custom function name\n     */\n    Workbook.prototype.addCustomFunction = function (functionHandler, functionName) {\n        functionName = functionName ? functionName : typeof functionHandler === 'string' ? functionHandler :\n            functionHandler.name.replace('bound ', '');\n        var eventArgs = {\n            action: 'addCustomFunction',\n            functionHandler: functionHandler,\n            functionName: functionName\n        };\n        this.notify(events.workbookFormulaOperation, eventArgs);\n    };\n    /**\n     * This method is used to Clear contents, formats and hyperlinks in spreadsheet.\n     *    * @param {ClearOptions} options - Options for clearing the content, formats and hyperlinks in spreadsheet.\n     */\n    Workbook.prototype.clear = function (options) {\n        this.notify(events.clear, options);\n    };\n    /**\n     * Gets the formatted text of the cell.\n     * {% codeBlock src='spreadsheet/getDisplayText/index.md' %}{% endcodeBlock %}\n     */\n    Workbook.prototype.getDisplayText = function (cell) {\n        if (!cell) {\n            return '';\n        }\n        if (cell.value && cell.format) {\n            var eventArgs = {\n                formattedText: cell.value, value: cell.value, format: cell.format, onLoad: true\n            };\n            this.notify(events.getFormattedCellObject, eventArgs);\n            return eventArgs.formattedText;\n        }\n        else if (!cell.value && cell.hyperlink) {\n            return typeof cell.hyperlink === 'string' ? cell.hyperlink : cell.hyperlink.address;\n        }\n        else {\n            return cell.value ? cell.value.toString() : '';\n        }\n    };\n    /**\n     * @hidden\n     */\n    Workbook.prototype.getAddressInfo = function (address) {\n        return getAddressInfo(this, address);\n    };\n    /**\n     * @hidden\n     */\n    Workbook.prototype.setSheetPropertyOnMute = function (sheet, prop, value) {\n        this.isProtectedOnChange = true;\n        sheet[prop] = value;\n        this.isProtectedOnChange = false;\n    };\n    var Workbook_1;\n    __decorate([\n        Collection([], Sheet)\n    ], Workbook.prototype, \"sheets\", void 0);\n    __decorate([\n        Property(0)\n    ], Workbook.prototype, \"activeSheetIndex\", void 0);\n    __decorate([\n        Property('100%')\n    ], Workbook.prototype, \"height\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowFindAndReplace\", void 0);\n    __decorate([\n        Property()\n    ], Workbook.prototype, \"filterCollection\", void 0);\n    __decorate([\n        Property('100%')\n    ], Workbook.prototype, \"width\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showRibbon\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showFormulaBar\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"showSheetTabs\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowEditing\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowOpen\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowSave\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowSorting\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowFiltering\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowNumberFormatting\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowCellFormatting\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowHyperlink\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowInsert\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowDelete\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowMerge\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowDataValidation\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowImage\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowChart\", void 0);\n    __decorate([\n        Property(true)\n    ], Workbook.prototype, \"allowConditionalFormat\", void 0);\n    __decorate([\n        Complex({}, CellStyle)\n    ], Workbook.prototype, \"cellStyle\", void 0);\n    __decorate([\n        Property('')\n    ], Workbook.prototype, \"openUrl\", void 0);\n    __decorate([\n        Property('')\n    ], Workbook.prototype, \"saveUrl\", void 0);\n    __decorate([\n        Collection([], DefineName)\n    ], Workbook.prototype, \"definedNames\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"openFailure\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeSave\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"saveComplete\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"beforeCellFormat\", void 0);\n    __decorate([\n        Event()\n    ], Workbook.prototype, \"queryCellInfo\", void 0);\n    Workbook = Workbook_1 = __decorate([\n        NotifyPropertyChanges\n    ], Workbook);\n    return Workbook;\n}(Component));\nexport { Workbook };\n","import { detach, EventHandler, Browser, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getCell, setCell, getSheet, getSwapRange, inRange } from '../../workbook/index';\nimport { getRangeAddress, workbookEditOperation, getSheetIndexFromId, getSheetName } from '../../workbook/index';\nimport { getFormattedCellObject, workbookFormulaOperation, checkIsFormula } from '../../workbook/index';\nimport { pasteMerge, setMerge, getCellIndexes, getCellAddress } from '../../workbook/index';\nimport { ribbonClick, cut, copy, paste, initiateFilterUI, focus } from '../common/index';\nimport { hasTemplate, createImageElement } from '../common/index';\nimport { enableToolbarItems, rowHeightChanged, completeAction, beginAction } from '../common/index';\nimport { clearCopy, locateElem, selectRange, dialog, contentLoaded, tabSwitch, cMenuBeforeOpen, locale } from '../common/index';\nimport { getMaxHgt, setMaxHgt, setRowEleHeight, deleteImage, getRowIdxFromClientY, getColIdxFromClientX } from '../common/index';\nimport { Deferred } from '@syncfusion/ej2-data';\nimport { refreshRibbonIcons, isCellReference, getColumn, isLocked as isCellLocked } from '../../workbook/index';\nimport { getFilteredCollection, setChart, parseIntValue } from '../../workbook/index';\n/**\n * Represents clipboard support for Spreadsheet.\n */\nvar Clipboard = /** @class */ (function () {\n    function Clipboard(parent) {\n        this.externalMerge = false;\n        this.parent = parent;\n        this.init();\n        this.addEventListener();\n    }\n    Clipboard.prototype.init = function () {\n        this.parent.element\n            .appendChild(this.parent.createElement('input', { className: 'e-clipboard', attrs: { 'contenteditable': 'true' } }));\n    };\n    Clipboard.prototype.addEventListener = function () {\n        var ele = this.getClipboardEle();\n        this.parent.on(cut, this.cut, this);\n        this.parent.on(copy, this.copy, this);\n        this.parent.on(paste, this.paste, this);\n        this.parent.on(clearCopy, this.clearCopiedInfo, this);\n        this.parent.on(tabSwitch, this.tabSwitchHandler, this);\n        this.parent.on(cMenuBeforeOpen, this.cMenuBeforeOpenHandler, this);\n        this.parent.on(ribbonClick, this.ribbonClickHandler, this);\n        this.parent.on(contentLoaded, this.initCopyIndicator, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChanged, this);\n        EventHandler.add(ele, 'cut', this.cut, this);\n        EventHandler.add(ele, 'copy', this.copy, this);\n        EventHandler.add(ele, 'paste', this.paste, this);\n    };\n    Clipboard.prototype.removeEventListener = function () {\n        var ele = this.getClipboardEle();\n        if (!this.parent.isDestroyed) {\n            this.parent.off(cut, this.cut);\n            this.parent.off(copy, this.copy);\n            this.parent.off(paste, this.paste);\n            this.parent.off(clearCopy, this.clearCopiedInfo);\n            this.parent.off(tabSwitch, this.tabSwitchHandler);\n            this.parent.off(cMenuBeforeOpen, this.cMenuBeforeOpenHandler);\n            this.parent.off(ribbonClick, this.ribbonClickHandler);\n            this.parent.off(contentLoaded, this.initCopyIndicator);\n            this.parent.off(rowHeightChanged, this.rowHeightChanged);\n        }\n        EventHandler.remove(ele, 'cut', this.cut);\n        EventHandler.remove(ele, 'copy', this.copy);\n        EventHandler.remove(ele, 'paste', this.paste);\n    };\n    Clipboard.prototype.ribbonClickHandler = function (args) {\n        var parentId = this.parent.element.id;\n        switch (args.item.id) {\n            case parentId + '_cut':\n                this.cut({ isAction: true });\n                break;\n            case parentId + '_copy':\n                this.copy({ isAction: true });\n                break;\n        }\n        focus(this.parent.element);\n    };\n    Clipboard.prototype.tabSwitchHandler = function (args) {\n        if (args.activeTab === 0 && !this.copiedInfo && !this.copiedShapeInfo) {\n            this.hidePaste();\n        }\n    };\n    Clipboard.prototype.cMenuBeforeOpenHandler = function (e) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var delRowItems = [];\n        var hideRowItems = [];\n        var delColItems = [];\n        var hideColItems = [];\n        var actCell = sheet.activeCell;\n        var actCellIndex = getCellIndexes(actCell);\n        var cellObj = getCell(actCellIndex[0], actCellIndex[1], sheet);\n        var isLocked = sheet.isProtected && isCellLocked(cellObj, getColumn(sheet, actCellIndex[1]));\n        if (e.target === 'Content' || e.target === 'RowHeader' || e.target === 'ColumnHeader') {\n            this.parent.enableContextMenuItems([l10n.getConstant('Paste'), l10n.getConstant('PasteSpecial')], (this.copiedInfo ||\n                this.copiedShapeInfo && !isLocked) ? true : false);\n            this.parent.enableContextMenuItems([l10n.getConstant('Cut')], (!isLocked) ? true : false);\n        }\n        if ((e.target === 'Content') && isLocked) {\n            this.parent.enableContextMenuItems([l10n.getConstant('Cut'), l10n.getConstant('Filter'), l10n.getConstant('Sort')], false);\n        }\n        if ((e.target === 'Content') && (isLocked && !sheet.protectSettings.insertLink)) {\n            this.parent.enableContextMenuItems([l10n.getConstant('Hyperlink')], false);\n        }\n        if (e.target === 'ColumnHeader' && sheet.isProtected) {\n            delColItems = [l10n.getConstant('DeleteColumn'), l10n.getConstant('DeleteColumns'),\n                l10n.getConstant('InsertColumn'), l10n.getConstant('InsertColumns')];\n            hideColItems = [l10n.getConstant('HideColumn'), l10n.getConstant('HideColumns'),\n                l10n.getConstant('UnHideColumns')];\n            this.parent.enableContextMenuItems(delColItems, false);\n            this.parent.enableContextMenuItems(hideColItems, (sheet.protectSettings.formatColumns) ? true : false);\n        }\n        if (e.target === 'RowHeader' && sheet.isProtected) {\n            delRowItems = [l10n.getConstant('DeleteRow'), l10n.getConstant('DeleteRows'),\n                l10n.getConstant('InsertRow'), l10n.getConstant('InsertRows')];\n            hideRowItems = [l10n.getConstant('HideRow'), l10n.getConstant('HideRows'), l10n.getConstant('UnHideRows')];\n            this.parent.enableContextMenuItems(delRowItems, false);\n            this.parent.enableContextMenuItems(hideRowItems, (sheet.protectSettings.formatRows) ? true : false);\n        }\n    };\n    Clipboard.prototype.rowHeightChanged = function (args) {\n        if (this.copiedInfo && this.copiedInfo.range[0] > args.rowIdx) {\n            var ele = this.parent.element.getElementsByClassName('e-copy-indicator')[0];\n            if (ele) {\n                ele.style.top = parseInt(ele.style.top, 10) + args.threshold + \"px\";\n            }\n        }\n    };\n    Clipboard.prototype.cut = function (args) {\n        this.setCopiedInfo(args, true);\n    };\n    Clipboard.prototype.copy = function (args) {\n        this.copiedSheet = this.parent.getActiveSheet();\n        this.setCopiedInfo(args, false);\n    };\n    Clipboard.prototype.paste = function (args) {\n        if (this.parent.isEdit) {\n            return;\n        }\n        var rfshRange;\n        args.isAction = true;\n        /* tslint:disable-next-line */\n        var isExternal = ((args && args.clipboardData) || window['clipboardData']);\n        var copiedIdx = this.getCopiedIdx();\n        var isCut;\n        var copyInfo = Object.assign({}, this.copiedInfo);\n        if (isExternal || this.copiedShapeInfo || (args.isInternal && this.copiedInfo)) {\n            var cSIdx = (args && args.sIdx > -1) ? args.sIdx : this.parent.activeSheetIndex;\n            var curSheet = getSheet(this.parent, cSIdx);\n            var selIdx = getSwapRange(args && args.range || getRangeIndexes(curSheet.selectedRange));\n            var rows = isExternal && this.getExternalCells(args);\n            if (!args.isInternal && rows && rows.internal) {\n                isExternal = false;\n                if (!this.copiedInfo) {\n                    return;\n                }\n            }\n            if (isExternal && !rows.length) { // If image pasted\n                return;\n            }\n            var cellLength = 0;\n            if (rows) {\n                for (var i = 0; i < rows.length; i++) {\n                    cellLength = rows[i].cells.length > cellLength ? rows[i].cells.length : cellLength;\n                }\n            }\n            var rowIdx = selIdx[0];\n            var cIdx = isExternal\n                ? [0, 0, rows.length - 1, cellLength - 1] : getSwapRange(this.copiedShapeInfo ?\n                getRangeIndexes(curSheet.selectedRange) : this.copiedInfo.range);\n            var isRepeative = (selIdx[2] - selIdx[0] + 1) % (cIdx[2] - cIdx[0] + 1) === 0\n                && (selIdx[3] - selIdx[1] + 1) % (cIdx[3] - cIdx[1] + 1) === 0;\n            rfshRange = isRepeative ? selIdx : [selIdx[0], selIdx[1]]\n                .concat([selIdx[0] + cIdx[2] - cIdx[0], selIdx[1] + cIdx[3] - cIdx[1] || selIdx[1]]);\n            var beginEventArgs = {\n                requestType: 'paste',\n                copiedInfo: this.copiedInfo,\n                copiedRange: getRangeAddress(cIdx),\n                pastedRange: getRangeAddress(rfshRange),\n                type: (args && args.type) || 'All',\n                cancel: false\n            };\n            if (args.isAction && !this.copiedShapeInfo && this.copiedInfo) {\n                this.parent.notify(beginAction, { eventArgs: beginEventArgs, action: 'clipboard' });\n            }\n            if (beginEventArgs.cancel) {\n                return;\n            }\n            var cell = void 0;\n            var isExtend = void 0;\n            var prevCell = void 0;\n            var mergeCollection = [];\n            var prevSheet = getSheet(this.parent, isExternal ? cSIdx : copiedIdx);\n            selIdx = getRangeIndexes(beginEventArgs.pastedRange);\n            rowIdx = selIdx[0];\n            cIdx = isExternal\n                ? [0, 0, rows.length - 1, cellLength - 1] : getSwapRange(this.copiedShapeInfo ?\n                getRangeIndexes(curSheet.selectedRange) : this.copiedInfo.range);\n            isRepeative = (selIdx[2] - selIdx[0] + 1) % (cIdx[2] - cIdx[0] + 1) === 0 && (selIdx[3] - selIdx[1] + 1) %\n                (cIdx[3] - cIdx[1] + 1) === 0;\n            var mergeArgs = {\n                range: cIdx, prevSheet: prevSheet, cancel: false\n            };\n            rfshRange = isRepeative ? selIdx : [selIdx[0], selIdx[1]]\n                .concat([selIdx[0] + cIdx[2] - cIdx[0], selIdx[1] + cIdx[3] - cIdx[1] || selIdx[1]]);\n            if (this.copiedShapeInfo && !this.copiedInfo) {\n                var pictureElem = this.copiedShapeInfo.pictureElem;\n                if (pictureElem.classList.contains('e-datavisualization-chart')) {\n                    this.copiedShapeInfo.chartInfo.top = null;\n                    this.copiedShapeInfo.chartInfo.left = null;\n                    this.parent.notify(setChart, {\n                        chart: [this.copiedShapeInfo.chartInfo], isInitCell: true, isUndoRedo: true, isPaste: true,\n                        dataSheetIdx: this.copiedShapeInfo.sheetIdx, isCut: this.copiedShapeInfo.isCut,\n                        range: args.range || curSheet.selectedRange, isIdAvailabe: false\n                    });\n                }\n                else {\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            src: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: this.copiedShapeInfo.height, width: this.copiedShapeInfo.width,\n                            imageId: this.copiedShapeInfo.isCut ? pictureElem.id : ''\n                        },\n                        range: getRangeAddress([rowIdx, selIdx[1], rowIdx, selIdx[1]]), isPublic: false, isUndoRedo: true\n                    });\n                }\n                var pastedCell = getCell(rowIdx, selIdx[1], curSheet);\n                if (pastedCell && !isNullOrUndefined(pastedCell.image)) {\n                    var imgLen = pastedCell.image ? pastedCell.image.length - 1 : 0;\n                    var eventArgs = {\n                        requestType: 'imagePaste',\n                        copiedShapeInfo: this.copiedShapeInfo,\n                        pasteSheetIndex: this.parent.activeSheetIndex,\n                        pastedRange: getSheetName(this.parent) + '!' + getRangeAddress([rowIdx, selIdx[1], rowIdx, selIdx[1]]),\n                        pastedPictureElement: document.getElementById(pastedCell.image[imgLen].id)\n                    };\n                    this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'clipboard' });\n                }\n            }\n            else {\n                this.parent.notify(pasteMerge, mergeArgs);\n                if (mergeArgs.cancel) {\n                    return;\n                }\n                var pasteType = beginEventArgs.type ? beginEventArgs.type : args.type;\n                var cRows = [];\n                var inRange_1 = this.isInRange(cIdx, selIdx);\n                for (var i = cIdx[0], l = 0; i <= cIdx[2]; i++, l++) {\n                    if (inRange_1) {\n                        cRows[selIdx[0] + l] = { cells: [] };\n                    }\n                    for (var j = cIdx[1], k = 0; j <= cIdx[3]; j++, k++) {\n                        if (inRange_1) {\n                            cRows[selIdx[0] + l].cells[selIdx[1] + k] = getCell(selIdx[0] + l, selIdx[1] + k, prevSheet);\n                        }\n                        cell = isExternal ? rows[i].cells[j] : Object.assign({}, (inRange_1 && cRows[i] && cRows[i].cells[j])\n                            ? cRows[i].cells[j] : getCell(i, j, prevSheet));\n                        this.copiedCell = [i, j];\n                        if (cell && args && args.type || pasteType) {\n                            switch (pasteType) {\n                                case 'Formats':\n                                    cell = { format: cell.format, style: cell.style };\n                                    break;\n                                case 'Values':\n                                    cell = { value: cell.value };\n                                    if (cell.value && cell.value.toString().indexOf('\\n') > -1) {\n                                        var ele = this.parent.getCell(selIdx[0], selIdx[1]);\n                                        ele.classList.add('e-alt-unwrap');\n                                    }\n                                    break;\n                            }\n                            isExtend = ['Formats', 'Values'].indexOf(args.type) > -1;\n                        }\n                        if ((!this.parent.scrollSettings.isFinite && (cIdx[2] - cIdx[0] > (1048575 - selIdx[0])\n                            || cIdx[3] - cIdx[1] > (16383 - selIdx[1])))\n                            || (this.parent.scrollSettings.isFinite && (cIdx[2] - cIdx[0] > (curSheet.rowCount - 1 - selIdx[0])\n                                || cIdx[3] - cIdx[1] > (curSheet.colCount - 1 - selIdx[1])))) {\n                            this.showDialog();\n                            return;\n                        }\n                        if (isRepeative) {\n                            for (var x = selIdx[0]; x <= selIdx[2]; x += (cIdx[2] - cIdx[0]) + 1) {\n                                for (var y = selIdx[1]; y <= selIdx[3]; y += (cIdx[3] - cIdx[1] + 1)) {\n                                    prevCell = getCell(x + l, y + k, curSheet) || {};\n                                    if (!this.externalMerge && prevCell.colSpan !== undefined || prevCell.rowSpan !== undefined) {\n                                        mergeArgs = { range: [x + l, y + k, x + l, y + k] };\n                                        var merge = { range: mergeArgs.range, merge: false, isAction: false, type: 'All' };\n                                        mergeCollection.push(merge);\n                                        if (this.parent.activeSheetIndex === curSheet.index) {\n                                            this.parent.notify(setMerge, merge);\n                                        }\n                                    }\n                                    var colInd = y + k;\n                                    if (this.externalMerge && this.externalMergeRow === x + l) {\n                                        colInd = colInd + 1;\n                                    }\n                                    else {\n                                        this.externalMerge = false;\n                                    }\n                                    var newFormula = this.isFormula([x + l, colInd]);\n                                    if (!isNullOrUndefined(newFormula)) {\n                                        cell.formula = newFormula;\n                                    }\n                                    this.setCell(x + l, colInd, curSheet, cell, isExtend, false, y === selIdx[3]);\n                                    var sId = this.parent.activeSheetIndex;\n                                    var cellElem = this.parent.getCell(x + l, colInd);\n                                    var address = getCellAddress(x + l, colInd);\n                                    var cellArgs = {\n                                        address: this.parent.sheets[sId].name + '!' + address,\n                                        requestType: 'paste',\n                                        value: getCell(x + l, colInd, curSheet) ? getCell(x + l, colInd, curSheet).value : '',\n                                        oldValue: prevCell.value,\n                                        element: cellElem,\n                                        displayText: this.parent.getDisplayText(cell)\n                                    };\n                                    this.parent.trigger('cellSave', cellArgs);\n                                }\n                            }\n                        }\n                        else {\n                            if (!hasTemplate(this.parent, i, j, copiedIdx)) {\n                                this.setCell(rowIdx, selIdx[1] + k, curSheet, cell, isExtend, false, j === cIdx[3]);\n                            }\n                        }\n                        if (!isExternal && this.copiedInfo.isCut) {\n                            this.setCell(i, j, prevSheet, null, false, true, j === cIdx[3]);\n                        }\n                    }\n                    rowIdx++;\n                }\n                this.parent.notify(refreshRibbonIcons, null);\n                this.parent.setUsedRange(rfshRange[2] + 1, rfshRange[3]);\n                if (cSIdx === this.parent.activeSheetIndex) {\n                    this.parent.serviceLocator.getService('cell').refreshRange(rfshRange);\n                    this.parent.notify(selectRange, { indexes: rfshRange });\n                }\n                if (!isExternal && this.copiedInfo.isCut) {\n                    isCut = this.copiedInfo.isCut;\n                    if (copiedIdx === this.parent.activeSheetIndex) {\n                        this.parent.serviceLocator.getService('cell').refreshRange(cIdx);\n                    }\n                    this.clearCopiedInfo();\n                    this.cutInfo = isCut;\n                }\n                if ((isExternal || inRange_1) && this.copiedInfo) {\n                    this.clearCopiedInfo();\n                }\n                if (isExternal || (args && args.isAction)) {\n                    focus(this.parent.element);\n                }\n                if (args.isAction) {\n                    var sheetIndex = copyInfo && copyInfo.sId ? getSheetIndexFromId(this.parent, copyInfo.sId) :\n                        this.parent.activeSheetIndex;\n                    var eventArgs = {\n                        requestType: 'paste',\n                        copiedInfo: copyInfo,\n                        mergeCollection: mergeCollection,\n                        pasteSheetIndex: this.parent.activeSheetIndex,\n                        copiedRange: this.parent.sheets[sheetIndex].name + '!' + getRangeAddress(copyInfo && copyInfo.range ?\n                            copyInfo.range : getRangeIndexes(this.parent.sheets[sheetIndex].selectedRange)),\n                        pastedRange: getSheetName(this.parent) + '!' + getRangeAddress(rfshRange),\n                        type: pasteType || 'All'\n                    };\n                    this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'clipboard' });\n                }\n                if (isCut) {\n                    this.updateFilter(copyInfo, rfshRange);\n                    setMaxHgt(prevSheet, cIdx[0], cIdx[1], 20);\n                    var hgt = getMaxHgt(prevSheet, cIdx[0]);\n                    setRowEleHeight(this.parent, prevSheet, hgt, cIdx[0]);\n                }\n            }\n        }\n        else {\n            this.getClipboardEle().select();\n        }\n    };\n    Clipboard.prototype.updateFilter = function (copyInfo, pastedRange) {\n        var isFilterCut;\n        var diff;\n        this.parent.notify(getFilteredCollection, null);\n        for (var i = 0; i < this.parent.sheets.length; i++) {\n            if (this.parent.filterCollection && this.parent.filterCollection[i] &&\n                this.parent.filterCollection[i].sheetIdx === getSheetIndexFromId(this.parent, copyInfo.sId)) {\n                var range = copyInfo.range;\n                var fRange = getRangeIndexes(this.parent.filterCollection[i].filterRange);\n                range = getSwapRange(range);\n                if ((fRange[0] >= range[0] && fRange[2] <= range[2])) {\n                    isFilterCut = true;\n                    diff = [Math.abs(range[0] - fRange[0]), Math.abs(range[1] - fRange[1]),\n                        Math.abs(range[2] - fRange[2]), Math.abs(range[3] - fRange[3])];\n                }\n            }\n        }\n        var cell = this.parent.getCell(copyInfo.range[0], copyInfo.range[1]);\n        cell = cell.querySelector('.e-filter-icon') ? cell : this.parent.getCell(copyInfo.range[2], copyInfo.range[3]);\n        var asc = cell.querySelector('.e-sortasc-filter');\n        var desc = cell.querySelector('.e-sortdesc-filter');\n        if (isFilterCut) {\n            for (var n = 0; n < this.parent.filterCollection.length; n++) {\n                var filterCol = this.parent.filterCollection[n];\n                var sheetIndex = copyInfo && copyInfo.sId ? getSheetIndexFromId(this.parent, copyInfo.sId) :\n                    this.parent.activeSheetIndex;\n                if (filterCol.sheetIdx === sheetIndex) {\n                    this.parent.notify(initiateFilterUI, { predicates: null, range: filterCol.filterRange, sIdx: sheetIndex, isCut: true });\n                }\n                if (filterCol.sheetIdx === sheetIndex && sheetIndex === this.parent.activeSheetIndex) {\n                    diff = [pastedRange[0] + diff[0], pastedRange[1] + diff[1],\n                        Math.abs(pastedRange[2] - diff[2]), Math.abs(pastedRange[3] - diff[3])];\n                    this.parent.notify(initiateFilterUI, { predicates: null, range: getRangeAddress(diff), sIdx: null, isCut: true });\n                    if (copyInfo.range[3] === copyInfo.range[1]) { // To update sorted icon after pasting.\n                        var filteredCell = this.parent.getCell(pastedRange[0], pastedRange[1]);\n                        if (asc && filteredCell) {\n                            filteredCell.querySelector('.e-filter-icon').classList.add('e-sortasc-filter');\n                        }\n                        if (desc && filteredCell) {\n                            filteredCell.querySelector('.e-filter-icon').classList.add('e-sortdesc-filter');\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Clipboard.prototype.isInRange = function (cRng, pRng) {\n        return inRange(cRng, pRng[0], pRng[1]) || inRange(cRng, pRng[2], pRng[3]);\n    };\n    Clipboard.prototype.isFormula = function (selIdx) {\n        var cIdxValue;\n        var cell;\n        var sheet;\n        if (!isNullOrUndefined(this.copiedCell)) {\n            sheet = !isNullOrUndefined(this.copiedSheet) ? this.copiedSheet : this.parent.getActiveSheet();\n            cell = getCell(this.copiedCell[0], this.copiedCell[1], sheet);\n            if (!isNullOrUndefined(cell)) {\n                cIdxValue = cell.formula ? cell.formula.toUpperCase() : '';\n            }\n        }\n        if (cIdxValue !== '' && !isNullOrUndefined(cIdxValue)) {\n            if (cIdxValue.indexOf('=') === 0) {\n                cIdxValue = cIdxValue.slice(1);\n            }\n            var start = cIdxValue.indexOf('(');\n            var end = cIdxValue.indexOf(')');\n            if (start > -1 && end > -1) {\n                cIdxValue = cIdxValue.slice(start + 1, end);\n            }\n            var difIndex = [];\n            var formulaOperators = ['+', '-', '*', '/'];\n            var splitArray = void 0;\n            var value = cIdxValue;\n            for (var i = 0; i < formulaOperators.length; i++) {\n                splitArray = value.split(formulaOperators[i]);\n                value = splitArray.join(',');\n            }\n            splitArray = value.split(',');\n            for (var j = 0; j < splitArray.length; j++) {\n                if (isCellReference(splitArray[j])) {\n                    var range = getCellIndexes(splitArray[j]);\n                    var diff = [this.copiedCell[0] - range[0], this.copiedCell[1] - range[1]];\n                    difIndex.push(diff[0]);\n                    difIndex.push(diff[1]);\n                }\n            }\n            var newAddress = [];\n            for (var j = 0; j < difIndex.length; j++) {\n                var address = getCellAddress(selIdx[0] - difIndex[0 + j], selIdx[1] - difIndex[1 + j]);\n                newAddress.push(address);\n                j++;\n            }\n            for (var a = 0; a < newAddress.length; a++) {\n                if (isCellReference(newAddress[a])) {\n                    var range = getRangeIndexes(newAddress[a]);\n                    if (range[0] < 0 || range[1] < 0) {\n                        newAddress[a] = '#REF!';\n                    }\n                }\n                else {\n                    newAddress[a] = '#REF!';\n                }\n            }\n            cIdxValue = cell.formula.toUpperCase();\n            for (var i = 0; i < splitArray.length; i++) {\n                for (var j = 0; j < newAddress.length; j++) {\n                    cIdxValue = cIdxValue.replace(splitArray[i].toUpperCase(), newAddress[j].toUpperCase());\n                    i++;\n                }\n            }\n            return cIdxValue;\n        }\n        else {\n            return null;\n        }\n    };\n    Clipboard.prototype.setCell = function (rIdx, cIdx, sheet, cell, isExtend, isCut, lastCell) {\n        setCell(rIdx, cIdx, sheet, isCut ? null : cell, isExtend);\n        if (cell && cell.formula) {\n            this.parent.notify(workbookFormulaOperation, {\n                action: 'refreshCalculate', value: isCut ? '' : cell.formula, rowIndex: rIdx,\n                colIndex: cIdx, sheetIndex: this.parent.activeSheetIndex, isFormula: true\n            });\n        }\n        if (cell && !cell.formula) {\n            this.parent.notify(workbookEditOperation, {\n                action: 'updateCellValue', address: [rIdx, cIdx, rIdx,\n                    cIdx], value: cell.value\n            });\n        }\n        if (sheet.name === this.parent.getActiveSheet().name) {\n            this.parent.serviceLocator.getService('cell').refresh(rIdx, cIdx, lastCell);\n        }\n    };\n    Clipboard.prototype.getCopiedIdx = function () {\n        if (this.copiedInfo) {\n            for (var i = 0; i < this.parent.sheets.length; i++) {\n                if (this.parent.sheets[i].id === this.copiedInfo.sId) {\n                    return i;\n                }\n            }\n            this.clearCopiedInfo();\n        }\n        return -1;\n    };\n    Clipboard.prototype.setCopiedInfo = function (args, isCut) {\n        var _this = this;\n        if (this.parent.isEdit) {\n            return;\n        }\n        var deferred = new Deferred();\n        args.promise = deferred.promise;\n        var sheet = this.parent.getActiveSheet();\n        var range = (args && args.range) || getRangeIndexes(sheet.selectedRange);\n        var option = {\n            sheet: sheet, indexes: [0, 0, sheet.rowCount - 1, sheet.colCount - 1], promise: new Promise(function (resolve, reject) { resolve((function () { })()); })\n        };\n        var pictureElements = document.getElementsByClassName('e-ss-overlay-active');\n        var pictureLen = pictureElements.length;\n        if (sheet.isLocalData && !(args && args.clipboardData) && range[0] === 0 && range[2] === (sheet.rowCount - 1)) {\n            this.parent.showSpinner();\n            this.parent.notify('updateSheetFromDataSource', option);\n        }\n        option.promise.then(function () {\n            if (pictureLen > 0) {\n                var imgRowIdx = {\n                    clientY: pictureElements[0].offsetTop,\n                    isImage: true\n                };\n                _this.parent.notify(getRowIdxFromClientY, imgRowIdx);\n                var imgColIdx = {\n                    clientX: pictureElements[0].offsetLeft,\n                    isImage: true\n                };\n                _this.parent.notify(getColIdxFromClientX, imgColIdx);\n                _this.copiedShapeInfo = {\n                    sId: (args && args.sId) ? args.sId : sheet.id, sheetIdx: sheet.index, isCut: isCut, pictureElem: pictureElements[0], copiedRange: getRangeAddress([imgRowIdx.clientY, imgColIdx.clientX,\n                        imgRowIdx.clientY, imgColIdx.clientX]), height: pictureElements[0].offsetHeight,\n                    width: pictureElements[0].offsetWidth,\n                    chartInfo: _this.getChartElemInfo(pictureElements[0], isCut)\n                };\n                _this.hidePaste(true);\n                if (isCut) {\n                    if (pictureElements[0].classList.contains('e-datavisualization-chart')) {\n                        _this.parent.deleteChart(_this.copiedShapeInfo.chartInfo.id);\n                    }\n                    else {\n                        _this.parent.notify(deleteImage, {\n                            id: _this.copiedShapeInfo.pictureElem.id, sheetIdx: _this.copiedShapeInfo.sId, range: _this.copiedShapeInfo.copiedRange\n                        });\n                    }\n                }\n            }\n            else if (!(args && args.clipboardData)) {\n                if (_this.copiedInfo) {\n                    _this.clearCopiedInfo();\n                }\n                _this.copiedInfo = {\n                    range: range, sId: (args && args.sId) ? args.sId : sheet.id, isCut: isCut\n                };\n                _this.hidePaste(true);\n                _this.initCopyIndicator();\n                if (!Browser.isIE) {\n                    _this.getClipboardEle().select();\n                }\n                if (args && args.isAction) {\n                    document.execCommand(isCut ? 'cut' : 'copy');\n                }\n                _this.parent.hideSpinner();\n            }\n            if (Browser.isIE) {\n                _this.setExternalCells(args);\n            }\n            deferred.resolve();\n        });\n        if (args && args.clipboardData) {\n            this.setExternalCells(args);\n            focus(this.parent.element);\n        }\n    };\n    Clipboard.prototype.getChartElemInfo = function (overlayEle, isCut) {\n        var chartColl = this.parent.chartColl;\n        if (overlayEle.classList.contains('e-datavisualization-chart')) {\n            var chartId = overlayEle.getElementsByClassName('e-control')[0].id;\n            for (var idx = 0; idx < chartColl.length; idx++) {\n                if (chartColl[idx].id === chartId) {\n                    var chart = chartColl[idx];\n                    return chart;\n                }\n            }\n        }\n        return null;\n    };\n    Clipboard.prototype.clearCopiedInfo = function () {\n        if (this.copiedInfo) {\n            if (this.parent.getActiveSheet().id === this.copiedInfo.sId) {\n                detach(this.parent.getMainContent().getElementsByClassName('e-copy-indicator')[0]);\n            }\n            this.copiedInfo = null;\n            this.hidePaste();\n        }\n        if (this.copiedShapeInfo) {\n            this.copiedShapeInfo = null;\n            this.hidePaste();\n        }\n    };\n    Clipboard.prototype.initCopyIndicator = function () {\n        if (this.copiedInfo && this.parent.getActiveSheet().id === this.copiedInfo.sId) {\n            var copyIndicator = this.parent.createElement('div', { className: 'e-copy-indicator' });\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-top' }));\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-bottom' }));\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-left' }));\n            copyIndicator.appendChild(this.parent.createElement('div', { className: 'e-right' }));\n            locateElem(copyIndicator, this.copiedInfo.range, this.parent.getActiveSheet(), false);\n            this.parent.getMainContent().appendChild(copyIndicator);\n        }\n    };\n    Clipboard.prototype.showDialog = function () {\n        var _this = this;\n        this.parent.serviceLocator.getService(dialog).show({\n            header: 'Spreadsheet',\n            target: this.parent.element,\n            height: 205, width: 340, isModal: true, showCloseIcon: true,\n            content: this.parent.serviceLocator.getService(locale).getConstant('PasteAlert'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'PasteDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n            }\n        });\n    };\n    Clipboard.prototype.hidePaste = function (isShow) {\n        if (this.parent.getActiveSheet().isProtected) {\n            isShow = false;\n        }\n        this.parent.notify(enableToolbarItems, [{ items: [this.parent.element.id + '_paste'], enable: isShow || false }]);\n    };\n    Clipboard.prototype.setExternalCells = function (args) {\n        var cell;\n        var text = '';\n        var range = this.copiedInfo.range;\n        var sheet = this.parent.getActiveSheet();\n        var data = '<html><body><table class=\"e-spreadsheet\" xmlns=\"http://www.w3.org/1999/xhtml\"><tbody>';\n        for (var i = range[0]; i <= range[2]; i++) {\n            data += '<tr>';\n            for (var j = range[1]; j <= range[3]; j++) {\n                cell = getCell(i, j, sheet);\n                data += '<td style=\"white-space:' + ((cell && cell.wrap) ? 'normal' : 'nowrap') + ';vertical-align:bottom;';\n                if (cell && cell.style) {\n                    Object.keys(cell.style).forEach(function (style) {\n                        var regex = style.match(/[A-Z]/);\n                        data += (style === 'backgroundColor' ? 'background' : (regex ? style.replace(regex[0], '-'\n                            + regex[0].toLowerCase()) : style)) + ':' + ((style === 'backgroundColor' || style === 'color')\n                            ? cell.style[style].slice(0, 7) : cell.style[style]) + ';';\n                    });\n                }\n                data += '\">';\n                if (cell && cell.value) {\n                    var eventArgs = {\n                        formattedText: cell.value,\n                        value: cell.value,\n                        format: cell.format,\n                        onLoad: true\n                    };\n                    if (cell.format) {\n                        this.parent.notify(getFormattedCellObject, eventArgs);\n                    }\n                    data += eventArgs.formattedText;\n                    text += eventArgs.formattedText;\n                }\n                data += '</td>';\n                text += j === range[3] ? '' : '\\t';\n            }\n            data += '</tr>';\n            text += i === range[2] ? '' : '\\n';\n        }\n        data += '</tbody></table></body></html>';\n        if (Browser.isIE) {\n            /* tslint:disable-next-line */\n            window['clipboardData'].setData('text', text);\n        }\n        else {\n            args.clipboardData.setData('text/html', data);\n            args.clipboardData.setData('text/plain', text);\n            args.preventDefault();\n        }\n    };\n    Clipboard.prototype.getExternalCells = function (args) {\n        var _this = this;\n        var html;\n        var text;\n        var rows = [];\n        var cells = [];\n        var cellStyle;\n        var ele = this.parent.createElement('span');\n        if (Browser.isIE) {\n            /* tslint:disable-next-line */\n            text = window['clipboardData'].getData('text');\n        }\n        else {\n            html = args.clipboardData.getData('text/html');\n            text = args.clipboardData.getData('text/plain');\n            ele.innerHTML = html;\n        }\n        if (ele.querySelector('table')) {\n            if (ele.querySelector('.e-spreadsheet')) {\n                rows = { internal: true };\n            }\n            else {\n                ele.querySelectorAll('tr').forEach(function (tr) {\n                    tr.querySelectorAll('td').forEach(function (td, j) {\n                        cellStyle = _this.getStyle(td, ele);\n                        td.textContent = td.textContent.replace(/(\\r\\n|\\n|\\r)/gm, '');\n                        var cSpan = isNaN(parseInt(td.getAttribute('colspan'), 10)) ? 1 : parseInt(td.getAttribute('colspan'), 10);\n                        var rSpan = isNaN(parseInt(td.getAttribute('rowspan'), 10)) ? 1 : parseInt(td.getAttribute('rowspan'), 10);\n                        cells[j] = {\n                            value: td.textContent ? parseIntValue(td.textContent.trim()) : null, style: cellStyle, colSpan: cSpan,\n                            rowSpan: rSpan\n                        };\n                        if (cellStyle.whiteSpace) {\n                            cells[j].wrap = true;\n                        }\n                    });\n                    rows.push({ cells: cells });\n                    cells = [];\n                });\n            }\n        }\n        else if (text) {\n            if (html) {\n                [].slice.call(ele.children).forEach(function (child) {\n                    if (child.getAttribute('style')) {\n                        cellStyle = _this.getStyle(child, ele);\n                    }\n                });\n            }\n            text.trim().split('\\n').forEach(function (row) {\n                row.split('\\t').forEach(function (col, j) {\n                    if (col) {\n                        cells[j] = { style: cellStyle };\n                        if (cellStyle && cellStyle.whiteSpace) {\n                            cells[j].wrap = true;\n                        }\n                        if (checkIsFormula(col)) {\n                            cells[j].formula = col;\n                        }\n                        else {\n                            cells[j].value = parseIntValue(col.trim());\n                        }\n                    }\n                });\n                rows.push({ cells: cells });\n                cells = [];\n            });\n        }\n        setTimeout(function () { _this.getClipboardEle().innerHTML = ''; }, 0);\n        return rows;\n    };\n    Clipboard.prototype.getStyle = function (td, ele) {\n        var styles = [];\n        var cellStyle = {};\n        var keys = Object.keys(this.parent.commonCellStyle);\n        if (td.classList.length || td.getAttribute('style') || keys.length) {\n            if (td.classList.length) {\n                if (ele.querySelector('style').innerHTML.indexOf(td.classList[0]) > -1) {\n                    styles.push(ele.querySelector('style').innerHTML.split(td.classList[0])[1].split('{')[1].split('}')[0]);\n                }\n            }\n            if (td.getAttribute('style')) {\n                styles.push(td.getAttribute('style'));\n            }\n            if (keys.length) {\n                if (ele.querySelector('style')) {\n                    var tdStyle = ele.querySelector('style').innerHTML.split('td')[1].split('{')[1].split('}')[0];\n                    for (var i = 0; i < keys.length; i++) {\n                        var key = keys[i];\n                        var regex = key.match(/[A-Z]/);\n                        if (regex) {\n                            key = key.replace(regex[0], '-' + regex[0].toLowerCase());\n                        }\n                        if (tdStyle.indexOf(key) > -1) {\n                            cellStyle[keys[i]] = tdStyle.split(key + ':')[1].split(';')[0];\n                        }\n                    }\n                }\n            }\n            styles.forEach(function (styles) {\n                styles.split(';').forEach(function (style) {\n                    var char = style.split(':')[0].trim();\n                    if (['font-family', 'vertical-align', 'text-align', 'text-indent', 'color', 'background', 'font-weight', 'font-style',\n                        'font-size', 'text-decoration', 'border-bottom', 'border-top', 'border-right', 'border-left',\n                        'border', 'white-space'].indexOf(char) > -1) {\n                        char = char === 'background' ? 'backgroundColor' : char;\n                        var regex = char.match(/-[a-z]/);\n                        var value = style.split(':')[1];\n                        cellStyle[regex ? char.replace(regex[0], regex[0].charAt(1).toUpperCase()) : char]\n                            = (char === 'font-weight' && ['bold', 'normal'].indexOf(value) === -1)\n                                ? (value > '599' ? 'bold' : 'normal') : value;\n                    }\n                });\n            });\n        }\n        if (td.innerHTML.indexOf('<s>') > -1) {\n            cellStyle.textDecoration = 'line-through';\n        }\n        return cellStyle;\n    };\n    Clipboard.prototype.getClipboardEle = function () {\n        return this.parent.element.getElementsByClassName('e-clipboard')[0];\n    };\n    Clipboard.prototype.getModuleName = function () {\n        return 'clipboard';\n    };\n    Clipboard.prototype.destroy = function () {\n        this.removeEventListener();\n        var ele = this.getClipboardEle();\n        detach(ele);\n        this.parent = null;\n    };\n    return Clipboard;\n}());\nexport { Clipboard };\n","import { EventHandler, Browser, closest, isUndefined, isNullOrUndefined, select } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getRangeFromAddress, getIndexesFromAddress, getRangeAddress, isSingleCell } from '../../workbook/common/address';\nimport { keyDown, editOperation, clearCopy, mouseDown, selectionComplete, enableToolbarItems, completeAction } from '../common/event';\nimport { formulaBarOperation, formulaOperation, setActionData, keyUp, getCellPosition, deleteImage, focus } from '../common/index';\nimport { workbookEditOperation, getFormattedBarText, getFormattedCellObject, wrapEvent, isValidation } from '../../workbook/common/event';\nimport { getSheetName, getSheetIndex, getCell, getColumn } from '../../workbook/base/index';\nimport { getSheetNameFromAddress, getSheet } from '../../workbook/base/index';\nimport { hasTemplate, editAlert } from '../common/index';\nimport { getSwapRange, getCellIndexes, wrap as wrapText, checkIsFormula, dataChanged, isNumber, isLocked } from '../../workbook/index';\nimport { checkConditionalFormat, initiateFormulaReference, initiateCur, clearCellRef, addressHandle } from '../common/event';\nimport { editValue, initiateEdit, forRefSelRender, isFormulaBarEdit, deleteChart, beginAction } from '../common/event';\n/**\n * The `Protect-Sheet` module is used to handle the Protecting functionalities in Spreadsheet.\n */\nvar Edit = /** @class */ (function () {\n    /**\n     * Constructor for protect-sheet module in Spreadsheet.\n     * @private\n     */\n    function Edit(parent) {\n        this.editorElem = null;\n        this.editCellData = {};\n        this.isEdit = false;\n        this.isCellEdit = true;\n        this.isNewValueEdit = true;\n        this.isAltEnter = false;\n        this.validCharacters = ['+', '-', '*', '/', ',', '(', '=', '&'];\n        this.keyCodes = {\n            BACKSPACE: 8,\n            SPACE: 32,\n            TAB: 9,\n            DELETE: 46,\n            ESC: 27,\n            ENTER: 13,\n            FIRSTALPHABET: 65,\n            LASTALPHABET: 90,\n            FIRSTNUMBER: 48,\n            LASTNUMBER: 59,\n            FIRSTNUMPAD: 96,\n            LASTNUMPAD: 111,\n            SYMBOLSETONESTART: 186,\n            SYMBOLSETONEEND: 192,\n            SYMBOLSETTWOSTART: 219,\n            SYMBOLSETTWOEND: 222,\n            FIREFOXEQUALPLUS: 61,\n            FIREFOXMINUS: 173,\n            F2: 113\n        };\n        this.parent = parent;\n        this.init();\n        //Spreadsheet.Inject(WorkbookEdit);\n    }\n    Edit.prototype.init = function () {\n        this.addEventListener();\n    };\n    /**\n     * To destroy the edit module.\n     * @return {void}\n     * @hidden\n     */\n    Edit.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        this.editorElem = null;\n    };\n    Edit.prototype.addEventListener = function () {\n        EventHandler.add(this.parent.element, 'dblclick', this.dblClickHandler, this);\n        this.parent.on(mouseDown, this.mouseDownHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(editOperation, this.performEditOperation, this);\n        this.parent.on(initiateCur, this.initiateCurPosition, this);\n        this.parent.on(editValue, this.updateFormulaBarValue, this);\n        this.parent.on(addressHandle, this.addressHandler, this);\n        this.parent.on(initiateEdit, this.initiateRefSelection, this);\n        this.parent.on(forRefSelRender, this.refSelectionRender, this);\n    };\n    Edit.prototype.removeEventListener = function () {\n        EventHandler.remove(this.parent.element, 'dblclick', this.dblClickHandler);\n        if (!this.parent.isDestroyed) {\n            this.parent.off(mouseDown, this.mouseDownHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(editOperation, this.performEditOperation);\n            this.parent.off(initiateCur, this.initiateCurPosition);\n            this.parent.off(editValue, this.updateFormulaBarValue);\n            this.parent.off(addressHandle, this.addressHandler);\n            this.parent.off(initiateEdit, this.initiateRefSelection);\n            this.parent.off(forRefSelRender, this.refSelectionRender);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    Edit.prototype.getModuleName = function () {\n        return 'edit';\n    };\n    Edit.prototype.performEditOperation = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'renderEditor':\n                this.renderEditor();\n                break;\n            case 'refreshEditor':\n                this.refreshEditor(args.value, args.refreshFormulaBar, args.refreshEditorElem, args.isAppend, args.trigEvent);\n                if (args.refreshCurPos) {\n                    this.setCursorPosition();\n                }\n                break;\n            case 'startEdit':\n                if (!this.isEdit) {\n                    this.isNewValueEdit = args.isNewValueEdit;\n                    this.startEdit(args.address, args.value, args.refreshCurPos);\n                }\n                else {\n                    var isEdit = false;\n                    var arg = { isEdit: isEdit };\n                    this.parent.notify(isFormulaBarEdit, arg);\n                    if (arg.isEdit) {\n                        this.isNewValueEdit = args.isNewValueEdit;\n                        this.startEdit(args.address, args.value, args.refreshCurPos);\n                    }\n                }\n                break;\n            case 'endEdit':\n                if (this.isEdit) {\n                    this.endEdit(args.refreshFormulaBar);\n                }\n                break;\n            case 'cancelEdit':\n                if (this.isEdit) {\n                    this.cancelEdit(args.refreshFormulaBar);\n                }\n                break;\n            case 'getCurrentEditValue':\n                args.editedValue = this.editCellData.value;\n                break;\n            case 'refreshDependentCellValue':\n                this.refreshDependentCellValue(args.rowIdx, args.colIdx, args.sheetIdx);\n                break;\n            case 'getPosition':\n                args.position = this.editorElem.getBoundingClientRect();\n                break;\n            case 'focusEditorElem':\n                this.editorElem.focus();\n                break;\n            case 'getCurrentEditSheetIdx':\n                args.sheetIndex = this.editCellData.sheetIndex;\n                break;\n        }\n    };\n    Edit.prototype.keyUpHandler = function (e) {\n        if (this.isEdit) {\n            if (e.altKey && e.keyCode === 13) {\n                var editElement = this.parent.element.querySelector('.e-spreadsheet-edit');\n                editElement.focus();\n                this.altEnter();\n                this.isAltEnter = true;\n            }\n            else if (this.isCellEdit && this.editCellData.value !== this.editorElem.textContent && e.keyCode !== 16) {\n                this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n            }\n            var isFormulaEdit = checkIsFormula(this.editCellData.value) ||\n                (this.editCellData.value && this.editCellData.value.toString().indexOf('=') === 0);\n            if (isFormulaEdit && e.keyCode !== 16) {\n                var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n                if (formulaRefIndicator) {\n                    formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                }\n                if (this.editCellData.value !== this.editorElem.textContent) {\n                    this.refreshEditor(this.editorElem.textContent, true);\n                }\n                var sheetIdx = this.editCellData.sheetIndex;\n                var editValue_1 = this.editCellData.value;\n                this.parent.notify(initiateFormulaReference, { range: editValue_1, formulaSheetIdx: sheetIdx });\n            }\n        }\n    };\n    Edit.prototype.keyDownHandler = function (e) {\n        var trgtElem = e.target;\n        var keyCode = e.keyCode;\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(sheet.activeCell);\n        var cell = getCell(actCell[0], actCell[1], sheet) || {};\n        if (!closest(e.target, '.e-findtool-dlg') && !closest(e.target, '.e-validationerror-dlg')) {\n            if (!sheet.isProtected || closest(e.target, '.e-sheet-rename') || !isLocked(cell, getColumn(sheet, actCell[1]))) {\n                if (this.isEdit) {\n                    var isFormulaEdit = checkIsFormula(this.editCellData.value) ||\n                        (this.editCellData.value && this.editCellData.value.toString().indexOf('=') === 0);\n                    if (this.isCellEdit || (isFormulaEdit && this.editCellData.value !== this.editorElem.textContent && e.keyCode !== 16)) {\n                        this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n                    }\n                    if (!e.altKey) {\n                        switch (keyCode) {\n                            case this.keyCodes.ENTER:\n                                if (Browser.isWindows) {\n                                    e.preventDefault();\n                                }\n                                if (this.isAltEnter) {\n                                    var text = this.parent.element.querySelector('.e-spreadsheet-edit').textContent;\n                                    if (text && text.indexOf('\\n') > -1) {\n                                        wrapText(this.parent.getActiveSheet().selectedRange, true, this.parent);\n                                        this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n                                        this.isAltEnter = false;\n                                    }\n                                }\n                                if (!isFormulaEdit) {\n                                    this.endEdit(false, e);\n                                }\n                                else {\n                                    var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    if (this.editCellData.sheetIndex === sheet.id - 1) {\n                                        this.endEdit(false, e);\n                                    }\n                                    else {\n                                        this.parent.goTo(this.editCellData.fullAddr);\n                                        this.endEdit(false, e);\n                                    }\n                                }\n                                break;\n                            case this.keyCodes.TAB:\n                                if (!this.hasFormulaSuggSelected()) {\n                                    this.endEdit(false, e);\n                                }\n                                break;\n                            case this.keyCodes.ESC:\n                                this.cancelEdit(true, true, e);\n                                break;\n                        }\n                    }\n                }\n                else {\n                    if (!this.isEdit && (trgtElem.classList.contains('e-spreadsheet') || closest(trgtElem, '.e-sheet-panel'))) {\n                        var isAlphabet = (keyCode >= this.keyCodes.FIRSTALPHABET && keyCode <= this.keyCodes.LASTALPHABET);\n                        var isNumeric = (keyCode >= this.keyCodes.FIRSTNUMBER && keyCode <= this.keyCodes.LASTNUMBER);\n                        var isNumpadKeys = (keyCode >= this.keyCodes.FIRSTNUMPAD && keyCode <= this.keyCodes.LASTNUMPAD);\n                        var isSymbolkeys = (keyCode >= this.keyCodes.SYMBOLSETONESTART &&\n                            keyCode <= this.keyCodes.SYMBOLSETONEEND);\n                        if (!isSymbolkeys) {\n                            isSymbolkeys = (keyCode >= this.keyCodes.SYMBOLSETTWOSTART && keyCode <= this.keyCodes.SYMBOLSETTWOEND);\n                        }\n                        var isFirefoxExceptionkeys = (keyCode === this.keyCodes.FIREFOXEQUALPLUS) ||\n                            (keyCode === this.keyCodes.FIREFOXMINUS);\n                        var isF2Edit = (!e.shiftKey && !e.ctrlKey && !e.metaKey && keyCode === this.keyCodes.F2);\n                        var isBackSpace = keyCode === this.keyCodes.BACKSPACE;\n                        if ((!e.ctrlKey && !e.metaKey && !e.altKey && ((!e.shiftKey && keyCode === this.keyCodes.SPACE) || isAlphabet || isNumeric ||\n                            isNumpadKeys || isSymbolkeys || (Browser.info.name === 'mozilla' && isFirefoxExceptionkeys))) || isF2Edit || isBackSpace) {\n                            if (isF2Edit) {\n                                this.isNewValueEdit = false;\n                            }\n                            var pictureElements = document.getElementsByClassName('e-ss-overlay-active');\n                            var pictureLen = pictureElements.length;\n                            if (pictureLen > 0) {\n                                this.parent.notify(deleteImage, {\n                                    id: pictureElements[0].id, sheetIdx: this.parent.activeSheetIndex + 1\n                                });\n                            }\n                            else {\n                                this.startEdit(null, null, true, true);\n                            }\n                        }\n                        if (keyCode === this.keyCodes.DELETE) {\n                            var islockcell = sheet.isProtected && this.isLockCellDelete();\n                            if (!islockcell) {\n                                this.editingHandler('delete');\n                            }\n                        }\n                    }\n                }\n            }\n            else {\n                if (((keyCode >= this.keyCodes.FIRSTALPHABET && keyCode <= this.keyCodes.LASTALPHABET) ||\n                    (keyCode >= this.keyCodes.FIRSTNUMBER && keyCode <= this.keyCodes.LASTNUMBER)\n                    || (keyCode === this.keyCodes.DELETE) || (keyCode === this.keyCodes.BACKSPACE) || (keyCode === this.keyCodes.SPACE)\n                    || (keyCode >= this.keyCodes.FIRSTNUMPAD && keyCode <= this.keyCodes.LASTNUMPAD) ||\n                    (keyCode >= this.keyCodes.SYMBOLSETONESTART && keyCode <= this.keyCodes.SYMBOLSETONEEND)\n                    || (keyCode >= 219 && keyCode <= 222) || (!e.shiftKey && !e.ctrlKey && !e.metaKey && keyCode === this.keyCodes.F2))\n                    && (keyCode !== 67) && (keyCode !== 89) && (keyCode !== 90)) {\n                    if (sheet.protectSettings.insertLink && keyCode === 75) {\n                        return;\n                    }\n                    if (!this.parent.element.querySelector('.e-editAlert-dlg')) {\n                        this.parent.notify(editAlert, null);\n                    }\n                }\n            }\n        }\n    };\n    Edit.prototype.isLockCellDelete = function () {\n        var sheet = this.parent.getActiveSheet();\n        var hasLockCell;\n        var address = getSwapRange(getRangeIndexes(sheet.selectedRange));\n        for (var row = address[0]; row <= address[2]; row++) {\n            for (var col = address[1]; col <= address[3]; col++) {\n                var cell = getCell(row, col, sheet);\n                if (isLocked(cell, getColumn(sheet, col))) {\n                    hasLockCell = true;\n                    break;\n                }\n            }\n        }\n        return hasLockCell;\n    };\n    Edit.prototype.renderEditor = function () {\n        if (!this.editorElem || !select('#' + this.parent.element.id + '_edit', this.parent.element)) {\n            var editor = void 0;\n            editor = this.parent.createElement('div', { id: this.parent.element.id + '_edit', className: 'e-spreadsheet-edit' });\n            editor.contentEditable = 'true';\n            editor.spellcheck = false;\n            this.editorElem = editor;\n            if (this.parent.element.getElementsByClassName('e-spreadsheet-edit')[0]) {\n                this.parent.element.getElementsByClassName('e-spreadsheet-edit')[0].remove();\n            }\n            this.parent.element.querySelector('.e-sheet-content').appendChild(this.editorElem);\n        }\n        this.parent.notify(formulaOperation, { action: 'renderAutoComplete' });\n    };\n    Edit.prototype.refreshEditor = function (value, refreshFormulaBar, refreshEditorElem, isAppend, trigEvent) {\n        if (trigEvent === void 0) { trigEvent = true; }\n        if (isAppend) {\n            value = this.editCellData.value = this.editCellData.value + value;\n        }\n        else {\n            this.editCellData.value = value;\n        }\n        if (refreshEditorElem) {\n            this.editorElem.textContent = value;\n        }\n        if (refreshFormulaBar) {\n            this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: value });\n        }\n        if (trigEvent && this.editCellData.value === this.editorElem.textContent) {\n            if (this.triggerEvent('cellEditing')) {\n                this.cancelEdit();\n            }\n        }\n        // if (this.editorElem.scrollHeight + 2 <= this.editCellData.element.offsetHeight) {\n        //     this.editorElem.style.height = (this.editCellData.element.offsetHeight + 1) + 'px';\n        // } else {\n        //     this.editorElem.style.removeProperty('height');\n        // }\n    };\n    Edit.prototype.startEdit = function (address, value, refreshCurPos, preventFormulaReference) {\n        if (refreshCurPos === void 0) { refreshCurPos = true; }\n        if (this.parent.showSheetTabs) {\n            this.parent.element.querySelector('.e-add-sheet-tab').setAttribute('disabled', 'true');\n        }\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(sheet.activeCell);\n        var cell = getCell(actCell[0], actCell[1], sheet) || {};\n        var range = getRangeIndexes(sheet.activeCell);\n        if (hasTemplate(this.parent, range[0], range[1], this.parent.activeSheetIndex)) {\n            var cellEle = this.parent.getCell(range[0], range[1]);\n            var isDelTemplate = false;\n            var value_1 = cellEle.innerHTML;\n            if (cellEle) {\n                if (value_1.indexOf('<') > -1 && value_1.indexOf('>') > -1 && value_1.indexOf('input') > -1) {\n                    isDelTemplate = true;\n                }\n            }\n            if (isDelTemplate) {\n                return;\n            }\n        }\n        this.updateEditCellDetail(address, value);\n        this.initiateEditor(refreshCurPos);\n        this.positionEditor();\n        this.parent.isEdit = this.isEdit = true;\n        this.parent.notify(clearCopy, null);\n        this.parent.notify(enableToolbarItems, [{ enable: false }]);\n        if (cell.formula && !preventFormulaReference) {\n            this.parent.notify(initiateFormulaReference, { range: cell.formula, formulaSheetIdx: this.editCellData.sheetIndex });\n        }\n    };\n    Edit.prototype.setCursorPosition = function () {\n        var elem = this.editorElem;\n        var textLen = elem.textContent.length;\n        if (textLen) {\n            var selection = document.getSelection();\n            var range = document.createRange();\n            range.setStart(elem.firstChild, textLen);\n            range.collapse(true);\n            selection.removeAllRanges();\n            selection.addRange(range);\n        }\n        elem.focus();\n    };\n    Edit.prototype.hasFormulaSuggSelected = function () {\n        var suggDdlElem = document.getElementById(this.parent.element.id + '_ac_popup');\n        return suggDdlElem && suggDdlElem.style.visibility === 'visible' &&\n            suggDdlElem.querySelectorAll('.e-item-focus').length > 0;\n    };\n    Edit.prototype.editingHandler = function (action) {\n        var pictureElements = document.getElementsByClassName('e-ss-overlay-active');\n        var pictureLen = pictureElements.length;\n        switch (action) {\n            case 'delete':\n                if (pictureLen > 0) {\n                    if (pictureElements[0].classList.contains('e-datavisualization-chart')) {\n                        this.parent.notify(deleteChart, {\n                            id: pictureElements[0].id, sheetIdx: this.parent.activeSheetIndex + 1\n                        });\n                    }\n                    else {\n                        this.parent.notify(deleteImage, {\n                            id: pictureElements[0].id, sheetIdx: this.parent.activeSheetIndex + 1\n                        });\n                    }\n                }\n                else {\n                    var sheet = this.parent.getActiveSheet();\n                    var address = sheet.selectedRange;\n                    this.parent.notify(beginAction, { action: 'cellDelete', eventArgs: { address: sheet.name + '!' + address } });\n                    var range = getIndexesFromAddress(address);\n                    range = range[0] > range[2] ? getSwapRange(range) : range;\n                    address = getRangeAddress(range);\n                    this.parent.clearRange(address, null, true);\n                    this.parent.serviceLocator.getService('cell').refreshRange(range);\n                    this.parent.notify(selectionComplete, {});\n                    this.parent.notify(dataChanged, { address: address, sheetIdx: this.parent.activeSheetIndex, action: 'delete' });\n                    this.parent.notify(completeAction, { action: 'cellDelete', eventArgs: { address: sheet.name + '!' + address } });\n                }\n                break;\n        }\n    };\n    Edit.prototype.mouseDownHandler = function (e) {\n        if (!closest(e.target, '.e-findtool-dlg')) {\n            if (this.isEdit) {\n                var trgtElem = e.target;\n                var sheet = this.parent.getActiveSheet();\n                var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n                this.isCellEdit = trgtElem.classList.contains('e-spreadsheet-edit');\n                var isFormula = checkIsFormula(this.editCellData.value) ||\n                    (this.editCellData.value && this.editCellData.value.toString().indexOf('=') === 0);\n                if (trgtElem.classList.contains('e-cell') || trgtElem.classList.contains('e-header-cell') ||\n                    trgtElem.classList.contains('e-selectall') || closest(trgtElem, '.e-toolbar-item.e-active')) {\n                    if (this.isAltEnter) {\n                        var editText = this.parent.element.querySelector('.e-spreadsheet-edit').textContent;\n                        if (editText && editText.indexOf('\\n') > -1) {\n                            this.isAltEnter = false;\n                            wrapText(this.parent.getActiveSheet().selectedRange, true, this.parent);\n                            this.refreshEditor(this.editorElem.textContent, this.isCellEdit);\n                        }\n                    }\n                    if (!isFormula) {\n                        this.endEdit(false, e);\n                    }\n                    else {\n                        var curPos = window.getSelection().focusOffset;\n                        var actCellIdx = getCellIndexes(sheet.activeCell);\n                        var cell = getCell(actCellIdx[0], actCellIdx[1], sheet);\n                        if (this.editCellData.value === this.editorElem.textContent && (this.editorElem.textContent.indexOf('(') !==\n                            this.editorElem.textContent.length - 1 && this.editorElem.textContent.indexOf('(') !== -1)) {\n                            if (this.editCellData.sheetIndex !== sheet.id - 1) {\n                                var elem = this.parent.element.querySelector('.e-formula-bar');\n                                if (this.editorElem.textContent.substring(elem.selectionEnd - 1, elem.selectionEnd) !== ',' &&\n                                    !e.shiftKey) {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.parent.goTo(this.editCellData.fullAddr);\n                                    this.endEdit(false, e);\n                                    return;\n                                }\n                            }\n                            else {\n                                if (this.validCharacters.indexOf(this.editorElem.textContent.substring(curPos - 1, curPos)) === -1) {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                    return;\n                                }\n                            }\n                        }\n                        if (!cell) {\n                            return;\n                        }\n                        isFormula = cell.formula ?\n                            checkIsFormula(getCell(actCellIdx[0], actCellIdx[1], sheet).formula) ||\n                                (this.editCellData.value && this.editCellData.value.toString().indexOf('=') === 0) : false;\n                        if (isFormula) {\n                            var curPos_1 = window.getSelection().focusOffset;\n                            if (this.editCellData.value.length === curPos_1) {\n                                if (this.editCellData.value.substring(this.editCellData.value.length - 1) === ')' ||\n                                    isNumber(this.editCellData.value.substring(this.editCellData.value.length - 1))) {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                }\n                            }\n                            else if (this.editCellData.value === this.editorElem.textContent) {\n                                if ((this.editCellData.value + sheet.selectedRange).substring(curPos_1 - 1, curPos_1) !== ',') {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                }\n                                else if (this.editCellData.value.substring(curPos_1) !== ')') {\n                                    if (formulaRefIndicator) {\n                                        formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                    }\n                                    this.endEdit(false, e);\n                                }\n                            }\n                        }\n                    }\n                }\n                else {\n                    if (isFormula && this.editCellData.value === this.editorElem.textContent && this.editorElem.textContent.indexOf('(') !==\n                        this.editorElem.textContent.length - 1 && !this.isCellEdit) {\n                        if (this.editCellData.sheetIndex === sheet.id - 1) {\n                            var curPos = window.getSelection().focusOffset;\n                            if (this.validCharacters.indexOf(this.editorElem.textContent.substring(curPos - 1, curPos)) === -1) {\n                                if (formulaRefIndicator) {\n                                    formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n                                }\n                                this.parent.goTo(this.editCellData.fullAddr);\n                                this.endEdit(false, e);\n                                return;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Edit.prototype.dblClickHandler = function (e) {\n        var trgtElem = e.target;\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(sheet.activeCell);\n        var cell = getCell(actCell[0], actCell[1], sheet) || {};\n        if (closest(trgtElem, '.e-datavisualization-chart')) {\n            return;\n        }\n        if (!sheet.isProtected || !isLocked(cell, getColumn(sheet, actCell[1]))) {\n            if ((trgtElem.className.indexOf('e-ss-overlay') < 0) &&\n                (trgtElem.classList.contains('e-active-cell') || trgtElem.classList.contains('e-cell')\n                    || closest(trgtElem, '.e-sheet-content'))) {\n                if (this.isEdit) {\n                    if (checkIsFormula(this.editCellData.value)) {\n                        var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n                        if (this.parent.getActiveSheet().name === sheetName) {\n                            this.endEdit();\n                        }\n                    }\n                    else {\n                        this.endEdit();\n                    }\n                }\n                else {\n                    this.isNewValueEdit = false;\n                    this.startEdit();\n                }\n            }\n        }\n        else {\n            if (trgtElem.classList.contains('e-active-cell') || trgtElem.classList.contains('e-cell')) {\n                this.parent.notify(editAlert, null);\n            }\n        }\n    };\n    Edit.prototype.updateEditCellDetail = function (addr, value) {\n        var sheetIdx;\n        var sheet;\n        if (!this.editCellData.sheetIndex) {\n            if (addr && addr.split('!').length > 1) {\n                sheetIdx = getSheetIndex(this.parent, getSheetNameFromAddress(addr));\n            }\n            else {\n                sheetIdx = this.parent.activeSheetIndex;\n            }\n        }\n        if (!this.editCellData.addr) {\n            sheet = getSheet(this.parent, sheetIdx);\n            if (addr) {\n                addr = getRangeFromAddress(addr);\n            }\n            else {\n                addr = sheet.activeCell;\n            }\n        }\n        else if (checkIsFormula(this.editCellData.value)) {\n            sheet = getSheet(this.parent, sheetIdx);\n            this.isNewValueEdit = false;\n        }\n        if (addr) {\n            var range = getRangeIndexes(addr);\n            var rowIdx = range[0];\n            var colIdx = range[1];\n            var cellElem = this.parent.getCell(rowIdx, colIdx);\n            var cellPosition = getCellPosition(sheet, range);\n            this.editCellData = {\n                addr: addr,\n                fullAddr: getSheetName(this.parent, sheetIdx) + '!' + addr,\n                rowIndex: rowIdx,\n                colIndex: colIdx,\n                sheetIndex: sheetIdx,\n                element: cellElem,\n                value: value || '',\n                position: cellPosition\n            };\n        }\n    };\n    Edit.prototype.initiateEditor = function (refreshCurPos) {\n        var _this = this;\n        var data = this.parent.getData(this.editCellData.fullAddr);\n        data.then(function (values) {\n            values.forEach(function (cell, key) {\n                var args = { cell: cell, value: cell ? cell.value : '' };\n                _this.parent.notify(getFormattedBarText, args);\n                var value = cell ? args.value : '';\n                if (cell && cell.formula) {\n                    value = cell.formula;\n                }\n                _this.editCellData.oldValue = value;\n                if (_this.editCellData.value) {\n                    value = _this.editCellData.value;\n                }\n                else {\n                    _this.editCellData.value = value;\n                }\n                if (_this.isNewValueEdit) {\n                    value = '';\n                }\n                else {\n                    _this.isNewValueEdit = true;\n                }\n                if (!isUndefined(value)) {\n                    _this.refreshEditor(value, false, true, false, false);\n                }\n                if (refreshCurPos) {\n                    _this.setCursorPosition();\n                }\n                if (_this.triggerEvent('cellEdit')) {\n                    _this.cancelEdit(true, false);\n                }\n            });\n        });\n    };\n    Edit.prototype.positionEditor = function (isWrap) {\n        var tdElem = this.editCellData.element;\n        var isEdit = false;\n        var cellEle;\n        var arg = { isEdit: isEdit };\n        this.parent.notify(isFormulaBarEdit, arg);\n        if (arg.isEdit && isNullOrUndefined(tdElem)) {\n            cellEle = this.parent.getCell(this.editCellData.rowIndex, this.editCellData.colIndex);\n            tdElem = cellEle;\n            this.editCellData.element = cellEle;\n        }\n        if (tdElem) {\n            tdElem.classList.add('e-ss-edited');\n            var cell = getCell(this.editCellData.rowIndex, this.editCellData.colIndex, this.parent.getActiveSheet());\n            var left = this.editCellData.position.left + 1;\n            var top_1 = this.editCellData.position.top + 1;\n            var minHeight = this.parent.getCell(this.editCellData.rowIndex, this.editCellData.colIndex).offsetHeight - 3;\n            var minWidth = this.editCellData.element.offsetWidth - 3;\n            var mainContElement = this.parent.getMainContent();\n            var editWidth = mainContElement.offsetWidth - left - 28;\n            var height = ((cell && cell.wrap) || (tdElem && isWrap)) ? 'height:auto' : (minHeight) + 'px;';\n            // let editHeight: number = mainContElement.offsetHeight - top - 28;\n            var inlineStyles = 'display:block;top:' + top_1 + 'px;' + (this.parent.enableRtl ? 'right:' : 'left:') + left + 'px;' +\n                'min-width:' + minWidth + 'px;max-width:' + editWidth + 'px;' + 'height:' + height +\n                ((cell && cell.wrap) ? ('width:' + minWidth + 'px;') : '') + 'min-height:' + minHeight + 'px;';\n            inlineStyles += tdElem.style.cssText;\n            this.editorElem.setAttribute('style', inlineStyles);\n            this.parent.element.querySelector('.e-active-cell').style.height =\n                (this.editCellData.element.offsetHeight + 1) + 'px'; // we using edit div height as auto , while editing div enlarges and \n            // hide active cell bottom border for that we increasing 1px height to active cell.\n            if (tdElem.classList.contains('e-right-align')) {\n                this.editorElem.classList.add('e-right-align');\n            }\n            else if (tdElem.classList.contains('e-center-align')) {\n                this.editorElem.classList.add('e-center-align');\n            }\n        }\n    };\n    Edit.prototype.updateEditedValue = function (tdRefresh) {\n        if (tdRefresh === void 0) { tdRefresh = true; }\n        var oldCellValue = this.editCellData.oldValue;\n        var oldValue = oldCellValue ? oldCellValue.toString().toUpperCase() : '';\n        var isValidate = true;\n        var address = this.editCellData.addr;\n        var cellIndex = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(cellIndex[0], cellIndex[1], sheet);\n        /* To set the before cell details for undo redo. */\n        this.parent.notify(setActionData, { args: { action: 'beforeCellSave', eventArgs: { address: this.editCellData.addr } } });\n        if (this.parent.allowDataValidation && cell && cell.validation) {\n            var value = this.parent.element.getElementsByClassName('e-spreadsheet-edit')[0].innerText;\n            var isCell = true;\n            var sheetIdx = this.parent.activeSheetIndex;\n            var range = void 0;\n            if (typeof address === 'string') {\n                range = getRangeIndexes(address);\n            }\n            else {\n                range = address;\n            }\n            this.parent.notify(isValidation, { value: value, range: range, sheetIdx: sheetIdx, isCell: isCell });\n            isValidate = this.parent.allowDataValidation;\n            this.editCellData.value = isValidate ? value : this.editCellData.value;\n            this.parent.allowDataValidation = true;\n        }\n        if ((oldCellValue !== this.editCellData.value || oldValue.indexOf('=RAND()') > -1 || oldValue.indexOf('RAND()') > -1 ||\n            oldValue.indexOf('=RANDBETWEEN(') > -1 || oldValue.indexOf('RANDBETWEEN(') > -1) && isValidate) {\n            var sheet_1 = this.parent.getActiveSheet();\n            var cellIndex_1 = getRangeIndexes(sheet_1.activeCell);\n            this.parent.notify(workbookEditOperation, { action: 'updateCellValue', address: this.editCellData.addr, value: this.editCellData.value });\n            var cell_1 = getCell(cellIndex_1[0], cellIndex_1[1], sheet_1, true);\n            var eventArgs = this.getRefreshNodeArgs(cell_1);\n            this.editCellData.value = eventArgs.value;\n            if (cell_1 && cell_1.formula) {\n                this.editCellData.formula = cell_1.formula;\n            }\n            if (cell_1.wrap) {\n                this.parent.notify(wrapEvent, { range: cellIndex_1, wrap: true, sheet: sheet_1 });\n            }\n            if (tdRefresh) {\n                this.parent.refreshNode(this.editCellData.element, eventArgs);\n            }\n        }\n        if (this.parent.allowConditionalFormat) {\n            this.parent.notify(checkConditionalFormat, { rowIdx: cellIndex[0], colIdx: cellIndex[1], cell: cell });\n        }\n        return isValidate;\n    };\n    Edit.prototype.refreshDependentCellValue = function (rowIdx, colIdx, sheetIdx) {\n        if (rowIdx && colIdx) {\n            rowIdx--;\n            colIdx--;\n            if ((this.editCellData.rowIndex !== rowIdx || this.editCellData.colIndex !== colIdx)\n                && this.parent.activeSheetIndex === sheetIdx) {\n                var td = this.parent.getCell(rowIdx, colIdx);\n                if (td) {\n                    var sheet = getSheet(this.parent, sheetIdx);\n                    var cell = getCell(rowIdx, colIdx, sheet);\n                    var eventArgs = this.getRefreshNodeArgs(cell);\n                    this.parent.refreshNode(td, eventArgs);\n                }\n            }\n        }\n    };\n    Edit.prototype.getRefreshNodeArgs = function (cell) {\n        cell = cell ? cell : {};\n        var fCode = (cell && cell.format) ? cell.format : '';\n        var eventArgs = {\n            value: cell.value, format: fCode, onLoad: true,\n            formattedText: '', isRightAlign: false, type: 'General'\n        };\n        var args;\n        this.parent.notify(getFormattedCellObject, eventArgs);\n        eventArgs.formattedText = this.parent.allowNumberFormatting ? eventArgs.formattedText : eventArgs.value;\n        args = {\n            isRightAlign: eventArgs.isRightAlign,\n            result: eventArgs.formattedText,\n            type: eventArgs.type,\n            value: eventArgs.value,\n            curSymbol: eventArgs.curSymbol\n        };\n        return args;\n    };\n    Edit.prototype.endEdit = function (refreshFormulaBar, event) {\n        if (refreshFormulaBar === void 0) { refreshFormulaBar = false; }\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(sheet.activeCell);\n        var cell = this.parent.getCell(actCell[0], actCell[1]);\n        var fSize = '';\n        if (this.editCellData.element.children[0] && this.editCellData.element.children[0].className === 'e-cf-databar') {\n            fSize = cell.children[0].querySelector('.e-databar-value').style.fontSize;\n        }\n        if (refreshFormulaBar) {\n            this.refreshEditor(this.editCellData.oldValue, false, true, false, false);\n        }\n        if (this.triggerEvent('beforeCellSave')) {\n            event.preventDefault();\n            return;\n        }\n        var isValidate = this.updateEditedValue();\n        if (isValidate) {\n            this.triggerEvent('cellSave', event);\n            this.resetEditState();\n            this.focusElement();\n        }\n        else if (event) {\n            event.preventDefault();\n        }\n        if (fSize !== '') {\n            cell.children[0].querySelector('.e-databar-value').style.fontSize = fSize;\n        }\n        if (this.parent.showSheetTabs) {\n            this.parent.element.querySelector('.e-add-sheet-tab').removeAttribute('disabled');\n        }\n    };\n    Edit.prototype.cancelEdit = function (refreshFormulaBar, trigEvent, event) {\n        if (refreshFormulaBar === void 0) { refreshFormulaBar = true; }\n        if (trigEvent === void 0) { trigEvent = true; }\n        this.refreshEditor(this.editCellData.oldValue, refreshFormulaBar, false, false, false);\n        if (trigEvent) {\n            this.triggerEvent('cellSave', event);\n        }\n        this.resetEditState();\n        this.focusElement();\n    };\n    Edit.prototype.focusElement = function () {\n        focus(this.parent.element);\n        this.parent.notify(enableToolbarItems, [{ enable: true }]);\n    };\n    Edit.prototype.triggerEvent = function (eventName, event) {\n        var cell = getCell(this.editCellData.rowIndex, this.editCellData.colIndex, this.parent.getActiveSheet());\n        var eventArgs = {\n            element: this.editCellData.element,\n            value: this.editCellData.value,\n            oldValue: this.editCellData.oldValue,\n            address: this.editCellData.fullAddr,\n            displayText: this.parent.getDisplayText(cell)\n        };\n        if (eventName === 'cellSave') {\n            if (this.editCellData.formula) {\n                eventArgs.formula = this.editCellData.formula;\n            }\n            eventArgs.originalEvent = event;\n            this.parent.notify(dataChanged, eventArgs);\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'cellSave' });\n        }\n        if (eventName !== 'cellSave') {\n            eventArgs.cancel = false;\n        }\n        this.parent.trigger(eventName, eventArgs);\n        return eventArgs.cancel;\n    };\n    Edit.prototype.altEnter = function () {\n        this.positionEditor(true);\n        var text;\n        var textBefore;\n        var textAfter;\n        var selection = window.getSelection();\n        var node = selection.anchorNode;\n        var offset;\n        var range = document.createRange();\n        offset = (node.nodeType === 3) ? selection.anchorOffset : node.textContent.length;\n        if (offset === 0 && node.textContent.length > 0) {\n            offset = node.textContent.length;\n        }\n        text = node.textContent;\n        textBefore = text.slice(0, offset);\n        textAfter = text.slice(offset) || ' ';\n        node.textContent = textBefore + '\\n' + textAfter;\n        range = document.createRange();\n        if (node.nodeType === 3) {\n            range.setStart(node, offset + 1);\n            range.setEnd(node, offset + 1);\n        }\n        else if (node.nodeType === 1) {\n            range.setStart(node.firstChild, offset + 1);\n            range.setEnd(node.firstChild, offset + 1);\n        }\n        selection.removeAllRanges();\n        selection.addRange(range);\n    };\n    Edit.prototype.resetEditState = function (elemRefresh) {\n        if (elemRefresh === void 0) { elemRefresh = true; }\n        if (elemRefresh) {\n            if (checkIsFormula(this.editorElem.textContent)) {\n                this.parent.notify(clearCellRef, null);\n            }\n            if (this.editCellData.element) {\n                this.editCellData.element.classList.remove('e-ss-edited');\n                this.editorElem.textContent = '';\n                this.editorElem.removeAttribute('style');\n                this.editorElem.classList.remove('e-right-align');\n            }\n        }\n        this.editCellData = {};\n        this.parent.isEdit = this.isEdit = false;\n        this.isCellEdit = true;\n        this.parent.notify(formulaOperation, { action: 'endEdit' });\n    };\n    Edit.prototype.refSelectionRender = function () {\n        if (this.editorElem) {\n            if (checkIsFormula(this.editorElem.textContent)) {\n                this.parent.notify(initiateFormulaReference, {\n                    range: this.editorElem.textContent, formulaSheetIdx: this.editCellData.sheetIndex\n                });\n            }\n        }\n    };\n    // Start edit the formula cell and set cursor position\n    Edit.prototype.initiateRefSelection = function () {\n        var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n        var value = this.parent.element.querySelector('.e-formula-bar').value;\n        if (this.parent.getActiveSheet().name === sheetName && checkIsFormula(this.editCellData.value)) {\n            this.startEdit(this.editCellData.addr, value, false);\n            this.parent.notify(initiateFormulaReference, {\n                range: this.editCellData.value, formulaSheetIdx: this.editCellData.sheetIndex\n            });\n            this.parent.element.querySelector('.e-spreadsheet-edit').innerHTML = value;\n            this.initiateCurPosition();\n        }\n        else {\n            this.initiateCurPosition();\n        }\n    };\n    Edit.prototype.addressHandler = function (args) {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var address = args.range;\n        var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n        var sheetIdx = this.editCellData.sheetIndex;\n        var editorEle = this.parent.element.querySelector('.e-spreadsheet-edit');\n        if (this.parent.getActiveSheet().name !== sheetName) {\n            address = '\\'' + this.parent.getActiveSheet().name + '\\'' + '!' + address;\n        }\n        if (args.isSelect) {\n            this.parent.notify(initiateFormulaReference, { range: eventArgs.editedValue + address, formulaSheetIdx: sheetIdx });\n        }\n        else {\n            var editedValue = eventArgs.editedValue;\n            if (editedValue.indexOf(')') === editedValue.length - 1) {\n                editorEle.textContent = editedValue.substring(0, editedValue.length - 1)\n                    + address + editedValue.substring(editedValue.length - 1);\n            }\n            else {\n                editorEle.textContent = editedValue + address;\n            }\n        }\n    };\n    Edit.prototype.updateFormulaBarValue = function () {\n        var value = this.editCellData.value;\n        var address = this.parent.getActiveSheet().selectedRange;\n        address = isSingleCell(getIndexesFromAddress(address)) ? address.split(':')[0] : address;\n        var formulaBar = this.parent.element.querySelector('.e-formula-bar');\n        if (value && checkIsFormula(value)) {\n            var sheetName = this.editCellData.fullAddr.substring(0, this.editCellData.fullAddr.indexOf('!'));\n            if (this.parent.getActiveSheet().name !== sheetName) {\n                address = '\\'' + this.parent.getActiveSheet().name + '\\'' + '!' + address;\n            }\n            if (value.indexOf(')') === value.length - 1) {\n                formulaBar.value = value.substring(0, value.length - 1) + address + value.substring(value.length - 1);\n            }\n            else {\n                formulaBar.value = value + address;\n            }\n        }\n    };\n    Edit.prototype.setFormulaBarCurPosition = function (input, selectionStart, selectionEnd) {\n        if (input.setSelectionRange) {\n            input.focus();\n            input.selectionStart = selectionStart;\n            input.selectionEnd = selectionStart;\n            input.setSelectionRange(selectionStart, selectionEnd);\n        }\n    };\n    Edit.prototype.initiateCurPosition = function () {\n        var el = this.parent.element.querySelector('.e-spreadsheet-edit');\n        if (el.innerText) {\n            var range = document.createRange();\n            if (el.innerText.indexOf(')') === el.innerText.length - 1) {\n                range.setStart(el.childNodes[0], el.innerText.length - 1);\n                range.setEnd(el.childNodes[0], el.innerText.length - 1);\n            }\n            else {\n                range.setStart(el.childNodes[0], el.innerText.length);\n                range.setEnd(el.childNodes[0], el.innerText.length);\n            }\n            var selection = window.getSelection();\n            selection.removeAllRanges();\n            selection.addRange(range);\n        }\n        var sheetIdx = this.editCellData.sheetIndex;\n        if (sheetIdx !== this.parent.getActiveSheet().id - 1) {\n            var elem = this.parent.element.querySelector('.e-formula-bar');\n            if (elem.value) {\n                var valueLength = elem.value.length;\n                if (elem.value.indexOf(')') === valueLength - 1) {\n                    this.setFormulaBarCurPosition(elem, valueLength - 1, valueLength - 1);\n                }\n                else {\n                    this.setFormulaBarCurPosition(elem, valueLength, valueLength);\n                }\n            }\n        }\n    };\n    return Edit;\n}());\nexport { Edit };\n","import { contentLoaded, mouseDown, virtualContentLoaded, cellNavigate, getUpdateUsingRaf, focusBorder } from '../common/index';\nimport { showAggregate, refreshImgElem, getRowIdxFromClientY, getColIdxFromClientX, clearChartBorder } from '../common/index';\nimport { getColumnsWidth, updateSelectedRange, getColumnWidth, mergedRange, activeCellMergedRange } from '../../workbook/index';\nimport { getRowHeight, isSingleCell, activeCellChanged, checkIsFormula, getSheetIndex } from '../../workbook/index';\nimport { EventHandler, addClass, removeClass, isNullOrUndefined, Browser, closest } from '@syncfusion/ej2-base';\nimport { selectionComplete, getMoveEvent, getEndEvent, isTouchStart, locateElem } from '../common/index';\nimport { isTouchEnd, isTouchMove, getClientX, getClientY, mouseUpAfterSelection, selectRange, rowHeightChanged } from '../common/index';\nimport { colWidthChanged, protectSelection, editOperation, initiateFormulaReference, initiateCur, clearCellRef } from '../common/index';\nimport { getRangeIndexes, getCellAddress, getRangeAddress, getCellIndexes, getSwapRange } from '../../workbook/common/address';\nimport { addressHandle } from '../common/index';\nimport { isCellReference } from '../../workbook/index';\nimport { getIndexesFromAddress } from '../../workbook/common/address';\n/**\n * Represents selection support for Spreadsheet.\n */\nvar Selection = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet selection module.\n     * @private\n     */\n    function Selection(parent) {\n        this.uniqueOBracket = String.fromCharCode(129);\n        this.uniqueCBracket = String.fromCharCode(130);\n        this.uniqueCSeparator = String.fromCharCode(131);\n        this.uniqueCOperator = String.fromCharCode(132);\n        this.uniquePOperator = String.fromCharCode(133);\n        this.uniqueSOperator = String.fromCharCode(134);\n        this.uniqueMOperator = String.fromCharCode(135);\n        this.uniqueDOperator = String.fromCharCode(136);\n        this.uniqueModOperator = String.fromCharCode(137);\n        this.uniqueConcateOperator = String.fromCharCode(138);\n        this.uniqueEqualOperator = String.fromCharCode(139);\n        this.uniqueExpOperator = String.fromCharCode(140);\n        this.uniqueGTOperator = String.fromCharCode(141);\n        this.uniqueLTOperator = String.fromCharCode(142);\n        this.invalidOperators = ['%'];\n        this.formulaRange = [];\n        this.tableRangesFormula = {};\n        this.parent = parent;\n        this.addEventListener();\n        this.mouseMoveEvt = this.mouseMoveHandler.bind(this);\n    }\n    Selection.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.init, this);\n        this.parent.on(mouseDown, this.mouseDownHandler, this);\n        this.parent.on(virtualContentLoaded, this.virtualContentLoadedHandler, this);\n        this.parent.on(cellNavigate, this.cellNavigateHandler, this);\n        this.parent.on(selectRange, this.selectRange, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChanged, this);\n        this.parent.on(colWidthChanged, this.colWidthChanged, this);\n        this.parent.on(protectSelection, this.protectHandler, this);\n        this.parent.on(initiateFormulaReference, this.initiateFormulaSelection, this);\n        this.parent.on(clearCellRef, this.clearBorder, this);\n        this.parent.on(getRowIdxFromClientY, this.getRowIdxFromClientY, this);\n        this.parent.on(getColIdxFromClientX, this.getColIdxFromClientX, this);\n        this.parent.on(focusBorder, this.chartBorderHandler, this);\n    };\n    Selection.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(contentLoaded, this.init);\n            this.parent.off(mouseDown, this.mouseDownHandler);\n            this.parent.off(virtualContentLoaded, this.virtualContentLoadedHandler);\n            this.parent.off(cellNavigate, this.cellNavigateHandler);\n            this.parent.off(selectRange, this.selectRange);\n            this.parent.off(rowHeightChanged, this.rowHeightChanged);\n            this.parent.off(colWidthChanged, this.colWidthChanged);\n            this.parent.off(protectSelection, this.protectHandler);\n            this.parent.off(initiateFormulaReference, this.initiateFormulaSelection);\n            this.parent.off(clearCellRef, this.clearBorder);\n            this.parent.off(getRowIdxFromClientY, this.getRowIdxFromClientY);\n            this.parent.off(getColIdxFromClientX, this.getColIdxFromClientX);\n            this.parent.off(focusBorder, this.chartBorderHandler);\n        }\n    };\n    Selection.prototype.rowHeightChanged = function (args) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var ele = _this.getActiveCell();\n            var cellIndex = getCellIndexes(_this.parent.getActiveSheet().activeCell)[0];\n            if (cellIndex === args.rowIdx && ele) {\n                ele.style.height = parseInt(ele.style.height, 10) + args.threshold + \"px\";\n            }\n            else if (cellIndex > args.rowIdx && ele) {\n                ele.style.top = parseInt(ele.style.top, 10) + args.threshold + \"px\";\n            }\n            ele = _this.getSelectionElement();\n            if (ele) {\n                var selectedRange = getRangeIndexes(_this.parent.getActiveSheet().selectedRange);\n                var sRange = getSwapRange(selectedRange);\n                var rowStart = sRange[0];\n                var rowEnd = sRange[2];\n                if (rowStart <= args.rowIdx && rowEnd >= args.rowIdx && ele) {\n                    ele.style.height = parseInt(ele.style.height, 10) + args.threshold + \"px\";\n                }\n                else if (rowStart > args.rowIdx && ele) {\n                    ele.style.top = parseInt(ele.style.top, 10) + args.threshold + \"px\";\n                }\n            }\n        });\n    };\n    Selection.prototype.colWidthChanged = function (args) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var ele = _this.getActiveCell();\n            var cellIndex = getCellIndexes(_this.parent.getActiveSheet().activeCell)[1];\n            if (cellIndex === args.colIdx && ele) {\n                ele.style.width = parseInt(ele.style.width, 10) + args.threshold + \"px\";\n            }\n            else if (cellIndex > args.colIdx && ele) {\n                ele.style.left = parseInt(ele.style.left, 10) + args.threshold + \"px\";\n            }\n            ele = _this.getSelectionElement();\n            var selectedRange = getRangeIndexes(_this.parent.getActiveSheet().selectedRange);\n            var sRange = getSwapRange(selectedRange);\n            var colStart = sRange[1];\n            var colEnd = sRange[3];\n            if (colStart <= args.colIdx && colEnd >= args.colIdx && ele) {\n                ele.style.width = parseInt(ele.style.width, 10) + args.threshold + \"px\";\n            }\n            else if (colStart > args.colIdx && ele) {\n                ele.style.left = parseInt(ele.style.left, 10) + args.threshold + \"px\";\n            }\n        });\n    };\n    Selection.prototype.selectRange = function (args) {\n        this.selectRangeByIdx(this.parent.selectionSettings.mode === 'Single' ? args.indexes.slice(0, 2).concat(args.indexes.slice(0, 2)) : args.indexes, null, null, null, null, args.skipChecking);\n    };\n    Selection.prototype.init = function () {\n        var isInit = true;\n        var sheet = this.parent.getActiveSheet();\n        var range = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n        var sRange = getSwapRange(range);\n        var actRange = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var inRange = sRange[0] <= actRange[0] && sRange[2] >= actRange[0] && sRange[1] <= actRange[1]\n            && sRange[3] >= actRange[1];\n        this.createSelectionElement();\n        this.selectRangeByIdx(range, null, null, inRange, isInit);\n    };\n    Selection.prototype.createSelectionElement = function () {\n        var cont = this.parent.getMainContent();\n        var ele = this.parent.createElement('div', { className: 'e-selection' });\n        var activeCell = this.parent.createElement('div', { className: 'e-active-cell' });\n        cont.appendChild(ele);\n        cont.appendChild(activeCell);\n    };\n    Selection.prototype.mouseDownHandler = function (e) {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0) ||\n            checkIsFormula(eventArgs.editedValue);\n        if (!this.parent.isEdit || isFormulaEdit) {\n            var overlayElem = document.getElementById(this.parent.element.id + '_overlay');\n            if (typeof (e.target.className) === 'string') {\n                if (e.target.className.indexOf('e-ss-overlay') > -1) {\n                    return;\n                }\n            }\n            else if (overlayElem) {\n                overlayElem.classList.remove('e-ss-overlay-active');\n            }\n            if (closest(e.target, '.e-datavisualization-chart')) {\n                return;\n            }\n            if (this.parent.getActiveSheet().isProtected && !this.parent.getActiveSheet().protectSettings.selectCells) {\n                return;\n            }\n            if (!closest(e.target, '.e-findtool-dlg')) {\n                if (this.getSheetElement().contains(e.target) && !e.target.classList.contains('e-colresize')\n                    && !e.target.classList.contains('e-rowresize')) {\n                    var sheet = this.parent.getActiveSheet();\n                    var mode = this.parent.selectionSettings.mode;\n                    var rowIdx = this.getRowIdxFromClientY({ clientY: getClientY(e) });\n                    var colIdx = this.getColIdxFromClientX({ clientX: getClientX(e) });\n                    var activeIdx = getCellIndexes(sheet.activeCell);\n                    var isRowSelected = sheet.showHeaders && this.parent.getRowHeaderContent().contains(e.target);\n                    var isColSelected = sheet.showHeaders && this.parent.getColumnHeaderContent().contains(e.target);\n                    if (e.which === 3 && this.isSelected(rowIdx, colIdx)) {\n                        return;\n                    }\n                    if (mode === 'Multiple' && (!isTouchEnd(e) && (!isTouchStart(e) ||\n                        (isTouchStart(e) && activeIdx[0] === rowIdx && activeIdx[1] === colIdx)) || isColSelected || isRowSelected)) {\n                        document.addEventListener(getMoveEvent().split(' ')[0], this.mouseMoveEvt);\n                        if (!Browser.isPointer) {\n                            document.addEventListener(getMoveEvent().split(' ')[1], this.mouseMoveEvt, { passive: false });\n                        }\n                    }\n                    if (!isTouchEnd(e)) {\n                        EventHandler.add(document, getEndEvent(), this.mouseUpHandler, this);\n                    }\n                    if (isTouchStart(e) && !(isColSelected || isRowSelected)) {\n                        this.touchEvt = e;\n                        return;\n                    }\n                    if (isRowSelected) {\n                        this.isRowSelected = true;\n                        if (!e.shiftKey || mode === 'Single') {\n                            this.startCell = [rowIdx, 0];\n                        }\n                        this.selectRangeByIdx([this.startCell[0], 0, rowIdx, sheet.colCount - 1], e);\n                    }\n                    else if (isColSelected) {\n                        this.isColSelected = true;\n                        if (!e.shiftKey || mode === 'Single') {\n                            this.startCell = [0, colIdx];\n                        }\n                        this.selectRangeByIdx([0, this.startCell[1], sheet.rowCount - 1, colIdx], e);\n                    }\n                    else if (e.target.classList.contains('e-selectall')) {\n                        this.startCell = [0, 0];\n                        this.selectRangeByIdx([].concat(this.startCell, [sheet.rowCount - 1, sheet.colCount - 1]), e);\n                    }\n                    else if (!e.target.classList.contains('e-sheet-content')) {\n                        if (!e.shiftKey || mode === 'Single') {\n                            this.startCell = [rowIdx, colIdx];\n                        }\n                        this.selectRangeByIdx([].concat(this.startCell ? this.startCell : getCellIndexes(sheet.activeCell), [rowIdx, colIdx]), e);\n                    }\n                    if (this.parent.isMobileView()) {\n                        this.parent.element.classList.add('e-mobile-focused');\n                        this.parent.renderModule.setSheetPanelSize();\n                    }\n                }\n            }\n        }\n        if (isFormulaEdit && (e.target.classList.contains('e-cell') ||\n            e.target.classList.contains('e-header-cell')) && this.parent.isEdit) {\n            var range = this.parent.getActiveSheet().selectedRange;\n            range = isSingleCell(getIndexesFromAddress(range)) ? range.split(':')[0] : range;\n            this.parent.notify(addressHandle, { range: range, isSelect: false });\n        }\n    };\n    Selection.prototype.mouseMoveHandler = function (e) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        if (isTouchMove(e)) {\n            e.preventDefault();\n        }\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = checkIsFormula(eventArgs.editedValue) ||\n            (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0);\n        var cont = this.getScrollContent();\n        var clientRect = cont.getBoundingClientRect();\n        var clientX = getClientX(e);\n        var clientY = getClientY(e);\n        // remove math.min or handle top and left auto scroll\n        var colIdx = this.isRowSelected ? sheet.colCount - 1 :\n            this.getColIdxFromClientX({ clientX: Math.min(clientX, clientRect.right) });\n        var rowIdx = this.isColSelected ? sheet.rowCount - 1 :\n            this.getRowIdxFromClientY({ clientY: Math.min(clientY, clientRect.bottom) });\n        var prevIndex = getRangeIndexes(sheet.selectedRange);\n        var mergeArgs = { range: [rowIdx, colIdx, rowIdx, colIdx] };\n        this.parent.notify(activeCellMergedRange, mergeArgs);\n        if (mergeArgs.range[2] === prevIndex[2] && mergeArgs.range[3] === prevIndex[3]) {\n            return;\n        }\n        var isScrollDown = clientY > clientRect.bottom && rowIdx < sheet.rowCount;\n        var isScrollUp = clientY < clientRect.top && rowIdx >= 0 && !this.isColSelected;\n        var isScrollRight = clientX > clientRect.right && colIdx < sheet.colCount;\n        var isScrollLeft = clientX < clientRect.left && colIdx >= 0 && !this.isRowSelected;\n        this.clearInterval();\n        if (!isFormulaEdit && !this.isColSelected && !this.isRowSelected) {\n            prevIndex = getCellIndexes(sheet.activeCell);\n        }\n        if (isScrollDown || isScrollUp || isScrollRight || isScrollLeft) {\n            this.scrollInterval = setInterval(function () {\n                if ((isScrollDown || isScrollUp) && !_this.isColSelected) {\n                    rowIdx = _this.getRowIdxFromClientY({ clientY: isScrollDown ? clientRect.bottom : clientRect.top });\n                    if (rowIdx >= sheet.rowCount) { // clear interval when scroll up\n                        _this.clearInterval();\n                        return;\n                    }\n                    cont.scrollTop += (isScrollDown ? 1 : -1) * getRowHeight(sheet, rowIdx);\n                }\n                if ((isScrollRight || isScrollLeft) && !_this.isRowSelected) {\n                    colIdx = _this.getColIdxFromClientX({ clientX: isScrollRight ? clientRect.right : clientRect.left });\n                    if (colIdx >= sheet.colCount) { // clear interval when scroll left\n                        _this.clearInterval();\n                        return;\n                    }\n                    cont.scrollLeft += (isScrollRight ? 1 : -1) * getColumnWidth(sheet, colIdx);\n                }\n                _this.selectRangeByIdx([].concat(prevIndex[0], prevIndex[1], [rowIdx, colIdx]), e);\n                // tslint:disable-next-line\n            }, 100);\n        }\n        else {\n            this.selectRangeByIdx([].concat(prevIndex[0], prevIndex[1], [rowIdx, colIdx]), e);\n        }\n        if (isFormulaEdit && this.parent.isEdit) {\n            var range = this.parent.getActiveSheet().selectedRange;\n            this.parent.notify(addressHandle, { range: range, isSelect: false });\n        }\n    };\n    Selection.prototype.mouseUpHandler = function (e) {\n        var rowIdx = this.getRowIdxFromClientY({ clientY: getClientY(e) });\n        var colIdx = this.getColIdxFromClientX({ clientX: getClientX(e) });\n        this.clearInterval();\n        if (isTouchEnd(e) && !(this.isColSelected || this.isRowSelected) &&\n            (this.getRowIdxFromClientY({ clientY: getClientY(this.touchEvt) }) === rowIdx &&\n                this.getColIdxFromClientX({ clientX: getClientX(this.touchEvt) }) === colIdx)) {\n            this.mouseDownHandler(e);\n        }\n        this.parent.trigger('select', { range: this.parent.getActiveSheet().selectedRange });\n        document.removeEventListener(getMoveEvent().split(' ')[0], this.mouseMoveEvt);\n        if (!Browser.isPointer) {\n            document.removeEventListener(getMoveEvent().split(' ')[1], this.mouseMoveEvt);\n        }\n        EventHandler.remove(document, getEndEvent(), this.mouseUpHandler);\n        this.parent.notify(mouseUpAfterSelection, e);\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = checkIsFormula(eventArgs.editedValue) ||\n            (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0);\n        if (isFormulaEdit && this.parent.isEdit && !e.target.classList.contains('e-spreadsheet-edit')) {\n            this.parent.notify(initiateCur, {});\n        }\n    };\n    Selection.prototype.isSelected = function (rowIdx, colIdx) {\n        var indexes = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n        return indexes[0] <= rowIdx && rowIdx <= indexes[2] && indexes[1] <= colIdx && colIdx <= indexes[3];\n    };\n    Selection.prototype.virtualContentLoadedHandler = function () {\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getRangeIndexes(sheet.selectedRange);\n        if (this.isColSelected && this.isRowSelected) {\n            this.selectRangeByIdx([0, 0, sheet.rowCount - 1, sheet.colCount - 1], null, true);\n        }\n        else if (this.isColSelected) {\n            this.selectRangeByIdx([0, indexes[1], sheet.rowCount - 1, indexes[3]], null, true);\n        }\n        else if (this.isRowSelected) {\n            this.selectRangeByIdx([indexes[0], 0, indexes[2], sheet.colCount - 1], null, true);\n        }\n        else {\n            this.highlightHdr(indexes, indexes[0] >= this.parent.viewport.topIndex || indexes[2] >= this.parent.viewport.topIndex, indexes[1] >= this.parent.viewport.leftIndex || indexes[3] >= this.parent.viewport.leftIndex);\n        }\n    };\n    Selection.prototype.clearInterval = function () {\n        clearInterval(this.scrollInterval);\n        this.scrollInterval = null;\n    };\n    Selection.prototype.getScrollContent = function () {\n        return this.parent.getMainContent();\n    };\n    Selection.prototype.getScrollLeft = function () {\n        return this.parent.scrollModule ? this.parent.scrollModule.prevScroll.scrollLeft : 0;\n    };\n    Selection.prototype.cellNavigateHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected && !sheet.protectSettings.selectCells) {\n            return;\n        }\n        this.selectRangeByIdx(args.range.concat(args.range));\n    };\n    Selection.prototype.getColIdxFromClientX = function (args) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        var cliRect = this.parent.getMainContent().getBoundingClientRect();\n        var left = 0;\n        left = (args.isImage) ? args.clientX : (this.parent.enableRtl ? (cliRect.right - args.clientX) :\n            (args.clientX - cliRect.left)) + this.getScrollLeft();\n        for (var i = 0;; i++) {\n            width += getColumnsWidth(sheet, i);\n            if (left < width) {\n                args.clientX = i;\n                return i;\n            }\n        }\n    };\n    Selection.prototype.getRowIdxFromClientY = function (args) {\n        var height = 0;\n        var sheet = this.parent.getActiveSheet();\n        var top = 0;\n        top = args.isImage ? args.clientY : (args.clientY - this.parent.getMainContent().getBoundingClientRect().top)\n            + this.parent.getMainContent().scrollTop;\n        for (var i = 0;; i++) {\n            height += getRowHeight(sheet, i);\n            if (top < height) {\n                args.clientY = i;\n                return i;\n            }\n        }\n    };\n    Selection.prototype.initFormulaReferenceIndicator = function (range) {\n        if (this.parent.isEdit) {\n            var forRefIndicator = this.parent.createElement('div', { className: 'e-formularef-indicator' });\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-top' }));\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-bottom' }));\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-left' }));\n            forRefIndicator.appendChild(this.parent.createElement('div', { className: 'e-right' }));\n            locateElem(forRefIndicator, range, this.parent.getActiveSheet(), false);\n            this.parent.getMainContent().appendChild(forRefIndicator);\n        }\n    };\n    Selection.prototype.selectRangeByIdx = function (range, e, isScrollRefresh, isActCellChanged, isInit, skipChecking) {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var isFormulaEdit = checkIsFormula(eventArgs.editedValue) ||\n            (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0);\n        var ele = this.getSelectionElement();\n        var sheet = this.parent.getActiveSheet();\n        var formulaRefIndicator = this.parent.element.querySelector('.e-formularef-indicator');\n        var mergeArgs = { range: [].slice.call(range), isActiveCell: false, skipChecking: skipChecking };\n        var isMergeRange;\n        if (!this.isColSelected && !this.isRowSelected) {\n            this.parent.notify(mergedRange, mergeArgs);\n        }\n        if (range !== mergeArgs.range) {\n            isMergeRange = true;\n        }\n        range = mergeArgs.range;\n        var args = { range: getRangeAddress(range), cancel: false };\n        this.parent.trigger('beforeSelect', args);\n        if (args.cancel === true) {\n            return;\n        }\n        if (isFormulaEdit && formulaRefIndicator) {\n            formulaRefIndicator.parentElement.removeChild(formulaRefIndicator);\n        }\n        if (isSingleCell(range) || mergeArgs.isActiveCell) {\n            if (ele) {\n                ele.classList.add('e-hide');\n            }\n            if (isFormulaEdit && e && !e.target.classList.contains('e-spreadsheet-edit') && this.parent.isEdit) {\n                this.parent.notify(addressHandle, { range: getRangeAddress(range).split(':')[0], isSelect: true });\n                this.initFormulaReferenceIndicator(range);\n            }\n        }\n        else {\n            if (isFormulaEdit && this.parent.isEdit) {\n                if (e && !e.target.classList.contains('e-spreadsheet-edit') && this.parent.isEdit) {\n                    this.parent.notify(addressHandle, { range: getRangeAddress(range), isSelect: true });\n                    this.initFormulaReferenceIndicator(range);\n                }\n            }\n            else {\n                if (ele) {\n                    ele.classList.remove('e-hide');\n                }\n                var offset = (this.isColSelected && this.isRowSelected) ? undefined\n                    : this.getOffset(range[2], range[3]);\n                if (isMergeRange && offset) { // Need to handle half hidden merge cell in better way\n                    offset.left = { idx: 0, size: 0 };\n                }\n                locateElem(ele, range, sheet, this.parent.enableRtl);\n            }\n        }\n        var eArgs = { action: 'getCurrentEditSheetIdx', sheetIndex: null };\n        this.parent.notify(editOperation, eArgs);\n        if (!isFormulaEdit) {\n            updateSelectedRange(this.parent, getRangeAddress(range), sheet);\n        }\n        else if (!isInit) {\n            updateSelectedRange(this.parent, getRangeAddress(range), sheet);\n        }\n        this.UpdateRowColSelected(range);\n        this.highlightHdr(range);\n        if (!isScrollRefresh && !(e && (e.type === 'mousemove' || isTouchMove(e)))) {\n            if (!isFormulaEdit) {\n                this.updateActiveCell(isActCellChanged ? getRangeIndexes(sheet.activeCell) : range, isInit);\n            }\n            else if (eArgs.sheetIndex === this.parent.getActiveSheet().id - 1 && isInit) {\n                isActCellChanged = true;\n                this.updateActiveCell(isActCellChanged ? getRangeIndexes(sheet.activeCell) : range, isInit);\n            }\n            else if (!this.parent.isEdit) {\n                this.updateActiveCell(isActCellChanged ? getRangeIndexes(sheet.activeCell) : range, isInit);\n            }\n        }\n        if (isNullOrUndefined(e)) {\n            e = { type: 'mousedown' };\n        }\n        if (!isFormulaEdit) {\n            this.parent.notify(selectionComplete, e);\n        }\n        else if (!isInit) {\n            this.parent.notify(selectionComplete, e);\n        }\n        this.parent.notify(showAggregate, {});\n        this.parent.notify(refreshImgElem, {});\n        this.parent.notify(clearChartBorder, {});\n    };\n    Selection.prototype.UpdateRowColSelected = function (indexes) {\n        var sheet = this.parent.getActiveSheet();\n        this.isRowSelected = (indexes[1] === 0 && indexes[3] === sheet.colCount - 1);\n        this.isColSelected = (indexes[0] === 0 && indexes[2] === sheet.rowCount - 1);\n    };\n    Selection.prototype.updateActiveCell = function (range, isInit) {\n        var sheet = this.parent.getActiveSheet();\n        var topLeftIdx = getRangeIndexes(sheet.topLeftCell);\n        var rowIdx;\n        var colIdx;\n        var cell;\n        var isMergeRange;\n        if (this.isColSelected) {\n            rowIdx = topLeftIdx[0];\n            colIdx = range[1];\n            if (this.isRowSelected) {\n                colIdx = topLeftIdx[1];\n            }\n        }\n        else {\n            rowIdx = range[0];\n            colIdx = range[1];\n            if (this.isRowSelected) {\n                colIdx = topLeftIdx[1];\n            }\n        }\n        var mergeArgs = { range: [rowIdx, colIdx].concat([rowIdx, colIdx]) };\n        this.parent.notify(activeCellMergedRange, mergeArgs);\n        if (range !== mergeArgs.range) {\n            isMergeRange = true;\n        }\n        range = mergeArgs.range;\n        if (sheet.activeCell !== getCellAddress(range[0], range[1]) || isInit) {\n            this.parent.setSheetPropertyOnMute(sheet, 'activeCell', getCellAddress(range[0], range[1]));\n            if (this.getActiveCell()) {\n                var offset = this.getOffset(range[2], range[3]);\n                if (isMergeRange) {\n                    offset.left = { idx: 0, size: 0 };\n                }\n                locateElem(this.getActiveCell(), range, sheet, this.parent.enableRtl);\n            }\n            this.parent.notify(activeCellChanged, null);\n        }\n        else {\n            locateElem(this.getActiveCell(), range, sheet, this.parent.enableRtl);\n        }\n    };\n    Selection.prototype.getOffset = function (rowIdx, colIdx) {\n        var offset = { left: { idx: 0, size: 0 }, top: { idx: 0, size: 0 } };\n        if (this.parent.scrollModule) {\n            if (colIdx >= this.parent.scrollModule.offset.left.idx) {\n                offset.left = this.parent.scrollModule.offset.left;\n            }\n            if (rowIdx >= this.parent.scrollModule.offset.top.idx) {\n                offset.top = this.parent.scrollModule.offset.top;\n            }\n        }\n        return offset;\n    };\n    Selection.prototype.getSelectionElement = function () {\n        return this.parent.element.getElementsByClassName('e-selection')[0];\n    };\n    Selection.prototype.getActiveCell = function () {\n        return this.parent.getMainContent().getElementsByClassName('e-active-cell')[0];\n    };\n    Selection.prototype.getSheetElement = function () {\n        return document.getElementById(this.parent.element.id + '_sheet');\n    };\n    Selection.prototype.highlightHdr = function (range, isRowRefresh, isColRefresh) {\n        if (isRowRefresh === void 0) { isRowRefresh = true; }\n        if (isColRefresh === void 0) { isColRefresh = true; }\n        if (this.parent.getActiveSheet().showHeaders) {\n            var sheet = this.parent.getActiveSheet();\n            var rowHdr = [];\n            var colHdr = [];\n            var swapRange = getSwapRange(range);\n            swapRange = this.getHdrIndexes(swapRange);\n            var selectAll = this.parent.element.getElementsByClassName('e-select-all-cell')[0];\n            removeClass(this.getSheetElement().querySelectorAll('.e-highlight'), 'e-highlight');\n            removeClass(this.getSheetElement().querySelectorAll('.e-prev-highlight'), 'e-prev-highlight');\n            if (selectAll) {\n                removeClass([selectAll], ['e-prev-highlight-right', 'e-prev-highlight-bottom']);\n            }\n            if (isRowRefresh) {\n                rowHdr = [].slice.call(this.parent.getRowHeaderContent().querySelectorAll('td')).slice(swapRange[0], swapRange[2] + 1);\n            }\n            if (isColRefresh) {\n                colHdr = [].slice.call(this.parent.getColumnHeaderContent().querySelectorAll('th')).slice(swapRange[1], swapRange[3] + 1);\n            }\n            if (sheet.isProtected && !sheet.protectSettings.selectCells) {\n                removeClass([].concat(rowHdr, colHdr), 'e-highlight');\n            }\n            else {\n                addClass([].concat(rowHdr, colHdr), 'e-highlight');\n            }\n            if (rowHdr.length && rowHdr[0].parentElement.previousElementSibling) {\n                rowHdr[0].parentElement.previousElementSibling.classList.add('e-prev-highlight');\n            }\n            if (colHdr.length && colHdr[0].previousElementSibling) {\n                colHdr[0].previousElementSibling.classList.add('e-prev-highlight');\n            }\n            if (this.isRowSelected && this.isColSelected) {\n                if (sheet.isProtected && !sheet.protectSettings.selectCells) {\n                    document.getElementById(this.parent.element.id + \"_select_all\").classList.remove('e-highlight');\n                }\n                else {\n                    document.getElementById(this.parent.element.id + \"_select_all\").classList.add('e-highlight');\n                }\n            }\n            if (selectAll) {\n                if (swapRange[0] === 0) {\n                    selectAll.classList.add('e-prev-highlight-bottom');\n                }\n                if (swapRange[1] === 0) {\n                    selectAll.classList.add('e-prev-highlight-right');\n                }\n            }\n        }\n    };\n    Selection.prototype.protectHandler = function () {\n        var range = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n        var swapRange = getSwapRange(range);\n        var actRange = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var inRange = swapRange[0] <= actRange[0] && swapRange[2] >= actRange[0] && swapRange[1] <= actRange[1]\n            && swapRange[3] >= actRange[1];\n        this.selectRangeByIdx(range, null, null, inRange);\n    };\n    Selection.prototype.getHdrIndexes = function (range) {\n        if (this.parent.scrollSettings.enableVirtualization) {\n            var indexes = [];\n            var hiddenRowCount = this.parent.hiddenCount(this.parent.viewport.topIndex, range[0]);\n            var hiddenColCount = this.parent.hiddenCount(this.parent.viewport.leftIndex, range[1], 'columns');\n            indexes[0] = this.isColSelected ? range[0] : (range[0] - this.parent.viewport.topIndex) < 0\n                ? 0 : ((range[0] - hiddenRowCount) - this.parent.viewport.topIndex);\n            indexes[1] = this.isRowSelected ? range[1] : (range[1] - this.parent.viewport.leftIndex) < 0\n                ? 0 : ((range[1] - hiddenColCount) - this.parent.viewport.leftIndex);\n            indexes[2] = this.isColSelected ? this.parent.viewport.rowCount + this.parent.getThreshold('row') * 2 : range[2] -\n                this.parent.hiddenCount(range[0], range[2]) - hiddenRowCount - this.parent.viewport.topIndex;\n            indexes[3] = this.isRowSelected ? this.parent.viewport.colCount + this.parent.getThreshold('col') * 2 :\n                range[3] - this.parent.hiddenCount(range[1], range[3], 'columns') - hiddenColCount - this.parent.viewport.leftIndex;\n            return indexes;\n        }\n        return range;\n    };\n    Selection.prototype.initiateFormulaSelection = function (args) {\n        this.processFormulaEditRange(args.range, args.formulaSheetIdx);\n    };\n    Selection.prototype.processFormulaEditRange = function (val, formulaStartSheetIdx) {\n        var str;\n        var actSheetIdx;\n        var formulaSheetIdx = formulaStartSheetIdx;\n        var lastChar;\n        var i = 0;\n        var parsedVal = this.parseFormula(val);\n        var len = parsedVal.length;\n        var ctrlKeyCount = 0;\n        var formulaBorder = [['e-vborderright', 'e-vborderbottom'], ['e-pborderright', 'e-pborderbottom'],\n            ['e-cborderright', 'e-cborderbottom'], ['e-gborderright', 'e-gborderbottom'], ['e-oborderright', 'e-oborderbottom'],\n            ['e-bborderright', 'e-bborderbottom']];\n        this.clearBorder();\n        actSheetIdx = this.parent.getActiveSheet().id - 1;\n        while (i < len) {\n            str = parsedVal[i];\n            if (this.invalidOperators.indexOf(str) > -1) {\n                break;\n            }\n            if (isCellReference(str.toUpperCase())) {\n                str = str.replace(/\\$/g, '');\n                if (i > 0) {\n                    if (parsedVal[i - 1].indexOf('!') === parsedVal[i - 1].length - 1) {\n                        var splitStr = parsedVal[i - 1].split('!');\n                        formulaSheetIdx = getSheetIndex(this.parent, splitStr[0].substring(1, splitStr[0].length - 1));\n                    }\n                }\n                if (parsedVal[i + 1] === ':') {\n                    i++;\n                    if (parsedVal[i + 1] && isCellReference(parsedVal[i + 1].toUpperCase())) {\n                        str = str + ':' + parsedVal[i + 1];\n                        i++;\n                    }\n                }\n                if (actSheetIdx === formulaSheetIdx) {\n                    this.updateFormulaEditRange(str, ctrlKeyCount, formulaBorder);\n                }\n                formulaSheetIdx = formulaStartSheetIdx;\n                ctrlKeyCount++;\n            }\n            i++;\n        }\n    };\n    Selection.prototype.updateFormulaEditRange = function (str, i, formulaBorder) {\n        var indices = getRangeIndexes(str);\n        this.formulaRange[i] = str;\n        this.dStartCell = { rowIndex: indices[0], colIndex: indices[1] };\n        this.dEndCell = { rowIndex: indices[2], colIndex: indices[3] };\n        this.focusBorder(this.dStartCell, this.dEndCell, formulaBorder[i % 6]);\n    };\n    Selection.prototype.chartBorderHandler = function (args) {\n        this.focusBorder(args.startcell, args.endcell, args.classes, true);\n    };\n    Selection.prototype.focusBorder = function (startcell, endcell, classes, isChart) {\n        isChart = isNullOrUndefined(isChart) ? false : isChart;\n        var range = getSwapRange([startcell.rowIndex, startcell.colIndex, endcell.rowIndex, endcell.colIndex]);\n        var minr = range[0];\n        var minc = range[1];\n        var maxr = range[2];\n        var maxc = range[3];\n        if (minr) {\n            (this.getEleFromRange([minr - 1, minc, minr - 1, maxc])).forEach(function (td) {\n                if (td) {\n                    td.classList.add(classes[1]);\n                    if (!isChart) {\n                        td.classList.add('e-formularef-selection');\n                    }\n                }\n            }); // top                            \n        }\n        (this.getEleFromRange([minr, maxc, maxr, maxc])).forEach(function (td) {\n            if (td) {\n                td.classList.add(classes[0]);\n                if (!isChart) {\n                    td.classList.add('e-formularef-selection');\n                }\n            }\n        }); // right\n        this.getEleFromRange([maxr, minc, maxr, maxc]).forEach(function (td) {\n            if (td) {\n                td.classList.add(classes[1]);\n                if (!isChart) {\n                    td.classList.add('e-formularef-selection');\n                }\n            }\n        }); // bottom\n        if (minc) {\n            (this.getEleFromRange([minr, minc - 1, maxr, minc - 1])).forEach(function (td) {\n                if (td) {\n                    td.classList.add(classes[0]);\n                    if (!isChart) {\n                        td.classList.add('e-formularef-selection');\n                    }\n                }\n            }); // left\n        }\n    };\n    Selection.prototype.getEleFromRange = function (range, sheetIdx) {\n        sheetIdx = this.parent.getActiveSheet().index;\n        var sheet = this.parent.getActiveSheet();\n        var startRIndex = range[0];\n        var startCIndex = range[1];\n        var endRIndex = range[2];\n        var endCIndex = range[3];\n        var i;\n        var rowIdx;\n        var temp;\n        var len;\n        var tempCells = [];\n        var rowCells;\n        var cells = [];\n        if (startRIndex > endRIndex) {\n            temp = startRIndex;\n            startRIndex = endRIndex;\n            endRIndex = temp;\n        }\n        if (startCIndex > endCIndex) {\n            temp = startCIndex;\n            startCIndex = endCIndex;\n            endCIndex = temp;\n        }\n        if (this.parent.scrollSettings.enableVirtualization) {\n            for (i = startRIndex; i <= endRIndex; i++) {\n                rowIdx = i;\n                if (rowIdx > -1) {\n                    var row = this.parent.getRow(rowIdx);\n                    if (row) {\n                        rowCells = row.getElementsByClassName('e-cell');\n                        tempCells = (endCIndex === startCIndex) ?\n                            [rowCells[endCIndex]] : this.getRowCells(rowCells, startCIndex, endCIndex + 1);\n                        this.merge(cells, tempCells);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    Selection.prototype.getRowCells = function (rowCells, startCIndex, endCIndex) {\n        var tdCol = [];\n        for (startCIndex; startCIndex < endCIndex; startCIndex++) {\n            if (rowCells[startCIndex]) {\n                tdCol.push(rowCells[startCIndex]);\n            }\n        }\n        return tdCol;\n    };\n    Selection.prototype.merge = function (first, second) {\n        if (!first || !second) {\n            return;\n        }\n        Array.prototype.push.apply(first, second);\n    };\n    ;\n    Selection.prototype.clearBorder = function () {\n        var borderEleColl = this.parent.element.getElementsByClassName('e-formularef-selection');\n        for (var idx = 0; idx < borderEleColl.length; idx++) {\n            var td = borderEleColl[idx];\n            var classArr = ['e-vborderright', 'e-vborderbottom', 'e-pborderright', 'e-pborderbottom',\n                'e-cborderright', 'e-cborderbottom', 'e-gborderright', 'e-gborderbottom', 'e-oborderright',\n                'e-oborderbottom', 'e-bborderright', 'e-bborderbottom'];\n            for (var idx_1 = 0; idx_1 < classArr.length; idx_1++) {\n                td.classList.remove(classArr[idx_1]);\n            }\n        }\n        for (var idx = 0; idx < borderEleColl.length; idx++) {\n            var td = borderEleColl[idx];\n        }\n    };\n    Selection.prototype.parseFormula = function (formulaStr) {\n        var tempStr;\n        var str;\n        var len;\n        var i = 0;\n        var arr = [];\n        formulaStr = this.markSpecialChar(formulaStr.replace('=', ''));\n        var formula = formulaStr.split(/\\(|\\)|=|\\^|>|<|,|:|\\+|-|\\*|\\/|%|&/g);\n        len = formula.length;\n        while (i < len) {\n            tempStr = formula[i];\n            if (!tempStr) {\n                i++;\n                continue;\n            }\n            if (tempStr.length === 1) {\n                arr.push(this.isUniqueChar(tempStr) ? this.getUniqueCharVal(tempStr) : tempStr);\n            }\n            else {\n                str = tempStr[0];\n                if (tempStr.indexOf('!') > 0) {\n                    if (this.isUniqueChar(str)) {\n                        arr.push(this.getUniqueCharVal(str));\n                        tempStr = tempStr.substr(1);\n                    }\n                    var strVal = tempStr.indexOf('!') + 1;\n                    arr.push(tempStr.substr(0, strVal));\n                    arr.push(tempStr.substr(strVal));\n                }\n                else if (this.isUniqueChar(str)) {\n                    arr.push(this.getUniqueCharVal(str));\n                    arr.push(tempStr.substr(1));\n                }\n                else {\n                    arr.push(tempStr);\n                }\n            }\n            i++;\n        }\n        return arr;\n    };\n    Selection.prototype.isUniqueChar = function (str) {\n        var code = str.charCodeAt(str.charAt[0]);\n        return code >= 129 && code <= 142;\n    };\n    Selection.prototype.getUniqueCharVal = function (tempStr) {\n        switch (tempStr) {\n            case this.uniqueOBracket:\n                return '(';\n            case this.uniqueCBracket:\n                return ')';\n            case this.uniqueCOperator:\n                return ':';\n            case this.uniqueSOperator:\n                return '-';\n            case this.uniquePOperator:\n                return '+';\n            case this.uniqueMOperator:\n                return '*';\n            case this.uniqueDOperator:\n                return '/';\n            case this.uniqueModOperator:\n                return '%';\n            case this.uniqueCSeparator:\n                return ',';\n            case this.uniqueConcateOperator:\n                return '&';\n            case this.uniqueEqualOperator:\n                return '=';\n            case this.uniqueExpOperator:\n                return '^';\n            case this.uniqueLTOperator:\n                return '<';\n            case this.uniqueGTOperator:\n                return '>';\n        }\n        return '';\n    };\n    Selection.prototype.markSpecialChar = function (formulaVal) {\n        formulaVal = formulaVal.replace(/\\(/g, '(' + this.uniqueOBracket).replace(/\\)/g, ')' + this.uniqueCBracket);\n        formulaVal = formulaVal.replace(/,/g, ',' + this.uniqueCSeparator).replace(/:/g, ':' + this.uniqueCOperator);\n        formulaVal = formulaVal.replace(/\\+/g, '+' + this.uniquePOperator).replace(/-/g, '-' + this.uniqueSOperator);\n        formulaVal = formulaVal.replace(/\\*/g, '*' + this.uniqueMOperator).replace(/\\//g, '/' + this.uniqueDOperator);\n        formulaVal = formulaVal.replace(/&/g, '&' + this.uniqueConcateOperator);\n        formulaVal = formulaVal.replace(/=/g, '=' + this.uniqueEqualOperator);\n        formulaVal = formulaVal.replace(/\\^/g, '^' + this.uniqueExpOperator);\n        formulaVal = formulaVal.replace(/>/g, '>' + this.uniqueGTOperator).replace(/</g, '<' + this.uniqueLTOperator);\n        return formulaVal.replace(/%/g, '%' + this.uniqueModOperator);\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    Selection.prototype.getModuleName = function () {\n        return 'selection';\n    };\n    Selection.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return Selection;\n}());\nexport { Selection };\n","import { EventHandler, Browser } from '@syncfusion/ej2-base';\nimport { contentLoaded, spreadsheetDestroyed, onVerticalScroll, onHorizontalScroll, getScrollBarWidth } from '../common/index';\nimport { onContentScroll, deInitProperties, setScrollEvent, skipHiddenIdx } from '../common/index';\nimport { getRowHeight, getColumnWidth, getCellAddress } from '../../workbook/index';\nimport { isFormulaBarEdit } from '../common/index';\n/**\n * The `Scroll` module is used to handle scrolling behavior.\n * @hidden\n */\nvar Scroll = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet scroll module.\n     * @private\n     */\n    function Scroll(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        this.initProps();\n    }\n    Scroll.prototype.onContentScroll = function (e) {\n        var target = this.parent.getMainContent();\n        var scrollLeft = e.scrollLeft || target.scrollLeft;\n        var top = e.scrollTop || target.scrollTop;\n        var left = this.parent.enableRtl ? this.initScrollValue - scrollLeft : scrollLeft;\n        var scrollArgs;\n        var prevSize;\n        if (this.prevScroll.scrollLeft !== left) {\n            var scrollRight = left > this.prevScroll.scrollLeft;\n            prevSize = this.offset.left.size;\n            this.offset.left = this.getColOffset(left, scrollRight, e.skipHidden);\n            if (this.parent.getActiveSheet().showHeaders) {\n                this.parent.getColumnHeaderContent().scrollLeft = scrollLeft;\n            }\n            scrollArgs = {\n                cur: this.offset.left, prev: { idx: this.leftIndex, size: prevSize }, increase: scrollRight, preventScroll: e.preventScroll\n            };\n            this.parent.notify(onHorizontalScroll, scrollArgs);\n            this.updateTopLeftCell(scrollRight);\n            if (!this.parent.scrollSettings.enableVirtualization && scrollRight && !this.parent.scrollSettings.isFinite) {\n                this.updateNonVirtualCols();\n            }\n            this.leftIndex = scrollArgs.prev.idx;\n            this.prevScroll.scrollLeft = left;\n        }\n        if (this.prevScroll.scrollTop !== top) {\n            var scrollDown = top > this.prevScroll.scrollTop;\n            prevSize = this.offset.top.size;\n            this.offset.top = this.getRowOffset(top, scrollDown);\n            if (this.parent.getActiveSheet().showHeaders) {\n                this.parent.getRowHeaderContent().scrollTop = top;\n            }\n            scrollArgs = {\n                cur: this.offset.top, prev: { idx: this.topIndex, size: prevSize }, increase: scrollDown, preventScroll: e.preventScroll\n            };\n            this.parent.notify(onVerticalScroll, scrollArgs);\n            this.updateTopLeftCell(scrollDown);\n            if (!this.parent.scrollSettings.enableVirtualization && scrollDown && !this.parent.scrollSettings.isFinite) {\n                this.updateNonVirtualRows();\n            }\n            this.topIndex = scrollArgs.prev.idx;\n            this.prevScroll.scrollTop = top;\n        }\n        var isEdit = false;\n        var args = { isEdit: isEdit };\n        this.parent.notify(isFormulaBarEdit, args);\n        if (args.isEdit) {\n            var textArea = this.parent.element.querySelector('.e-formula-bar');\n            textArea.focus();\n        }\n    };\n    Scroll.prototype.updateNonVirtualRows = function () {\n        var sheet = this.parent.getActiveSheet();\n        var threshold = this.parent.getThreshold('row');\n        if (this.offset.top.idx > sheet.rowCount - (this.parent.viewport.rowCount + threshold)) {\n            this.parent.renderModule.refreshUI({ colIndex: 0, direction: 'first', refresh: 'RowPart' }, getCellAddress(sheet.rowCount, 0) + \":\" + getCellAddress(sheet.rowCount + threshold - 1, sheet.colCount - 1));\n            sheet.rowCount += threshold;\n        }\n    };\n    Scroll.prototype.updateNonVirtualCols = function () {\n        var sheet = this.parent.getActiveSheet();\n        var threshold = this.parent.getThreshold('col');\n        if (this.offset.left.idx > sheet.colCount - (this.parent.viewport.colCount + threshold)) {\n            this.parent.renderModule.refreshUI({ rowIndex: 0, colIndex: sheet.colCount, direction: 'first', refresh: 'ColumnPart' }, getCellAddress(0, sheet.colCount) + \":\" + getCellAddress(sheet.rowCount - 1, sheet.colCount + threshold - 1));\n            sheet.colCount += threshold;\n        }\n    };\n    Scroll.prototype.updateTopLeftCell = function (increase) {\n        var top = this.offset.top.idx;\n        var left = this.offset.left.idx;\n        if (!increase) {\n            var sheet = this.parent.getActiveSheet();\n            top = skipHiddenIdx(sheet, top, true);\n            left = skipHiddenIdx(sheet, left, true, 'columns');\n        }\n        this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'topLeftCell', getCellAddress(top, left));\n    };\n    Scroll.prototype.getRowOffset = function (scrollTop, scrollDown) {\n        var temp = this.offset.top.size;\n        var sheet = this.parent.getActiveSheet();\n        var i = scrollDown ? this.offset.top.idx + 1 : (this.offset.top.idx ? this.offset.top.idx - 1 : 0);\n        var count;\n        if (this.parent.scrollSettings.isFinite) {\n            count = sheet.rowCount;\n            if (scrollDown && i + this.parent.viewport.rowCount + this.parent.getThreshold('row') >= count) {\n                return { idx: this.offset.top.idx, size: this.offset.top.size };\n            }\n        }\n        else {\n            count = Infinity;\n        }\n        while (i < count) {\n            if (scrollDown) {\n                temp += getRowHeight(sheet, i - 1);\n                if (temp === scrollTop) {\n                    return { idx: i, size: temp };\n                }\n                if (temp > scrollTop) {\n                    return { idx: i - 1, size: temp - getRowHeight(sheet, i - 1) };\n                }\n                i++;\n            }\n            else {\n                if (temp === 0) {\n                    return { idx: 0, size: 0 };\n                }\n                temp -= getRowHeight(sheet, i);\n                if (temp === scrollTop) {\n                    return { idx: i, size: temp };\n                }\n                if (temp < scrollTop) {\n                    temp += getRowHeight(sheet, i);\n                    if (temp > scrollTop) {\n                        return { idx: i, size: temp - getRowHeight(sheet, i) < 0 ? 0 : temp - getRowHeight(sheet, i) };\n                    }\n                    else {\n                        return { idx: i + 1, size: temp };\n                    }\n                }\n                i--;\n            }\n        }\n        return { idx: this.offset.top.idx, size: this.offset.top.size };\n    };\n    Scroll.prototype.getColOffset = function (scrollLeft, increase, skipHidden) {\n        var temp = this.offset.left.size;\n        var sheet = this.parent.getActiveSheet();\n        var i = increase ? this.offset.left.idx + 1 : this.offset.left.idx - 1;\n        var count;\n        if (this.parent.scrollSettings.isFinite) {\n            count = sheet.colCount;\n            if (increase && i + this.parent.viewport.colCount + this.parent.getThreshold('col') >= count) {\n                return { idx: this.offset.left.idx, size: this.offset.left.size };\n            }\n        }\n        else {\n            count = Infinity;\n        }\n        while (i < count) {\n            if (increase) {\n                temp += getColumnWidth(sheet, i - 1, skipHidden);\n                if (temp === scrollLeft) {\n                    return { idx: i, size: temp };\n                }\n                if (temp > scrollLeft) {\n                    return { idx: i - 1, size: temp - getColumnWidth(sheet, i - 1, skipHidden) };\n                }\n                i++;\n            }\n            else {\n                if (temp === 0) {\n                    return { idx: 0, size: 0 };\n                }\n                temp -= getColumnWidth(sheet, i, skipHidden);\n                if (temp === scrollLeft) {\n                    return { idx: i, size: temp };\n                }\n                if (temp < scrollLeft) {\n                    temp += getColumnWidth(sheet, i, skipHidden);\n                    if (temp > scrollLeft) {\n                        return { idx: i, size: temp - getColumnWidth(sheet, i, skipHidden) };\n                    }\n                    else {\n                        return { idx: i + 1, size: temp };\n                    }\n                }\n                i--;\n            }\n        }\n        return { idx: this.offset.left.idx, size: this.offset.left.size };\n    };\n    Scroll.prototype.contentLoaded = function () {\n        this.onScroll = this.onContentScroll.bind(this);\n        this.setScrollEvent();\n        if (this.parent.enableRtl) {\n            this.initScrollValue = this.parent.getMainContent().scrollLeft;\n        }\n    };\n    Scroll.prototype.setScrollEvent = function (args) {\n        if (args === void 0) { args = { set: true }; }\n        args.set ? EventHandler.add(this.parent.getMainContent(), 'scroll', this.onScroll, this) :\n            EventHandler.remove(this.parent.getMainContent(), 'scroll', this.onScroll);\n    };\n    Scroll.prototype.initProps = function () {\n        this.topIndex = 0;\n        this.leftIndex = 0;\n        this.prevScroll = { scrollLeft: 0, scrollTop: 0 };\n        this.offset = { left: { idx: 0, size: 0 }, top: { idx: 0, size: 0 } };\n    };\n    Scroll.prototype.getThreshold = function () {\n        /* Some browsers places the scroller outside the content,\n         * hence the padding should be adjusted.*/\n        if (Browser.info.name === 'mozilla') {\n            return 0.5;\n        }\n        return 1;\n    };\n    /**\n     * @hidden\n     */\n    Scroll.prototype.setPadding = function () {\n        if (!this.parent.allowScrolling) {\n            return;\n        }\n        var colHeader = this.parent.getColumnHeaderContent();\n        var rowHeader = this.parent.getRowHeaderContent();\n        var scrollWidth = getScrollBarWidth() - this.getThreshold();\n        var cssProps = this.parent.enableRtl ? { padding: 'paddingLeft', border: 'borderLeftWidth' }\n            : { padding: 'paddingRight', border: 'borderRightWidth' };\n        if (scrollWidth > 0) {\n            colHeader.parentElement.style[cssProps.padding] = scrollWidth + 'px';\n            colHeader.style[cssProps.border] = '1px';\n            rowHeader.style.marginBottom = scrollWidth + 'px';\n        }\n    };\n    Scroll.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.contentLoaded, this);\n        this.parent.on(onContentScroll, this.onContentScroll, this);\n        this.parent.on(deInitProperties, this.initProps, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n        this.parent.on(setScrollEvent, this.setScrollEvent, this);\n    };\n    Scroll.prototype.destroy = function () {\n        EventHandler.remove(this.parent.getMainContent(), 'scroll', this.onScroll);\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Scroll.prototype.removeEventListener = function () {\n        this.parent.off(contentLoaded, this.contentLoaded);\n        this.parent.off(onContentScroll, this.onContentScroll);\n        this.parent.off(deInitProperties, this.initProps);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n        this.parent.off(setScrollEvent, this.setScrollEvent);\n    };\n    return Scroll;\n}());\nexport { Scroll };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { spreadsheetDestroyed, beforeContentLoaded, beforeVirtualContentLoaded, virtualContentLoaded } from '../common/index';\nimport { colWidthChanged, updateTableWidth, focus } from '../common/index';\nimport { onVerticalScroll, onHorizontalScroll, rowHeightChanged, beforeHeaderLoaded, deInitProperties } from '../common/index';\nimport { getRowHeight, getRowsHeight, getColumnWidth, getColumnsWidth } from './../../workbook/index';\nimport { getRangeAddress } from '../../workbook/common/index';\nimport { updateUsedRange, sheetCreated, sheetsDestroyed } from '../../workbook/common/event';\n/**\n * VirtualScroll module\n * @hidden\n */\nvar VirtualScroll = /** @class */ (function () {\n    function VirtualScroll(parent) {\n        this.scroll = [];\n        this.parent = parent;\n        this.addEventListener();\n    }\n    VirtualScroll.prototype.createVirtualElement = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var container = this.parent.getMainContent();\n        this.content = this.parent.createElement('div', { className: 'e-virtualable' });\n        this.content.appendChild(container.querySelector('.e-table'));\n        container.appendChild(this.content);\n        var vTrack = container.appendChild(this.parent.createElement('div', { className: 'e-virtualtrack' }));\n        var colVTrack;\n        var rowVTrack;\n        var height;\n        var width;\n        if (this.parent.sheets.length > this.scroll.length) {\n            this.initScroll();\n        }\n        var domCount = this.parent.viewport.rowCount + 1 + (this.parent.getThreshold('row') * 2);\n        if (sheet.rowCount > domCount || sheet.usedRange.rowIndex > domCount - 1) {\n            if (!this.parent.scrollSettings.isFinite && sheet.rowCount <= sheet.usedRange.rowIndex) {\n                this.parent.setSheetPropertyOnMute(sheet, 'rowCount', sheet.usedRange.rowIndex + 1);\n            }\n            this.setScrollCount(sheet.rowCount, 'row');\n            height = getRowsHeight(sheet, 0, this.scroll[this.parent.activeSheetIndex].rowCount - 1);\n        }\n        else {\n            if (!this.parent.scrollSettings.isFinite) {\n                this.parent.setSheetPropertyOnMute(sheet, 'rowCount', domCount);\n            }\n            this.scroll[this.parent.activeSheetIndex].rowCount = sheet.rowCount;\n            height = 1;\n        }\n        domCount = this.parent.viewport.colCount + 1 + (this.parent.getThreshold('col') * 2);\n        var size;\n        if (sheet.colCount > domCount || sheet.usedRange.colIndex > domCount - 1) {\n            if (!this.parent.scrollSettings.isFinite && sheet.colCount <= sheet.usedRange.colIndex) {\n                this.parent.setSheetPropertyOnMute(sheet, 'colCount', sheet.usedRange.colIndex + 1);\n            }\n            size = getColumnsWidth(sheet, 0, domCount - 1);\n            this.setScrollCount(sheet.colCount, 'col');\n            width = size + getColumnsWidth(sheet, domCount, this.scroll[this.parent.activeSheetIndex].colCount - 1);\n        }\n        else {\n            if (!this.parent.scrollSettings.isFinite) {\n                this.parent.setSheetPropertyOnMute(sheet, 'colCount', domCount);\n            }\n            size = getColumnsWidth(sheet, 0, sheet.colCount - 1);\n            this.scroll[this.parent.activeSheetIndex].colCount = sheet.colCount;\n            width = size;\n        }\n        if (args.startColIdx) {\n            size = getColumnsWidth(sheet, args.startColIdx, args.startColIdx + domCount - 1);\n        }\n        if (isNullOrUndefined(this.parent.viewport.leftIndex)) {\n            this.parent.viewport.leftIndex = 0;\n        }\n        if (isNullOrUndefined(this.parent.viewport.topIndex)) {\n            this.parent.viewport.topIndex = 0;\n        }\n        if (isNullOrUndefined(this.translateX)) {\n            this.translateX = 0;\n        }\n        if (isNullOrUndefined(this.translateY)) {\n            this.translateY = 0;\n        }\n        if (sheet.showHeaders) {\n            container = this.parent.getRowHeaderContent();\n            this.rowHeader = this.content.cloneNode();\n            this.rowHeader.appendChild(container.querySelector('.e-table'));\n            container.appendChild(this.rowHeader);\n            rowVTrack = container.appendChild(vTrack.cloneNode());\n            this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n            container = this.parent.getColumnHeaderContent();\n            this.colHeader = this.content.cloneNode();\n            this.colHeader.appendChild(container.querySelector('.e-table'));\n            container.appendChild(this.colHeader);\n            colVTrack = container.appendChild(vTrack.cloneNode());\n            this.colHeader.style.width = size + \"px\";\n            rowVTrack.style.height = height + \"px\";\n            colVTrack.style.width = width + \"px\";\n            this.colHeader.style.transform = \"translate(\" + this.translateX + \"px, 0px)\";\n        }\n        this.content.style.transform = \"translate(\" + this.translateX + \"px, \" + this.translateY + \"px)\";\n        this.content.style.width = size + \"px\";\n        vTrack.style.height = height + \"px\";\n        vTrack.style.width = width + \"px\";\n    };\n    VirtualScroll.prototype.initScroll = function () {\n        var i = 0;\n        while (i < this.parent.sheets.length) {\n            if (!this.scroll[i]) {\n                this.scroll.push({ rowCount: 0, colCount: 0 });\n            }\n            i++;\n        }\n    };\n    VirtualScroll.prototype.setScrollCount = function (count, layout) {\n        var activeSheetIdx = this.parent.activeSheetIndex;\n        if (!this.scroll[activeSheetIdx][layout + 'Count']) {\n            this.scroll[activeSheetIdx][layout + 'Count'] = count;\n        }\n    };\n    VirtualScroll.prototype.getRowAddress = function (indexes) {\n        return getRangeAddress([indexes[0], this.parent.viewport.leftIndex, indexes[1], this.parent.viewport.rightIndex]);\n    };\n    VirtualScroll.prototype.getColAddress = function (indexes) {\n        return getRangeAddress([this.parent.viewport.topIndex, indexes[0], this.parent.viewport.bottomIndex, indexes[1]]);\n    };\n    VirtualScroll.prototype.updateScrollCount = function (idx, layout, threshold) {\n        if (threshold === void 0) { threshold = idx; }\n        var sheet = this.parent.getActiveSheet();\n        var rowCount = idx + this.parent.viewport[layout + 'Count'] + 1 + threshold;\n        var usedRangeCount = this.scroll[this.parent.activeSheetIndex][layout + 'Count'];\n        if (rowCount < usedRangeCount) {\n            if (sheet[layout + 'Count'] === usedRangeCount) {\n                return;\n            }\n            rowCount = usedRangeCount;\n        }\n        if (!this.parent.scrollSettings.isFinite) {\n            this.parent.setSheetPropertyOnMute(sheet, layout + 'Count', rowCount);\n        }\n    };\n    VirtualScroll.prototype.onVerticalScroll = function (args) {\n        var idx = args.cur.idx;\n        var height = args.cur.size;\n        var prevIdx = args.prev.idx;\n        var idxDiff = Math.abs(idx - prevIdx);\n        var threshold = this.parent.getThreshold('row');\n        if (idxDiff > Math.round(threshold / 2)) {\n            var startIdx = void 0;\n            var lastIdx = void 0;\n            var prevTopIdx = void 0;\n            if (idx <= threshold) {\n                if (!args.increase) {\n                    if (this.translateY && prevIdx > threshold) {\n                        this.translateY = 0;\n                        this.parent.viewport.topIndex = prevIdx - threshold;\n                        if (!args.preventScroll) {\n                            if (idxDiff < this.parent.viewport.rowCount + threshold) {\n                                lastIdx = this.parent.viewport.topIndex - 1;\n                                startIdx = this.parent.skipHidden(0, lastIdx)[0];\n                                this.parent.viewport.topIndex = startIdx;\n                                var hiddenCount = this.hiddenCount(startIdx, lastIdx);\n                                var skippedHiddenIdx = this.skipHiddenIdx((this.parent.viewport.bottomIndex - ((lastIdx - startIdx + 1) - hiddenCount)), args.increase);\n                                this.parent.viewport.bottomIndex -= (((lastIdx - startIdx + 1) - hiddenCount) +\n                                    (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.bottomIndex)));\n                                this.parent.renderModule.refreshUI({\n                                    colIndex: this.parent.viewport.leftIndex, rowIndex: startIdx, direction: 'last', refresh: 'RowPart',\n                                    skipUpdateOnFirst: true\n                                }, this.getRowAddress([0, this.skipHiddenIdx(lastIdx, false)]));\n                            }\n                            else {\n                                this.parent.renderModule.refreshUI({ rowIndex: 0, colIndex: this.parent.viewport.leftIndex, refresh: 'Row', skipUpdateOnFirst: true });\n                            }\n                            focus(this.parent.element);\n                        }\n                    }\n                    this.updateScrollCount(threshold, 'row');\n                }\n            }\n            if (prevIdx < threshold) {\n                idxDiff = Math.abs(idx - threshold);\n            }\n            if (idx > threshold) {\n                prevTopIdx = this.parent.viewport.topIndex;\n                this.parent.viewport.topIndex = idx - threshold;\n                if (args.increase && prevTopIdx > this.parent.viewport.topIndex) {\n                    this.parent.viewport.topIndex = prevTopIdx;\n                    return;\n                }\n                this.translateY = height - this.getThresholdHeight(this.parent.viewport.topIndex, threshold);\n                if (!args.preventScroll) {\n                    if (idxDiff < this.parent.viewport.rowCount + threshold) {\n                        if (args.increase) {\n                            startIdx = this.parent.viewport.bottomIndex + 1;\n                            lastIdx = this.parent.viewport.bottomIndex + (this.parent.viewport.topIndex - prevTopIdx);\n                            lastIdx -= this.hiddenCount(prevTopIdx, this.parent.viewport.topIndex - 1);\n                            this.parent.viewport.topIndex = this.skipHiddenIdx(this.parent.viewport.topIndex, args.increase);\n                            if (lastIdx <= this.parent.viewport.bottomIndex) {\n                                return;\n                            }\n                            var indexes = this.parent.skipHidden(startIdx, lastIdx);\n                            startIdx = indexes[0];\n                            lastIdx = this.checkLastIdx(indexes[1], 'row');\n                            this.parent.viewport.bottomIndex = lastIdx;\n                            this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, rowIndex: startIdx, direction: 'first', refresh: 'RowPart' }, this.getRowAddress([startIdx, lastIdx]));\n                        }\n                        else {\n                            startIdx = this.parent.viewport.topIndex;\n                            lastIdx = startIdx + idxDiff - 1;\n                            var hiddenCount = this.hiddenCount(startIdx, lastIdx);\n                            var skippedHiddenIdx = this.skipHiddenIdx((this.parent.viewport.bottomIndex - ((lastIdx - startIdx) - hiddenCount)), args.increase);\n                            this.parent.viewport.bottomIndex -= ((idxDiff - hiddenCount) +\n                                (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.bottomIndex)));\n                            startIdx = this.parent.skipHidden(startIdx, lastIdx)[0];\n                            this.parent.viewport.topIndex = startIdx;\n                            this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, rowIndex: startIdx, direction: 'last', refresh: 'RowPart' }, this.getRowAddress([startIdx, lastIdx]));\n                        }\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({\n                            rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Row'\n                        });\n                    }\n                    this.updateScrollCount(idx, 'row', threshold);\n                    focus(this.parent.element);\n                }\n            }\n            args.prev.idx = idx;\n        }\n    };\n    VirtualScroll.prototype.skipHiddenIdx = function (index, increase, layout, sheet) {\n        if (layout === void 0) { layout = 'rows'; }\n        if (sheet === void 0) { sheet = this.parent.getActiveSheet(); }\n        if ((sheet[layout])[index] && (sheet[layout])[index].hidden) {\n            increase ? index++ : index--;\n            index = this.skipHiddenIdx(index, increase, layout, sheet);\n        }\n        return index;\n    };\n    VirtualScroll.prototype.hiddenCount = function (startIdx, endIdx, layout) {\n        if (layout === void 0) { layout = 'rows'; }\n        var index = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = startIdx; i <= endIdx; i++) {\n            if ((sheet[layout])[i] && (sheet[layout])[i].hidden) {\n                index++;\n            }\n        }\n        return index;\n    };\n    VirtualScroll.prototype.checkLastIdx = function (idx, layout) {\n        if (this.parent.scrollSettings.isFinite) {\n            var count = this.parent.getActiveSheet()[layout + 'Count'] - 1;\n            if (idx > count) {\n                idx = count;\n            }\n        }\n        return idx;\n    };\n    VirtualScroll.prototype.onHorizontalScroll = function (args) {\n        var idx = args.cur.idx;\n        var width = args.cur.size;\n        var prevIdx = args.prev.idx;\n        var idxDiff = Math.abs(idx - prevIdx);\n        var threshold = this.parent.getThreshold('col');\n        if (idxDiff > Math.round(threshold / 2)) {\n            var startIdx = void 0;\n            var endIdx = void 0;\n            var prevLeftIdx = void 0;\n            if (idx <= threshold) {\n                if (!args.increase) {\n                    if (this.translateX && prevIdx > threshold) {\n                        this.translateX = 0;\n                        this.parent.viewport.leftIndex = prevIdx - threshold;\n                        if (!args.preventScroll) {\n                            if (idxDiff < this.parent.viewport.colCount + threshold) {\n                                endIdx = this.parent.viewport.leftIndex - 1;\n                                startIdx = this.parent.skipHidden(0, endIdx, 'columns')[0];\n                                this.parent.viewport.leftIndex = startIdx;\n                                var hiddenCount = this.hiddenCount(startIdx, endIdx, 'columns');\n                                var skippedHiddenIdx = this.skipHiddenIdx((this.parent.viewport.rightIndex - ((endIdx - startIdx + 1) - hiddenCount)), args.increase, 'columns');\n                                this.parent.viewport.rightIndex -= (((endIdx - startIdx + 1) - hiddenCount) +\n                                    (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.rightIndex, 'columns')));\n                                this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: startIdx, direction: 'last', refresh: 'ColumnPart',\n                                    skipUpdateOnFirst: true }, this.getColAddress([0, this.skipHiddenIdx(endIdx, false, 'columns')]));\n                            }\n                            else {\n                                this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: 0, refresh: 'Column', skipUpdateOnFirst: true });\n                            }\n                            focus(this.parent.element);\n                        }\n                    }\n                    this.updateScrollCount(threshold, 'col');\n                }\n            }\n            if (prevIdx < threshold) {\n                idxDiff = Math.abs(idx - threshold);\n            }\n            if (idx > threshold) {\n                prevLeftIdx = this.parent.viewport.leftIndex;\n                this.parent.viewport.leftIndex = idx - threshold;\n                if (args.increase && prevLeftIdx > this.parent.viewport.leftIndex) {\n                    this.parent.viewport.leftIndex = prevLeftIdx;\n                    return;\n                }\n                this.translateX = width - this.getThresholdWidth(this.parent.viewport.leftIndex, threshold);\n                if (!args.preventScroll) {\n                    if (idxDiff < this.parent.viewport.colCount + threshold) {\n                        if (args.increase) {\n                            startIdx = this.parent.viewport.rightIndex + 1;\n                            endIdx = this.parent.viewport.rightIndex + (this.parent.viewport.leftIndex - prevLeftIdx);\n                            endIdx -= this.hiddenCount(prevLeftIdx, this.parent.viewport.leftIndex - 1, 'columns');\n                            this.parent.viewport.leftIndex = this.skipHiddenIdx(this.parent.viewport.leftIndex, args.increase, 'columns');\n                            if (endIdx <= this.parent.viewport.rightIndex) {\n                                return;\n                            }\n                            var indexes = this.parent.skipHidden(startIdx, endIdx, 'columns');\n                            startIdx = indexes[0];\n                            endIdx = this.checkLastIdx(indexes[1], 'col');\n                            this.parent.viewport.rightIndex = endIdx;\n                            this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: startIdx, direction: 'first', refresh: 'ColumnPart' }, this.getColAddress([startIdx, endIdx]));\n                        }\n                        else {\n                            startIdx = this.parent.viewport.leftIndex;\n                            endIdx = startIdx + idxDiff - 1;\n                            var hiddenCount = this.hiddenCount(startIdx, endIdx, 'columns');\n                            var skippedHiddenIdx = this.skipHiddenIdx((this.parent.viewport.rightIndex - ((endIdx - startIdx) - hiddenCount)), args.increase, 'columns');\n                            this.parent.viewport.rightIndex -= ((idxDiff - hiddenCount) +\n                                (this.hiddenCount(skippedHiddenIdx, this.parent.viewport.rightIndex, 'columns')));\n                            startIdx = this.parent.skipHidden(startIdx, endIdx, 'columns')[0];\n                            this.parent.viewport.leftIndex = startIdx;\n                            this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: startIdx, direction: 'last', refresh: 'ColumnPart' }, this.getColAddress([startIdx, endIdx]));\n                        }\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({\n                            rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Column'\n                        });\n                    }\n                    this.updateScrollCount(idx, 'col', threshold);\n                    focus(this.parent.element);\n                }\n            }\n            args.prev.idx = idx;\n        }\n    };\n    VirtualScroll.prototype.getThresholdHeight = function (idx, threshold) {\n        var height = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = idx; i < idx + threshold; i++) {\n            height += getRowHeight(sheet, i);\n        }\n        return height;\n    };\n    VirtualScroll.prototype.getThresholdWidth = function (idx, threshold) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = idx; i < idx + threshold; i++) {\n            width += getColumnWidth(sheet, i);\n        }\n        return width;\n    };\n    VirtualScroll.prototype.translate = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        if (args.refresh === 'Row' || args.refresh === 'RowPart') {\n            this.content.style.transform = \"translate(\" + this.translateX + \"px, \" + this.translateY + \"px)\";\n            if (sheet.showHeaders) {\n                this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n            }\n        }\n        if (args.refresh === 'Column' || args.refresh === 'ColumnPart') {\n            var translateX = this.parent.enableRtl ? -this.translateX : this.translateX;\n            this.content.style.transform = \"translate(\" + translateX + \"px, \" + this.translateY + \"px)\";\n            if (sheet.showHeaders) {\n                this.colHeader.style.transform = \"translate(\" + translateX + \"px, 0px)\";\n            }\n        }\n    };\n    VirtualScroll.prototype.updateColumnWidth = function (args) {\n        if (args.refresh === 'Column') {\n            this.content.style.width = '';\n            var width = getColumnsWidth(this.parent.getActiveSheet(), this.parent.viewport.leftIndex, this.parent.viewport.rightIndex);\n            if (this.parent.getActiveSheet().showHeaders) {\n                this.colHeader.style.width = width + 'px';\n            }\n            this.content.style.width = width + 'px';\n        }\n    };\n    VirtualScroll.prototype.updateUsedRange = function (args) {\n        if (!this.scroll.length) {\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        if (args.update === 'row') {\n            if (args.index !== this.scroll[this.parent.activeSheetIndex].rowCount - 1) {\n                var height = this.getVTrackHeight('height');\n                if (args.index >= this.scroll[this.parent.activeSheetIndex].rowCount) {\n                    height += getRowsHeight(sheet, this.scroll[this.parent.activeSheetIndex].rowCount, args.index);\n                }\n                else {\n                    height -= getRowsHeight(sheet, args.index + 1, this.scroll[this.parent.activeSheetIndex].rowCount - 1);\n                }\n                this.scroll[this.parent.activeSheetIndex].rowCount = args.index + 1;\n                this.updateVTrack(this.rowHeader, height, 'height');\n                if (this.scroll[this.parent.activeSheetIndex].rowCount > sheet.rowCount) {\n                    this.parent.setSheetPropertyOnMute(sheet, 'rowCount', this.scroll[this.parent.activeSheetIndex].rowCount);\n                }\n            }\n        }\n        else {\n            if (args.index > this.scroll[this.parent.activeSheetIndex].colCount) {\n                var width = this.getVTrackHeight('width');\n                width += getColumnsWidth(sheet, this.scroll[this.parent.activeSheetIndex].colCount, args.index);\n                this.scroll[this.parent.activeSheetIndex].colCount = args.index + 1;\n                this.updateVTrack(this.colHeader, width, 'width');\n                if (this.scroll[this.parent.activeSheetIndex].colCount > sheet.colCount) {\n                    this.parent.setSheetPropertyOnMute(sheet, 'colCount', this.scroll[this.parent.activeSheetIndex].colCount);\n                }\n            }\n        }\n    };\n    VirtualScroll.prototype.createHeaderElement = function (args) {\n        this.rowHeader = this.content.cloneNode();\n        this.colHeader = this.rowHeader.cloneNode();\n        this.rowHeader.style.width = '';\n        this.rowHeader.style.transform = \"translate(0px, \" + this.translateY + \"px)\";\n        this.colHeader.style.transform = \"translate(\" + (this.parent.enableRtl ? -this.translateX : this.translateX) + \"px, 0px)\";\n        this.rowHeader.appendChild(args.element.querySelector('table'));\n        args.element.appendChild(this.rowHeader);\n        var container = this.parent.getColumnHeaderContent();\n        this.colHeader.appendChild(container.querySelector('table'));\n        container.appendChild(this.colHeader);\n        var rowVTrack = this.content.nextElementSibling.cloneNode();\n        var colVTrack = rowVTrack.cloneNode();\n        rowVTrack.style.width = '';\n        colVTrack.style.height = '';\n        args.element.appendChild(rowVTrack);\n        container.appendChild(colVTrack);\n    };\n    VirtualScroll.prototype.getVTrackHeight = function (str) {\n        var height = this.content.nextElementSibling.style[str];\n        if (height.includes('e+')) {\n            height = height.split('px')[0];\n            var heightArr = height.split('e+');\n            return Number(heightArr[0]) * Math.pow(10, Number(heightArr[1]));\n        }\n        else {\n            return parseInt(height, 10);\n        }\n    };\n    VirtualScroll.prototype.updateVTrackHeight = function (args) {\n        var domCount = this.parent.viewport.rowCount + 1 + (this.parent.getThreshold('row') * 2);\n        if (args.rowIdx >= domCount && args.rowIdx < this.scroll[this.parent.activeSheetIndex].rowCount) {\n            this.updateVTrack(this.rowHeader, this.getVTrackHeight('height') + args.threshold, 'height');\n        }\n    };\n    VirtualScroll.prototype.updateVTrackWidth = function (args) {\n        if (args.colIdx >= this.parent.viewport.leftIndex && args.colIdx <= this.parent.viewport.rightIndex) {\n            if (this.parent.getActiveSheet().showHeaders) {\n                var hdrVTrack = this.parent.getColumnHeaderContent().getElementsByClassName('e-virtualtrack')[0];\n                hdrVTrack.style.width = parseInt(hdrVTrack.style.width, 10) + args.threshold + 'px';\n            }\n            var cntVTrack = this.parent.getMainContent().getElementsByClassName('e-virtualtrack')[0];\n            cntVTrack.style.width = parseInt(cntVTrack.style.width, 10) + args.threshold + 'px';\n            if (this.parent.getActiveSheet().showHeaders) {\n                var hdrColumn = this.parent.getColumnHeaderContent().getElementsByClassName('e-virtualable')[0];\n                hdrColumn.style.width = parseInt(hdrColumn.style.width, 10) + args.threshold + 'px';\n            }\n            var cntColumn = this.parent.getMainContent().getElementsByClassName('e-virtualable')[0];\n            cntColumn.style.width = parseInt(cntColumn.style.width, 10) + args.threshold + 'px';\n        }\n    };\n    VirtualScroll.prototype.updateVTrack = function (header, size, sizeStr) {\n        if (this.parent.getActiveSheet().showHeaders) {\n            header.nextElementSibling.style[sizeStr] = size + \"px\";\n        }\n        this.content.nextElementSibling.style[sizeStr] = size + \"px\";\n    };\n    VirtualScroll.prototype.deInitProps = function () {\n        this.parent.viewport.leftIndex = null;\n        this.parent.viewport.topIndex = null;\n        this.parent.viewport.bottomIndex = null;\n        this.translateX = null;\n        this.translateY = null;\n    };\n    VirtualScroll.prototype.updateScrollProps = function (args) {\n        var _this = this;\n        if (args === void 0) { args = { sheetIndex: 0, sheets: this.parent.sheets }; }\n        if (this.scroll.length === 0) {\n            this.initScroll();\n        }\n        else {\n            args.sheets.forEach(function () { _this.scroll.splice(args.sheetIndex, 0, { rowCount: 0, colCount: 0 }); });\n        }\n    };\n    VirtualScroll.prototype.sliceScrollProps = function (args) {\n        if (isNullOrUndefined(args.sheetIndex)) {\n            this.scroll.length = 0;\n        }\n        else {\n            this.scroll.splice(args.sheetIndex, 1);\n        }\n    };\n    VirtualScroll.prototype.addEventListener = function () {\n        this.parent.on(beforeContentLoaded, this.createVirtualElement, this);\n        this.parent.on(beforeVirtualContentLoaded, this.translate, this);\n        this.parent.on(virtualContentLoaded, this.updateColumnWidth, this);\n        this.parent.on(updateTableWidth, this.updateColumnWidth, this);\n        this.parent.on(onVerticalScroll, this.onVerticalScroll, this);\n        this.parent.on(onHorizontalScroll, this.onHorizontalScroll, this);\n        this.parent.on(updateUsedRange, this.updateUsedRange, this);\n        this.parent.on(rowHeightChanged, this.updateVTrackHeight, this);\n        this.parent.on(colWidthChanged, this.updateVTrackWidth, this);\n        this.parent.on(beforeHeaderLoaded, this.createHeaderElement, this);\n        this.parent.on(deInitProperties, this.deInitProps, this);\n        this.parent.on(sheetsDestroyed, this.sliceScrollProps, this);\n        this.parent.on(sheetCreated, this.updateScrollProps, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    VirtualScroll.prototype.destroy = function () {\n        this.removeEventListener();\n        this.rowHeader = null;\n        this.colHeader = null;\n        this.content = null;\n        this.parent = null;\n        this.scroll.length = 0;\n        this.translateX = null;\n        this.translateY = null;\n    };\n    VirtualScroll.prototype.removeEventListener = function () {\n        this.parent.off(beforeContentLoaded, this.createVirtualElement);\n        this.parent.off(beforeVirtualContentLoaded, this.translate);\n        this.parent.off(virtualContentLoaded, this.updateColumnWidth);\n        this.parent.off(updateTableWidth, this.updateColumnWidth);\n        this.parent.off(onVerticalScroll, this.onVerticalScroll);\n        this.parent.off(onHorizontalScroll, this.onHorizontalScroll);\n        this.parent.off(updateUsedRange, this.updateUsedRange);\n        this.parent.off(rowHeightChanged, this.updateVTrackHeight);\n        this.parent.off(colWidthChanged, this.updateVTrackWidth);\n        this.parent.off(beforeHeaderLoaded, this.createHeaderElement);\n        this.parent.off(sheetsDestroyed, this.sliceScrollProps);\n        this.parent.off(sheetCreated, this.updateScrollProps);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return VirtualScroll;\n}());\nexport { VirtualScroll };\n","import { keyDown, cellNavigate, renameSheet, filterCellKeyDown } from '../common/index';\nimport { getCellIndexes, getRangeAddress, getRowHeight, getColumnWidth, getCell } from '../../workbook/index';\nimport { closest } from '@syncfusion/ej2-base';\n/**\n * Represents keyboard navigation support for Spreadsheet.\n */\nvar KeyboardNavigation = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Keyboard Navigation module.\n     * @private\n     */\n    function KeyboardNavigation(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        /* code snippet */\n    }\n    KeyboardNavigation.prototype.addEventListener = function () {\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        /* code snippet */\n    };\n    KeyboardNavigation.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(keyDown, this.keyDownHandler);\n        }\n        /* code snippet */\n    };\n    KeyboardNavigation.prototype.keyDownHandler = function (e) {\n        if (!this.parent.isEdit && (document.activeElement.classList.contains('e-spreadsheet') ||\n            closest(document.activeElement, '.e-sheet'))) {\n            var isNavigate = void 0;\n            var scrollIdxes = void 0;\n            var isRtl = this.parent.enableRtl;\n            var sheet = this.parent.getActiveSheet();\n            var filterArgs = { e: e, isFilterCell: false };\n            var actIdxes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n            if ([9, 37, 38, 39, 40].indexOf(e.keyCode) > -1) {\n                e.preventDefault();\n            }\n            if (!e.shiftKey && e.altKey && (e.keyCode === 38 || e.keyCode === 40)) {\n                this.parent.notify(filterCellKeyDown, filterArgs);\n            }\n            if ((!e.shiftKey && ((!isRtl && e.keyCode === 37) || (isRtl && e.keyCode === 39)))\n                || (e.shiftKey && e.keyCode === 9)) { //left key\n                if (actIdxes[1] > 0) {\n                    actIdxes[1] -= 1;\n                    isNavigate = true;\n                }\n                else {\n                    var content = this.parent.getMainContent();\n                    if (actIdxes[1] === 0 && content.scrollLeft && !isRtl) {\n                        content.scrollLeft = 0;\n                    }\n                }\n            }\n            else if ((!filterArgs.isFilterCell && !e.shiftKey && e.keyCode === 38) || (e.shiftKey && e.keyCode === 13)) { // Up key\n                if (actIdxes[0] > 0) {\n                    actIdxes[0] -= 1;\n                    isNavigate = true;\n                }\n                else {\n                    var content = this.parent.getMainContent();\n                    if (actIdxes[0] === 0 && content.scrollTop) {\n                        content.scrollTop = 0;\n                    }\n                }\n            }\n            else if ((!e.shiftKey && ((!isRtl && e.keyCode === 39) || (isRtl && e.keyCode === 37))) || e.keyCode === 9) { // Right key\n                var cell = getCell(actIdxes[0], actIdxes[1], sheet);\n                if (cell && cell.colSpan > 1) {\n                    actIdxes[1] += (cell.colSpan - 1);\n                }\n                if (actIdxes[1] < sheet.colCount - 1) {\n                    actIdxes[1] += 1;\n                    isNavigate = true;\n                }\n            }\n            else if ((!filterArgs.isFilterCell && !e.shiftKey && e.keyCode === 40) || e.keyCode === 13) { // Down Key\n                var cell = getCell(actIdxes[0], actIdxes[1], sheet);\n                if (cell && cell.rowSpan > 1) {\n                    actIdxes[0] += (cell.rowSpan - 1);\n                }\n                if (actIdxes[0] < sheet.rowCount - 1) {\n                    actIdxes[0] += 1;\n                    isNavigate = true;\n                }\n            }\n            /* else if (e.keyCode === 36) {\n                actIdxes[1] = 0;\n                if (e.ctrlKey) {\n                    actIdxes[0] = 0;\n                }\n                isNavigate = true;\n                e.preventDefault();\n            } else if (e.keyCode === 35 && e.ctrlKey) {\n                actIdxes = [sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n                scrollIdxes = [sheet.usedRange.rowIndex - this.parent.viewport.rowCount,\n                    sheet.usedRange.colIndex - this.parent.viewport.colCount];\n                isNavigate = true;\n                e.preventDefault();\n            } */\n            if (isNavigate) {\n                this.scrollNavigation(scrollIdxes || actIdxes, scrollIdxes ? true : false);\n                this.parent.setSheetPropertyOnMute(sheet, 'activeCell', getRangeAddress(actIdxes));\n                this.parent.notify(cellNavigate, { range: actIdxes });\n            }\n        }\n        var target = e.target;\n        if (target.classList.contains('e-sheet-rename')) {\n            if (e.keyCode === 32) {\n                e.stopPropagation();\n            }\n            else if (e.keyCode === 13 || e.keyCode === 27) {\n                this.parent.notify(renameSheet, e);\n            }\n        }\n    };\n    KeyboardNavigation.prototype.scrollNavigation = function (actIdxes, isScroll) {\n        var x = this.parent.enableRtl ? -1 : 1;\n        var cont = this.parent.getMainContent();\n        var sheet = this.parent.getActiveSheet();\n        var prevActIdxes = getCellIndexes(sheet.activeCell);\n        var topLeftIdxes = getCellIndexes(sheet.topLeftCell);\n        if (this.getBottomIdx(topLeftIdxes) <= actIdxes[0] || isScroll) {\n            cont.scrollTop += getRowHeight(sheet, actIdxes[0]);\n        }\n        else if (topLeftIdxes[0] > actIdxes[0]) {\n            cont.scrollTop -= getRowHeight(sheet, actIdxes[0]);\n        }\n        if (this.getRightIdx(topLeftIdxes) <= actIdxes[1] || isScroll) {\n            cont.scrollLeft += getColumnWidth(sheet, actIdxes[1]) * x;\n        }\n        else if (topLeftIdxes[1] > actIdxes[1]) {\n            cont.scrollLeft -= getColumnWidth(sheet, actIdxes[1]) * x;\n        }\n    };\n    KeyboardNavigation.prototype.getBottomIdx = function (topLeftIdxes) {\n        var hgt = 0;\n        var sheet = this.parent.getActiveSheet();\n        for (var i = topLeftIdxes[0];; i++) {\n            hgt += getRowHeight(sheet, i);\n            if (hgt >= this.parent.viewport.height - 17) {\n                return i;\n            }\n        }\n    };\n    KeyboardNavigation.prototype.getRightIdx = function (topLeftIdxes) {\n        var width = 0;\n        var sheet = this.parent.getActiveSheet();\n        var contWidth = this.parent.getMainContent().offsetWidth;\n        for (var i = topLeftIdxes[1];; i++) {\n            width += getColumnWidth(sheet, i);\n            if (width >= contWidth - 17) {\n                return i;\n            }\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    KeyboardNavigation.prototype.getModuleName = function () {\n        return 'keyboardNavigation';\n    };\n    KeyboardNavigation.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return KeyboardNavigation;\n}());\nexport { KeyboardNavigation };\n","import { keyDown, cut, paste, copy, clearCopy, performUndoRedo, initiateHyperlink, editHyperlink } from '../common/index';\nimport { findDlg, gotoDlg } from '../common/index';\nimport { setCellFormat, textDecorationUpdate, getCellIndexes } from '../../workbook/common/index';\nimport { getColumn, isLocked as isCellLocked } from '../../workbook/index';\nimport { setCell, getCell } from '../../workbook/base/cell';\nimport { isNullOrUndefined, closest, select } from '@syncfusion/ej2-base';\n/**\n * Represents keyboard shortcut support for Spreadsheet.\n */\nvar KeyboardShortcut = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Keyboard Shortcut module.\n     * @private\n     */\n    function KeyboardShortcut(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    KeyboardShortcut.prototype.addEventListener = function () {\n        this.parent.on(keyDown, this.keyDownHandler, this);\n    };\n    KeyboardShortcut.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(keyDown, this.keyDownHandler);\n        }\n    };\n    KeyboardShortcut.prototype.keyDownHandler = function (e) {\n        if (e.ctrlKey || e.metaKey) {\n            if (!closest(e.target, '.e-find-dlg')) {\n                if ([79, 83, 65].indexOf(e.keyCode) > -1) {\n                    e.preventDefault();\n                }\n            }\n            if (e.keyCode === 79) {\n                select('#' + this.parent.element.id + '_fileUpload', this.parent.element).click();\n            }\n            else if (e.keyCode === 83) {\n                if (this.parent.saveUrl && this.parent.allowSave) {\n                    this.parent.save();\n                }\n            }\n            else if (e.keyCode === 67) {\n                this.parent.notify(copy, { promise: Promise });\n            }\n            else if (e.keyCode === 75) {\n                var sheet = this.parent.getActiveSheet();\n                var indexes = getCellIndexes(sheet.activeCell);\n                var row = this.parent.sheets[this.parent.getActiveSheet().id - 1].rows[indexes[0]];\n                var cell = void 0;\n                e.preventDefault();\n                if (!isNullOrUndefined(row)) {\n                    cell = row.cells[indexes[1]];\n                }\n                if (isNullOrUndefined(cell)) {\n                    setCell(indexes[0], indexes[1], this.parent.getActiveSheet(), cell, false);\n                }\n                if (cell && cell.hyperlink) {\n                    this.parent.notify(editHyperlink, null);\n                }\n                else {\n                    this.parent.notify(initiateHyperlink, null);\n                }\n            }\n            else if (e.keyCode === 90) { /* Ctrl + Z */\n                if (!this.parent.isEdit) {\n                    e.preventDefault();\n                    this.parent.notify(performUndoRedo, { isUndo: true });\n                }\n            }\n            else if (e.keyCode === 89) { /* Ctrl + Y */\n                if (!this.parent.isEdit) {\n                    e.preventDefault();\n                    this.parent.notify(performUndoRedo, { isUndo: false });\n                }\n            }\n            var actSheet = this.parent.sheets[this.parent.getActiveSheet().id - 1];\n            var actCell = actSheet.activeCell;\n            var actCellIndex = getCellIndexes(actCell);\n            var cellObj = getCell(actCellIndex[0], actCellIndex[1], actSheet);\n            var isLocked = actSheet.isProtected && isCellLocked(cellObj, getColumn(actSheet, actCellIndex[1]));\n            if (!isLocked || !actSheet.isProtected) {\n                if (e.keyCode === 70) {\n                    e.preventDefault();\n                    var toolBarElem = document.querySelector('.e-spreadsheet-find-ddb');\n                    if (!isNullOrUndefined(toolBarElem)) {\n                        toolBarElem.click();\n                    }\n                }\n                else if (e.keyCode === 71) {\n                    e.preventDefault();\n                    this.parent.notify(gotoDlg, null);\n                }\n                else if (e.keyCode === 72) {\n                    e.preventDefault();\n                    this.parent.notify(findDlg, null);\n                }\n                else if (e.keyCode === 88) {\n                    this.parent.notify(cut, { promise: Promise });\n                }\n                else if (e.keyCode === 86) {\n                    if (!isLocked) {\n                        this.parent.notify(paste, { isAction: true });\n                    }\n                }\n                else if (e.keyCode === 66) {\n                    e.preventDefault();\n                    var value = this.parent.getCellStyleValue(['fontWeight'], getCellIndexes(this.parent.getActiveSheet().activeCell)).fontWeight;\n                    value = value === 'bold' ? 'normal' : 'bold';\n                    this.parent.notify(setCellFormat, { style: { fontWeight: value }, onActionUpdate: true, refreshRibbon: true });\n                }\n                else if (e.keyCode === 73) {\n                    e.preventDefault();\n                    var value = this.parent.getCellStyleValue(['fontStyle'], getCellIndexes(this.parent.getActiveSheet().activeCell)).fontStyle;\n                    value = value === 'italic' ? 'normal' : 'italic';\n                    this.parent.notify(setCellFormat, { style: { fontStyle: value }, onActionUpdate: true, refreshRibbon: true });\n                }\n                else if (e.keyCode === 85) {\n                    e.preventDefault();\n                    this.parent.notify(textDecorationUpdate, { style: { textDecoration: 'underline' }, refreshRibbon: true });\n                }\n                else if (e.keyCode === 53) {\n                    e.preventDefault();\n                    this.parent.notify(textDecorationUpdate, { style: { textDecoration: 'line-through' }, refreshRibbon: true });\n                }\n                if (e.shiftKey) {\n                    if (e.keyCode === 76) { /* Ctrl + Shift + L */\n                        if (!this.parent.isEdit) {\n                            e.preventDefault();\n                            this.parent.applyFilter();\n                        }\n                    }\n                }\n            }\n        }\n        if (e.keyCode === 27) {\n            this.parent.notify(clearCopy, null);\n        }\n    };\n    KeyboardShortcut.prototype.getModuleName = function () {\n        return 'keyboardShortcut';\n    };\n    KeyboardShortcut.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return KeyboardShortcut;\n}());\nexport { KeyboardShortcut };\n","import { clearViewer, beginAction } from '../../spreadsheet/index';\nimport { rowHeightChanged, setRowEleHeight, setMaxHgt, getTextHeight, getMaxHgt, getLines, initialLoad } from '../common/index';\nimport { getBorderHeight, getExcludedColumnWidth } from '../common/index';\nimport { getRowHeight, applyCellFormat } from '../../workbook/index';\nimport { isHiddenRow, getCell, getRangeIndexes, getSheetIndex, clearCFRule } from '../../workbook/index';\nimport { wrapEvent, getRangeAddress, clear } from '../../workbook/index';\nimport { removeClass, isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * CellFormat module allows to format the cell styles.\n */\nvar CellFormat = /** @class */ (function () {\n    function CellFormat(parent) {\n        this.checkHeight = false;\n        this.parent = parent;\n        this.row = parent.createElement('tr', { className: 'e-row' });\n        this.parent.on(initialLoad, this.addEventListener, this);\n    }\n    CellFormat.prototype.applyCellFormat = function (args) {\n        var keys = Object.keys(args.style);\n        var sheet = this.parent.getActiveSheet();\n        if (args.lastCell && getMaxHgt(sheet, args.rowIdx) <= 20 && !keys.length) {\n            return;\n        }\n        var cell = args.cell || this.parent.getCell(args.rowIdx, args.colIdx);\n        if (cell) {\n            if (args.style.border !== undefined || args.style.borderTop !== undefined || args.style.borderLeft !== undefined) {\n                var curStyle_1 = {};\n                Object.keys(args.style).forEach(function (key) { curStyle_1[key] = args.style[key]; });\n                if (curStyle_1.border !== undefined) {\n                    Object.assign(cell.style, { borderRight: args.style.border, borderBottom: args.style.border });\n                    this.setLeftBorder(args.style.border, cell, args.rowIdx, args.colIdx, args.row, args.onActionUpdate, args.first);\n                    this.setTopBorder(args.style.border, cell, args.rowIdx, args.colIdx, args.pRow, args.pHRow, args.onActionUpdate, args.first, args.lastCell, args.manualUpdate);\n                    delete curStyle_1.border;\n                }\n                if (curStyle_1.borderTop !== undefined) {\n                    this.setTopBorder(args.style.borderTop, cell, args.rowIdx, args.colIdx, args.pRow, args.pHRow, args.onActionUpdate, args.first, args.lastCell, args.manualUpdate);\n                    delete curStyle_1.borderTop;\n                }\n                if (curStyle_1.borderLeft !== undefined) {\n                    this.setLeftBorder(args.style.borderLeft, cell, args.rowIdx, args.colIdx, args.row, args.onActionUpdate, args.first);\n                    delete curStyle_1.borderLeft;\n                }\n                if (Object.keys(curStyle_1).length) {\n                    if (curStyle_1.borderBottom !== undefined) {\n                        this.setThickBorderHeight(curStyle_1.borderBottom, args.rowIdx, args.colIdx, cell, args.row, args.hRow, args.onActionUpdate, args.lastCell, args.manualUpdate);\n                    }\n                    Object.assign(cell.style, curStyle_1);\n                }\n            }\n            else {\n                if (args.style.borderBottom !== undefined) {\n                    this.setThickBorderHeight(args.style.borderBottom, args.rowIdx, args.colIdx, cell, args.row, args.hRow, args.onActionUpdate, args.lastCell, args.manualUpdate);\n                }\n                Object.assign(cell.style, args.style);\n            }\n            if (args.isHeightCheckNeeded) {\n                if (!sheet.rows[args.rowIdx] || !sheet.rows[args.rowIdx].customHeight) {\n                    if (!args.manualUpdate) {\n                        var cellModel = getCell(args.rowIdx, args.colIdx, sheet);\n                        if (!(cellModel && cellModel.wrap) && this.isHeightCheckNeeded(args.style)) {\n                            setMaxHgt(sheet, args.rowIdx, args.colIdx, getTextHeight(this.parent, args.style));\n                        }\n                        if (args.lastCell) {\n                            var height = getMaxHgt(sheet, args.rowIdx);\n                            if (height > 20 && height > getRowHeight(sheet, args.rowIdx)) {\n                                setRowEleHeight(this.parent, sheet, height, args.rowIdx, args.row, args.hRow, false);\n                            }\n                        }\n                    }\n                    else {\n                        if (!this.checkHeight) {\n                            this.checkHeight = this.isHeightCheckNeeded(args.style, args.onActionUpdate);\n                        }\n                        if (cell && cell.children[0] && cell.children[0].className === 'e-cf-databar' && args.style.fontSize) {\n                            cell.children[0].querySelector('.e-databar-value').style.fontSize = args.style.fontSize;\n                        }\n                        this.updateRowHeight(args.rowIdx, args.colIdx, args.lastCell, args.onActionUpdate);\n                    }\n                }\n            }\n        }\n        else {\n            this.updateRowHeight(args.rowIdx, args.colIdx, true, args.onActionUpdate);\n        }\n    };\n    CellFormat.prototype.updateRowHeight = function (rowIdx, colIdx, isLastCell, onActionUpdate, borderSize) {\n        if (this.checkHeight) {\n            var hgt = 0;\n            var maxHgt = void 0;\n            var sheet = this.parent.getActiveSheet();\n            var cell = getCell(rowIdx, colIdx, sheet, null, true);\n            var td = this.parent.getCell(rowIdx, colIdx);\n            hgt = getTextHeight(this.parent, (cell.style) || this.parent.cellStyle, (cell.wrap) ?\n                getLines(this.parent.getDisplayText(cell), getExcludedColumnWidth(sheet, rowIdx, colIdx), cell.style, this.parent.cellStyle)\n                : 1) + 1; // 1 -> For buffer\n            if (!borderSize) {\n                borderSize = getBorderHeight(rowIdx, colIdx, sheet);\n            }\n            if (!isNullOrUndefined(cell.value)) {\n                var val = cell.value.toString();\n                if (val.indexOf('\\n') > -1) {\n                    var i = void 0;\n                    var splitVal = cell.value.split('\\n');\n                    var n = 0;\n                    var valLength = splitVal.length;\n                    for (i = 0; i < valLength; i++) {\n                        var lines = getLines(splitVal[i], getExcludedColumnWidth(sheet, rowIdx, colIdx), cell.style, this.parent.cellStyle);\n                        if (lines === 0) {\n                            lines = 1; // for empty new line\n                        }\n                        n = n + lines;\n                    }\n                    hgt = getTextHeight(this.parent, cell.style || this.parent.cellStyle, n) + 1;\n                }\n            }\n            if (hgt + borderSize < 20) {\n                hgt = 20; // default height\n            }\n            if (td && td.children[0] && td.children[0].className === 'e-cf-databar') {\n                td.children[0].style.height = '100%';\n                td.children[0].firstElementChild.nextElementSibling.style.height = '100%';\n            }\n            setMaxHgt(sheet, rowIdx, colIdx, hgt + borderSize);\n            if (isLastCell) {\n                this.checkHeight = false;\n                var row = this.parent.getRow(rowIdx);\n                if (!row) {\n                    return;\n                }\n                var prevHeight = getRowHeight(sheet, rowIdx);\n                maxHgt = getMaxHgt(sheet, rowIdx);\n                var heightChanged = onActionUpdate ? maxHgt !== prevHeight : maxHgt > prevHeight;\n                if (heightChanged) {\n                    setRowEleHeight(this.parent, sheet, maxHgt, rowIdx, row);\n                }\n            }\n        }\n    };\n    CellFormat.prototype.isHeightCheckNeeded = function (style, onActionUpdate) {\n        var keys = Object.keys(style);\n        return (onActionUpdate ? keys.indexOf('fontSize') > -1 : keys.indexOf('fontSize') > -1\n            && Number(style.fontSize.split('pt')[0]) > 12) || keys.indexOf('fontFamily') > -1;\n    };\n    CellFormat.prototype.setLeftBorder = function (border, cell, rowIdx, colIdx, row, actionUpdate, first) {\n        if (first && first.includes('Column')) {\n            return;\n        }\n        for (var j = 0; j < cell.rowSpan; j++) {\n            var prevCell = this.parent.getCell(rowIdx + j, colIdx - 1, row);\n            var i = 1;\n            while (prevCell && prevCell.style.display === 'none') {\n                prevCell = this.parent.getCell(rowIdx + j, colIdx - 1 - i, row);\n                i++;\n            }\n            if (prevCell) {\n                if (actionUpdate && border !== '' && colIdx === this.parent.viewport.leftIndex) {\n                    this.parent.getMainContent().scrollLeft -= this.getBorderSize(border);\n                }\n                prevCell.style.borderRight = (border === 'none') ? prevCell.style.borderRight : border;\n            }\n            else {\n                cell.style.borderLeft = border;\n            }\n        }\n    };\n    CellFormat.prototype.setTopBorder = function (border, cell, rowIdx, colIdx, pRow, pHRow, actionUpdate, first, lastCell, manualUpdate) {\n        if (first && first.includes('Row')) {\n            return;\n        }\n        for (var j = 0; j < cell.colSpan; j++) {\n            var prevCell = this.parent.getCell(rowIdx - 1, colIdx + j, pRow);\n            if (prevCell) {\n                if (isHiddenRow(this.parent.getActiveSheet(), rowIdx - 1)) {\n                    var index = [Number(prevCell.parentElement.getAttribute('aria-rowindex')) - 1, colIdx];\n                    if (this.parent.getCellStyleValue(['bottomPriority'], index).bottomPriority) {\n                        return;\n                    }\n                }\n                if (actionUpdate && border !== '' && this.parent.getActiveSheet().topLeftCell.includes(\"\" + (rowIdx + 1))) {\n                    this.parent.getMainContent().scrollTop -= this.getBorderSize(border);\n                }\n                this.setThickBorderHeight(border, rowIdx - 1, colIdx + j, prevCell, pRow, pHRow, actionUpdate, lastCell, manualUpdate);\n                prevCell.style.borderBottom = (border === 'none') ? prevCell.style.borderBottom : border;\n            }\n            else {\n                cell.style.borderTop = border;\n            }\n        }\n    };\n    CellFormat.prototype.setThickBorderHeight = function (border, rowIdx, colIdx, cell, row, hRow, actionUpdate, lastCell, manualUpdate) {\n        var size = border ? this.getBorderSize(border) : 1;\n        var sheet = this.parent.getActiveSheet();\n        if (size > 2 && (!sheet.rows[rowIdx] || !sheet.rows[rowIdx].customHeight)) {\n            if (manualUpdate) {\n                if (!this.checkHeight) {\n                    this.checkHeight = true;\n                }\n                this.updateRowHeight(rowIdx, colIdx, lastCell, actionUpdate, size);\n            }\n            else {\n                var prevHeight = getRowHeight(sheet, rowIdx);\n                var height = Math.ceil(this.parent.calculateHeight(this.parent.getCellStyleValue(['fontFamily', 'fontSize'], [rowIdx, colIdx]), 1, 3));\n                if (height > prevHeight) {\n                    setRowEleHeight(this.parent, sheet, height, rowIdx, row, hRow, false);\n                    this.parent.notify(rowHeightChanged, { rowIdx: rowIdx, threshold: height - 20 });\n                }\n            }\n        }\n        if (actionUpdate && (lastCell || !this.checkHeight) && size < 3 && (!sheet.rows[rowIdx] || !sheet.rows[rowIdx].customHeight)) {\n            if (!this.checkHeight) {\n                this.checkHeight = true;\n            }\n            this.updateRowHeight(rowIdx, colIdx, lastCell, actionUpdate, size);\n        }\n    };\n    CellFormat.prototype.getBorderSize = function (border) {\n        var size = border.split(' ')[0];\n        return size === 'thin' ? 1 : (size === 'medium' ? 2 : (size === 'thick' ? 3 :\n            (parseInt(size, 10) ? parseInt(size, 10) : 1)));\n    };\n    CellFormat.prototype.clearObj = function (args) {\n        var options = args.options;\n        var range = options.range ? (options.range.indexOf('!') > 0) ? options.range.split('!')[1] : options.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIndex = (options.range && options.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, options.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var rangeIdx = getRangeIndexes(range);\n        var sheet = this.parent.sheets[sheetIndex];\n        var sRIdx = rangeIdx[0];\n        var eRIdx = rangeIdx[2];\n        var sCIdx;\n        var eCIdx;\n        var eventArgs = { range: range, type: options.type, requestType: 'clear', sheetIndex: sheetIndex };\n        if (!args.isPublic) {\n            this.parent.notify(beginAction, { action: 'beforeClear', eventArgs: eventArgs });\n        }\n        if (options.type === 'Clear Formats' || options.type === 'Clear All') {\n            this.parent.notify(clearCFRule, { range: range, isPublic: false });\n            for (sRIdx; sRIdx <= eRIdx; sRIdx++) {\n                sCIdx = rangeIdx[1];\n                eCIdx = rangeIdx[3];\n                for (sCIdx; sCIdx <= eCIdx; sCIdx++) {\n                    var cell = getCell(sRIdx, sCIdx, sheet);\n                    var cellElem = this.parent.getCell(sRIdx, sCIdx);\n                    if (cell) {\n                        if (cell.wrap) {\n                            this.parent.notify(wrapEvent, { range: [sRIdx, sCIdx, sRIdx, sCIdx], wrap: false, sheet: sheet });\n                        }\n                        if (cell.hyperlink) {\n                            removeClass(cellElem.querySelectorAll('.e-hyperlink'), 'e-hyperlink-style');\n                            if (options.type === 'Clear All') {\n                                this.parent.removeHyperlink(getRangeAddress([sRIdx, sCIdx, sRIdx, sCIdx]));\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        if (options.type === 'Clear Hyperlinks') {\n            this.parent.removeHyperlink(range);\n        }\n        this.parent.notify(clear, { range: sheet.name + '!' + range, type: options.type });\n        this.parent.serviceLocator.getService('cell').refreshRange(getRangeIndexes(range));\n        if (!args.isPublic) {\n            eventArgs = { range: sheet.name + '!' + range, type: options.type, sheetIndex: sheetIndex };\n            this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'clear' });\n        }\n    };\n    CellFormat.prototype.addEventListener = function () {\n        this.parent.on(applyCellFormat, this.applyCellFormat, this);\n        this.parent.on(clearViewer, this.clearObj, this);\n    };\n    CellFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initialLoad, this.addEventListener);\n            this.parent.off(applyCellFormat, this.applyCellFormat);\n            this.parent.off(clearViewer, this.clearObj);\n        }\n    };\n    /**\n     * Destroy cell format module.\n     */\n    CellFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        this.row = null;\n        this.checkHeight = null;\n    };\n    /**\n     * Get the cell format module name.\n     */\n    CellFormat.prototype.getModuleName = function () {\n        return 'cellformat';\n    };\n    return CellFormat;\n}());\nexport { CellFormat };\n","import { closest, EventHandler } from '@syncfusion/ej2-base';\nimport { colWidthChanged, rowHeightChanged, beforeHeaderLoaded, contentLoaded, hideShow, getFilterRange } from '../common/index';\nimport { findMaxValue, setResize, autoFit, completeAction, setAutoFit } from '../common/index';\nimport { setRowHeight, isHiddenRow, getRowHeight, getColumnWidth, setColumn, isHiddenCol } from '../../workbook/base/index';\nimport { getColumn, setRow, getCell } from '../../workbook/base/index';\nimport { getRangeIndexes, getSwapRange, getCellIndexes, setMerge } from '../../workbook/common/index';\n/**\n * The `Resize` module is used to handle the resizing functionalities in Spreadsheet.\n */\nvar Resize = /** @class */ (function () {\n    /**\n     * Constructor for resize module in Spreadsheet.\n     * @private\n     */\n    function Resize(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Resize.prototype.addEventListener = function () {\n        this.parent.on(contentLoaded, this.wireEvents, this);\n        this.parent.on(beforeHeaderLoaded, this.wireEvents, this);\n        this.parent.on(autoFit, this.autoFit, this);\n        this.parent.on(setAutoFit, this.setAutoFitHandler, this);\n    };\n    Resize.prototype.autoFit = function (args) {\n        var element = args.isRow ? this.parent.getRowHeaderTable() : this.parent.getColHeaderTable().rows[0];\n        for (var i = args.startIndex; i <= args.endIndex; i++) {\n            this.trgtEle = args.isRow ? this.parent.getRow(i, element) :\n                this.parent.getCell(null, i, element);\n            this.setAutofit(i, !args.isRow);\n        }\n    };\n    Resize.prototype.wireEvents = function (args) {\n        if (this.parent.getActiveSheet().showHeaders) {\n            var rowHeader = args ? args.element : this.parent.getRowHeaderContent();\n            var colHeader = this.parent.getColumnHeaderContent();\n            EventHandler.add(colHeader, 'dblclick', this.dblClickHandler, this);\n            EventHandler.add(rowHeader, 'dblclick', this.dblClickHandler, this);\n            EventHandler.add(colHeader, 'mousedown', this.mouseDownHandler, this);\n            EventHandler.add(rowHeader, 'mousedown', this.mouseDownHandler, this);\n            this.wireResizeCursorEvent(rowHeader, colHeader);\n        }\n    };\n    Resize.prototype.wireResizeCursorEvent = function (rowHeader, colHeader) {\n        EventHandler.add(rowHeader, 'mousemove', this.setTarget, this);\n        EventHandler.add(colHeader, 'mousemove', this.setTarget, this);\n    };\n    Resize.prototype.unWireResizeCursorEvent = function () {\n        EventHandler.remove(this.parent.getRowHeaderContent(), 'mousemove', this.setTarget);\n        EventHandler.remove(this.parent.getColumnHeaderContent(), 'mousemove', this.setTarget);\n    };\n    Resize.prototype.unwireEvents = function () {\n        if (this.parent.getActiveSheet().showHeaders) {\n            EventHandler.remove(this.parent.getColumnHeaderContent(), 'dblclick', this.dblClickHandler);\n            EventHandler.remove(this.parent.getRowHeaderContent(), 'dblclick', this.dblClickHandler);\n            EventHandler.remove(this.parent.getColumnHeaderContent(), 'mousedown', this.mouseDownHandler);\n            EventHandler.remove(this.parent.getRowHeaderContent(), 'mousedown', this.mouseDownHandler);\n            this.unWireResizeCursorEvent();\n        }\n    };\n    Resize.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(contentLoaded, this.wireEvents);\n            this.parent.off(beforeHeaderLoaded, this.wireEvents);\n            this.parent.off(autoFit, this.autoFit);\n            this.parent.off(setAutoFit, this.setAutoFitHandler);\n        }\n    };\n    Resize.prototype.mouseMoveHandler = function (e) {\n        var sheetPanel = this.parent.element.getElementsByClassName('e-sheet-panel')[0];\n        var colResizeHandler = this.parent.element.getElementsByClassName('e-colresize-handler')[0];\n        var rowResizeHandler = this.parent.element.getElementsByClassName('e-rowresize-handler')[0];\n        if (colResizeHandler || rowResizeHandler) {\n            this.isMouseMoved = true;\n            if (colResizeHandler) {\n                if (e.x > this.trgtEle.parentElement.firstChild.getBoundingClientRect().left) {\n                    colResizeHandler.style.left = e.clientX - this.parent.element.getBoundingClientRect().left + 'px';\n                }\n            }\n            else if (rowResizeHandler) {\n                if (e.y >= this.trgtEle.parentElement.parentElement.firstChild.getBoundingClientRect().top) {\n                    rowResizeHandler.style.top = e.clientY - sheetPanel.getBoundingClientRect().top + 'px';\n                }\n            }\n        }\n    };\n    Resize.prototype.mouseDownHandler = function (e) {\n        this.event = e;\n        this.trgtEle = e.target;\n        if (this.trgtEle.parentElement.classList.contains('e-hide-end') || this.trgtEle.classList.contains('e-hide-end')) {\n            var offsetSize = this.trgtEle.offsetHeight;\n            var offset = e.offsetY;\n            if ((offsetSize >= 10 && offset < 5) || (offsetSize - 2 < 8 && offset < Math.ceil((offset - 2) / 2))) {\n                this.trgtEle.classList.add('e-skip-resize');\n            }\n        }\n        this.updateTarget(e, this.trgtEle);\n        var trgt = this.trgtEle;\n        var className = trgt.classList.contains('e-colresize') ? 'e-colresize-handler' :\n            trgt.classList.contains('e-rowresize') ? 'e-rowresize-handler' : '';\n        this.createResizeHandler(trgt, className);\n        this.unWireResizeCursorEvent();\n        EventHandler.add(this.parent.element, 'mousemove', this.mouseMoveHandler, this);\n        EventHandler.add(document, 'mouseup', this.mouseUpHandler, this);\n    };\n    Resize.prototype.mouseUpHandler = function (e) {\n        var colResizeHandler = this.parent.element.getElementsByClassName('e-colresize-handler')[0];\n        var rowResizeHandler = this.parent.element.getElementsByClassName('e-rowresize-handler')[0];\n        this.resizeOn(e);\n        this.isMouseMoved = null;\n        var resizeHandler = colResizeHandler ? colResizeHandler : rowResizeHandler;\n        if (resizeHandler) {\n            this.parent.element.getElementsByClassName('e-sheet-panel')[0].removeChild(resizeHandler);\n            this.updateCursor(e);\n        }\n        EventHandler.remove(document, 'mouseup', this.mouseUpHandler);\n        EventHandler.remove(this.parent.element, 'mousemove', this.mouseMoveHandler);\n        this.wireResizeCursorEvent(this.parent.getRowHeaderContent(), this.parent.getColumnHeaderContent());\n    };\n    Resize.prototype.dblClickHandler = function (e) {\n        this.trgtEle = e.target;\n        this.updateTarget(e, this.trgtEle);\n        if (this.trgtEle.classList.contains('e-colresize')) {\n            var colIndx = parseInt(this.trgtEle.getAttribute('aria-colindex'), 10) - 1;\n            var prevWidth = getColumnWidth(this.parent.getActiveSheet(), colIndx) + \"px\";\n            if (this.trgtEle.classList.contains('e-unhide-column')) {\n                this.showHiddenColumns(colIndx - 1);\n            }\n            else {\n                this.setAutofit(colIndx, true, prevWidth);\n            }\n        }\n        else if (this.trgtEle.classList.contains('e-rowresize')) {\n            var rowIndx = parseInt(this.trgtEle.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            var prevHeight = getRowHeight(this.parent.getActiveSheet(), rowIndx) + \"px\";\n            this.setAutofit(rowIndx, false, prevHeight);\n        }\n    };\n    Resize.prototype.setTarget = function (e) {\n        var trgt = e.target;\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected && (!sheet.protectSettings.formatColumns || !sheet.protectSettings.formatRows)) {\n            if (!sheet.protectSettings.formatRows && !sheet.protectSettings.formatColumns) {\n                return;\n            }\n            if (sheet.protectSettings.formatRows) {\n                if (closest(trgt, '.e-colhdr-table')) {\n                    return;\n                }\n            }\n            if (sheet.protectSettings.formatColumns) {\n                if (closest(trgt, '.e-rowhdr-table')) {\n                    return;\n                }\n            }\n        }\n        var newTrgt;\n        var tOffsetV;\n        var eOffsetV;\n        var tClass;\n        if (closest(trgt, '.e-header-row')) {\n            eOffsetV = e.offsetX;\n            tOffsetV = trgt.offsetWidth;\n            tClass = 'e-colresize';\n            if (trgt.previousElementSibling) {\n                newTrgt = trgt.previousElementSibling;\n            }\n            else {\n                if (Number(trgt.getAttribute('aria-colindex')) > 1) {\n                    newTrgt = trgt;\n                }\n            }\n        }\n        else if (closest(trgt, '.e-row')) {\n            eOffsetV = e.offsetY;\n            tOffsetV = trgt.offsetHeight;\n            tClass = 'e-rowresize';\n            if (trgt.parentElement.previousElementSibling) {\n                newTrgt = trgt.parentElement.previousElementSibling.firstElementChild;\n            }\n            else {\n                if (Number(trgt.parentElement.getAttribute('aria-rowindex')) > 1) {\n                    newTrgt = trgt;\n                }\n            }\n        }\n        if (tOffsetV - 2 < 8 && eOffsetV !== Math.ceil((tOffsetV - 2) / 2)) {\n            if (eOffsetV < Math.ceil((tOffsetV - 2) / 2)) {\n                trgt.classList.add(tClass);\n                newTrgt.classList.add(tClass);\n            }\n            else if (eOffsetV > Math.ceil((tOffsetV - 2) / 2)) {\n                trgt.classList.add(tClass);\n            }\n        }\n        else if (tOffsetV - 5 < eOffsetV && eOffsetV <= tOffsetV && tOffsetV >= 10) {\n            trgt.classList.add(tClass);\n        }\n        else if (eOffsetV < 5 && newTrgt && tOffsetV >= 10) {\n            trgt.classList.add(tClass);\n            newTrgt.classList.add(tClass);\n        }\n        else {\n            var resEle = (tClass === 'e-colresize' ? trgt.parentElement.getElementsByClassName(tClass)\n                : this.parent.getRowHeaderTable().getElementsByClassName(tClass));\n            for (var index = 0; index < resEle.length; index++) {\n                resEle[index].classList.remove(tClass);\n            }\n        }\n    };\n    Resize.prototype.updateTarget = function (e, trgt) {\n        if (closest(trgt, '.e-header-row')) {\n            if ((trgt.offsetWidth < 10 && e.offsetX < Math.ceil((trgt.offsetWidth - 2) / 2)) || (e.offsetX < 5 &&\n                trgt.offsetWidth >= 10) && trgt.classList.contains('e-colresize')) {\n                var sheet = this.parent.getActiveSheet();\n                var prevIdx = Number(this.trgtEle.getAttribute('aria-colindex')) - 2;\n                if (trgt.previousElementSibling && !isHiddenCol(sheet, prevIdx)) {\n                    this.trgtEle = trgt.previousElementSibling;\n                }\n                else {\n                    if (prevIdx > -1) {\n                        this.trgtEle.classList.add('e-unhide-column');\n                    }\n                }\n            }\n        }\n        else {\n            if ((trgt.offsetHeight < 10 && e.offsetY < Math.ceil((trgt.offsetHeight - 2) / 2)) || (e.offsetY < 5 &&\n                trgt.offsetHeight >= 10) && trgt.classList.contains('e-rowresize')) {\n                var sheet = this.parent.getActiveSheet();\n                var prevIdx = Number(trgt.parentElement.getAttribute('aria-rowindex')) - 2;\n                if (trgt.parentElement.previousElementSibling || isHiddenRow(sheet, prevIdx)) {\n                    if (e.type === 'dblclick' && isHiddenRow(sheet, prevIdx)) {\n                        var selectRange = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n                        var eventArgs = void 0;\n                        if (prevIdx <= selectRange[2] && prevIdx > selectRange[0]) {\n                            eventArgs = { startIndex: selectRange[0], endIndex: selectRange[2], hide: false, autoFit: true };\n                        }\n                        else {\n                            eventArgs = { startIndex: prevIdx, endIndex: prevIdx, hide: false, autoFit: true };\n                        }\n                        this.parent.notify(hideShow, eventArgs);\n                    }\n                    else {\n                        if (!isHiddenRow(sheet, prevIdx)) {\n                            this.trgtEle = trgt.parentElement.previousElementSibling.getElementsByClassName('e-header-cell')[0];\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Resize.prototype.setAutoFitHandler = function (args) {\n        this.setAutofit(args.idx, args.isCol);\n    };\n    // tslint:disable-next-line:max-func-body-length\n    Resize.prototype.setAutofit = function (idx, isCol, prevData) {\n        var index = 0;\n        var sheet = this.parent.getActiveSheet();\n        var mainContent = this.parent.getMainContent();\n        var oldValue = isCol ? getColumnWidth(this.parent.getActiveSheet(), idx) + \"px\" :\n            getRowHeight(this.parent.getActiveSheet(), idx) + \"px\";\n        var contentClone = [];\n        var contentTable = mainContent.getElementsByClassName('e-content-table')[0];\n        if (this.parent.getActiveSheet().showHeaders) {\n            var headerTable = isCol ? this.parent.getColHeaderTable() : this.parent.getRowHeaderTable();\n            var headerRow = headerTable.getElementsByTagName('tr');\n        }\n        var headerText;\n        var isWrap = false;\n        if (isCol) {\n            var rowLength = sheet.rows.length;\n            for (var rowIdx = 0; rowIdx < rowLength; rowIdx++) {\n                if (sheet.rows[rowIdx] && sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[idx]) {\n                    if (getCell(rowIdx, idx, sheet).wrap) {\n                        isWrap = true;\n                    }\n                    var td = this.parent.createElement('td', { className: 'e-cell' });\n                    td.textContent = this.parent.getDisplayText(sheet.rows[rowIdx].cells[idx]);\n                    if (sheet.rows[rowIdx].cells[idx].style) {\n                        var style = sheet.rows[rowIdx].cells[idx].style;\n                        if (style.fontFamily) {\n                            td.style.fontFamily = style.fontFamily;\n                        }\n                        if (style.fontSize) {\n                            td.style.fontSize = style.fontSize;\n                        }\n                    }\n                    contentClone[index] = td;\n                    index++;\n                }\n            }\n        }\n        else {\n            var colLength = sheet.rows[idx] && sheet.rows[idx].cells ? sheet.rows[idx].cells.length : 0;\n            for (var colIdx = 0; colIdx < colLength; colIdx++) {\n                if (sheet.rows[idx] && sheet.rows[idx].cells[colIdx]) {\n                    if (getCell(idx, colIdx, sheet).wrap) {\n                        isWrap = true;\n                    }\n                    var style = sheet.rows[idx].cells[colIdx].style;\n                    var td = this.parent.createElement('td');\n                    td.textContent = this.parent.getDisplayText(sheet.rows[idx].cells[colIdx]);\n                    if (sheet.rows[idx].cells[colIdx].style) {\n                        var style_1 = sheet.rows[idx].cells[colIdx].style;\n                        if (style_1.fontFamily) {\n                            td.style.fontFamily = style_1.fontFamily;\n                        }\n                        if (style_1.fontSize) {\n                            td.style.fontSize = style_1.fontSize;\n                        }\n                    }\n                    contentClone[index] = td;\n                    index++;\n                }\n            }\n        }\n        var contentFit = findMaxValue(contentTable, contentClone, isCol, this.parent, prevData, isWrap);\n        if (isCol) {\n            contentFit = this.getFloatingElementWidth(contentFit, idx);\n        }\n        var autofitValue = contentFit === 0 ? parseInt(oldValue, 10) : contentFit;\n        var threshold = parseInt(oldValue, 10) > autofitValue ?\n            -(parseInt(oldValue, 10) - autofitValue) : autofitValue - parseInt(oldValue, 10);\n        if (isCol) {\n            if (idx >= this.parent.viewport.leftIndex && idx <= this.parent.viewport.rightIndex) {\n                getColumn(sheet, idx).width = autofitValue > 0 ? autofitValue : 0;\n                this.parent.notify(colWidthChanged, { threshold: threshold, colIdx: idx });\n                this.resizeStart(idx, this.parent.getViewportIndex(idx, true), autofitValue + 'px', isCol, true, prevData);\n            }\n            else {\n                var oldWidth = getColumnWidth(sheet, idx);\n                var threshold_1;\n                if (autofitValue > 0) {\n                    threshold_1 = -(oldWidth - autofitValue);\n                }\n                else {\n                    threshold_1 = -oldWidth;\n                }\n                this.parent.notify(colWidthChanged, { threshold: threshold_1, colIdx: idx });\n                getColumn(sheet, idx).width = autofitValue > 0 ? autofitValue : 0;\n            }\n        }\n        else if (!isCol) {\n            if (idx >= this.parent.viewport.topIndex && idx <= this.parent.viewport.bottomIndex) {\n                autofitValue = autofitValue > 20 ? autofitValue : 20;\n                setRowHeight(sheet, idx, autofitValue > 0 ? autofitValue : 0);\n                this.parent.notify(rowHeightChanged, { threshold: threshold, rowIdx: idx });\n                this.resizeStart(idx, this.parent.getViewportIndex(idx), autofitValue + 'px', isCol, true, prevData);\n            }\n            else {\n                var oldHeight = getRowHeight(sheet, idx);\n                var threshold_2;\n                if (autofitValue > 0) {\n                    threshold_2 = -(oldHeight - autofitValue);\n                }\n                else {\n                    threshold_2 = -oldHeight;\n                }\n                this.parent.notify(rowHeightChanged, { threshold: threshold_2, rowIdx: idx });\n                setRowHeight(sheet, idx, autofitValue > 0 ? autofitValue : 0);\n            }\n        }\n    };\n    Resize.prototype.createResizeHandler = function (trgt, className) {\n        var editor = this.parent.createElement('div', { className: className });\n        if (trgt.classList.contains('e-colresize')) {\n            editor.style.height = this.parent.getMainContent().clientHeight + trgt.offsetHeight + 'px';\n            editor.style.left = this.event.clientX - this.parent.element.getBoundingClientRect().left + 'px';\n            editor.style.top = '0px';\n        }\n        else if (trgt.classList.contains('e-rowresize')) {\n            editor.style.width = this.parent.getMainContent().clientWidth + trgt.offsetWidth + 'px';\n            editor.style.left = '0px';\n            editor.style.top = this.event.clientY\n                - this.parent.element.getElementsByClassName('e-sheet-panel')[0].getBoundingClientRect().top + 'px';\n        }\n        this.parent.element.getElementsByClassName('e-sheet-panel')[0].appendChild(editor);\n        this.updateCursor(this.event);\n    };\n    Resize.prototype.setColWidth = function (index, viewportIdx, width, curWidth) {\n        var sheet = this.parent.getActiveSheet();\n        var threshold = width - curWidth;\n        if (threshold < 0 && curWidth < -(threshold)) {\n            threshold = -curWidth;\n        }\n        if (width > 0) {\n            if (this.isMouseMoved && this.trgtEle.classList.contains('e-unhide-column')) {\n                this.showHiddenColumns(index, width);\n                this.parent.notify(completeAction, {\n                    eventArgs: {\n                        index: index, width: 0 + \"px\", isCol: true, sheetIdx: this.parent.activeSheetIndex, oldWidth: curWidth + \"px\",\n                        hide: false\n                    }, action: 'resize'\n                });\n                return;\n            }\n            this.parent.notify(colWidthChanged, { threshold: threshold, colIdx: index });\n            this.resizeStart(index, viewportIdx, width + \"px\", true, false, curWidth + \"px\");\n            setColumn(sheet, index, { width: width, customWidth: true });\n        }\n        else {\n            if (this.isMouseMoved) {\n                this.parent.hideColumn(index);\n                this.parent.notify(completeAction, {\n                    eventArgs: {\n                        index: index, width: 0 + \"px\", isCol: true, sheetIdx: this.parent.activeSheetIndex, oldWidth: curWidth + \"px\",\n                        hide: true\n                    }, action: 'resize'\n                });\n            }\n        }\n    };\n    Resize.prototype.showHiddenColumns = function (index, width) {\n        var sheet = this.parent.getActiveSheet();\n        var selectedRange = getRangeIndexes(sheet.selectedRange);\n        var startIdx;\n        var endIdx;\n        var colgroup;\n        if (index >= selectedRange[1] && index <= selectedRange[3] && selectedRange[2] === sheet.rowCount - 1 &&\n            getCellIndexes(sheet.activeCell)[0] === getCellIndexes(sheet.topLeftCell)[0]) {\n            startIdx = selectedRange[1];\n            endIdx = selectedRange[3];\n            colgroup = this.parent.getMainContent().querySelector('colgroup');\n        }\n        else {\n            startIdx = endIdx = index;\n        }\n        if (width !== undefined) {\n            for (var i = startIdx; i <= endIdx; i++) {\n                setColumn(sheet, i, { width: width, customWidth: true });\n                if (i >= this.parent.viewport.leftIndex && i <= this.parent.viewport.rightIndex && !isHiddenCol(sheet, i)) {\n                    colgroup.children[this.parent.getViewportIndex(i, true)].style.width = width + \"px\";\n                }\n            }\n        }\n        this.trgtEle.classList.remove('e-unhide-column');\n        this.parent.hideColumn(startIdx, endIdx, false);\n        if (width === undefined) {\n            this.autoFit({ isRow: false, startIndex: startIdx, endIndex: endIdx });\n        }\n    };\n    Resize.prototype.setRowHeight = function (rowIdx, viewportIdx, height, prevData) {\n        var sheet = this.parent.getActiveSheet();\n        var eleHeight = parseInt(this.parent.getMainContent().getElementsByTagName('tr')[viewportIdx].style.height, 10);\n        var rowHeight = height;\n        var threshold = parseInt(rowHeight, 10) - eleHeight;\n        if (threshold < 0 && eleHeight < -(threshold)) {\n            threshold = -eleHeight;\n        }\n        this.parent.notify(rowHeightChanged, { threshold: threshold, rowIdx: rowIdx, isCustomHgt: true });\n        this.resizeStart(rowIdx, viewportIdx, rowHeight, false, false, prevData);\n        setRow(sheet, rowIdx, { height: parseInt(rowHeight, 10) > 0 ? parseInt(rowHeight, 10) : 0, customHeight: true });\n    };\n    Resize.prototype.resizeOn = function (e) {\n        var _this = this;\n        var idx;\n        var actualIdx;\n        if (this.trgtEle.classList.contains('e-rowresize')) {\n            var sheet = this.parent.getActiveSheet();\n            var prevIdx = Number(this.trgtEle.parentElement.getAttribute('aria-rowindex')) - 2;\n            if (this.isMouseMoved && isHiddenRow(sheet, prevIdx) && this.trgtEle.classList.contains('e-skip-resize') &&\n                e.clientY > this.trgtEle.getBoundingClientRect().top) {\n                this.trgtEle.classList.remove('e-skip-resize');\n                var eventArgs = { startIndex: prevIdx, endIndex: prevIdx, hide: false, skipAppend: true };\n                this.parent.notify(hideShow, eventArgs);\n                var rTbody = this.parent.getRowHeaderTable().tBodies[0];\n                var tbody = this.parent.getContentTable().tBodies[0];\n                eventArgs.hdrRow.style.display = 'none';\n                eventArgs.row.style.display = 'none';\n                rTbody.insertBefore(eventArgs.hdrRow, rTbody.children[eventArgs.insertIdx]);\n                tbody.insertBefore(eventArgs.row, tbody.children[eventArgs.insertIdx]);\n                this.trgtEle = eventArgs.hdrRow.firstElementChild;\n                eventArgs.hdrRow.nextElementSibling.classList.remove('e-hide-end');\n                eventArgs.mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(setMerge, mergeArgs); });\n            }\n            else {\n                if (this.trgtEle.classList.contains('e-skip-resize')) {\n                    this.trgtEle.classList.remove('e-skip-resize');\n                    if ((!this.isMouseMoved && isHiddenRow(sheet, prevIdx)) || !this.trgtEle.parentElement.previousElementSibling) {\n                        return;\n                    }\n                    this.trgtEle = this.trgtEle.parentElement.previousElementSibling.getElementsByClassName('e-header-cell')[0];\n                }\n            }\n            actualIdx = idx = parseInt(this.trgtEle.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            idx = this.parent.getViewportIndex(actualIdx);\n            var prevData = this.parent.getMainContent().getElementsByClassName('e-row')[idx].style.height;\n            var rowHeight = e.clientY - this.event.clientY + parseInt(prevData, 10);\n            if (rowHeight <= 0) {\n                this.parent.hideRow(actualIdx);\n                setRow(sheet, actualIdx, { height: 0, customHeight: true });\n                this.parent.notify(completeAction, {\n                    eventArgs: { index: actualIdx, height: '0px', isCol: false, sheetIdx: this.parent.activeSheetIndex, oldHeight: prevData },\n                    action: 'resize'\n                });\n                return;\n            }\n            this.setRowHeight(actualIdx, idx, rowHeight + \"px\", prevData);\n            if (this.trgtEle.parentElement.style.display === 'none') {\n                var sheet_1 = this.parent.getActiveSheet();\n                var selectedRange = getSwapRange(getRangeIndexes(sheet_1.selectedRange));\n                if (actualIdx <= selectedRange[2] && actualIdx > selectedRange[0]) {\n                    rowHeight = sheet_1.rows[actualIdx].height;\n                    var count = void 0;\n                    for (var i = selectedRange[0]; i <= selectedRange[2]; i++) {\n                        if (i === actualIdx) {\n                            continue;\n                        }\n                        prevData = getRowHeight(sheet_1, i) + \"px\";\n                        setRow(sheet_1, i, { customHeight: true, height: rowHeight });\n                        if (isHiddenRow(sheet_1, i)) {\n                            if (!count) {\n                                count = i;\n                            }\n                        }\n                        else {\n                            this.parent.getRow(i).style.height = rowHeight + \"px\";\n                            if (sheet_1.showHeaders) {\n                                this.parent.getRow(i, this.parent.getRowHeaderTable()).style.height = rowHeight + \"px\";\n                            }\n                        }\n                        this.parent.notify(completeAction, {\n                            eventArgs: {\n                                index: i, height: rowHeight + \"px\", isCol: false,\n                                sheetIdx: this.parent.activeSheetIndex, oldHeight: prevData\n                            },\n                            action: 'resize'\n                        });\n                    }\n                    this.parent.hideRow(selectedRange[0], actualIdx - 1, false);\n                    idx += Math.abs(actualIdx - count);\n                }\n                else {\n                    if (idx !== 0 && !isHiddenRow(sheet_1, actualIdx - 1)) {\n                        this.trgtEle.parentElement.previousElementSibling.classList.remove('e-hide-start');\n                    }\n                    else {\n                        if (idx !== 0) {\n                            this.trgtEle.parentElement.classList.add('e-hide-end');\n                        }\n                    }\n                    this.parent.selectRange(sheet_1.selectedRange);\n                }\n                this.trgtEle.parentElement.style.display = '';\n                this.parent.getContentTable().rows[idx].style.display = '';\n            }\n        }\n        else if (this.trgtEle.classList.contains('e-colresize')) {\n            if (this.isMouseMoved && this.trgtEle.classList.contains('e-unhide-column') &&\n                e.clientX < this.trgtEle.getBoundingClientRect().left) {\n                this.trgtEle.classList.remove('e-unhide-column');\n                if (this.trgtEle.previousElementSibling) {\n                    this.trgtEle = this.trgtEle.previousElementSibling;\n                }\n            }\n            idx = parseInt(this.trgtEle.getAttribute('aria-colindex'), 10) - 1;\n            var curWidth = void 0;\n            if (this.trgtEle.classList.contains('e-unhide-column')) {\n                idx -= 1;\n                curWidth = 0;\n            }\n            else {\n                curWidth = getColumnWidth(this.parent.getActiveSheet(), idx);\n            }\n            this.setColWidth(idx, this.parent.getViewportIndex(idx, true), (e.clientX - this.event.clientX) + curWidth, curWidth);\n        }\n    };\n    Resize.prototype.setWidthAndHeight = function (trgt, value, isCol) {\n        if (isCol) {\n            trgt.style.width = parseInt(trgt.style.width, 10) + value + 'px';\n        }\n        else {\n            trgt.style.height = parseInt(trgt.style.height, 10) + value + 'px';\n        }\n    };\n    Resize.prototype.resizeStart = function (idx, viewportIdx, value, isCol, isFit, prevData) {\n        if (this.parent.getActiveSheet().showHeaders) {\n            setResize(viewportIdx, value, isCol, this.parent);\n        }\n        else {\n            if (isCol) {\n                var curEle = this.parent.element.getElementsByClassName('e-sheet-content')[0].getElementsByTagName('col')[viewportIdx];\n                curEle.style.width = value;\n            }\n            else {\n                var curEle = this.parent.element.getElementsByClassName('e-sheet-content')[0].getElementsByTagName('tr')[viewportIdx];\n                curEle.style.height = value;\n            }\n        }\n        var action = isFit ? 'resizeToFit' : 'resize';\n        var eventArgs;\n        var isAction;\n        if (isCol) {\n            eventArgs = { index: idx, width: value, isCol: isCol, sheetIdx: this.parent.activeSheetIndex, oldWidth: prevData };\n            isAction = prevData !== value;\n        }\n        else {\n            eventArgs = { index: idx, height: value, isCol: isCol, sheetIdx: this.parent.activeSheetIndex, oldHeight: prevData };\n            isAction = prevData !== value;\n        }\n        if (isAction) {\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: action });\n        }\n    };\n    Resize.prototype.updateCursor = function (e) {\n        if (this.parent.element.getElementsByClassName('e-colresize-handler')[0]) {\n            this.parent.element.classList.add('e-col-resizing');\n        }\n        else if (this.parent.element.classList.contains('e-col-resizing')) {\n            this.parent.element.classList.remove('e-col-resizing');\n        }\n        if (this.parent.element.getElementsByClassName('e-rowresize-handler')[0]) {\n            this.parent.element.classList.add('e-row-resizing');\n        }\n        else if (this.parent.element.classList.contains('e-row-resizing')) {\n            this.parent.element.classList.remove('e-row-resizing');\n        }\n    };\n    // To get the floating element width like filter\n    Resize.prototype.getFloatingElementWidth = function (oldWidth, colIdx) {\n        var floatingWidth = oldWidth;\n        var eventArgs = { filterRange: [], hasFilter: false };\n        this.parent.notify(getFilterRange, eventArgs);\n        if (eventArgs.hasFilter && eventArgs.filterRange) {\n            if (eventArgs.filterRange[1] <= colIdx && eventArgs.filterRange[3] >= colIdx) {\n                floatingWidth = oldWidth + 22; // default width and padding for button \n            }\n        }\n        return floatingWidth;\n    };\n    /**\n     * To destroy the resize module.\n     * @return {void}\n     */\n    Resize.prototype.destroy = function () {\n        this.unwireEvents();\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     */\n    Resize.prototype.getModuleName = function () {\n        return 'resize';\n    };\n    return Resize;\n}());\nexport { Resize };\n","import { collaborativeUpdate, updateAction } from '../common/index';\n/**\n * Collaborative Editing module for real time changes in the Spreadsheet.\n */\nvar CollaborativeEditing = /** @class */ (function () {\n    function CollaborativeEditing(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    CollaborativeEditing.prototype.refreshClients = function (options) {\n        updateAction(options, this.parent);\n    };\n    CollaborativeEditing.prototype.addEventListener = function () {\n        this.parent.on(collaborativeUpdate, this.refreshClients, this);\n    };\n    CollaborativeEditing.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(collaborativeUpdate, this.refreshClients);\n        }\n    };\n    /**\n     * Destroy collaborative editing module.\n     */\n    CollaborativeEditing.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the collaborative editing module name.\n     */\n    CollaborativeEditing.prototype.getModuleName = function () {\n        return 'collaborativeEditing';\n    };\n    return CollaborativeEditing;\n}());\nexport { CollaborativeEditing };\n","import { spreadsheetDestroyed, getUpdateUsingRaf } from '../common/index';\nimport { autoFit, hideShow, virtualContentLoaded, completeAction, setScrollEvent, onContentScroll, skipHiddenIdx } from '../common/index';\nimport { beginAction, hiddenMerge, updateTableWidth } from '../common/index';\nimport { getCellAddress, isHiddenRow, setRow, setColumn, isHiddenCol, getRangeAddress, getCell } from '../../workbook/index';\nimport { getCellIndexes, getColumnWidth, applyCellFormat } from '../../workbook/index';\nimport { activeCellMergedRange, setMerge } from '../../workbook/index';\nimport { detach } from '@syncfusion/ej2-base';\n/**\n * The `ShowHide` module is used to perform hide/show the rows and columns.\n * @hidden\n */\nvar ShowHide = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet show hide module.\n     * @private\n     */\n    function ShowHide(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    ShowHide.prototype.hideShow = function (args) {\n        if (args.startIndex > args.endIndex) {\n            var temp = args.startIndex;\n            args.startIndex = args.endIndex;\n            args.endIndex = temp;\n        }\n        if (args.actionUpdate) {\n            this.parent.notify(beginAction, { eventArgs: args, action: 'hideShow' });\n        }\n        args.isCol ? this.hideCol(args) : this.hideRow(args);\n        if (args.actionUpdate) {\n            this.parent.notify(completeAction, { eventArgs: args, action: 'hideShow' });\n        }\n    };\n    // tslint:disable-next-line\n    ShowHide.prototype.hideRow = function (args) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var cell;\n        var count = 0;\n        var idx;\n        var nextIdx;\n        var merge;\n        if (args.hide) {\n            var content = void 0;\n            var rowHdr = void 0;\n            var row = void 0;\n            for (var i = args.startIndex; i <= args.endIndex; i++) {\n                if (isHiddenRow(sheet, i)) {\n                    continue;\n                }\n                if (idx === undefined) {\n                    if (sheet.showHeaders) {\n                        rowHdr = this.parent.getRowHeaderTable();\n                    }\n                    content = this.parent.getContentTable();\n                    idx = this.parent.getViewportIndex(i);\n                    count = 0;\n                }\n                setRow(sheet, i, { hidden: true });\n                row = content.rows[idx];\n                if (row) {\n                    if (!merge) {\n                        for (var j = 0; j <= sheet.usedRange.colIndex; j++) {\n                            cell = getCell(i, j, sheet) || {};\n                            if ((cell.colSpan || cell.rowSpan) && (args.startIndex >= this.parent.viewport.topIndex ||\n                                this.parent.scrollSettings.enableVirtualization)) {\n                                merge = true;\n                                break;\n                            }\n                        }\n                    }\n                    if (merge) {\n                        continue;\n                    }\n                    if (sheet.showHeaders) {\n                        detach(rowHdr.rows[idx]);\n                    }\n                    detach(row);\n                    count++;\n                    row = content.rows[idx];\n                    if (row && i === args.endIndex) {\n                        var cell_1 = void 0;\n                        nextIdx = skipHiddenIdx(sheet, i + 1, true);\n                        var first = nextIdx !== skipHiddenIdx(sheet, 0, true) && nextIdx ===\n                            (this.parent.viewport.topIndex >= args.startIndex ? args.endIndex + 1 : this.parent.viewport.topIndex) ? 'Row' : '';\n                        for (var j = this.parent.viewport.leftIndex; j <= this.parent.viewport.rightIndex; j++) {\n                            var borderTop = this.parent.getCellStyleValue(['borderTop'], [nextIdx, j]).borderTop;\n                            if (borderTop !== '') {\n                                cell_1 = row.cells[j];\n                                this.parent.notify(applyCellFormat, { onActionUpdate: false, rowIdx: nextIdx, colIdx: j,\n                                    style: { borderTop: borderTop }, row: row, pRow: row.previousElementSibling,\n                                    first: first, cell: cell_1 });\n                            }\n                        }\n                    }\n                }\n                else {\n                    if (i <= this.parent.viewport.bottomIndex) {\n                        count++;\n                    }\n                    else {\n                        count--;\n                    }\n                }\n            }\n            if (merge && (args.startIndex >= this.parent.viewport.topIndex || !this.parent.scrollSettings.enableVirtualization)) {\n                this.parent.selectRange(sheet.selectedRange);\n                this.parent.renderModule.refreshUI({\n                    rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Row'\n                });\n                return;\n            }\n            if (!count) {\n                return;\n            }\n            this.parent.selectRange(sheet.selectedRange);\n            if (this.parent.scrollSettings.enableVirtualization) {\n                if (this.parent.viewport.topIndex >= args.startIndex) {\n                    this.parent.viewport.topIndex = args.endIndex + 1;\n                }\n                args.startIndex = this.parent.viewport.bottomIndex + 1;\n                args.endIndex = args.startIndex + count - 1;\n                var indexes = this.parent.skipHidden(args.startIndex, args.endIndex);\n                args.startIndex = indexes[0];\n                args.endIndex = indexes[1];\n                this.parent.viewport.bottomIndex = args.endIndex;\n                this.parent.renderModule.refreshUI({ colIndex: this.parent.viewport.leftIndex, direction: '', refresh: 'RowPart' }, getCellAddress(args.startIndex, this.parent.viewport.leftIndex) + \":\" + getCellAddress(args.endIndex, this.parent.viewport.leftIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2)));\n            }\n            if (sheet.showHeaders) {\n                if (idx === 0) {\n                    if (rowHdr.rows[0]) {\n                        rowHdr.rows[0].classList.add('e-hide-end');\n                    }\n                }\n                else {\n                    if (rowHdr.rows[idx - 1]) {\n                        rowHdr.rows[idx - 1].classList.add('e-hide-start');\n                    }\n                    if (rowHdr.rows[idx]) {\n                        rowHdr.rows[idx].classList.add('e-hide-end');\n                    }\n                }\n            }\n        }\n        else {\n            var hFrag = void 0;\n            var frag = void 0;\n            var hRow = void 0;\n            var row = void 0;\n            var rowRenderer = void 0;\n            var rTBody = void 0;\n            var tBody = void 0;\n            var startRow = void 0;\n            var endRow = args.startIndex - 1;\n            var newStartRow = void 0;\n            var mergeCollection = [];\n            for (var i = args.startIndex, len = args.endIndex; i <= len; i++) {\n                if (!isHiddenRow(sheet, i)) {\n                    if (args.startIndex === args.endIndex) {\n                        return;\n                    }\n                    if (idx === undefined) {\n                        endRow++;\n                    }\n                    else {\n                        newStartRow = i;\n                    }\n                    continue;\n                }\n                if (newStartRow !== undefined) {\n                    len = i;\n                    continue;\n                }\n                if (i > this.parent.viewport.bottomIndex) {\n                    setRow(sheet, i, { hidden: false });\n                    if (startRow === undefined) {\n                        return;\n                    }\n                    continue;\n                }\n                if (startRow === undefined) {\n                    startRow = i;\n                }\n                setRow(sheet, i, { hidden: false });\n                if (idx === undefined) {\n                    hFrag = document.createDocumentFragment();\n                    frag = document.createDocumentFragment();\n                    rowRenderer = this.parent.serviceLocator.getService('row');\n                    if (sheet.showHeaders) {\n                        rTBody = this.parent.getRowHeaderTable().tBodies[0];\n                    }\n                    tBody = this.parent.getContentTable().tBodies[0];\n                    if (i < this.parent.viewport.topIndex) {\n                        this.parent.viewport.topIndex = i;\n                    }\n                    if (i === 0) {\n                        idx = 0;\n                    }\n                    else {\n                        idx = this.parent.getViewportIndex(i);\n                    }\n                }\n                endRow++;\n                if (sheet.showHeaders) {\n                    hRow = rowRenderer.refresh(i, null, null, true);\n                    hFrag.appendChild(hRow);\n                    detach(rTBody.lastElementChild);\n                }\n                row = frag.appendChild(rowRenderer.refresh(i, row, hRow));\n                detach(tBody.lastElementChild);\n                for (var j = this.parent.viewport.leftIndex; j <= this.parent.viewport.rightIndex; j++) {\n                    cell = getCell(i, j, sheet) || {};\n                    if (cell.rowSpan !== undefined) {\n                        var mergeArgs = { range: [i, j, i, j], isAction: false, merge: true,\n                            type: 'All', skipChecking: true };\n                        this.parent.notify(activeCellMergedRange, mergeArgs);\n                        if (!mergeCollection.length || mergeArgs.range[1] !== mergeCollection[mergeCollection.length - 1].range[1]) {\n                            mergeCollection.push(mergeArgs);\n                        }\n                    }\n                }\n            }\n            this.parent.viewport.bottomIndex = this.parent.viewport.topIndex + this.parent.viewport.rowCount +\n                (this.parent.getThreshold('row') * 2);\n            count = this.parent.hiddenCount(this.parent.viewport.topIndex, args.startIndex) +\n                this.parent.hiddenCount(args.endIndex + 1, this.parent.viewport.bottomIndex);\n            this.parent.viewport.bottomIndex += count;\n            args.insertIdx = idx;\n            args.row = frag.querySelector('.e-row');\n            args.mergeCollection = mergeCollection;\n            if (sheet.showHeaders) {\n                args.hdrRow = hFrag.querySelector('.e-row');\n                if (idx !== 0 && !isHiddenRow(sheet, endRow - 1) && rTBody.children[idx - 1]) {\n                    rTBody.children[idx - 1].classList.remove('e-hide-start');\n                }\n                if (args.startIndex !== 0 && isHiddenRow(sheet, args.startIndex - 1)) {\n                    args.hdrRow.classList.add('e-hide-end');\n                }\n                if (isHiddenRow(sheet, endRow + 1)) {\n                    hFrag.lastElementChild.classList.add('e-hide-start');\n                }\n                else {\n                    if (rTBody.children[idx]) {\n                        rTBody.children[idx].classList.remove('e-hide-end');\n                    }\n                }\n            }\n            if (row && tBody.children[idx]) {\n                nextIdx = skipHiddenIdx(sheet, endRow + 1, true);\n                for (var i = this.parent.viewport.leftIndex; i <= this.parent.viewport.rightIndex; i++) {\n                    var borderTop = this.parent.getCellStyleValue(['borderTop'], [nextIdx, i]).borderTop;\n                    if (borderTop !== '') {\n                        this.parent.notify(applyCellFormat, { onActionUpdate: false, rowIdx: nextIdx, colIdx: i,\n                            style: { borderTop: borderTop }, pRow: row, cell: tBody.children[idx].children[i],\n                            first: '' });\n                        var prevIdx = skipHiddenIdx(sheet, startRow - 1, false);\n                        if (prevIdx > -1) {\n                            if (tBody.children[idx - 1] && !this.parent.getCellStyleValue(['borderBottom'], [prevIdx, i]).borderBottom &&\n                                !this.parent.getCellStyleValue(['borderTop'], [startRow, i]).borderTop) {\n                                tBody.children[idx - 1].children[i].style.borderBottom = '';\n                            }\n                        }\n                        else {\n                            tBody.children[idx].children[i].style.borderTop = '';\n                        }\n                    }\n                }\n            }\n            if (args.skipAppend) {\n                return;\n            }\n            if (sheet.showHeaders) {\n                rTBody.insertBefore(hFrag, rTBody.children[idx]);\n            }\n            tBody.insertBefore(frag, tBody.children[idx]);\n            this.parent.selectRange(sheet.selectedRange);\n            if (args.autoFit && sheet.showHeaders) {\n                this.parent.notify(autoFit, { startIndex: args.startIndex, endIndex: args.endIndex, isRow: true });\n            }\n            mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(setMerge, mergeArgs); });\n            if (newStartRow !== undefined && newStartRow !== args.endIndex) {\n                args.startIndex = newStartRow;\n                this.hideRow(args);\n            }\n        }\n    };\n    ShowHide.prototype.hideCol = function (args) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var hiddenIndex = [];\n        var beforeViewportIdx = [];\n        var topLeftCell = getCellIndexes(sheet.topLeftCell);\n        var scrollable;\n        for (var i = args.startIndex; i <= args.endIndex; i++) {\n            if (args.hide ? isHiddenCol(sheet, i) : !isHiddenCol(sheet, i)) {\n                continue;\n            }\n            setColumn(sheet, i, { hidden: args.hide });\n            if (this.parent.scrollSettings.enableVirtualization && (i < this.parent.viewport.leftIndex ||\n                i > this.parent.viewport.rightIndex)) {\n                if (i < this.parent.viewport.leftIndex) {\n                    beforeViewportIdx.push(i);\n                }\n                continue;\n            }\n            hiddenIndex.push(i);\n            if (args.hide && topLeftCell[1] === i) {\n                scrollable = true;\n            }\n        }\n        if (!beforeViewportIdx.length && !hiddenIndex.length) {\n            return;\n        }\n        if (args.hide) {\n            if (!hiddenIndex.length) {\n                return;\n            }\n            if (hiddenIndex.length <= this.parent.getThreshold('col') || !this.parent.scrollSettings.enableVirtualization) {\n                this.removeCell(sheet, hiddenIndex);\n            }\n            if (this.parent.scrollSettings.enableVirtualization) {\n                if (hiddenIndex[0] === this.parent.viewport.leftIndex) {\n                    this.parent.viewport.leftIndex = skipHiddenIdx(sheet, hiddenIndex[hiddenIndex.length - 1] + 1, true, 'columns');\n                }\n                if (scrollable) {\n                    var scrollWidth_1 = 0;\n                    hiddenIndex.slice(0, hiddenIndex.indexOf(topLeftCell[1])).forEach(function (colIdx) {\n                        scrollWidth_1 += getColumnWidth(sheet, colIdx, true);\n                    });\n                    if (scrollWidth_1) {\n                        this.parent.notify(setScrollEvent, { set: false });\n                        var content = this.parent.getMainContent();\n                        content.scrollLeft -= scrollWidth_1;\n                        this.parent.notify(onContentScroll, { scrollLeft: content.scrollLeft, preventScroll: true, skipHidden: true });\n                        getUpdateUsingRaf(function () { return _this.parent.notify(setScrollEvent, { set: true }); });\n                    }\n                }\n                if (this.parent.scrollSettings.isFinite) {\n                    var colCount = skipHiddenIdx(sheet, sheet.colCount - 1, false, 'columns');\n                    var startIdx = this.parent.viewport.leftIndex;\n                    var endIndex = this.parent.viewport.rightIndex;\n                    if (endIndex + hiddenIndex.length >= colCount) {\n                        var index = skipHiddenIdx(sheet, startIdx - ((endIndex + hiddenIndex.length) - colCount), false, 'columns');\n                        if (index > -1) {\n                            this.parent.viewport.leftIndex = index;\n                            this.parent.viewport.leftIndex -= this.parent.hiddenCount(endIndex, colCount);\n                        }\n                        this.parent.viewport.rightIndex = colCount;\n                        if (startIdx !== this.parent.viewport.leftIndex || endIndex !== this.parent.viewport.rightIndex) {\n                            this.parent.renderModule.refreshUI({ skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(sheet, 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Column' });\n                        }\n                        else {\n                            this.parent.notify(updateTableWidth, { refresh: 'Column' });\n                        }\n                        this.parent.selectRange(sheet.selectedRange);\n                        return;\n                    }\n                }\n                if (hiddenIndex.length <= this.parent.getThreshold('col')) {\n                    var indexes = this.parent.skipHidden(this.parent.viewport.rightIndex + 1, this.parent.viewport.rightIndex + hiddenIndex.length, 'columns');\n                    this.parent.viewport.rightIndex = indexes[1];\n                    this.parent.renderModule.refreshUI({ rowIndex: this.parent.viewport.topIndex, colIndex: indexes[0], direction: '', refresh: 'ColumnPart' }, \"\" + getRangeAddress([this.parent.viewport.topIndex, indexes[0], this.parent.viewport.bottomIndex, indexes[1]]));\n                }\n                else {\n                    this.parent.renderModule.refreshUI({ skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(sheet, 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex,\n                        refresh: 'Column' });\n                }\n            }\n            this.parent.selectRange(sheet.selectedRange);\n        }\n        else {\n            if (beforeViewportIdx.length) {\n                beforeViewportIdx.sort(function (i, j) { return i - j; });\n                if (this.parent.scrollSettings.enableVirtualization && beforeViewportIdx[0] < this.parent.getThreshold('col')) {\n                    var rowIdx = getCellIndexes(sheet.topLeftCell)[0] + 1;\n                    this.parent.setSheetPropertyOnMute(sheet, 'topLeftCell', \"A\" + rowIdx);\n                    this.parent.renderModule.refreshUI({ skipUpdateOnFirst: true, rowIndex: this.parent.viewport.topIndex, colIndex: 0,\n                        refresh: 'Column' });\n                    this.parent.selectRange(sheet.selectedRange);\n                }\n                else {\n                    this.parent.goTo(getCellAddress(this.parent.viewport.topIndex, beforeViewportIdx[0]));\n                }\n                return;\n            }\n            if (hiddenIndex.length <= this.parent.getThreshold('col') || !this.parent.scrollSettings.enableVirtualization) {\n                this.appendCell(sheet, hiddenIndex);\n                if (this.parent.scrollSettings.enableVirtualization) {\n                    this.parent.notify(virtualContentLoaded, { refresh: 'Column' });\n                }\n            }\n            else {\n                this.parent.renderModule.refreshUI({ skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(sheet, 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex,\n                    refresh: 'Column' });\n            }\n            this.parent.selectRange(sheet.selectedRange);\n        }\n    };\n    ShowHide.prototype.removeCell = function (sheet, indexes) {\n        var _this = this;\n        var startIdx;\n        var endIdx;\n        var hRow;\n        var row;\n        var hColgrp;\n        var colgrp;\n        var rowIdx = 0;\n        var cellIdx = this.parent.getViewportIndex(indexes[0], true) + 1;\n        var cell;\n        if (this.parent.scrollSettings.enableVirtualization) {\n            startIdx = this.parent.viewport.topIndex;\n            endIdx = this.parent.viewport.bottomIndex;\n        }\n        else {\n            startIdx = 0;\n            endIdx = sheet.rowCount - 1;\n        }\n        var table = this.parent.getContentTable();\n        var nextIdx;\n        colgrp = table.getElementsByTagName('colgroup')[0];\n        var colSpan;\n        if (sheet.showHeaders) {\n            var hTable = this.parent.getColHeaderTable();\n            hColgrp = hTable.getElementsByTagName('colgroup')[0];\n            hRow = hTable.rows[0];\n        }\n        var modelLen = indexes.length - 1;\n        var prevIdx;\n        while (startIdx <= endIdx) {\n            if (isHiddenRow(sheet, startIdx)) {\n                startIdx++;\n                continue;\n            }\n            row = table.rows[rowIdx];\n            indexes.forEach(function (idx, index) {\n                detach(row.cells[cellIdx]);\n                if (rowIdx === 0) {\n                    if (sheet.showHeaders) {\n                        detach(hRow.cells[cellIdx]);\n                        detach(hColgrp.children[cellIdx]);\n                    }\n                    detach(colgrp.children[cellIdx]);\n                }\n                if (index === 0) {\n                    cell = getCell(startIdx, idx, sheet) || {};\n                    if (cell.colSpan !== undefined && (cell.rowSpan === undefined || cell.colSpan > 1)) {\n                        _this.parent.notify(hiddenMerge, { rowIdx: startIdx, colIdx: idx, model: 'col',\n                            start: indexes[0], end: indexes[modelLen] });\n                    }\n                }\n                if (index === modelLen) {\n                    nextIdx = skipHiddenIdx(sheet, idx + 1, true, 'columns');\n                    var borderLeft = _this.parent.getCellStyleValue(['borderLeft'], [rowIdx, nextIdx]).borderLeft;\n                    if (borderLeft !== '') {\n                        _this.parent.notify(applyCellFormat, { onActionUpdate: false, rowIdx: rowIdx, colIdx: nextIdx,\n                            style: { borderLeft: borderLeft }, row: row, first: '' });\n                    }\n                    cell = getCell(startIdx, idx, sheet) || {};\n                    if (cell.colSpan !== undefined && (cell.rowSpan === undefined || cell.colSpan > 1)) {\n                        _this.parent.notify(hiddenMerge, { rowIdx: startIdx, colIdx: idx, model: 'col',\n                            start: indexes[0], end: indexes[modelLen], isEnd: true });\n                    }\n                }\n            });\n            startIdx++;\n            rowIdx++;\n        }\n        if (cellIdx - 1 > -1) {\n            if (sheet.showHeaders && hRow.cells[cellIdx - 1]) {\n                hRow.cells[cellIdx - 1].classList.add('e-hide-start');\n            }\n        }\n        if (hRow.cells[cellIdx]) {\n            hRow.cells[cellIdx].classList.add('e-hide-end');\n        }\n    };\n    ShowHide.prototype.appendCell = function (sheet, indexes) {\n        var _this = this;\n        var startIdx;\n        var endIdx;\n        var hRow;\n        var row;\n        var hColgrp;\n        var colgrp;\n        var rowIdx = 0;\n        var prevIdx;\n        var hFrag = document.createDocumentFragment();\n        var frag = document.createDocumentFragment();\n        var colFrag = document.createDocumentFragment();\n        if (this.parent.scrollSettings.enableVirtualization) {\n            startIdx = this.parent.viewport.topIndex;\n            endIdx = this.parent.viewport.bottomIndex;\n        }\n        else {\n            startIdx = 0;\n            endIdx = sheet.rowCount - 1;\n        }\n        var table = this.parent.getContentTable();\n        var hTable = this.parent.getColHeaderTable();\n        colgrp = table.getElementsByTagName('colgroup')[0];\n        if (sheet.showHeaders) {\n            hColgrp = hTable.getElementsByTagName('colgroup')[0];\n            hRow = hTable.rows[0];\n        }\n        var cellRenderer = this.parent.serviceLocator.getService('cell');\n        indexes.sort(function (i, j) { return i - j; });\n        var cellModel;\n        var mergeCollection = [];\n        var cellIdx = [];\n        var cell;\n        var refCell;\n        var modelLen = indexes.length - 1;\n        while (startIdx <= endIdx) {\n            if (isHiddenRow(sheet, startIdx)) {\n                startIdx++;\n                continue;\n            }\n            row = table.rows[rowIdx];\n            indexes.forEach(function (idx, index) {\n                if (rowIdx === 0) {\n                    cellIdx[index] = _this.parent.getViewportIndex(idx, true);\n                    if (colgrp.children[cellIdx[index]]) {\n                        colgrp.insertBefore(_this.parent.sheetModule.updateCol(sheet, idx), colgrp.children[cellIdx[index]]);\n                        if (sheet.showHeaders) {\n                            refCell = hRow.cells[cellIdx[index]];\n                            if (index === 0 && indexes[index] && !isHiddenCol(sheet, indexes[index] - 1)) {\n                                refCell.previousElementSibling.classList.remove('e-hide-start');\n                            }\n                            hRow.insertBefore(cellRenderer.renderColHeader(idx), refCell);\n                            if (index === modelLen) {\n                                refCell.classList.remove('e-hide-end');\n                            }\n                        }\n                    }\n                    else {\n                        colgrp.appendChild(_this.parent.sheetModule.updateCol(sheet, idx));\n                        if (sheet.showHeaders) {\n                            hRow.appendChild(cellRenderer.renderColHeader(idx));\n                        }\n                    }\n                    detach(colgrp.lastChild);\n                    if (sheet.showHeaders) {\n                        detach(hRow.lastChild);\n                        if (index === modelLen) {\n                            detach(hColgrp);\n                            hTable.insertBefore(colgrp.cloneNode(true), hTable.tHead[0]);\n                        }\n                    }\n                }\n                detach(row.lastChild);\n                refCell = row.cells[cellIdx[index]];\n                cell = cellRenderer.render({ rowIdx: startIdx, colIdx: idx, cell: getCell(startIdx, idx, sheet),\n                    address: getCellAddress(startIdx, idx), lastCell: idx === modelLen, isHeightCheckNeeded: true,\n                    first: idx !== skipHiddenIdx(sheet, 0, true, 'columns') && idx === _this.parent.viewport.leftIndex ? 'Column' : '',\n                    checkNextBorder: index === modelLen ? 'Column' : '' });\n                refCell ? row.insertBefore(cell, refCell) : row.appendChild(cell);\n                if (index === 0 && cell.previousSibling) {\n                    var borderLeft = _this.parent.getCellStyleValue(['borderLeft'], [rowIdx, skipHiddenIdx(sheet, indexes[indexes.length - 1] + 1, true, 'columns')]).borderLeft;\n                    if (borderLeft !== '') {\n                        prevIdx = skipHiddenIdx(sheet, indexes[0] - 1, false, 'columns');\n                        if (prevIdx > -1 && !_this.parent.getCellStyleValue(['borderRight'], [rowIdx, prevIdx]).borderRight &&\n                            !_this.parent.getCellStyleValue(['borderLeft'], [rowIdx, indexes[0]]).borderLeft) {\n                            cell.previousSibling.style.borderRight = '';\n                        }\n                    }\n                }\n                cellModel = getCell(rowIdx, idx, sheet) || {};\n                if (cellModel.colSpan !== undefined && (cellModel.rowSpan === undefined || cellModel.colSpan > 1)) {\n                    var mergeArgs = { range: [rowIdx, idx, rowIdx, idx], isAction: false, merge: true,\n                        type: 'All', skipChecking: true };\n                    _this.parent.notify(activeCellMergedRange, mergeArgs);\n                    if (!mergeCollection.length || mergeArgs.range[1] !== mergeCollection[mergeCollection.length - 1].range[1]) {\n                        mergeCollection.push(mergeArgs);\n                    }\n                }\n            });\n            startIdx++;\n            rowIdx++;\n        }\n        mergeCollection.forEach(function (mergeArgs) { _this.parent.notify(setMerge, mergeArgs); });\n        this.parent.viewport.rightIndex = skipHiddenIdx(sheet, this.parent.viewport.rightIndex - indexes.length, false, 'columns');\n    };\n    ShowHide.prototype.addEventListener = function () {\n        this.parent.on(hideShow, this.hideShow, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    ShowHide.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    ShowHide.prototype.removeEventListener = function () {\n        this.parent.off(hideShow, this.hideShow);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return ShowHide;\n}());\nexport { ShowHide };\n","import { initiateHyperlink, locale, dialog, click, keyUp, createHyperlinkElement, getUpdateUsingRaf, focus } from '../common/index';\nimport { editHyperlink, removeHyperlink, openHyperlink, editAlert } from '../common/index';\nimport { isNullOrUndefined, closest } from '@syncfusion/ej2-base';\nimport { getRangeIndexes, getCellIndexes, getCellAddress, getRangeAddress } from '../../workbook/common/address';\nimport { getTypeFromFormat, getCell } from '../../workbook/index';\nimport { beforeHyperlinkClick, afterHyperlinkClick } from '../../workbook/common/event';\nimport { isCellReference } from '../../workbook/index';\nimport { Tab, TreeView } from '@syncfusion/ej2-navigations';\n/**\n * `Hyperlink` module\n */\nvar SpreadsheetHyperlink = /** @class */ (function () {\n    /**\n     * Constructor for Hyperlink module.\n     */\n    function SpreadsheetHyperlink(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the Hyperlink module.\n     * @return {void}\n     */\n    SpreadsheetHyperlink.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    SpreadsheetHyperlink.prototype.addEventListener = function () {\n        this.parent.on(initiateHyperlink, this.initiateHyperlinkHandler, this);\n        this.parent.on(editHyperlink, this.editHyperlinkHandler, this);\n        this.parent.on(removeHyperlink, this.removeHyperlinkHandler, this);\n        this.parent.on(openHyperlink, this.openHyperlinkHandler, this);\n        this.parent.on(click, this.hyperlinkClickHandler, this);\n        this.parent.on(createHyperlinkElement, this.createHyperlinkElementHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n    };\n    SpreadsheetHyperlink.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateHyperlink, this.initiateHyperlinkHandler);\n            this.parent.off(editHyperlink, this.editHyperlinkHandler);\n            this.parent.off(removeHyperlink, this.removeHyperlinkHandler);\n            this.parent.off(openHyperlink, this.openHyperlinkHandler);\n            this.parent.off(click, this.hyperlinkClickHandler);\n            this.parent.off(createHyperlinkElement, this.createHyperlinkElementHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    SpreadsheetHyperlink.prototype.getModuleName = function () {\n        return 'spreadsheetHyperlink';\n    };\n    SpreadsheetHyperlink.prototype.keyUpHandler = function (e) {\n        var trgt = e.target;\n        if (closest(trgt, '.e-document')) {\n            var hyperlinkText = document.querySelector('.e-hyp-text');\n            var hyperlinkSpan = this.parent.element.querySelector('.e-hyperlink-alert-span');\n            var dlgElement = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n            var footerEle = dlgElement.getElementsByClassName('e-footer-content')[0];\n            var insertBut = footerEle.firstChild;\n            if (hyperlinkText && hyperlinkText.value) {\n                if (!isCellReference(hyperlinkText.value.toUpperCase())) {\n                    this.showDialog();\n                    insertBut.setAttribute('disabled', 'true');\n                }\n                else if (hyperlinkSpan) {\n                    hyperlinkSpan.remove();\n                    insertBut.removeAttribute('disabled');\n                }\n            }\n        }\n        if (trgt.classList.contains('e-text') && closest(trgt, '.e-cont')) {\n            if (closest(trgt, '.e-webpage') && closest(trgt, '.e-webpage').getElementsByClassName('e-cont')[1] === trgt.parentElement) {\n                var dlgEle = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n                var ftrEle = dlgEle.getElementsByClassName('e-footer-content')[0];\n                var insertBut = ftrEle.firstChild;\n                if (trgt.value !== '') {\n                    insertBut.removeAttribute('disabled');\n                }\n                else {\n                    var linkDialog = closest(trgt, '.e-link-dialog');\n                    var webPage = linkDialog.querySelector('.e-webpage');\n                    var isUrl = webPage.querySelectorAll('.e-cont')[1].querySelector('.e-text').value ? true : false;\n                    if (!isUrl) {\n                        insertBut.setAttribute('disabled', 'true');\n                    }\n                }\n            }\n        }\n    };\n    SpreadsheetHyperlink.prototype.initiateHyperlinkHandler = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected && !sheet.protectSettings.insertLink) {\n            this.parent.notify(editAlert, null);\n            return;\n        }\n        if (!this.parent.element.querySelector('.e-hyperlink-dlg')) {\n            var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n            dialogInst_1.show({\n                width: 323, isModal: true, showCloseIcon: true, cssClass: 'e-hyperlink-dlg',\n                header: l10n.getConstant('InsertLink'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'InsertLinkDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst_1.dialogInstance.content = _this.hyperlinkContent();\n                    dialogInst_1.dialogInstance.dataBind();\n                    focus(_this.parent.element);\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('Insert'), isPrimary: true, disabled: true\n                        },\n                        click: function () {\n                            _this.dlgClickHandler(dialogInst_1);\n                            dialogInst_1.hide();\n                        }\n                    }]\n            });\n        }\n    };\n    SpreadsheetHyperlink.prototype.dlgClickHandler = function (dialogInst) {\n        var value;\n        var address;\n        var spreadsheetInst = this.parent;\n        var item = this.parent.element.querySelector('.e-link-dialog').\n            getElementsByClassName('e-content')[0].querySelector('.e-item.e-active');\n        if (item) {\n            if (item.querySelector('.e-webpage')) {\n                value = item.getElementsByClassName('e-cont')[0].querySelector('.e-text').value;\n                address = item.getElementsByClassName('e-cont')[1].querySelector('.e-text').value;\n                var args = { address: address };\n                this.parent.insertHyperlink(args, this.parent.getActiveSheet().activeCell, value, false);\n            }\n            else {\n                value = item.getElementsByClassName('e-cont')[0].querySelector('.e-text').value;\n                address = item.getElementsByClassName('e-cont')[1].querySelector('.e-text').value;\n                var sheetIdx = void 0;\n                var dlgContent = item.getElementsByClassName('e-cont')[2];\n                if (dlgContent.getElementsByClassName('e-list-item')[0].querySelector('.e-active')) {\n                    var sheetName = item.getElementsByClassName('e-cont')[2].querySelector('.e-active').textContent;\n                    var sheets = spreadsheetInst.sheets;\n                    for (var idx = 0; idx < sheets.length; idx++) {\n                        if (sheets[idx].name === sheetName) {\n                            sheetIdx = idx + 1;\n                        }\n                    }\n                    address = sheetName + '!' + address.toUpperCase();\n                    var args = { address: address };\n                    this.parent.insertHyperlink(args, this.parent.getActiveSheet().activeCell, value, false);\n                }\n                else if (dlgContent.querySelector('.e-active')) {\n                    var definedName = item.getElementsByClassName('e-cont')[2].querySelector('.e-active').textContent;\n                    for (var idx = 0; idx < this.parent.definedNames.length; idx++) {\n                        if (this.parent.definedNames[idx].name === definedName) {\n                            var args = {\n                                address: this.parent.definedNames[idx].name,\n                            };\n                            this.parent.insertHyperlink(args, this.parent.getActiveSheet().activeCell, value, false);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    SpreadsheetHyperlink.prototype.showDialog = function () {\n        if (this.parent.element.querySelector('.e-hyperlink-alert-span')) {\n            this.parent.element.querySelector('.e-hyperlink-alert-span').remove();\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var hyperlinkSpan = this.parent.createElement('span', {\n            className: 'e-hyperlink-alert-span',\n            innerHTML: l10n.getConstant('HyperlinkAlert')\n        });\n        (this.parent.element.querySelector('.e-hyperlink-dlg').querySelector('.e-dlg-content')).appendChild(hyperlinkSpan);\n    };\n    SpreadsheetHyperlink.prototype.editHyperlinkHandler = function () {\n        var _this = this;\n        var isWeb = true;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            width: 323, isModal: true, showCloseIcon: true, cssClass: 'e-edithyperlink-dlg',\n            header: l10n.getConstant('EditLink'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'EditLinkDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                dialogInst.dialogInstance.content = _this.hyperEditContent();\n                dialogInst.dialogInstance.dataBind();\n                focus(_this.parent.element);\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Update'), isPrimary: true\n                    },\n                    click: function () {\n                        _this.dlgClickHandler(dialogInst);\n                        dialogInst.hide();\n                    }\n                }]\n        });\n    };\n    SpreadsheetHyperlink.prototype.openHyperlinkHandler = function () {\n        var cellIndexes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var trgt = this.parent.getCell(cellIndexes[0], cellIndexes[1]);\n        if (trgt.getElementsByClassName('e-hyperlink')[0]) {\n            trgt = trgt.querySelector('.e-hyperlink');\n        }\n        this.hlOpenHandler(trgt);\n    };\n    SpreadsheetHyperlink.prototype.removeHyperlinkHandler = function (cell) {\n        this.parent.removeHyperlink(cell);\n    };\n    // tslint:disable-next-line:max-func-body-length\n    SpreadsheetHyperlink.prototype.hlOpenHandler = function (trgt) {\n        var _this = this;\n        if (trgt.classList.contains('e-hyperlink')) {\n            var range = ['', ''];\n            var selRange = void 0;\n            var rangeIndexes = void 0;\n            var isEmpty = true;\n            trgt.style.color = '#551A8B';\n            var sheet = this.parent.getActiveSheet();\n            var colIdx = parseInt(trgt.parentElement.getAttribute('aria-colindex'), 10) - 1;\n            var rowIdx = parseInt(trgt.parentElement.parentElement.getAttribute('aria-rowindex'), 10) - 1;\n            var rangeAddr = sheet.rows[rowIdx].cells[colIdx].hyperlink;\n            var address = void 0;\n            var befArgs = void 0;\n            var aftArgs = void 0;\n            befArgs = { hyperlink: rangeAddr, cell: this.parent.getActiveSheet().activeCell, target: '_blank', cancel: false };\n            this.parent.trigger(beforeHyperlinkClick, befArgs);\n            if (befArgs.cancel) {\n                return;\n            }\n            rangeAddr = befArgs.hyperlink;\n            aftArgs = { hyperlink: rangeAddr, cell: this.parent.getActiveSheet().activeCell };\n            if (typeof (rangeAddr) === 'string') {\n                address = rangeAddr;\n            }\n            if (typeof (rangeAddr) === 'object') {\n                address = rangeAddr.address;\n            }\n            var definedNameCheck = address;\n            if (address.indexOf('http://') === -1 && address.indexOf('https://') === -1 && address.indexOf('ftp://') === -1) {\n                if (!isNullOrUndefined(address)) {\n                    if (this.parent.definedNames) {\n                        for (var idx = 0; idx < this.parent.definedNames.length; idx++) {\n                            if (this.parent.definedNames[idx].name === address) {\n                                address = this.parent.definedNames[idx].refersTo;\n                                address = address.slice(1);\n                                break;\n                            }\n                        }\n                    }\n                    if (address.indexOf('!') !== -1) {\n                        range = address.split('!');\n                        if (range[0].indexOf(' ') !== -1) {\n                            range[0] = range[0].slice(1, range[0].length - 1);\n                        }\n                    }\n                    else {\n                        range[0] = this.parent.getActiveSheet().name;\n                        range[1] = address;\n                    }\n                    selRange = range[1];\n                    var sheetIdx_1;\n                    for (var idx = 0; idx < this.parent.sheets.length; idx++) {\n                        if (this.parent.sheets[idx].name === range[0]) {\n                            sheetIdx_1 = idx;\n                        }\n                    }\n                    sheet = this.parent.sheets[sheetIdx_1];\n                    if (range[1].indexOf(':') !== -1) {\n                        var colIndex = range[1].indexOf(':');\n                        var left = range[1].substr(0, colIndex);\n                        var right = range[1].substr(colIndex + 1, range[1].length);\n                        left = left.replace('$', '');\n                        right = right.replace('$', '');\n                        if (right.match(/\\D/g) && !right.match(/[0-9]/g) && left.match(/\\D/g) && !left.match(/[0-9]/g)) {\n                            selRange = left + '1' + ':' + right + sheet.rowCount;\n                            left = left + '1';\n                            right = right + sheet.rowCount;\n                            range[1] = left + ':' + right;\n                        }\n                        else if (!right.match(/\\D/g) && right.match(/[0-9]/g) && !left.match(/\\D/g) && left.match(/[0-9]/g)) {\n                            selRange = getCellAddress(parseInt(left, 10) - 1, 0) + ':' +\n                                getCellAddress(parseInt(right, 10) - 1, sheet.colCount - 1);\n                            rangeIndexes = [parseInt(left, 10) - 1, 0, parseInt(right, 10) - 1, sheet.colCount - 1];\n                            isEmpty = false;\n                        }\n                    }\n                    var isDefinedNamed = void 0;\n                    var definedname = this.parent.definedNames;\n                    if (!isNullOrUndefined(definedname)) {\n                        for (var idx = 0; idx < definedname.length; idx++) {\n                            if (definedname[idx].name === definedNameCheck) {\n                                isDefinedNamed = true;\n                                break;\n                            }\n                        }\n                    }\n                    if (isCellReference(range[1]) || isDefinedNamed) {\n                        rangeIndexes = isEmpty ? getRangeIndexes(range[1]) : rangeIndexes;\n                        if (this.parent.scrollSettings.enableVirtualization) {\n                            rangeIndexes[0] = rangeIndexes[0] >= this.parent.viewport.topIndex ?\n                                rangeIndexes[0] - this.parent.viewport.topIndex : rangeIndexes[0];\n                            rangeIndexes[1] = rangeIndexes[1] >= this.parent.viewport.leftIndex ?\n                                rangeIndexes[1] - this.parent.viewport.leftIndex : rangeIndexes[1];\n                        }\n                        if (!isNullOrUndefined(sheet)) {\n                            var rangeAddr_1 = getRangeAddress(rangeIndexes);\n                            if (sheet === this.parent.getActiveSheet()) {\n                                getUpdateUsingRaf(function () { _this.parent.goTo(rangeAddr_1); });\n                            }\n                            else {\n                                if (rangeAddr_1.indexOf(':') >= 0) {\n                                    var addArr = rangeAddr_1.split(':');\n                                    rangeAddr_1 = addArr[0] === addArr[1] ? addArr[0] : rangeAddr_1;\n                                }\n                                getUpdateUsingRaf(function () { _this.parent.goTo(_this.parent.sheets[sheetIdx_1].name + '!' + rangeAddr_1); });\n                            }\n                        }\n                    }\n                }\n            }\n            else {\n                trgt.setAttribute('target', befArgs.target);\n            }\n            this.parent.trigger(afterHyperlinkClick, aftArgs);\n        }\n    };\n    SpreadsheetHyperlink.prototype.hyperlinkClickHandler = function (e) {\n        var trgt = e.target;\n        if (closest(trgt, '.e-link-dialog') && closest(trgt, '.e-toolbar-item')) {\n            var dlgEle = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n            var ftrEle = dlgEle.getElementsByClassName('e-footer-content')[0];\n            var insertBut = ftrEle.firstChild;\n            var docEle = dlgEle.querySelector('.e-document');\n            var webEle = dlgEle.querySelector('.e-webpage');\n            var webEleText = webEle ? webEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value :\n                docEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value;\n            var docEleText = docEle ? docEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value :\n                webEleText;\n            var toolbarItems = closest(trgt, '.e-toolbar-items');\n            if (toolbarItems.getElementsByClassName('e-toolbar-item')[1].classList.contains('e-active')) {\n                var actEle = docEle.querySelectorAll('.e-cont')[2].querySelector('.e-active');\n                docEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value = webEleText;\n                if (closest(actEle, '.e-list-item').classList.contains('e-level-2') && insertBut.hasAttribute('disabled')) {\n                    insertBut.removeAttribute('disabled');\n                }\n                else if (closest(actEle, '.e-list-item').classList.contains('e-level-1') && !insertBut.hasAttribute('disabled')) {\n                    insertBut.setAttribute('disabled', 'true');\n                }\n            }\n            else {\n                var isEmpty = webEle.querySelectorAll('.e-cont')[1].querySelector('.e-text').value ? false : true;\n                webEle.querySelectorAll('.e-cont')[0].querySelector('.e-text').value = docEleText;\n                if (isEmpty && !insertBut.hasAttribute('disabled')) {\n                    insertBut.setAttribute('disabled', 'true');\n                }\n                else if (!isEmpty && insertBut.hasAttribute('disabled')) {\n                    insertBut.removeAttribute('disabled');\n                }\n            }\n        }\n        if (closest(trgt, '.e-list-item') && trgt.classList.contains('e-fullrow')) {\n            var item = this.parent.element.getElementsByClassName('e-link-dialog')[0].\n                getElementsByClassName('e-content')[0].getElementsByClassName('e-active')[0];\n            var cellRef = item.getElementsByClassName('e-cont')[1].getElementsByClassName('e-text')[0];\n            var dlgEle = closest(trgt, '.e-hyperlink-dlg') || closest(trgt, '.e-edithyperlink-dlg');\n            var ftrEle = dlgEle.getElementsByClassName('e-footer-content')[0];\n            var insertBut = ftrEle.firstChild;\n            if (closest(trgt, '.e-list-item').classList.contains('e-level-2')) {\n                if (closest(trgt, '.e-list-item').getAttribute('data-uid') === 'defName') {\n                    if (!cellRef.classList.contains('e-disabled') && !cellRef.hasAttribute('readonly')) {\n                        cellRef.setAttribute('readonly', 'true');\n                        cellRef.classList.add('e-disabled');\n                        cellRef.setAttribute('disabled', 'true');\n                    }\n                }\n                else if (closest(trgt, '.e-list-item').getAttribute('data-uid') === 'sheet') {\n                    if (cellRef.classList.contains('e-disabled') && cellRef.hasAttribute('readonly')) {\n                        cellRef.removeAttribute('readonly');\n                        cellRef.classList.remove('e-disabled');\n                        cellRef.removeAttribute('disabled');\n                    }\n                }\n                if (insertBut.hasAttribute('disabled')) {\n                    insertBut.removeAttribute('disabled');\n                }\n            }\n            else if (closest(trgt, '.e-list-item').classList.contains('e-level-1')) {\n                insertBut.setAttribute('disabled', 'true');\n            }\n        }\n        else {\n            this.hlOpenHandler(trgt);\n        }\n    };\n    SpreadsheetHyperlink.prototype.createHyperlinkElementHandler = function (args) {\n        var cell = args.cell;\n        var td = args.td;\n        var rowIdx = args.rowIdx;\n        var colIdx = args.colIdx;\n        var hyperEle = this.parent.createElement('a', { className: 'e-hyperlink e-hyperlink-style' });\n        if (!isNullOrUndefined(cell.hyperlink)) {\n            var hyperlink = cell.hyperlink;\n            if (typeof (hyperlink) === 'string') {\n                if (hyperlink.indexOf('http://') === -1 && hyperlink.indexOf('https://') === -1 &&\n                    hyperlink.indexOf('ftp://') === -1 && hyperlink.indexOf('www.') !== -1) {\n                    hyperlink = 'http://' + hyperlink;\n                }\n                if (hyperlink.indexOf('http://') === 0 || hyperlink.indexOf('https://') === 0 || hyperlink.indexOf('ftp://') === 0) {\n                    hyperEle.setAttribute('href', hyperlink);\n                    hyperEle.setAttribute('target', '_blank');\n                }\n                else if (hyperlink.includes('=') || hyperlink.includes('!')) {\n                    hyperEle.setAttribute('ref', hyperlink);\n                }\n                hyperEle.innerText = td.innerText !== '' ? td.innerText : hyperlink;\n                td.textContent = '';\n                td.innerText = '';\n                td.appendChild(hyperEle);\n            }\n            else if (typeof (hyperlink) === 'object') {\n                if (hyperlink.address.indexOf('http://') === 0 || hyperlink.address.indexOf('https://') === 0 ||\n                    hyperlink.address.indexOf('ftp://') === 0) {\n                    hyperEle.setAttribute('href', hyperlink.address);\n                    hyperEle.setAttribute('target', '_blank');\n                }\n                else if (hyperlink.address.includes('=') || hyperlink.address.includes('!')) {\n                    hyperEle.setAttribute('ref', hyperlink.address);\n                }\n                if (getTypeFromFormat(cell.format) === 'Accounting') {\n                    hyperEle.innerHTML = td.innerHTML;\n                }\n                else {\n                    hyperEle.innerText = td.innerText !== '' ? td.innerText : hyperlink.address;\n                }\n                td.textContent = '';\n                td.innerText = '';\n                td.appendChild(hyperEle);\n            }\n        }\n        else if (td.querySelector('a') && cell.hyperlink) {\n            if (typeof (cell.hyperlink) === 'string') {\n                td.querySelector('a').setAttribute('href', cell.hyperlink);\n            }\n        }\n    };\n    SpreadsheetHyperlink.prototype.hyperEditContent = function () {\n        var isWeb = true;\n        var dialog = this.hyperlinkContent();\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var cell = this.parent.sheets[this.parent.getActiveSheet().id - 1].rows[indexes[0]].cells[indexes[1]];\n        if (this.parent.scrollSettings.enableVirtualization) {\n            indexes[0] = indexes[0] - this.parent.viewport.topIndex;\n            indexes[1] = indexes[1] - this.parent.viewport.leftIndex;\n        }\n        var value = this.parent.getDisplayText(cell);\n        var address;\n        var hyperlink = cell.hyperlink;\n        if (typeof (hyperlink) === 'string') {\n            address = hyperlink;\n            value = value || address;\n            if (address.indexOf('http://') === -1 && address.indexOf('https://') === -1 && address.indexOf('ftp://') === -1) {\n                isWeb = false;\n            }\n        }\n        else if (typeof (hyperlink) === 'object') {\n            address = hyperlink.address;\n            value = value || address;\n            if (address.indexOf('http://') === -1 && address.indexOf('https://') === -1 && address.indexOf('ftp://') === -1) {\n                isWeb = false;\n            }\n        }\n        var item = dialog.querySelector('.e-content');\n        if (isWeb) {\n            var webContElem = item.querySelector('.e-webpage');\n            webContElem.getElementsByClassName('e-cont')[0].getElementsByClassName('e-text')[0].setAttribute('value', value);\n            if (typeof (hyperlink) === 'string') {\n                webContElem.getElementsByClassName('e-cont')[1].querySelector('.e-text').setAttribute('value', hyperlink);\n            }\n            else {\n                var address_1;\n                address_1 = webContElem.getElementsByClassName('e-cont')[1].querySelector('.e-text');\n                address_1.setAttribute('value', hyperlink.address);\n            }\n        }\n        else {\n            var isDefinedNamed = void 0;\n            var docContElem = item.querySelector('.e-document');\n            docContElem.getElementsByClassName('e-cont')[0].getElementsByClassName('e-text')[0].setAttribute('value', value);\n            var rangeArr = void 0;\n            var sheet = this.parent.getActiveSheet();\n            var sheetIdx = void 0;\n            if (this.parent.definedNames) {\n                for (var idx = 0; idx < this.parent.definedNames.length; idx++) {\n                    if (this.parent.definedNames[idx].name === address) {\n                        isDefinedNamed = true;\n                        break;\n                    }\n                }\n            }\n            if (isDefinedNamed) {\n                var cellRef = void 0;\n                cellRef = docContElem.getElementsByClassName('e-cont')[1].getElementsByClassName('e-text')[0];\n                cellRef.setAttribute('readonly', 'true');\n                cellRef.classList.add('e-disabled');\n                cellRef.setAttribute('disabled', 'true');\n                var treeCont = docContElem.getElementsByClassName('e-cont')[2];\n                var listEle = treeCont.querySelectorAll('.e-list-item.e-level-1')[1];\n                for (var idx = 0; idx < listEle.getElementsByTagName('li').length; idx++) {\n                    if (listEle.getElementsByTagName('li')[idx].innerText === address) {\n                        listEle.getElementsByTagName('li')[idx].classList.add('e-active');\n                    }\n                }\n            }\n            else {\n                if (address && address.indexOf('!') !== -1) {\n                    rangeArr = address.split('!');\n                    sheetIdx = parseInt(rangeArr[0].replace(/\\D/g, ''), 10) - 1;\n                    sheet = this.parent.sheets[sheetIdx];\n                }\n                var sheetName = rangeArr[0];\n                docContElem.getElementsByClassName('e-cont')[1].querySelector('.e-text').setAttribute('value', rangeArr[1]);\n                var treeCont = docContElem.getElementsByClassName('e-cont')[2];\n                var listEle = treeCont.querySelectorAll('.e-list-item.e-level-1')[0];\n                for (var idx = 0; idx < listEle.getElementsByTagName('li').length; idx++) {\n                    if (listEle.getElementsByTagName('li')[idx].innerText === sheetName) {\n                        if (listEle.getElementsByTagName('li')[idx].classList.contains('e-active')) {\n                            break;\n                        }\n                        else {\n                            listEle.getElementsByTagName('li')[idx].classList.add('e-active');\n                        }\n                    }\n                    else {\n                        if (listEle.getElementsByTagName('li')[idx].classList.contains('e-active')) {\n                            listEle.getElementsByTagName('li')[idx].classList.remove('e-active');\n                        }\n                    }\n                }\n            }\n        }\n        return dialog;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    SpreadsheetHyperlink.prototype.hyperlinkContent = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var idx = 0;\n        var selIdx = 0;\n        var isWeb = true;\n        var isDefinedName;\n        var isCellRef = true;\n        var address;\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(indexes[0], indexes[1], sheet);\n        var isEnable = true;\n        if (cell) {\n            if ((cell.value && typeof (cell.value) === 'string' && cell.value.match('[A-Za-z]+') !== null) ||\n                cell.value === '' || isNullOrUndefined(cell.value)) {\n                isEnable = true;\n            }\n            else {\n                isEnable = false;\n            }\n            var hyperlink = cell.hyperlink;\n            if (typeof (hyperlink) === 'string') {\n                var hl = hyperlink;\n                if (hl.indexOf('http://') === -1 && hl.indexOf('https://') === -1 && hl.indexOf('ftp://') === -1) {\n                    address = hyperlink;\n                    isWeb = false;\n                }\n            }\n            else if (typeof (hyperlink) === 'object') {\n                var hl = hyperlink.address;\n                if (hl.indexOf('http://') === -1 && hl.indexOf('https://') === -1 && hl.indexOf('ftp://') === -1) {\n                    address = hyperlink.address;\n                    isWeb = false;\n                }\n            }\n            if (isWeb) {\n                selIdx = 0;\n            }\n            else {\n                selIdx = 1;\n            }\n            if (this.parent.definedNames) {\n                for (var idx_1 = 0; idx_1 < this.parent.definedNames.length; idx_1++) {\n                    if (this.parent.definedNames[idx_1].name === address) {\n                        isDefinedName = true;\n                        isCellRef = false;\n                        break;\n                    }\n                }\n            }\n        }\n        var dialogElem = this.parent.createElement('div', { className: 'e-link-dialog' });\n        var webContElem = this.parent.createElement('div', { className: 'e-webpage' });\n        var docContElem = this.parent.createElement('div', { className: 'e-document' });\n        var headerTabs = new Tab({\n            selectedItem: selIdx,\n            items: [\n                {\n                    header: { 'text': l10n.getConstant('WebPage') },\n                    content: webContElem\n                },\n                {\n                    header: { 'text': l10n.getConstant('ThisDocument') },\n                    content: docContElem\n                },\n            ]\n        });\n        headerTabs.appendTo(dialogElem);\n        if (isWeb) {\n            dialogElem.querySelector('.e-toolbar-items').querySelector('.e-indicator').setAttribute('style', 'left: 0; right: 136px');\n        }\n        else {\n            dialogElem.querySelector('.e-toolbar-items').querySelector('.e-indicator').setAttribute('style', 'left: 136px; right: 0');\n        }\n        var textCont = this.parent.createElement('div', { className: 'e-cont' });\n        var urlCont = this.parent.createElement('div', { className: 'e-cont' });\n        var textH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('DisplayText') });\n        var urlH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('Url') });\n        var textInput = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'Text' }, });\n        if (!isEnable) {\n            textInput.classList.add('e-disabled');\n            textInput.setAttribute('readonly', 'true');\n            textInput.setAttribute('disabled', 'true');\n        }\n        if (cell && isNullOrUndefined(cell.hyperlink)) {\n            textInput.setAttribute('value', this.parent.getDisplayText(cell));\n        }\n        var urlInput = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'Text' } });\n        textInput.setAttribute('placeholder', l10n.getConstant('EnterTheTextToDisplay'));\n        urlInput.setAttribute('placeholder', l10n.getConstant('EnterTheUrl'));\n        textCont.appendChild(textInput);\n        textCont.insertBefore(textH, textInput);\n        urlCont.appendChild(urlInput);\n        urlCont.insertBefore(urlH, urlInput);\n        webContElem.appendChild(urlCont);\n        webContElem.insertBefore(textCont, urlCont);\n        var cellRef = [];\n        var definedName = [];\n        var sheets = this.parent.sheets;\n        for (idx; idx < this.parent.sheets.length; idx++) {\n            var sheetName = this.parent.sheets[idx].name;\n            if (sheets[idx] === this.parent.getActiveSheet()) {\n                cellRef.push({\n                    nodeId: 'sheet',\n                    nodeText: sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName,\n                    selected: true\n                });\n            }\n            else {\n                cellRef.push({\n                    nodeId: 'sheet',\n                    nodeText: sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName\n                });\n            }\n        }\n        for (idx = 0; idx < this.parent.definedNames.length; idx++) {\n            definedName.push({\n                nodeId: 'defName',\n                nodeText: this.parent.definedNames[idx].name\n            });\n        }\n        var data = [\n            {\n                nodeId: '01', nodeText: l10n.getConstant('CellReference'), expanded: isCellRef,\n                nodeChild: cellRef\n            },\n            {\n                nodeId: '02', nodeText: l10n.getConstant('DefinedNames'), expanded: isDefinedName,\n                nodeChild: definedName\n            },\n        ];\n        var treeObj = new TreeView({\n            fields: { dataSource: data, id: 'nodeId', text: 'nodeText', child: 'nodeChild' }\n        });\n        var cellrefCont = this.parent.createElement('div', { className: 'e-cont' });\n        var cellrefH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('CellReference') });\n        var cellrefInput = this.parent.createElement('input', {\n            className: 'e-input e-text e-hyp-text',\n            attrs: { 'type': 'Text' }\n        });\n        cellrefInput.setAttribute('value', 'A1');\n        cellrefCont.appendChild(cellrefInput);\n        cellrefCont.insertBefore(cellrefH, cellrefInput);\n        var textCont1 = this.parent.createElement('div', { className: 'e-cont' });\n        var textH1 = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('DisplayText') });\n        var textInput1 = this.parent.createElement('input', { className: 'e-input e-text', attrs: { 'type': 'Text' } });\n        if (!isEnable) {\n            textInput1.classList.add('e-disabled');\n            textInput1.setAttribute('readonly', 'true');\n            textInput1.setAttribute('disabled', 'true');\n        }\n        if (cell && isNullOrUndefined(cell.hyperlink)) {\n            textInput1.setAttribute('value', this.parent.getDisplayText(cell));\n        }\n        textInput1.setAttribute('placeholder', l10n.getConstant('EnterTheTextToDisplay'));\n        textCont1.appendChild(textInput1);\n        textCont1.insertBefore(textH1, textInput1);\n        var sheetCont = this.parent.createElement('div', { className: 'e-cont' });\n        var sheetH = this.parent.createElement('div', { className: 'e-header', innerHTML: l10n.getConstant('Sheet') });\n        var refCont = this.parent.createElement('div', { className: 'e-refcont' });\n        sheetCont.appendChild(refCont);\n        sheetCont.insertBefore(sheetH, refCont);\n        docContElem.appendChild(cellrefCont);\n        docContElem.insertBefore(textCont1, cellrefCont);\n        treeObj.appendTo(refCont);\n        docContElem.appendChild(sheetCont);\n        return dialogElem;\n    };\n    return SpreadsheetHyperlink;\n}());\nexport { SpreadsheetHyperlink };\n","import { locale, deleteImage, createImageElement } from '../../spreadsheet/index';\nimport { performUndoRedo, updateUndoRedoCollection, enableToolbarItems, completeAction } from '../common/index';\nimport { setActionData, getBeforeActionData, updateAction, initiateFilterUI } from '../common/index';\nimport { setUndoRedo } from '../common/index';\nimport { selectRange, clearUndoRedoCollection, setMaxHgt, getMaxHgt, setRowEleHeight } from '../common/index';\nimport { getRangeFromAddress, getRangeIndexes, getSheet, workbookEditOperation } from '../../workbook/index';\nimport { getCell, setCell, getSheetIndex, wrapEvent, getSheetIndexFromId } from '../../workbook/index';\nimport { setMerge, getRangeAddress, getSwapRange } from '../../workbook/index';\nimport { addClass } from '@syncfusion/ej2-base';\nimport { getFilteredCollection, setCellFormat } from '../../workbook/index';\n/**\n * UndoRedo module allows to perform undo redo functionalities.\n */\nvar UndoRedo = /** @class */ (function () {\n    function UndoRedo(parent) {\n        this.undoCollection = [];\n        this.redoCollection = [];\n        this.isUndo = false;\n        this.undoRedoStep = 100;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    UndoRedo.prototype.setActionData = function (options) {\n        var sheet = this.parent.getActiveSheet();\n        var address;\n        var cells = [];\n        var cutCellDetails = [];\n        var args = options.args;\n        var eventArgs = args.eventArgs;\n        switch (args.action) {\n            case 'format':\n                address = getRangeIndexes(args.eventArgs.range);\n                break;\n            case 'clipboard':\n                var copiedInfo = eventArgs.copiedInfo;\n                address = getRangeIndexes(getRangeFromAddress(eventArgs.pastedRange));\n                if (copiedInfo.isCut) {\n                    cutCellDetails = this.getCellDetails(copiedInfo.range, getSheet(this.parent, getSheetIndexFromId(this.parent, copiedInfo.sId)));\n                }\n                break;\n            case 'beforeSort':\n                address = getRangeIndexes(args.eventArgs.range);\n                if (address[0] === address[2] && (address[2] - address[0]) === 0) { //if selected range is a single cell \n                    address[0] = 0;\n                    address[1] = 0;\n                    address[2] = sheet.usedRange.rowIndex;\n                    address[3] = sheet.usedRange.colIndex;\n                }\n                break;\n            case 'beforeCellSave':\n            case 'cellDelete':\n                address = getRangeIndexes(eventArgs.address);\n                break;\n            case 'beforeWrap':\n                address = this.parent.getAddressInfo(eventArgs.address).indices;\n                break;\n            case 'beforeReplace':\n                address = this.parent.getAddressInfo(eventArgs.address).indices;\n                break;\n            case 'beforeClear':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n            case 'beforeInsertImage':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n            case 'beforeInsertChart':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n            case 'filter':\n                address = getRangeIndexes(eventArgs.range);\n                break;\n        }\n        cells = this.getCellDetails(address, sheet);\n        this.beforeActionData = { cellDetails: cells, cutCellDetails: cutCellDetails };\n    };\n    UndoRedo.prototype.getBeforeActionData = function (args) {\n        args.beforeDetails = this.beforeActionData;\n    };\n    UndoRedo.prototype.performUndoRedo = function (args) {\n        var undoRedoArgs = args.isUndo ? this.undoCollection.pop() : this.redoCollection.pop();\n        this.isUndo = args.isUndo;\n        if (undoRedoArgs) {\n            switch (undoRedoArgs.action) {\n                case 'cellSave':\n                case 'format':\n                case 'sorting':\n                case 'wrap':\n                case 'cellDelete':\n                    undoRedoArgs = this.performOperation(undoRedoArgs);\n                    break;\n                case 'clipboard':\n                    undoRedoArgs = this.undoForClipboard(undoRedoArgs);\n                    break;\n                case 'resize':\n                    undoRedoArgs = this.undoForResize(undoRedoArgs);\n                    break;\n                case 'hideShow':\n                    undoRedoArgs.eventArgs.hide = !undoRedoArgs.eventArgs.hide;\n                    updateAction(undoRedoArgs, this.parent);\n                    break;\n                case 'replace':\n                    undoRedoArgs = this.performOperation(undoRedoArgs);\n                    break;\n                case 'insert':\n                case 'filter':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'delete':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'validation':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'merge':\n                    undoRedoArgs.eventArgs.merge = !undoRedoArgs.eventArgs.merge;\n                    updateAction(undoRedoArgs, this.parent);\n                    break;\n                case 'clear':\n                    undoRedoArgs = this.performOperation(undoRedoArgs);\n                    break;\n                case 'conditionalFormat':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'clearCF':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'insertImage':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'imageRefresh':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'insertChart':\n                case 'deleteChart':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n                case 'chartRefresh':\n                    updateAction(undoRedoArgs, this.parent, !args.isUndo);\n                    break;\n            }\n            args.isUndo ? this.redoCollection.push(undoRedoArgs) : this.undoCollection.push(undoRedoArgs);\n            if (this.undoCollection.length > this.undoRedoStep) {\n                this.undoCollection.splice(0, 1);\n            }\n            if (this.redoCollection.length > this.undoRedoStep) {\n                this.redoCollection.splice(0, 1);\n            }\n            this.updateUndoRedoIcons();\n            var completeArgs = Object.assign({}, undoRedoArgs.eventArgs);\n            completeArgs.requestType = args.isUndo ? 'undo' : 'redo';\n            delete completeArgs.beforeActionData;\n            if (!args.isPublic) {\n                this.parent.notify(completeAction, { eventArgs: completeArgs, action: 'undoRedo' });\n            }\n        }\n    };\n    UndoRedo.prototype.updateUndoRedoCollection = function (options) {\n        var actionList = ['clipboard', 'format', 'sorting', 'cellSave', 'resize', 'resizeToFit', 'wrap', 'hideShow', 'replace',\n            'validation', 'merge', 'clear', 'conditionalFormat', 'clearCF', 'insertImage', 'imageRefresh', 'insertChart', 'deleteChart',\n            'chartRefresh', 'filter', 'cellDelete'];\n        if ((options.args.action === 'insert' || options.args.action === 'delete') && options.args.eventArgs.modelType !== 'Sheet') {\n            actionList.push(options.args.action);\n        }\n        var action = options.args.action;\n        if (actionList.indexOf(action) === -1 && !options.isPublic) {\n            return;\n        }\n        var eventArgs = options.args.eventArgs;\n        if (action === 'clipboard' || action === 'sorting' || action === 'format' || action === 'cellSave' ||\n            action === 'wrap' || action === 'replace' || action === 'validation' || action === 'clear' || action === 'conditionalFormat' ||\n            action === 'clearCF' || action === 'insertImage' || action === 'imageRefresh' || action === 'insertChart' ||\n            action === 'chartRefresh' || action === 'filter' || action === 'cellDelete') {\n            var beforeActionDetails = { beforeDetails: { cellDetails: [] } };\n            this.parent.notify(getBeforeActionData, beforeActionDetails);\n            eventArgs.beforeActionData = beforeActionDetails.beforeDetails;\n        }\n        this.undoCollection.push(options.args);\n        this.redoCollection = [];\n        if (this.undoCollection.length > this.undoRedoStep) {\n            this.undoCollection.splice(0, 1);\n        }\n        this.updateUndoRedoIcons();\n    };\n    UndoRedo.prototype.clearUndoRedoCollection = function () {\n        this.undoCollection = [];\n        this.redoCollection = [];\n        this.updateUndoRedoIcons();\n    };\n    UndoRedo.prototype.updateUndoRedoIcons = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.parent.notify(enableToolbarItems, [{\n                tab: l10n.getConstant('Home'), items: [this.parent.element.id + '_undo'],\n                enable: this.undoCollection.length > 0\n            }]);\n        this.parent.notify(enableToolbarItems, [{\n                tab: l10n.getConstant('Home'), items: [this.parent.element.id + '_redo'],\n                enable: this.redoCollection.length > 0\n            }]);\n    };\n    UndoRedo.prototype.undoForClipboard = function (args) {\n        var _this = this;\n        var eventArgs = args.eventArgs;\n        var address = eventArgs.pastedRange.split('!');\n        var range = getRangeIndexes(address[1]);\n        var sheetIndex = getSheetIndex(this.parent, address[0]);\n        var sheet = getSheet(this.parent, sheetIndex);\n        var copiedInfo = eventArgs.copiedInfo;\n        var actionData = eventArgs.beforeActionData;\n        var isRefresh = this.checkRefreshNeeded(sheetIndex);\n        var pictureElem;\n        if (args.eventArgs.requestType === 'imagePaste') {\n            var copiedShapeInfo = eventArgs.copiedShapeInfo;\n            if (this.isUndo) {\n                pictureElem = copiedShapeInfo.pictureElem;\n                if (copiedShapeInfo.isCut) {\n                    this.parent.notify(deleteImage, {\n                        id: pictureElem.id, sheetIdx: eventArgs.pasteSheetIndex + 1\n                    });\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            data: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: copiedShapeInfo.height, width: copiedShapeInfo.width, imageId: pictureElem.id\n                        },\n                        range: copiedShapeInfo.copiedRange, isPublic: false, isUndoRedo: true\n                    });\n                }\n                else {\n                    this.parent.notify(deleteImage, {\n                        id: eventArgs.pastedPictureElement.id, sheetIdx: eventArgs.pasteSheetIndex + 1\n                    });\n                }\n            }\n            else {\n                if (copiedShapeInfo.isCut) {\n                    pictureElem = copiedShapeInfo.pictureElem;\n                    this.parent.notify(deleteImage, {\n                        id: pictureElem.id, sheetIdx: copiedShapeInfo.sId\n                    });\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            data: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: copiedShapeInfo.height, width: copiedShapeInfo.width, imageId: pictureElem.id\n                        },\n                        range: copiedShapeInfo.pastedRange, isPublic: false, isUndoRedo: true\n                    });\n                }\n                else {\n                    pictureElem = eventArgs.pastedPictureElement;\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            data: pictureElem.style.backgroundImage.replace(/url\\((['\"])?(.*?)\\1\\)/gi, '$2'),\n                            height: pictureElem.offsetHeight, width: pictureElem.offsetWidth, imageId: pictureElem.id\n                        },\n                        range: copiedShapeInfo.pastedRange, isPublic: false, isUndoRedo: true\n                    });\n                }\n            }\n        }\n        else {\n            if (this.isUndo) {\n                if (copiedInfo.isCut) {\n                    var cells = actionData.cutCellDetails;\n                    this.updateCellDetails(cells, getSheet(this.parent, getSheetIndexFromId(this.parent, copiedInfo.sId)), getSwapRange(copiedInfo.range), isRefresh);\n                    this.parent.notify(getFilteredCollection, null);\n                    for (var i = 0; i < this.parent.sheets.length; i++) {\n                        var sheetIndex_1 = getSheetIndexFromId(this.parent, copiedInfo.sId);\n                        if (this.parent.filterCollection && this.parent.filterCollection[i] &&\n                            this.parent.filterCollection[i].sheetIdx === eventArgs.pasteSheetIndex) {\n                            var filterCol = this.parent.filterCollection[i];\n                            var fRange = getRangeIndexes(filterCol.filterRange);\n                            var pRange = getSwapRange(range);\n                            if (fRange[0] >= pRange[0] && fRange[2] <= pRange[2]) {\n                                this.parent.notify(initiateFilterUI, {\n                                    predicates: null, range: filterCol.filterRange,\n                                    sIdx: eventArgs.pasteSheetIndex, isCut: true\n                                });\n                                var diff = [Math.abs(pRange[0] - fRange[0]), Math.abs(pRange[1] - fRange[1]),\n                                    Math.abs(pRange[2] - fRange[2]), Math.abs(pRange[3] - fRange[3])];\n                                var copiedRange = getSwapRange(copiedInfo.range);\n                                diff = [copiedRange[0] + diff[0], copiedRange[1] + diff[1],\n                                    Math.abs(copiedRange[2] - diff[2]), Math.abs(copiedRange[3] - diff[3])];\n                                this.parent.notify(initiateFilterUI, {\n                                    predicates: null,\n                                    range: getRangeAddress(diff), sIdx: sheetIndex_1, isCut: true\n                                });\n                            }\n                        }\n                    }\n                }\n                this.updateCellDetails(actionData.cellDetails, sheet, range, isRefresh);\n                setMaxHgt(sheet, range[0], range[1], 20);\n                var hgt = getMaxHgt(sheet, range[0]);\n                setRowEleHeight(this.parent, sheet, hgt, range[0]);\n                eventArgs.mergeCollection.forEach(function (mergeArgs) {\n                    mergeArgs.merge = !mergeArgs.merge;\n                    _this.parent.notify(setMerge, mergeArgs);\n                    mergeArgs.merge = !mergeArgs.merge;\n                });\n            }\n            else {\n                updateAction(args, this.parent, copiedInfo.isCut);\n            }\n            if (isRefresh) {\n                this.parent.notify(selectRange, { indexes: range });\n            }\n        }\n        return args;\n    };\n    UndoRedo.prototype.undoForResize = function (args) {\n        var eventArgs = args.eventArgs;\n        if (eventArgs.hide === undefined) {\n            if (eventArgs.isCol) {\n                var temp = eventArgs.oldWidth;\n                eventArgs.oldWidth = eventArgs.width;\n                eventArgs.width = temp;\n            }\n            else {\n                var temp = eventArgs.oldHeight;\n                eventArgs.oldHeight = eventArgs.height;\n                eventArgs.height = temp;\n            }\n        }\n        else {\n            eventArgs.hide = !eventArgs.hide;\n        }\n        updateAction(args, this.parent);\n        return args;\n    };\n    UndoRedo.prototype.performOperation = function (args) {\n        var eventArgs = args.eventArgs;\n        var address = (args.action === 'cellSave' || args.action === 'wrap' || args.action === 'replace'\n            || args.action === 'cellDelete') ? eventArgs.address.split('!') : eventArgs.range.split('!');\n        var range = getRangeIndexes(address[1]);\n        var indexes = range;\n        var sheetIndex = getSheetIndex(this.parent, address[0]);\n        var sheet = getSheet(this.parent, sheetIndex);\n        var actionData = eventArgs.beforeActionData;\n        var isRefresh = this.checkRefreshNeeded(sheetIndex);\n        if (this.isUndo) {\n            this.updateCellDetails(actionData.cellDetails, sheet, range, isRefresh, args);\n            setMaxHgt(sheet, range[0], range[1], 20);\n            var hgt = getMaxHgt(sheet, range[0]);\n            setRowEleHeight(this.parent, sheet, hgt, range[0]);\n        }\n        else {\n            /* tslint:disable-next-line:no-any */\n            var argsEventArgs = args.eventArgs;\n            var activeCellIndexes = getRangeIndexes(sheet.activeCell);\n            var cellValue = this.parent.getCellStyleValue(['textDecoration'], activeCellIndexes).textDecoration;\n            if (argsEventArgs && argsEventArgs.style && argsEventArgs.style.textDecoration) {\n                var value = argsEventArgs.style.textDecoration;\n                var changedValue = value;\n                var changedStyle = void 0;\n                var removeProp = false;\n                if (cellValue === 'underline') {\n                    changedValue = value === 'underline' ? 'none' : 'underline line-through';\n                }\n                else if (cellValue === 'line-through') {\n                    changedValue = value === 'line-through' ? 'none' : 'underline line-through';\n                }\n                else if (cellValue === 'underline line-through') {\n                    changedValue = value === 'underline' ? 'line-through' : 'underline';\n                    removeProp = true;\n                }\n                if (changedValue === 'none') {\n                    removeProp = true;\n                }\n                argsEventArgs.style.textDecoration = changedValue;\n                args.eventArgs = argsEventArgs;\n                this.parent.notify(setCellFormat, {\n                    style: { textDecoration: changedValue }, range: activeCellIndexes, refreshRibbon: true,\n                    onActionUpdate: true\n                });\n                for (var i = indexes[0]; i <= indexes[2]; i++) {\n                    for (var j = indexes[1]; j <= indexes[3]; j++) {\n                        if (i === activeCellIndexes[0] && j === activeCellIndexes[1]) {\n                            continue;\n                        }\n                        changedStyle = {};\n                        cellValue = this.parent.getCellStyleValue(['textDecoration'], [i, j]).textDecoration;\n                        if (cellValue === 'none') {\n                            if (removeProp) {\n                                continue;\n                            }\n                            changedStyle.textDecoration = value;\n                        }\n                        else if (cellValue === 'underline' || cellValue === 'line-through') {\n                            if (removeProp) {\n                                if (value === cellValue) {\n                                    changedStyle.textDecoration = 'none';\n                                }\n                                else {\n                                    continue;\n                                }\n                            }\n                            else {\n                                changedStyle.textDecoration = value !== cellValue ? 'underline line-through' : value;\n                            }\n                        }\n                        else if (cellValue === 'underline line-through') {\n                            if (removeProp) {\n                                changedStyle.textDecoration = value === 'underline' ? 'line-through' : 'underline';\n                            }\n                            else {\n                                continue;\n                            }\n                        }\n                        this.parent.notify(setCellFormat, {\n                            style: { textDecoration: changedStyle.textDecoration }, range: [i, j, i, j], refreshRibbon: true,\n                            onActionUpdate: true\n                        });\n                    }\n                }\n                argsEventArgs.style.textDecoration = value;\n                args.eventArgs = argsEventArgs;\n            }\n            else {\n                updateAction(args, this.parent);\n            }\n        }\n        if (isRefresh) {\n            this.parent.notify(selectRange, { indexes: range });\n        }\n        return args;\n    };\n    UndoRedo.prototype.getCellDetails = function (address, sheet) {\n        var cells = [];\n        var cell;\n        address = getSwapRange(address);\n        for (var i = address[0]; i <= address[2]; i++) {\n            for (var j = address[1]; j <= address[3]; j++) {\n                cell = getCell(i, j, sheet);\n                cells.push({\n                    rowIndex: i, colIndex: j, format: cell ? cell.format : null,\n                    style: cell && cell.style ? Object.assign({}, cell.style) : null, value: cell ? cell.value : '', formula: cell ?\n                        cell.formula : '', wrap: cell && cell.wrap, rowSpan: cell && cell.rowSpan, colSpan: cell && cell.colSpan,\n                    hyperlink: cell && cell.hyperlink, image: cell && cell.image && cell.chart\n                });\n            }\n        }\n        return cells;\n    };\n    UndoRedo.prototype.updateCellDetails = function (cells, sheet, range, isRefresh, args) {\n        var len = cells.length;\n        var cellElem;\n        for (var i = 0; i < len; i++) {\n            setCell(cells[i].rowIndex, cells[i].colIndex, sheet, {\n                value: cells[i].value, format: cells[i].format,\n                style: cells[i].style && Object.assign({}, cells[i].style), formula: cells[i].formula,\n                wrap: cells[i].wrap, rowSpan: cells[i].rowSpan,\n                colSpan: cells[i].colSpan, hyperlink: cells[i].hyperlink\n            });\n            if (cells[i].formula) {\n                this.parent.notify(workbookEditOperation, {\n                    action: 'updateCellValue', address: [cells[i].rowIndex, cells[i].colIndex, cells[i].rowIndex,\n                        cells[i].colIndex], value: cells[i].formula\n                });\n            }\n            if (args && args.action === 'wrap' && args.eventArgs.wrap) {\n                this.parent.notify(wrapEvent, {\n                    range: [cells[i].rowIndex, cells[i].colIndex, cells[i].rowIndex,\n                        cells[i].colIndex], wrap: false, sheet: sheet\n                });\n            }\n            if (args && cells[i].hyperlink && args.action === 'clear') {\n                args.eventArgs.range = sheet.name + '!' + getRangeAddress([cells[i].rowIndex, cells[i].colIndex, cells[i].rowIndex,\n                    cells[i].colIndex]);\n                cellElem = this.parent.getCell(cells[i].rowIndex, cells[i].colIndex);\n                if (args.eventArgs.type === 'Clear All' || args.eventArgs.type === 'Clear Hyperlinks') {\n                    this.parent.addHyperlink(cells[i].hyperlink, args.eventArgs.range);\n                }\n                else if (args.eventArgs.type === 'Clear Formats') {\n                    addClass(cellElem.querySelectorAll('.e-hyperlink'), 'e-hyperlink-style');\n                }\n            }\n        }\n        if (isRefresh) {\n            this.parent.serviceLocator.getService('cell').refreshRange(range);\n        }\n    };\n    UndoRedo.prototype.checkRefreshNeeded = function (sheetIndex) {\n        var isRefresh = true;\n        if (sheetIndex !== this.parent.activeSheetIndex) {\n            this.parent.activeSheetIndex = sheetIndex;\n            this.parent.dataBind();\n            isRefresh = false;\n        }\n        return isRefresh;\n    };\n    UndoRedo.prototype.addEventListener = function () {\n        this.parent.on(performUndoRedo, this.performUndoRedo, this);\n        this.parent.on(updateUndoRedoCollection, this.updateUndoRedoCollection, this);\n        this.parent.on(setActionData, this.setActionData, this);\n        this.parent.on(getBeforeActionData, this.getBeforeActionData, this);\n        this.parent.on(clearUndoRedoCollection, this.clearUndoRedoCollection, this);\n        this.parent.on(setUndoRedo, this.updateUndoRedoIcons, this);\n    };\n    UndoRedo.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(performUndoRedo, this.performUndoRedo);\n            this.parent.off(updateUndoRedoCollection, this.updateUndoRedoCollection);\n            this.parent.off(setActionData, this.setActionData);\n            this.parent.off(getBeforeActionData, this.getBeforeActionData);\n            this.parent.off(clearUndoRedoCollection, this.clearUndoRedoCollection);\n            this.parent.off(setUndoRedo, this.updateUndoRedoIcons);\n        }\n    };\n    /**\n     * Destroy undo redo module.\n     */\n    UndoRedo.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the undo redo module name.\n     */\n    UndoRedo.prototype.getModuleName = function () {\n        return 'undoredo';\n    };\n    return UndoRedo;\n}());\nexport { UndoRedo };\n","import { closest, Browser } from '@syncfusion/ej2-base';\nimport { ribbonClick, inView, setMaxHgt, getMaxHgt, WRAPTEXT, setRowEleHeight, rowHeightChanged, beginAction } from '../common/index';\nimport { completeAction, getTextHeight, getLines, getBorderHeight, getExcludedColumnWidth } from '../common/index';\nimport { getCell, wrap as wrapText, wrapEvent, getRow } from '../../workbook/index';\nimport { getRowHeight, getAddressFromSelectedRange } from '../../workbook/index';\n/**\n * Represents Wrap Text support for Spreadsheet.\n */\nvar WrapText = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Wrap Text module.\n     * @private\n     */\n    function WrapText(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    WrapText.prototype.addEventListener = function () {\n        this.parent.on(ribbonClick, this.ribbonClickHandler, this);\n        this.parent.on(wrapEvent, this.wrapTextHandler, this);\n        this.parent.on(rowHeightChanged, this.rowHeightChangedHandler, this);\n    };\n    WrapText.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(ribbonClick, this.ribbonClickHandler);\n            this.parent.off(wrapEvent, this.wrapTextHandler);\n            this.parent.off(rowHeightChanged, this.rowHeightChangedHandler);\n        }\n    };\n    WrapText.prototype.wrapTextHandler = function (args) {\n        if (inView(this.parent, args.range, true)) {\n            var ele = void 0;\n            var cell = void 0;\n            var colwidth = void 0;\n            var isCustomHgt = void 0;\n            var maxHgt = void 0;\n            var hgt = void 0;\n            for (var i = args.range[0]; i <= args.range[2]; i++) {\n                maxHgt = 0;\n                isCustomHgt = getRow(args.sheet, i).customHeight;\n                for (var j = args.range[1]; j <= args.range[3]; j++) {\n                    ele = args.initial ? args.td : this.parent.getCell(i, j);\n                    if (ele) {\n                        args.wrap ? ele.classList.add(WRAPTEXT) : ele.classList.remove(WRAPTEXT);\n                        if (isCustomHgt) {\n                            if (ele.children.length === 0 || !ele.querySelector('.e-wrap-content')) {\n                                ele.innerHTML\n                                    = this.parent.createElement('span', {\n                                        className: 'e-wrap-content',\n                                        innerHTML: ele.innerHTML\n                                    }).outerHTML;\n                            }\n                        }\n                    }\n                    if (Browser.isIE) {\n                        ele.classList.add('e-ie-wrap');\n                    }\n                    if (!isCustomHgt) {\n                        cell = getCell(i, j, args.sheet);\n                        colwidth = getExcludedColumnWidth(args.sheet, i, j, cell.colSpan > 1 ? j + cell.colSpan - 1 : j);\n                        var displayText = this.parent.getDisplayText(cell);\n                        if (displayText.indexOf('\\n') < 0) {\n                            var editElem = this.parent.element.querySelector('.e-spreadsheet-edit');\n                            if (editElem) {\n                                if (editElem.textContent.indexOf('\\n') > -1) {\n                                    displayText = editElem.textContent;\n                                }\n                            }\n                        }\n                        if (displayText) {\n                            if (args.wrap) {\n                                if (ele && ele.classList.contains('e-alt-unwrap')) {\n                                    ele.classList.remove('e-alt-unwrap');\n                                }\n                                var lines = void 0;\n                                var n = 0;\n                                var p = void 0;\n                                if (displayText.indexOf('\\n') > -1) {\n                                    var splitVal = displayText.split('\\n');\n                                    var valLength = splitVal.length;\n                                    for (p = 0; p < valLength; p++) {\n                                        lines = getLines(splitVal[p], colwidth, cell.style, this.parent.cellStyle);\n                                        if (lines === 0) {\n                                            lines = 1; // for empty new line\n                                        }\n                                        n = n + lines;\n                                    }\n                                    lines = n;\n                                }\n                                else {\n                                    lines = getLines(displayText, colwidth, cell.style, this.parent.cellStyle);\n                                }\n                                hgt = getTextHeight(this.parent, cell.style || this.parent.cellStyle, lines) + 1 +\n                                    getBorderHeight(i, j, args.sheet);\n                                maxHgt = Math.max(maxHgt, hgt);\n                                setMaxHgt(args.sheet, i, j, hgt);\n                            }\n                            else {\n                                if (displayText.indexOf('\\n') > -1) {\n                                    ele.classList.add('e-alt-unwrap');\n                                }\n                                hgt = getTextHeight(this.parent, cell.style || this.parent.cellStyle, 1);\n                                setMaxHgt(args.sheet, i, j, hgt);\n                                maxHgt = Math.max(getMaxHgt(args.sheet, i), 20);\n                            }\n                        }\n                        else if (!args.wrap) {\n                            setMaxHgt(args.sheet, i, j, 20);\n                            maxHgt = 20;\n                        }\n                        if (j === args.range[3] && ((args.wrap && maxHgt > 20 && getMaxHgt(args.sheet, i) <= maxHgt) || (!args.wrap\n                            && getMaxHgt(args.sheet, i) < getRowHeight(args.sheet, i) && getRowHeight(args.sheet, i) > 20))) {\n                            setRowEleHeight(this.parent, args.sheet, maxHgt, i, args.row, args.hRow);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    WrapText.prototype.ribbonClickHandler = function (args) {\n        var target = closest(args.originalEvent.target, '.e-btn');\n        if (target && target.id === this.parent.element.id + '_wrap') {\n            var wrap = target.classList.contains('e-active');\n            var address = getAddressFromSelectedRange(this.parent.getActiveSheet());\n            var eventArgs = { address: address, wrap: wrap, cancel: false };\n            this.parent.notify(beginAction, { action: 'beforeWrap', eventArgs: eventArgs });\n            if (!eventArgs.cancel) {\n                wrapText(this.parent.getActiveSheet().selectedRange, wrap, this.parent);\n                this.parent.notify(completeAction, { action: 'wrap', eventArgs: { address: address, wrap: wrap } });\n            }\n        }\n    };\n    WrapText.prototype.getTextWidth = function (text, style) {\n        if (style === void 0) { style = this.parent.cellStyle; }\n        var defaultStyle = this.parent.cellStyle;\n        var canvas = document.createElement('canvas');\n        var context = canvas.getContext('2d');\n        context.font = (style.fontStyle || defaultStyle.fontStyle) + ' ' + (style.fontWeight || defaultStyle.fontWeight) + ' '\n            + (style.fontSize || defaultStyle.fontSize) + ' ' + (style.fontFamily || defaultStyle.fontFamily);\n        return context.measureText(text).width;\n    };\n    WrapText.prototype.rowHeightChangedHandler = function (args) {\n        if (args.isCustomHgt) {\n            var sheet = this.parent.getActiveSheet();\n            var leftIdx = this.parent.viewport.leftIndex;\n            var rightIdx = leftIdx + this.parent.viewport.colCount + this.parent.getThreshold('col') * 2;\n            for (var i = leftIdx; i < rightIdx; i++) {\n                var cell = getCell(args.rowIdx, i, sheet);\n                if (cell && cell.wrap) {\n                    var ele = this.parent.getCell(args.rowIdx, i);\n                    if (ele.children.length === 0 || !ele.querySelector('.e-wrap-content')) {\n                        ele.innerHTML = this.parent.createElement('span', {\n                            className: 'e-wrap-content',\n                            innerHTML: ele.innerHTML\n                        }).outerHTML;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    WrapText.prototype.getModuleName = function () {\n        return 'wrapText';\n    };\n    WrapText.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return WrapText;\n}());\nexport { WrapText };\n","import { beginAction, completeAction, insertSheetTab, skipHiddenIdx, refreshImagePosition, focus } from '../common/index';\nimport { insert, dataChanged } from '../../workbook/common/index';\nimport { getCell } from '../../workbook/index';\n/**\n * The `Insert` module is used to insert cells, rows, columns and sheets in to the spreadsheet.\n */\nvar Insert = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet insert module.\n     * @private\n     */\n    function Insert(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Insert.prototype.insert = function (args) {\n        var isAction;\n        if (args.isAction) {\n            isAction = true;\n            delete args.isAction;\n        }\n        if (isAction) {\n            this.parent.notify(beginAction, { eventArgs: args, action: 'insert' });\n        }\n        switch (args.modelType) {\n            case 'Sheet':\n                this.parent.notify(insertSheetTab, { startIdx: args.index, endIdx: args.index + (args.model.length - 1), preventUpdate: !isAction });\n                this.parent.renderModule.refreshSheet();\n                focus(this.parent.element);\n                break;\n            case 'Row':\n                if (!this.parent.scrollSettings.enableVirtualization || args.index <= this.parent.viewport.bottomIndex) {\n                    if (this.parent.scrollSettings.enableVirtualization) {\n                        if (args.index < this.parent.viewport.topIndex) {\n                            this.parent.viewport.topIndex += args.model.length;\n                        }\n                        this.parent.renderModule.refreshUI({\n                            skipUpdateOnFirst: this.parent.viewport.topIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Row'\n                        });\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({ skipUpdateOnFirst: true, rowIndex: args.index, colIndex: 0, refresh: 'Row' });\n                    }\n                    this.parent.notify(dataChanged, args);\n                    this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n                }\n                break;\n            case 'Column':\n                if (!this.parent.scrollSettings.enableVirtualization || args.index <= this.parent.viewport.rightIndex) {\n                    if (this.parent.scrollSettings.enableVirtualization) {\n                        if (args.index < this.parent.viewport.leftIndex) {\n                            this.parent.viewport.leftIndex += args.model.length;\n                        }\n                        this.parent.renderModule.refreshUI({\n                            skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, colIndex: this.parent.viewport.leftIndex, refresh: 'Column'\n                        });\n                    }\n                    else {\n                        this.parent.renderModule.refreshUI({\n                            skipUpdateOnFirst: true, rowIndex: 0, colIndex: args.index, refresh: 'Column'\n                        });\n                    }\n                    this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n                }\n                break;\n        }\n        this.refreshImgElement(args.model.length, this.parent.activeSheetIndex, args.modelType, args.index);\n        if (isAction) {\n            this.parent.notify(completeAction, { eventArgs: args, action: 'insert' });\n        }\n    };\n    Insert.prototype.refreshImgElement = function (count, sheetIdx, modelType, index) {\n        var sheet = this.parent.sheets[sheetIdx];\n        var cellObj;\n        var indexes = [0, 0, sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n        for (var i = 0; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                cellObj = getCell(i, j, sheet);\n                if (cellObj && cellObj.image && cellObj.image.length > 0) {\n                    if ((modelType === 'Row' && i >= index) || (modelType === 'Column' && j >= index)) {\n                        this.parent.notify(refreshImagePosition, {\n                            rowIdx: i, colIdx: j, sheetIdx: sheetIdx, type: modelType, count: count, status: 'insert'\n                        });\n                    }\n                }\n            }\n        }\n    };\n    Insert.prototype.addEventListener = function () {\n        this.parent.on(insert, this.insert, this);\n    };\n    /**\n     * Destroy insert module.\n     */\n    Insert.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Insert.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(insert, this.insert);\n        }\n    };\n    /**\n     * Get the insert module name.\n     */\n    Insert.prototype.getModuleName = function () {\n        return 'insert';\n    };\n    return Insert;\n}());\nexport { Insert };\n","import { beginAction, completeAction, skipHiddenIdx, refreshSheetTabs, refreshImagePosition, focus } from '../common/index';\nimport { deleteAction, dataChanged } from '../../workbook/common/index';\nimport { getCell } from '../../workbook/index';\n/**\n * The `Delete` module is used to delete cells, rows, columns and sheets from the spreadsheet.\n */\nvar Delete = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet insert module.\n     * @private\n     */\n    function Delete(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Delete.prototype.delete = function (args) {\n        var isAction;\n        if (args.isAction) {\n            isAction = true;\n            delete args.isAction;\n        }\n        if (isAction) {\n            this.parent.notify(beginAction, { eventArgs: args, action: 'delete' });\n        }\n        if (args.modelType === 'Sheet') {\n            var activeSheetDeleted = args.activeSheetIndex >= args.startIndex && args.activeSheetIndex <= args.endIndex;\n            if (activeSheetDeleted) {\n                this.parent.setProperties({ activeSheetIndex: this.parent.skipHiddenSheets(args.startIndex < this.parent.sheets.length ? args.startIndex :\n                        (args.startIndex ? args.startIndex - 1 : 0)) }, true);\n            }\n            this.parent.notify(refreshSheetTabs, null);\n            if (activeSheetDeleted) {\n                this.parent.renderModule.refreshSheet();\n            }\n            focus(this.parent.element);\n        }\n        else if (args.modelType === 'Row') {\n            if (!this.parent.scrollSettings.enableVirtualization || args.startIndex <= this.parent.viewport.bottomIndex) {\n                if (this.parent.scrollSettings.enableVirtualization) {\n                    if (args.startIndex < this.parent.viewport.topIndex) {\n                        this.parent.viewport.topIndex -= args.model.length;\n                    }\n                    this.parent.renderModule.refreshUI({\n                        skipUpdateOnFirst: this.parent.viewport.topIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true), rowIndex: this.parent.viewport.topIndex, refresh: 'Row',\n                        colIndex: this.parent.viewport.leftIndex\n                    });\n                }\n                else {\n                    this.parent.renderModule.refreshUI({ skipUpdateOnFirst: true, refresh: 'Row', rowIndex: args.startIndex, colIndex: 0 });\n                }\n            }\n            this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n        }\n        else {\n            if (!this.parent.scrollSettings.enableVirtualization || args.startIndex <= this.parent.viewport.rightIndex) {\n                if (this.parent.scrollSettings.enableVirtualization) {\n                    if (args.startIndex < this.parent.viewport.leftIndex) {\n                        this.parent.viewport.leftIndex -= args.model.length;\n                    }\n                    this.parent.renderModule.refreshUI({\n                        skipUpdateOnFirst: this.parent.viewport.leftIndex === skipHiddenIdx(this.parent.getActiveSheet(), 0, true, 'columns'), rowIndex: this.parent.viewport.topIndex, refresh: 'Column',\n                        colIndex: this.parent.viewport.leftIndex\n                    });\n                }\n                else {\n                    this.parent.renderModule.refreshUI({\n                        skipUpdateOnFirst: true, refresh: 'Column', rowIndex: 0,\n                        colIndex: args.startIndex\n                    });\n                }\n            }\n            this.parent.selectRange(this.parent.getActiveSheet().selectedRange);\n        }\n        this.refreshImgElement(args.deletedModel.length, this.parent.activeSheetIndex, args.modelType, args.startIndex);\n        if (isAction) {\n            this.parent.notify(completeAction, { eventArgs: args, action: 'delete' });\n        }\n        if (args.modelType === 'Row') {\n            this.parent.notify(dataChanged, args);\n        }\n    };\n    Delete.prototype.refreshImgElement = function (count, sheetIdx, modelType, index) {\n        var sheet = this.parent.sheets[sheetIdx];\n        var cell;\n        var address = [0, 0, sheet.usedRange.rowIndex, sheet.usedRange.colIndex];\n        for (var i = 0; i <= address[2]; i++) {\n            for (var j = address[1]; j <= address[3]; j++) {\n                cell = getCell(i, j, sheet);\n                if (cell && cell.image && cell.image.length > 0) {\n                    if ((modelType === 'Row' && i >= index) || (modelType === 'Column' && j >= index)) {\n                        this.parent.notify(refreshImagePosition, {\n                            rowIdx: i, colIdx: j, sheetIdx: sheetIdx, type: modelType, count: count, status: 'delete'\n                        });\n                    }\n                }\n            }\n        }\n    };\n    Delete.prototype.addEventListener = function () {\n        this.parent.on(deleteAction, this.delete, this);\n    };\n    /**\n     * Destroy delete module.\n     */\n    Delete.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Delete.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(deleteAction, this.delete);\n        }\n    };\n    /**\n     * Get the delete module name.\n     */\n    Delete.prototype.getModuleName = function () {\n        return 'delete';\n    };\n    return Delete;\n}());\nexport { Delete };\n","import { editAlert } from '../index';\nimport { isValidation, checkDateFormat, applyCellFormat, workbookEditOperation, activeCellChanged } from '../../workbook/common/event';\nimport { getCell, setCell } from '../../workbook/base/cell';\nimport { FormValidator, NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { EventHandler, remove, closest, isNullOrUndefined, select } from '@syncfusion/ej2-base';\nimport { dialog, locale, initiateDataValidation, invalidData, editOperation, keyUp, focus } from '../common/index';\nimport { formulaBarOperation, removeDataValidation } from '../common/index';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { setRow } from '../../workbook/base/row';\nimport { getRangeIndexes, getIndexesFromAddress, getCellIndexes } from '../../workbook/common/address';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { getSheet, getSheetIndex } from '../../workbook/index';\nimport { getColumn, isLocked } from '../../workbook/index';\n/**\n * Represents Data Validation support for Spreadsheet.\n */\nvar DataValidation = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Data Validation module.\n     */\n    function DataValidation(parent) {\n        this.data = [];\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the Data Validation module.\n     * @return {void}\n     */\n    DataValidation.prototype.destroy = function () {\n        this.removeEventListener();\n        var dataValPopup = select('#' + this.parent.element.id + '_datavalidation-popup');\n        if (dataValPopup) {\n            dataValPopup.remove();\n        }\n        this.parent = null;\n    };\n    DataValidation.prototype.addEventListener = function () {\n        EventHandler.add(this.parent.element, 'dblclick', this.listOpen, this);\n        EventHandler.add(document, 'mousedown', this.mouseDownHandler, this);\n        this.parent.on(initiateDataValidation, this.initiateDataValidationHandler, this);\n        this.parent.on(invalidData, this.invalidDataHandler, this);\n        this.parent.on(isValidation, this.checkDataValidation, this);\n        this.parent.on(activeCellChanged, this.listHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(removeDataValidation, this.removeValidationHandler, this);\n    };\n    DataValidation.prototype.removeEventListener = function () {\n        EventHandler.remove(this.parent.element, 'dblclick', this.listOpen);\n        EventHandler.remove(document, 'mousedown', this.mouseDownHandler);\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateDataValidation, this.initiateDataValidationHandler);\n            this.parent.off(invalidData, this.invalidDataHandler);\n            this.parent.off(isValidation, this.checkDataValidation);\n            this.parent.off(activeCellChanged, this.listHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(removeDataValidation, this.removeValidationHandler);\n        }\n    };\n    DataValidation.prototype.removeValidationHandler = function (e) {\n        this.parent.removeDataValidation(this.parent.getActiveSheet().selectedRange);\n    };\n    DataValidation.prototype.mouseDownHandler = function (e) {\n        var target = e.target;\n        var parEle = closest(target, '.e-ddl');\n        if (parEle && parEle.getAttribute('id') === 'listValid_popup') {\n            this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: target.innerText });\n        }\n    };\n    DataValidation.prototype.keyUpHandler = function (e) {\n        var target = e.target;\n        var dlgEle = this.parent.element.querySelector('.e-datavalidation-dlg');\n        if (closest(target, '.e-values') && dlgEle && e.keyCode !== 13) {\n            var valuesCont = dlgEle.querySelector('.e-values');\n            var errorEle = valuesCont.querySelector('.e-dlg-error');\n            var footerCont = dlgEle.querySelector('.e-footer-content');\n            var primaryBut = footerCont.querySelector('.e-primary');\n            if (primaryBut.hasAttribute('disabled')) {\n                primaryBut.removeAttribute('disabled');\n            }\n            if (errorEle) {\n                valuesCont.removeChild(errorEle);\n            }\n        }\n    };\n    DataValidation.prototype.listOpen = function (e) {\n        var target = e.target;\n        if (this.listObj && target.classList.contains('e-cell') && target.querySelector('.e-validation-list')) {\n            this.listObj.showPopup();\n        }\n    };\n    DataValidation.prototype.invalidDataHandler = function (args) {\n        if (args.isRemoveHighlight) {\n            this.parent.removeInvalidHighlight();\n        }\n        else {\n            this.parent.addInvalidHighlight();\n        }\n    };\n    DataValidation.prototype.listHandler = function () {\n        var _this = this;\n        if (this.parent.allowDataValidation) {\n            var sheet = this.parent.getActiveSheet();\n            var mainCont = this.parent.getMainContent();\n            var indexes = getCellIndexes(sheet.activeCell);\n            var colIdx = indexes[1];\n            var rowIdx = indexes[0];\n            var cell_1 = getCell(indexes[0], indexes[1], sheet);\n            var tdEle_1;\n            tdEle_1 = this.parent.getCell(indexes[0], indexes[1]);\n            if (!tdEle_1) {\n                return;\n            }\n            if (document.getElementsByClassName('e-validation-list')[0]) {\n                remove(document.getElementsByClassName('e-validation-list')[0]);\n                this.data = [];\n            }\n            if (cell_1 && cell_1.validation && cell_1.validation.type === 'List') {\n                cell_1.validation.ignoreBlank = !isNullOrUndefined(cell_1.validation.ignoreBlank) ? cell_1.validation.ignoreBlank : true;\n                cell_1.validation.inCellDropDown = !isNullOrUndefined(cell_1.validation.inCellDropDown) ?\n                    cell_1.validation.inCellDropDown : true;\n                if (cell_1.validation.inCellDropDown) {\n                    var ddlCont = this.parent.createElement('div', { className: 'e-validation-list' });\n                    var ddlEle = this.parent.createElement('input', { id: 'listValid' });\n                    ddlCont.appendChild(ddlEle);\n                    if (!cell_1.validation.inCellDropDown) {\n                        ddlCont.style.display = 'none';\n                    }\n                    tdEle_1.insertBefore(ddlCont, tdEle_1.firstChild);\n                    this.listObj = new DropDownList({\n                        index: 0,\n                        dataSource: this.data,\n                        fields: { text: 'text', value: 'id' },\n                        width: '0px',\n                        popupWidth: '200px',\n                        popupHeight: '200px',\n                        beforeOpen: function () {\n                            _this.listObj.popupWidth = tdEle_1.offsetWidth - 1;\n                            _this.data = [];\n                            _this.updateDataSource(_this.listObj, cell_1);\n                        },\n                        change: function () { _this.listValueChange(_this.listObj.text); },\n                        open: function (args) {\n                            args.popup.offsetX = -(tdEle_1.offsetWidth - 20) + 4;\n                            args.popup.offsetY = -13;\n                        }\n                    });\n                    this.listObj.appendTo('#listValid');\n                }\n            }\n        }\n    };\n    DataValidation.prototype.updateDataSource = function (listObj, cell) {\n        var count = 0;\n        var value = cell.validation.value1;\n        var isRange = value.indexOf('=') !== -1;\n        if (isRange) {\n            var sheet = value.indexOf('!') > -1 ?\n                getSheet(this.parent, getSheetIndex(this.parent, value.split('=')[1].split('!')[0])) : this.parent.getActiveSheet();\n            var address = value.indexOf('!') > -1 ? value.split('!')[1] : value.split('=')[1];\n            var indexes = void 0;\n            var range = address.split(':');\n            if ((range[0].match(/[a-z]+$/ig) && range[1].match(/[a-z]+$/ig)) || (range[0].match(/^[0-9]/g) && range[1].match(/^[0-9]/g))) {\n                var addressInfo = this.parent.getIndexes(address);\n                if (addressInfo.isCol) {\n                    indexes = [0, addressInfo.startIdx, sheet.usedRange.rowIndex, addressInfo.startIdx];\n                }\n                else {\n                    indexes = [addressInfo.startIdx, 0, addressInfo.startIdx, sheet.usedRange.colIndex];\n                }\n            }\n            else {\n                indexes = getRangeIndexes(address);\n            }\n            for (var rowIdx = indexes[0]; rowIdx <= indexes[2]; rowIdx++) {\n                if (!sheet.rows[rowIdx]) {\n                    setRow(sheet, rowIdx, {});\n                }\n                for (var colIdx = indexes[1]; colIdx <= indexes[3]; colIdx++) {\n                    if (!sheet.rows[rowIdx].cells) {\n                        setCell(rowIdx, colIdx, sheet, {});\n                    }\n                    count += 1;\n                    cell = sheet.rows[rowIdx].cells[colIdx];\n                    var data = this.parent.getDisplayText(cell) ? this.parent.getDisplayText(cell) : '';\n                    this.data.push({ text: data, id: 'list-' + count });\n                }\n            }\n        }\n        else {\n            var listValues = value.split(',');\n            for (var idx = 0; idx < listValues.length; idx++) {\n                count += 1;\n                this.data.push({ text: listValues[idx], id: 'list-' + count });\n            }\n        }\n        listObj.dataSource = this.data;\n    };\n    DataValidation.prototype.listValueChange = function (value) {\n        var sheet = this.parent.getActiveSheet();\n        var cellIdx = getIndexesFromAddress(sheet.activeCell);\n        var cellObj = Object.assign({}, getCell(cellIdx[0], cellIdx[1], sheet));\n        if (sheet.isProtected && isLocked(cellObj, getColumn(sheet, cellIdx[1]))) {\n            this.parent.notify(editAlert, null);\n        }\n        else {\n            this.parent.notify(workbookEditOperation, { action: 'updateCellValue', address: sheet.activeCell, value: value });\n            this.parent.serviceLocator.getService('cell').refreshRange(cellIdx);\n            this.parent.trigger('cellSave', {\n                value: value, oldValue: cellObj && cellObj.value, address: sheet.name + '!' + sheet.activeCell,\n                displayText: this.parent.getDisplayText(getCell(cellIdx[0], cellIdx[1], sheet))\n            });\n        }\n    };\n    DataValidation.prototype.initiateDataValidationHandler = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var type;\n        var operator;\n        var value1;\n        var value2;\n        var ignoreBlank = true;\n        var inCellDropDown = true;\n        var isNew = true;\n        var sheet = this.parent.getActiveSheet();\n        var cell;\n        var indexes = getRangeIndexes(sheet.selectedRange);\n        for (var rowIdx = indexes[0]; rowIdx <= indexes[2]; rowIdx++) {\n            if (sheet.rows[rowIdx]) {\n                for (var colIdx = indexes[1]; colIdx <= indexes[3]; colIdx++) {\n                    if (sheet.rows[rowIdx].cells && sheet.rows[rowIdx].cells[colIdx]) {\n                        cell = sheet.rows[rowIdx].cells[colIdx];\n                        if (cell.validation) {\n                            isNew = false;\n                            type = cell.validation.type;\n                            operator = cell.validation.operator;\n                            value1 = cell.validation.value1;\n                            value2 = cell.validation.value2;\n                            ignoreBlank = !isNullOrUndefined(cell.validation.ignoreBlank) ?\n                                cell.validation.ignoreBlank : ignoreBlank;\n                            inCellDropDown = !isNullOrUndefined(cell.validation.inCellDropDown) ?\n                                cell.validation.inCellDropDown : inCellDropDown;\n                        }\n                    }\n                }\n            }\n        }\n        if (!this.parent.element.querySelector('.e-datavalidation-dlg')) {\n            var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n            dialogInst_1.show({\n                width: 375, showCloseIcon: true, isModal: true, cssClass: 'e-datavalidation-dlg',\n                header: l10n.getConstant('DataValidation'),\n                target: document.querySelector('.e-control.e-spreadsheet'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'ValidationDialog', element: args.element,\n                        target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst_1.dialogInstance.content =\n                        _this.dataValidationContent(isNew, type, operator, value1, value2, ignoreBlank, inCellDropDown);\n                    dialogInst_1.dialogInstance.dataBind();\n                    focus(_this.parent.element);\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('CLEARALL'),\n                            cssClass: 'e-btn e-clearall-btn e-flat'\n                        },\n                        click: function () {\n                            dialogInst_1.dialogInstance.content =\n                                _this.dataValidationContent(true, type, operator, value1, value2, ignoreBlank, inCellDropDown);\n                            dialogInst_1.dialogInstance.dataBind();\n                            focus(_this.parent.element);\n                        }\n                    },\n                    {\n                        buttonModel: {\n                            content: l10n.getConstant('APPLY'), isPrimary: true\n                        },\n                        click: function () {\n                            _this.dlgClickHandler(dialogInst_1);\n                        }\n                    }]\n            });\n            dialogInst_1.dialogInstance.refresh();\n        }\n    };\n    // tslint:disable-next-line:max-func-body-length\n    DataValidation.prototype.dataValidationContent = function (isNew, type, operator, val1, val2, ignoreBlank, inCellDropDown) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var value1 = isNew ? '0' : val1;\n        var value2 = isNew ? '0' : val2;\n        var dlgContent = this.parent.createElement('div', { className: 'e-validation-dlg' });\n        var cellRangeCont = this.parent.createElement('div', { className: 'e-cellrange' });\n        var allowDataCont = this.parent.createElement('div', { className: 'e-allowdata' });\n        var valuesCont = this.parent.createElement('div', { className: 'e-values' });\n        var ignoreBlankCont = this.parent.createElement('div', { className: 'e-ignoreblank' });\n        dlgContent.appendChild(cellRangeCont);\n        dlgContent.appendChild(allowDataCont);\n        dlgContent.appendChild(valuesCont);\n        dlgContent.appendChild(ignoreBlankCont);\n        var cellRangeText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('CellRange') });\n        var cellRangeEle = this.parent.createElement('input', {\n            className: 'e-input',\n            attrs: { value: this.parent.getActiveSheet().selectedRange }\n        });\n        cellRangeCont.appendChild(cellRangeText);\n        cellRangeCont.appendChild(cellRangeEle);\n        var allowCont = this.parent.createElement('div', { className: 'e-allow' });\n        var dataCont = this.parent.createElement('div', { className: 'e-data' });\n        allowDataCont.appendChild(allowCont);\n        allowDataCont.appendChild(dataCont);\n        var allowText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Allow') });\n        this.typeData = [\n            { text: l10n.getConstant('WholeNumber'), id: 'type-1' },\n            { text: l10n.getConstant('Decimal'), id: 'type-2' },\n            { text: l10n.getConstant('Date'), id: 'type-3' },\n            { text: l10n.getConstant('Time'), id: 'type-4' },\n            { text: l10n.getConstant('TextLength'), id: 'type-5' },\n            { text: l10n.getConstant('List'), id: 'type-6' }\n        ];\n        this.operatorData = [\n            { text: l10n.getConstant('Between'), id: 'operator-1' },\n            { text: l10n.getConstant('NotBetween'), id: 'operator-2' },\n            { text: l10n.getConstant('EqualTo'), id: 'operator-3' },\n            { text: l10n.getConstant('NotEqualTo'), id: 'operator-4' },\n            { text: l10n.getConstant('Greaterthan'), id: 'operator-5' },\n            { text: l10n.getConstant('Lessthan'), id: 'operator-6' },\n            { text: l10n.getConstant('GreaterThanOrEqualTo'), id: 'operator-7' },\n            { text: l10n.getConstant('LessThanOrEqualTo'), id: 'operator-8' }\n        ];\n        var allowSelectEle = this.parent.createElement('input', { className: 'e-select' });\n        var allowIdx = 0;\n        if (!isNew) {\n            for (var idx = 0; idx < this.typeData.length; idx++) {\n                if (type === this.typeData[idx].text.replace(' ', '')) {\n                    allowIdx = idx;\n                    break;\n                }\n            }\n        }\n        if (isNew || type !== 'List') {\n            var dataIdx = 0;\n            var dataText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Data') });\n            var dataSelectEle = this.parent.createElement('input', { className: 'e-select' });\n            if (!isNew) {\n                for (var idx = 0; idx < this.operatorData.length; idx++) {\n                    if (operator === this.FormattedValue(this.operatorData[idx].text)) {\n                        dataIdx = idx;\n                        break;\n                    }\n                }\n            }\n            dataCont.appendChild(dataText);\n            dataCont.appendChild(dataSelectEle);\n            this.dataList = new DropDownList({\n                dataSource: this.operatorData,\n                index: dataIdx,\n                popupHeight: '200px',\n                change: function () { _this.userInput(listObj, _this.dataList); }\n            });\n            this.dataList.appendTo(dataSelectEle);\n        }\n        else {\n            var ignoreBlankEle_1 = this.parent.createElement('input', { className: 'e-checkbox' });\n            dataCont.appendChild(ignoreBlankEle_1);\n            var ignoreBlankObj_1 = new CheckBox({ label: l10n.getConstant('InCellDropDown'), checked: inCellDropDown });\n            ignoreBlankObj_1.appendTo(ignoreBlankEle_1);\n        }\n        allowCont.appendChild(allowText);\n        allowCont.appendChild(allowSelectEle);\n        var listObj = new DropDownList({\n            dataSource: this.typeData,\n            index: allowIdx,\n            popupHeight: '200px',\n            change: function () { _this.userInput(listObj, _this.dataList); }\n        });\n        listObj.appendTo(allowSelectEle);\n        if (isNew || (listObj.value !== 'List' && (this.dataList.value === 'Between' || this.dataList.value === 'Not between'))) {\n            var minimumCont = this.parent.createElement('div', { className: 'e-minimum' });\n            var maximumCont = this.parent.createElement('div', { className: 'e-maximum' });\n            valuesCont.appendChild(minimumCont);\n            valuesCont.appendChild(maximumCont);\n            var minimumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Minimum') });\n            var maximumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Maximum') });\n            var minimumInp = this.parent.createElement('input', {\n                id: 'minvalue',\n                className: 'e-input', attrs: { value: value1 }\n            });\n            var maximumInp = this.parent.createElement('input', {\n                id: 'maxvalue',\n                className: 'e-input', attrs: { value: value2 }\n            });\n            minimumCont.appendChild(minimumText);\n            minimumCont.appendChild(minimumInp);\n            maximumCont.appendChild(maximumText);\n            maximumCont.appendChild(maximumInp);\n            var numericMin = new NumericTextBox({\n                value: 0\n            });\n            numericMin.appendTo('#minvalue');\n            var numericMax = new NumericTextBox({\n                value: 0\n            });\n            numericMax.appendTo('#maxvalue');\n        }\n        else if (!isNew || type === ' List') {\n            var valueText = this.parent.createElement('span', {\n                className: 'e-header', innerHTML: l10n.getConstant('Sources')\n            });\n            var valueEle = this.parent.createElement('input', { className: 'e-input', attrs: { value: value1 } });\n            valuesCont.appendChild(valueText);\n            valuesCont.appendChild(valueEle);\n        }\n        else {\n            var valueText = this.parent.createElement('span', {\n                className: 'e-header', innerHTML: l10n.getConstant('Value')\n            });\n            var valueEle = this.parent.createElement('input', { className: 'e-input', attrs: { value: value1 } });\n            valuesCont.appendChild(valueText);\n            valuesCont.appendChild(valueEle);\n        }\n        var isChecked = ignoreBlank;\n        var ignoreBlankEle = this.parent.createElement('input', { className: 'e-checkbox' });\n        ignoreBlankCont.appendChild(ignoreBlankEle);\n        var ignoreBlankObj = new CheckBox({ label: l10n.getConstant('IgnoreBlank'), checked: isChecked });\n        ignoreBlankObj.appendTo(ignoreBlankEle);\n        return dlgContent;\n    };\n    DataValidation.prototype.userInput = function (listObj, listObj1) {\n        var dlgEle = this.parent.element.querySelector('.e-datavalidation-dlg');\n        var dlgCont = dlgEle.querySelector('.e-validation-dlg');\n        var allowDataCont = dlgCont.querySelector('.e-allowdata');\n        var valuesCont = dlgCont.querySelector('.e-values');\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dataCont = allowDataCont.querySelector('.e-data');\n        var opeEle = dataCont.querySelector('.e-valid-input');\n        while (valuesCont.lastChild) {\n            valuesCont.removeChild(valuesCont.lastChild);\n        }\n        if (listObj.value === 'List') {\n            while (dataCont.lastChild) {\n                dataCont.removeChild(dataCont.lastChild);\n            }\n            var ignoreBlankEle = this.parent.createElement('input', { className: 'e-checkbox' });\n            dataCont.appendChild(ignoreBlankEle);\n            var ignoreBlankObj = new CheckBox({ label: l10n.getConstant('InCellDropDown'), checked: true });\n            ignoreBlankObj.appendTo(ignoreBlankEle);\n        }\n        else {\n            if (dataCont.getElementsByClassName('e-checkbox-wrapper')[0]) {\n                while (dataCont.lastChild) {\n                    dataCont.removeChild(dataCont.lastChild);\n                }\n                var dataText = this.parent.createElement('span', { className: 'e-header', innerHTML: 'Data' });\n                var dataSelectEle = this.parent.createElement('input', { className: 'e-select' });\n                dataCont.appendChild(dataText);\n                dataCont.appendChild(dataSelectEle);\n                listObj1.appendTo(dataSelectEle);\n            }\n        }\n        if (listObj.value !== 'List' && (listObj1.value === 'Between' || listObj1.value === 'Not between')) {\n            var minimumCont = this.parent.createElement('div', { className: 'e-minimum' });\n            var maximumCont = this.parent.createElement('div', { className: 'e-maximum' });\n            valuesCont.appendChild(minimumCont);\n            valuesCont.appendChild(maximumCont);\n            var minimumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Minimum') });\n            var maximumText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('Maximum') });\n            var minimumInp = this.parent.createElement('input', { id: 'min', className: 'e-input', attrs: { value: '0' } });\n            var maximumInp = this.parent.createElement('input', { id: 'max', className: 'e-input', attrs: { value: '0' } });\n            var numericMin = new NumericTextBox({\n                value: 0\n            });\n            numericMin.appendTo('min');\n            var numericMax = new NumericTextBox({\n                value: 0\n            });\n            numericMax.appendTo('max');\n            minimumCont.appendChild(minimumText);\n            minimumCont.appendChild(minimumInp);\n            maximumCont.appendChild(maximumText);\n            maximumCont.appendChild(maximumInp);\n        }\n        else {\n            var text = listObj.value === 'List' ? l10n.getConstant('Sources') : l10n.getConstant('Value');\n            var valueText = this.parent.createElement('span', { className: 'e-header', innerHTML: text });\n            var valueEle = listObj.value === 'List' ? this.parent.createElement('input', {\n                className: 'e-input',\n                attrs: { placeholder: 'Enter value' }\n            }) :\n                this.parent.createElement('input', { className: 'e-input', attrs: { value: '0' } });\n            valuesCont.appendChild(valueText);\n            valuesCont.appendChild(valueEle);\n        }\n    };\n    DataValidation.prototype.dlgClickHandler = function (dialogInst) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var isValidList = true;\n        var errorMsg;\n        var dlgEle = this.parent.element.querySelector('.e-datavalidation-dlg');\n        var dlgFooter = dlgEle.querySelector('.e-footer-content');\n        var dlgContEle = dlgEle.getElementsByClassName('e-dlg-content')[0].\n            getElementsByClassName('e-validation-dlg')[0];\n        var allowData = dlgContEle.getElementsByClassName('e-allowdata')[0];\n        var allowEle = allowData.getElementsByClassName('e-allow')[0].getElementsByTagName('input')[0];\n        var dataEle = allowData.getElementsByClassName('e-data')[0].getElementsByTagName('input')[0];\n        var values = dlgContEle.getElementsByClassName('e-values')[0];\n        var value1 = values.getElementsByTagName('input')[0].value;\n        var value2 = values.getElementsByTagName('input')[1] ? values.getElementsByTagName('input')[1].value : '';\n        var ignoreBlank = dlgContEle.querySelector('.e-ignoreblank').querySelector('.e-checkbox-wrapper').\n            getAttribute('aria-checked') === 'true' ? true : false;\n        var inCellDropDown = allowData.querySelector('.e-data').querySelector('.e-checkbox-wrapper') ?\n            allowData.querySelector('.e-data').querySelector('.e-checkbox-wrapper').querySelector('.e-check') ? true : false : null;\n        var range = dlgContEle.querySelector('.e-cellrange').getElementsByTagName('input')[0].value;\n        var operator;\n        var type = allowEle.value;\n        if (dataEle) {\n            operator = dataEle.value;\n            operator = this.FormattedValue(operator);\n        }\n        if (type) {\n            type = type.replace(' ', '');\n        }\n        var rangeAdd = [];\n        var valArr = [];\n        if (value1 !== '') {\n            valArr.push(value1);\n        }\n        if (value2 !== '') {\n            valArr.push(value2);\n        }\n        if (type === 'List') {\n            if (value1.indexOf('=') !== -1) {\n                if (value1.indexOf(':') !== -1) {\n                    var address = value1.indexOf('!') > -1 ? value1.split('!')[1] : value1.split('=')[1];\n                    var isSheetNameValid = value1.indexOf('!') > -1 ?\n                        getSheetIndex(this.parent, value1.split('=')[1].split('!')[0]) > -1 : true;\n                    rangeAdd = address.split(':');\n                    var isSingleCol = address.match(/[a-z]/gi) ?\n                        rangeAdd[0].replace(/[0-9]/g, '') === rangeAdd[1].replace(/[0-9]/g, '') : false;\n                    var isSingleRow = address.match(/\\d/g) ?\n                        rangeAdd[0].replace(/\\D/g, '') === rangeAdd[1].replace(/\\D/g, '') : false;\n                    isValidList = isSheetNameValid ? (isSingleCol ? true : isSingleRow ? true : false) : false;\n                    if (!isValidList) {\n                        errorMsg = l10n.getConstant('DialogError');\n                    }\n                }\n            }\n            else if (value1.length > 256) {\n                isValidList = false;\n                errorMsg = l10n.getConstant('ListLengthError');\n            }\n        }\n        if (type !== 'List' || isValidList) {\n            var sheet = this.parent.getActiveSheet();\n            var format = type;\n            var validDlg = this.isDialogValidator(valArr, format, operator);\n            errorMsg = validDlg.errorMsg;\n            isValidList = validDlg.isValidate;\n            if (isValidList) {\n                var indexes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n                if (sheet && sheet.rows[indexes[0]] && sheet.rows[indexes[0]].cells[indexes[1]] &&\n                    sheet.rows[indexes[0]].cells[indexes[1]].validation &&\n                    sheet.rows[indexes[0]].cells[indexes[1]].validation.type === 'List') {\n                    var tdEle = this.parent.getMainContent().\n                        getElementsByTagName('tr')[indexes[0]].getElementsByClassName('e-cell')[indexes[1]];\n                    if (tdEle && tdEle.getElementsByClassName('e-validation-list')[0]) {\n                        tdEle.removeChild(tdEle.getElementsByClassName('e-validation-list')[0]);\n                        this.listObj.destroy();\n                    }\n                }\n                var rules = {\n                    type: type, operator: operator,\n                    value1: value1, value2: value2, ignoreBlank: ignoreBlank, inCellDropDown: inCellDropDown\n                };\n                this.parent.addDataValidation(rules, range);\n                if (type === 'List' && isValidList) {\n                    this.listHandler();\n                }\n                if (!document.getElementsByClassName('e-validationerror-dlg')[0]) {\n                    if (dialogInst.dialogInstance) {\n                        dialogInst.dialogInstance.hide();\n                    }\n                    else {\n                        dialogInst.hide();\n                    }\n                }\n            }\n        }\n        if (!isValidList) {\n            var errorEle = this.parent.createElement('div', {\n                className: 'e-dlg-error', id: 'e-invalid', innerHTML: errorMsg\n            });\n            values.appendChild(errorEle);\n            dlgFooter.querySelector('.e-primary').setAttribute('disabled', 'true');\n        }\n    };\n    DataValidation.prototype.FormattedValue = function (value) {\n        switch (value) {\n            case 'Between':\n                value = 'Between';\n                break;\n            case 'Not between':\n                value = 'NotBetween';\n                break;\n            case 'Equal to':\n                value = 'EqualTo';\n                break;\n            case 'Not equal to':\n                value = 'NotEqualTo';\n                break;\n            case 'Greater than':\n                value = 'GreaterThan';\n                break;\n            case 'Less than':\n                value = 'LessThan';\n                break;\n            case 'Greater than or equal to':\n                value = 'GreaterThanOrEqualTo';\n                break;\n            case 'Less than or equal to':\n                value = 'LessThanOrEqualTo';\n                break;\n            default:\n                value = 'Between';\n                break;\n        }\n        return value;\n    };\n    DataValidation.prototype.isDialogValidator = function (values, type, operator) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var count = 0;\n        var isEmpty = false;\n        var formValidation;\n        if (type === 'List') {\n            isEmpty = values.length > 0 ? false : true;\n        }\n        else {\n            if (operator === 'Between' || operator === 'NotBetween') {\n                isEmpty = values.length === 2 ? false : true;\n            }\n            else {\n                isEmpty = values.length > 0 ? false : true;\n            }\n        }\n        if (!isEmpty) {\n            for (var idx = 0; idx < values.length; idx++) {\n                formValidation = this.formatValidation(values[idx], type);\n                if (formValidation.isValidate) {\n                    count = count + 1;\n                }\n                else {\n                    break;\n                }\n            }\n            formValidation.isValidate = count === values.length ? true : false;\n        }\n        else {\n            formValidation = { isValidate: false, errorMsg: l10n.getConstant('EmptyError') };\n        }\n        return { isValidate: formValidation.isValidate, errorMsg: formValidation.errorMsg };\n    };\n    // tslint:disable-next-line:max-func-body-length\n    DataValidation.prototype.isValidationHandler = function (args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        args.value = args.value ? args.value : '';\n        var isValidate;\n        var errorMsg;\n        var enterValue = args.value;\n        var sheet = this.parent.sheets[args.sheetIdx];\n        var cell = getCell(args.range[0], args.range[1], sheet);\n        var value = args.value;\n        var value1 = cell.validation.value1;\n        var value2 = cell.validation.value2;\n        var opt = cell.validation.operator;\n        var type = cell.validation.type;\n        var ignoreBlank = !isNullOrUndefined(cell.validation.ignoreBlank) ? cell.validation.ignoreBlank : true;\n        var formValidation = this.formatValidation(args.value, type);\n        isValidate = formValidation.isValidate;\n        errorMsg = formValidation.errorMsg;\n        if (isValidate) {\n            isValidate = false;\n            if (type === 'Date' || type === 'Time') {\n                for (var idx = 0; idx <= 3; idx++) {\n                    args.value = idx === 0 ? args.value : idx === 1 ? cell.validation.value1 : cell.validation.value2;\n                    var dateEventArgs = {\n                        value: args.value,\n                        rowIndex: args.range[0],\n                        colIndex: args.range[1],\n                        sheetIndex: args.sheetIdx,\n                        updatedVal: ''\n                    };\n                    if (args.value !== '') {\n                        this.parent.notify(checkDateFormat, dateEventArgs);\n                    }\n                    var updatedVal = dateEventArgs.updatedVal;\n                    if (idx === 0) {\n                        value = type === 'Date' ? args.value : updatedVal.slice(updatedVal.indexOf('.') + 1, updatedVal.length);\n                    }\n                    else if (idx === 1) {\n                        value1 = type === 'Date' ? updatedVal : updatedVal.slice(updatedVal.indexOf('.') + 1, updatedVal.length);\n                    }\n                    else {\n                        value2 = type === 'Date' ? updatedVal : updatedVal.slice(updatedVal.indexOf('.') + 1, updatedVal.length);\n                    }\n                }\n            }\n            else if (cell.validation.type === 'TextLength') {\n                value = args.value.toString().length.toString();\n            }\n            if (type === 'List') {\n                if (value1.indexOf('=') !== -1) {\n                    for (var idx = 0; idx < this.data.length; idx++) {\n                        if (args.value === this.data[idx].text) {\n                            isValidate = true;\n                        }\n                    }\n                }\n                else {\n                    var values = value1.split(',');\n                    for (var idx = 0; idx < values.length; idx++) {\n                        if (args.value === values[idx]) {\n                            isValidate = true;\n                        }\n                    }\n                }\n            }\n            else {\n                if (type === 'Decimal') {\n                    value = parseFloat(value.toString());\n                    value1 = parseFloat(value1.toString());\n                    value2 = value2 ? parseFloat(value2.toString()) : null;\n                }\n                else {\n                    value = parseInt(value.toString(), 10);\n                    value1 = parseInt(value1.toString(), 10);\n                    value2 = value2 ? parseInt(value2.toString(), 10) : null;\n                }\n                switch (opt) {\n                    case 'EqualTo':\n                        if (value === value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'NotEqualTo':\n                        if (value !== value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'Between':\n                        if (value >= value1 && value <= value2) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'NotBetween':\n                        if (value >= value1 && value <= value2) {\n                            isValidate = false;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = true;\n                        }\n                        break;\n                    case 'GreaterThan':\n                        if (value > value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'LessThan':\n                        if (value < value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'GreaterThanOrEqualTo':\n                        if (value >= value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    case 'LessThanOrEqualTo':\n                        if (value <= value1) {\n                            isValidate = true;\n                        }\n                        else if (ignoreBlank && enterValue === '') {\n                            isValidate = true;\n                        }\n                        else {\n                            isValidate = false;\n                        }\n                        break;\n                    default:\n                        break;\n                }\n            }\n        }\n        errorMsg = l10n.getConstant('ValidationError');\n        if (isValidate) {\n            var style = this.parent.getCellStyleValue(['backgroundColor', 'color'], [args.range[0], args.range[1]]);\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: args.range[0],\n                colIdx: args.range[1], isHeightCheckNeeded: true, manualUpdate: true,\n                onActionUpdate: true\n            });\n        }\n        return { isValidate: isValidate, errorMsg: errorMsg };\n    };\n    DataValidation.prototype.checkDataValidation = function (args) {\n        var isValid = this.isValidationHandler({\n            value: args.value, range: args.range, sheetIdx: args.sheetIdx\n        });\n        if (!isValid.isValidate && args.isCell) {\n            this.validationErrorHandler(isValid.errorMsg);\n        }\n        this.parent.allowDataValidation = isValid.isValidate;\n    };\n    DataValidation.prototype.formatValidation = function (value, type) {\n        var sheetPanel = this.parent.element.getElementsByClassName('e-sheet-panel')[0];\n        var isValidate;\n        var errorMsg;\n        var formEle = this.parent.createElement('form', {\n            id: 'formId',\n            className: 'form-horizontal'\n        });\n        var inputEle = this.parent.createElement('input', {\n            id: 'e-validation', innerHTML: value\n        });\n        inputEle.setAttribute('name', 'validation');\n        inputEle.setAttribute('type', 'text');\n        inputEle.setAttribute('value', value);\n        formEle.appendChild(inputEle);\n        sheetPanel.appendChild(formEle);\n        var options;\n        switch (type) {\n            case 'Date':\n                options = {\n                    rules: {\n                        'validation': { date: true },\n                    },\n                    customPlacement: function (inputElement, error) {\n                        errorMsg = error.innerText;\n                    }\n                };\n                break;\n            case 'Decimal':\n                options = {\n                    rules: {\n                        'validation': { number: true },\n                    },\n                    customPlacement: function (inputElement, error) {\n                        errorMsg = error.innerText;\n                    }\n                };\n                break;\n            case 'WholeNumber':\n                options = {\n                    rules: {\n                        'validation': { regex: /^\\d*\\.?[0]*$/ },\n                    },\n                    customPlacement: function (inputElement, error) {\n                        errorMsg = error.innerText;\n                    }\n                };\n                break;\n            default:\n                break;\n        }\n        var formObj = new FormValidator('#formId', options);\n        isValidate = formObj.validate();\n        sheetPanel.removeChild(sheetPanel.getElementsByClassName('form-horizontal')[0]);\n        return { isValidate: isValidate, errorMsg: errorMsg };\n    };\n    DataValidation.prototype.validationErrorHandler = function (error) {\n        var _this = this;\n        var el = document.getElementsByClassName('e-spreadsheet-edit')[0];\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (!this.parent.element.querySelector('.e-validationerror-dlg')) {\n            var erroDialogInst_1 = this.parent.serviceLocator.getService(dialog);\n            var disableCancel = false;\n            var dlgModel = {\n                width: 400, height: 200, isModal: true, showCloseIcon: true, cssClass: 'e-validationerror-dlg',\n                target: document.querySelector('.e-control.e-spreadsheet'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'ValidationErrorDialog',\n                        element: args.element, target: args.target, cancel: args.cancel, content: error\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        _this.errorDlgHandler(erroDialogInst_1, 'Cancel');\n                        args.cancel = true;\n                    }\n                    el.focus();\n                    erroDialogInst_1.dialogInstance.content = dlgArgs.content;\n                    erroDialogInst_1.dialogInstance.dataBind();\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('Retry'), isPrimary: true,\n                        },\n                        click: function () {\n                            _this.errorDlgHandler(erroDialogInst_1, 'Retry');\n                        }\n                    },\n                    {\n                        buttonModel: {\n                            content: l10n.getConstant('Cancel'),\n                        },\n                        click: function () {\n                            _this.errorDlgHandler(erroDialogInst_1, 'Cancel');\n                        }\n                    }]\n            };\n            erroDialogInst_1.show(dlgModel, disableCancel);\n        }\n    };\n    DataValidation.prototype.errorDlgHandler = function (errorDialogInst, buttonName) {\n        if (buttonName === 'Retry') {\n            var el = document.getElementsByClassName('e-spreadsheet-edit')[0];\n            var mainCont = this.parent.getMainContent();\n            errorDialogInst.hide();\n            if (el.innerText) {\n                var range = document.createRange();\n                range.setStart(el.childNodes[0], 0);\n                range.setEnd(el.childNodes[0], el.innerText.length);\n                var selection = window.getSelection();\n                selection.removeAllRanges();\n                selection.addRange(range);\n                if (this.listObj) {\n                    this.listObj.showPopup();\n                }\n            }\n        }\n        else {\n            var indexes = getCellIndexes(this.parent.getActiveSheet().activeCell);\n            var value = this.parent.getDisplayText(this.parent.getActiveSheet().rows[indexes[0]].cells[indexes[1]]);\n            this.parent.notify(editOperation, {\n                action: 'cancelEdit', value: value, refreshFormulaBar: true,\n                refreshEditorElem: true, isAppend: false, trigEvent: true\n            });\n            errorDialogInst.hide();\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    DataValidation.prototype.getModuleName = function () {\n        return 'dataValidation';\n    };\n    return DataValidation;\n}());\nexport { DataValidation };\n","import { applyProtect, protectSheet, protectCellFormat, editAlert, enableFormulaInput } from '../common/event';\nimport { clearCopy, protectSelection, clearUndoRedoCollection, focus } from '../common/index';\nimport { ListView } from '@syncfusion/ej2-lists';\nimport { EventHandler } from '@syncfusion/ej2-base';\nimport { locale, updateToggleItem } from '../common/index';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { applyLockCells, setCell } from '../../workbook/index';\n/**\n * The `Protect-sheet` module is used to handle the Protecting functionalities in Spreadsheet.\n */\nvar ProtectSheet = /** @class */ (function () {\n    /**\n     * Constructor for protectSheet module in Spreadsheet.\n     * @private\n     */\n    function ProtectSheet(parent) {\n        this.parent = parent;\n        this.init();\n    }\n    ProtectSheet.prototype.init = function () {\n        this.addEventListener();\n    };\n    /**\n     * To destroy the protectSheet module.\n     * @return {void}\n     * @hidden\n     */\n    ProtectSheet.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    ProtectSheet.prototype.addEventListener = function () {\n        this.parent.on(applyProtect, this.protect, this);\n        this.parent.on(protectSheet, this.protectSheetHandler, this);\n        this.parent.on(editAlert, this.editProtectedAlert, this);\n        this.parent.on(applyLockCells, this.lockCellsHandler, this);\n    };\n    ProtectSheet.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applyProtect, this.protect);\n            this.parent.off(protectSheet, this.protectSheetHandler);\n            this.parent.off(editAlert, this.editProtectedAlert);\n            this.parent.off(applyLockCells, this.lockCellsHandler);\n        }\n    };\n    ProtectSheet.prototype.protect = function (args) {\n        this.parent.notify(clearCopy, null);\n        if (!args.isActive) {\n            this.createDialogue();\n        }\n        else {\n            this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'isProtected', false);\n            this.parent.notify(updateToggleItem, { props: 'Protect' });\n            this.parent.notify(protectSheet, { isActive: args.isActive });\n            this.parent.notify(protectSelection, null);\n        }\n    };\n    ProtectSheet.prototype.createDialogue = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var listData = [\n            { text: l10n.getConstant('SelectCells'), id: '1' },\n            { text: l10n.getConstant('FormatCells'), id: '2' },\n            { text: l10n.getConstant('FormatRows'), id: '3' },\n            { text: l10n.getConstant('FormatColumns'), id: '4' },\n            { text: l10n.getConstant('InsertLinks'), id: '5' }\n        ];\n        this.optionList = new ListView({\n            width: '250px',\n            dataSource: listData,\n            showCheckBox: true,\n            select: this.dialogOpen.bind(this),\n        });\n        var protectHeaderCntent = this.parent.createElement('div', { className: 'e-protect-content',\n            innerHTML: l10n.getConstant('ProtectAllowUser') });\n        this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'isProtected', false);\n        var checkbox = new CheckBox({ checked: true, label: l10n.getConstant('ProtectContent'), cssClass: 'e-protect-checkbox' });\n        var listViewElement = this.parent.createElement('div', { className: 'e-protect-option-list',\n            id: this.parent.element.id + '_option_list' });\n        var headerContent = this.parent.createElement('div', { className: 'e-header-content', innerHTML: l10n.getConstant('ProtectSheet') });\n        var checkBoxElement = this.parent.createElement('input', { id: this.parent.element.id + '_protect_check', attrs: { type: 'checkbox' } });\n        this.dialog = this.parent.serviceLocator.getService('dialog');\n        this.dialog.show({\n            header: headerContent.outerHTML,\n            content: checkBoxElement.outerHTML + protectHeaderCntent.outerHTML + listViewElement.outerHTML,\n            showCloseIcon: true, isModal: true,\n            cssClass: 'e-protect-dlg',\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'ProtectSheetDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                focus(_this.parent.element);\n            },\n            open: function () {\n                _this.okBtnFocus();\n            },\n            beforeClose: function () {\n                var checkboxElement = document.getElementById(_this.parent.element.id + '_protect_check');\n                EventHandler.remove(checkboxElement, 'focus', _this.okBtnFocus);\n                EventHandler.remove(checkbox.element, 'click', _this.checkBoxClickHandler);\n                focus(_this.parent.element);\n            },\n            buttons: [{ click: (this.selectOption.bind(this, this.dialog, this)),\n                    buttonModel: { content: l10n.getConstant('Ok'), isPrimary: true } }]\n        });\n        checkbox.appendTo('#' + this.parent.element.id + '_protect_check');\n        this.optionList.appendTo('#' + this.parent.element.id + '_option_list');\n        this.optionList.selectMultipleItems([{ id: '1' }]);\n        EventHandler.add(checkbox.element, 'click', this.checkBoxClickHandler, this);\n    };\n    ;\n    ProtectSheet.prototype.okBtnFocus = function () {\n        var _this = this;\n        var checkboxElement = document.getElementById(this.parent.element.id + '_protect_check');\n        checkboxElement.addEventListener('focus', function () {\n            _this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').focus();\n        });\n    };\n    ProtectSheet.prototype.checkBoxClickHandler = function () {\n        var ch = document.getElementById(this.parent.element.id + '_protect_check');\n        if (ch.checked === false) {\n            this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').disabled = true;\n        }\n        else {\n            this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').disabled = false;\n            this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').focus();\n        }\n    };\n    ProtectSheet.prototype.dialogOpen = function () {\n        this.dialog.dialogInstance.element.getElementsByClassName('e-footer-content')[0].querySelector('button').focus();\n    };\n    ProtectSheet.prototype.selectOption = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var selectedItems = this.optionList.getSelectedItems();\n        this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'isProtected', true);\n        var protectSettings = { selectCells: selectedItems.text.indexOf(l10n.getConstant('SelectCells')) > -1,\n            formatCells: selectedItems.text.indexOf(l10n.getConstant('FormatCells')) > -1,\n            formatRows: selectedItems.text.indexOf(l10n.getConstant('FormatRows')) > -1,\n            formatColumns: selectedItems.text.indexOf(l10n.getConstant('FormatColumns')) > -1,\n            insertLink: selectedItems.text.indexOf(l10n.getConstant('InsertLinks')) > -1 };\n        this.parent.protectSheet(null, protectSettings);\n        this.parent.notify(protectSelection, null);\n        this.parent.notify(clearUndoRedoCollection, null);\n        this.dialog.hide();\n    };\n    ProtectSheet.prototype.protectSheetHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var id = this.parent.element.id;\n        var disableHomeBtnId = [id + '_undo', id + '_redo', id + '_cut', id + '_copy', id + '_paste', id + '_number_format',\n            id + '_font_name', id + '_font_size', id + '_bold', id + '_italic', id + '_line-through', id + '_underline',\n            id + '_font_color_picker', id + '_fill_color_picker', id + '_borders', id + '_merge_cells', id + '_text_align',\n            id + '_vertical_align', id + '_wrap', id + '_sorting', id + '_clear', id + '_conditionalformatting'];\n        var enableHomeBtnId = [id + '_cut', id + '_copy', id + '_number_format', id + '_font_name', id + '_font_size',\n            id + '_bold', id + '_italic', id + '_line-through', id + '_underline', id + '_font_color_picker', id + '_fill_color_picker',\n            id + '_borders', id + '_text_align', id + '_vertical_align', id + '_wrap', id + '_sorting',\n            id + '_clear', id + '_conditionalformatting'];\n        var enableFrmlaBtnId = [id + '_insert_function'];\n        var enableInsertBtnId = [id + '_hyperlink', id + '_', id + '_chart'];\n        var imageBtnId = [id + '_'];\n        var findBtnId = [id + '_find'];\n        var dataValidationBtnId = [id + '_datavalidation'];\n        var chartBtnId = [id + '_chart'];\n        var sheetElement = document.getElementById(this.parent.element.id + '_sheet_panel');\n        if (sheetElement) {\n            if ((sheet.isProtected && sheet.protectSettings.selectCells)) {\n                {\n                    sheetElement.classList.remove('e-protected');\n                }\n            }\n            else {\n                sheetElement.classList.add('e-protected');\n            }\n            if (!sheet.isProtected) {\n                sheetElement.classList.remove('e-protected');\n            }\n        }\n        this.parent.dataBind();\n        this.parent.notify(protectCellFormat, { disableHomeBtnId: disableHomeBtnId,\n            enableHomeBtnId: enableHomeBtnId, enableFrmlaBtnId: enableFrmlaBtnId, enableInsertBtnId: enableInsertBtnId,\n            findBtnId: findBtnId, dataValidationBtnId: dataValidationBtnId, imageBtnId: imageBtnId, chartBtnId: chartBtnId });\n        this.parent.notify(enableFormulaInput, null);\n        this.parent.notify(updateToggleItem, { props: 'Protect' });\n    };\n    ProtectSheet.prototype.editProtectedAlert = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.dialog = this.parent.serviceLocator.getService('dialog');\n        this.dialog.show({\n            content: l10n.getConstant('EditAlert'),\n            isModal: true,\n            closeOnEscape: true,\n            showCloseIcon: true,\n            width: '400px',\n            cssClass: 'e-editAlert-dlg',\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'EditAlertDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                focus(_this.parent.element);\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n    };\n    ProtectSheet.prototype.lockCellsHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var cellObj = { isLocked: args.isLocked ? args.isLocked : false };\n        setCell(args.rowIdx, args.colIdx, sheet, cellObj, true);\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     *\n     * @private\n     */\n    ProtectSheet.prototype.getModuleName = function () {\n        return 'protectSheet';\n    };\n    return ProtectSheet;\n}());\nexport { ProtectSheet };\n","import { findDlg, locale, dialog, gotoDlg, replace, findHandler, beginAction, focus } from '../common/index';\nimport { completeAction } from '../common/index';\nimport { getComponent, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { goto, showDialog, findUndoRedo, count, replaceAllDialog, findKeyUp } from '../../workbook/index';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { TextBox } from '@syncfusion/ej2-inputs';\n/**\n * `FindAndReplace` module is used to handle the search action in Spreadsheet.\n */\nvar FindAndReplace = /** @class */ (function () {\n    /**\n     * Constructor for FindAndReplace module.\n     */\n    function FindAndReplace(parent) {\n        this.shortValue = '';\n        this.parent = parent;\n        this.addEventListener();\n    }\n    FindAndReplace.prototype.addEventListener = function () {\n        this.parent.on(findDlg, this.renderFindDlg, this);\n        this.parent.on(gotoDlg, this.renderGotoDlg, this);\n        this.parent.on(goto, this.gotoHandler, this);\n        this.parent.on(findHandler, this.findHandler, this);\n        this.parent.on(replace, this.replaceHandler, this);\n        this.parent.on(showDialog, this.showDialog, this);\n        this.parent.on(replaceAllDialog, this.replaceAllDialog, this);\n        this.parent.on(findUndoRedo, this.findUndoRedo, this);\n        this.parent.on(findKeyUp, this.findKeyUp, this);\n    };\n    FindAndReplace.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(findDlg, this.renderFindDlg);\n            this.parent.off(gotoDlg, this.renderGotoDlg);\n            this.parent.off(goto, this.gotoHandler);\n            this.parent.off(findHandler, this.findHandler);\n            this.parent.off(replace, this.replaceHandler);\n            this.parent.off(showDialog, this.showDialog);\n            this.parent.off(replaceAllDialog, this.replaceAllDialog);\n            this.parent.off(findUndoRedo, this.findUndoRedo);\n            this.parent.off(findKeyUp, this.findKeyUp);\n        }\n    };\n    FindAndReplace.prototype.findUndoRedo = function (options) {\n        var eventArgs = { address: options.address, compareVal: options.compareVal, cancel: false };\n        if (options.undoRedoOpt === 'before') {\n            this.parent.notify(beginAction, { action: 'beforeReplace', eventArgs: eventArgs });\n        }\n        else if (options.undoRedoOpt === 'after') {\n            if (!eventArgs.cancel) {\n                var eventArgs_1 = { address: options.address, compareVal: options.compareVal };\n                this.parent.notify(completeAction, { action: 'replace', eventArgs: eventArgs_1 });\n            }\n        }\n        else if (options.undoRedoOpt === 'beforeReplaceAll') {\n            if (!eventArgs.cancel) {\n                var eventArgs_2 = { replaceValue: options.replaceValue, addressCollection: options.Collection };\n                this.parent.notify(beginAction, { action: 'beforeReplaceAll', eventArgs: eventArgs_2 });\n            }\n        }\n        else if (options.undoRedoOpt === 'afterReplaceAll') {\n            if (!eventArgs.cancel) {\n                var eventArgs_3 = { replaceValue: options.replaceValue, addressCollection: options.Collection };\n                this.parent.notify(completeAction, { action: 'replaceAll', eventArgs: eventArgs_3 });\n            }\n        }\n    };\n    FindAndReplace.prototype.renderFindDlg = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        var cancelButton = false;\n        if (isNullOrUndefined(this.parent.element.querySelector('.e-find-dlg'))) {\n            var dlg = {\n                isModal: false, showCloseIcon: true, cssClass: 'e-find-dlg', allowDragging: true,\n                header: l10n.getConstant('FindAndReplace'), closeOnEscape: false,\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'FindAndReplaceDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst.dialogInstance.content = _this.findandreplaceContent();\n                    dialogInst.dialogInstance.dataBind();\n                    focus(_this.parent.element);\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('FindPreviousBtn'), isPrimary: true, cssClass: 'e-btn-findPrevious', disabled: true\n                        },\n                        click: function () {\n                            _this.dialogMessage();\n                            _this.findDlgClick('prev');\n                        }\n                    }, {\n                        buttonModel: {\n                            content: l10n.getConstant('FindNextBtn'), isPrimary: true, cssClass: 'e-btn-findNext', disabled: true\n                        },\n                        click: function () {\n                            _this.dialogMessage();\n                            _this.findDlgClick('next');\n                        }\n                    }, {\n                        buttonModel: {\n                            content: l10n.getConstant('ReplaceBtn'), isPrimary: true, cssClass: 'e-btn-replace', disabled: true\n                        },\n                        click: function () {\n                            _this.dialogMessage();\n                            _this.findDlgClick('replace');\n                        }\n                    }, {\n                        buttonModel: {\n                            content: l10n.getConstant('ReplaceAllBtn'), isPrimary: true, cssClass: 'e-btn-replaceAll', disabled: true\n                        },\n                        click: function () {\n                            _this.dialogMessage();\n                            _this.findDlgClick('replaceAll');\n                        }\n                    }], open: function () {\n                    var findInput = _this.parent.element.querySelector('.e-text-findNext').value;\n                    if (findInput) {\n                        var prevButton = _this.parent.element.querySelector('.e-btn-findPrevious');\n                        var prevButtonObj = getComponent(prevButton, 'btn');\n                        prevButtonObj.disabled = false;\n                        getComponent(_this.parent.element.querySelector('.e-btn-findNext'), 'btn').disabled = false;\n                    }\n                }, close: function () {\n                    dialogInst.hide();\n                }\n            };\n            dialogInst.show(dlg, cancelButton);\n        }\n        else {\n            dialogInst.hide();\n        }\n    };\n    FindAndReplace.prototype.dialogMessage = function () {\n        if (this.parent.element.querySelector('.e-replace-alert-span')) {\n            this.parent.element.querySelector('.e-replace-alert-span').remove();\n        }\n        else if (this.parent.element.querySelector('.e-find-alert-span')) {\n            this.parent.element.querySelector('.e-find-alert-span').remove();\n        }\n    };\n    FindAndReplace.prototype.renderGotoDlg = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        var cancelBtn = false;\n        if (isNullOrUndefined(this.parent.element.querySelector('.e-find-dlg'))) {\n            var dlg = {\n                width: 300, isModal: false, showCloseIcon: true, cssClass: 'e-goto-dlg', allowDragging: true,\n                header: l10n.getConstant('GotoHeader'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'GoToDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    dialogInst.dialogInstance.content = _this.GotoContent();\n                    dialogInst.dialogInstance.dataBind();\n                    focus(_this.parent.element);\n                },\n                buttons: [{\n                        buttonModel: {\n                            content: l10n.getConstant('Ok'), isPrimary: true, cssClass: 'e-btn-goto-ok'\n                        },\n                        click: function () {\n                            _this.gotoHandler();\n                        },\n                    }], close: function () {\n                    dialogInst.hide();\n                }, open: function () {\n                    _this.textFocus();\n                },\n            };\n            dialogInst.show(dlg, cancelBtn);\n        }\n        else {\n            dialogInst.hide();\n        }\n    };\n    FindAndReplace.prototype.textFocus = function () {\n        var _this = this;\n        var element = this.parent.element.querySelector('.e-text-goto');\n        element.addEventListener('focus', function () {\n            if (_this.parent.element.querySelector('.e-goto-alert-span')) {\n                _this.parent.element.querySelector('.e-goto-alert-span').remove();\n            }\n        });\n    };\n    FindAndReplace.prototype.findDlgClick = function (findDlgArgs) {\n        if (findDlgArgs === 'prev') {\n            this.findHandler({ findOption: findDlgArgs });\n        }\n        else if (findDlgArgs === 'next') {\n            this.findHandler({ findOption: findDlgArgs });\n        }\n        else {\n            this.replaceHandler({ findDlgArgs: findDlgArgs });\n        }\n    };\n    FindAndReplace.prototype.findHandler = function (findOpt) {\n        var findInput = this.parent.element.querySelector('.e-text-findNext');\n        if (!findInput) {\n            findInput = this.parent.element.querySelector('.e-text-findNext-short');\n            if (!findInput) {\n                this.gotoAlert();\n            }\n        }\n        var value = findInput.value;\n        if (findInput.value !== '') {\n            var sheetIndex = this.parent.activeSheetIndex;\n            var checkCase = this.parent.element.querySelector('.e-findnreplace-checkcase');\n            var isCSen = void 0;\n            if (!checkCase) {\n                isCSen = false;\n            }\n            else {\n                var caseCheckbox = getComponent(checkCase, 'checkbox');\n                isCSen = caseCheckbox.checked;\n            }\n            var checkmatch = this.parent.element.querySelector('.e-findnreplace-checkmatch');\n            var isEMatch = void 0;\n            if (!checkmatch) {\n                isEMatch = false;\n            }\n            else {\n                var entireMatchCheckbox = getComponent(checkmatch, 'checkbox');\n                isEMatch = entireMatchCheckbox.checked;\n            }\n            var searchitem = this.parent.element.querySelector('.e-findnreplace-searchby');\n            var searchBy = void 0;\n            if (!searchitem) {\n                searchBy = 'By Row';\n            }\n            else {\n                var searchDDL = getComponent(searchitem, 'dropdownlist');\n                searchBy = searchDDL.value.toString();\n            }\n            var modeitem = this.parent.element.querySelector('.e-findnreplace-searchwithin');\n            var mode = void 0;\n            if (!modeitem) {\n                mode = 'Sheet';\n            }\n            else {\n                var modeDDL = getComponent(modeitem, 'dropdownlist');\n                mode = modeDDL.value.toString();\n            }\n            var args = {\n                value: value, sheetIndex: sheetIndex, findOpt: findOpt.findOption, mode: mode, isCSen: isCSen,\n                isEMatch: isEMatch, searchBy: searchBy\n            };\n            if (findOpt.findOption === 'next' || findOpt.findOption === 'prev') {\n                this.parent.find(args);\n            }\n            else if (findOpt.countArgs.countOpt === 'count') {\n                this.parent.notify(count, args);\n                findOpt.countArgs.findCount = args.findCount;\n            }\n        }\n    };\n    FindAndReplace.prototype.replaceHandler = function (replace) {\n        var sheetIndex = this.parent.activeSheetIndex;\n        var findInput = this.parent.element.querySelector('.e-text-findNext');\n        var replaceWith = this.parent.element.querySelector('.e-text-replaceInp');\n        var checkCase = this.parent.element.querySelector('.e-findnreplace-checkcase');\n        var caseCheckbox = getComponent(checkCase, 'checkbox');\n        var checkmatch = this.parent.element.querySelector('.e-findnreplace-checkmatch');\n        var eMatchCheckbox = getComponent(checkmatch, 'checkbox');\n        var searchitem = this.parent.element.querySelector('.e-findnreplace-searchby');\n        var searchDDL = getComponent(searchitem, 'dropdownlist');\n        var modeitem = this.parent.element.querySelector('.e-findnreplace-searchwithin');\n        var modeDDL = getComponent(modeitem, 'dropdownlist');\n        var findOption = 'next';\n        var args = {\n            value: findInput.value, mode: modeDDL.value.toString(), isCSen: caseCheckbox.checked,\n            isEMatch: eMatchCheckbox.checked, searchBy: searchDDL.value.toString(), findOpt: findOption, replaceValue: replaceWith.value,\n            replaceBy: replace.findDlgArgs ? replace.findDlgArgs : replace.replaceMode, sheetIndex: sheetIndex\n        };\n        this.parent.replace(args);\n    };\n    FindAndReplace.prototype.gotoHandler = function (address) {\n        if (address) {\n            this.parent.goTo(address.address);\n        }\n        else {\n            var item = this.parent.element.querySelector('.e-text-goto');\n            var gotoaddress = item.value;\n            var splitAddress = gotoaddress.split('');\n            if ((gotoaddress === '') || isNaN(parseInt(splitAddress[1], 10))) {\n                this.gotoAlert();\n                return;\n            }\n            else {\n                var address_1 = gotoaddress.toString().toUpperCase();\n                this.parent.goTo(address_1);\n            }\n        }\n    };\n    FindAndReplace.prototype.gotoAlert = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var gotoSpan = this.parent.createElement('span', {\n            className: 'e-goto-alert-span',\n            innerHTML: l10n.getConstant('InsertingEmptyValue')\n        });\n        (this.parent.element.querySelector('.e-goto-dlg').querySelector('.e-dlg-content')).appendChild(gotoSpan);\n    };\n    FindAndReplace.prototype.showDialog = function () {\n        if (this.parent.element.querySelector('.e-replace-alert-span')) {\n            this.parent.element.querySelector('.e-replace-alert-span').remove();\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var findSpan = this.parent.createElement('span', {\n            className: 'e-find-alert-span',\n            innerHTML: l10n.getConstant('NoElements')\n        });\n        (this.parent.element.querySelector('.e-find-dlg').querySelector('.e-dlg-content')).appendChild(findSpan);\n    };\n    FindAndReplace.prototype.replaceAllDialog = function (options) {\n        if (this.parent.element.querySelector('.e-find-alert-span')) {\n            this.parent.element.querySelector('.e-find-alert-span').remove();\n        }\n        var l10n = (this.parent.serviceLocator.getService(locale));\n        var replaceSpan = this.parent.createElement('span', {\n            className: 'e-replace-alert-span',\n            innerHTML: options.count + l10n.getConstant('ReplaceAllEnd') + options.replaceValue\n        });\n        if (this.parent.element.querySelector('.e-find-dlg')) {\n            (this.parent.element.querySelector('.e-find-dlg').querySelector('.e-dlg-content')).appendChild(replaceSpan);\n        }\n    };\n    FindAndReplace.prototype.findKeyUp = function (e) {\n        if (e.target, 'e-text-findNext') {\n            var findValue_1 = this.parent.element.querySelector('.e-text-findNext').value;\n            if (!isNullOrUndefined(findValue_1) && findValue_1 !== '') {\n                var prevButton = this.parent.element.querySelector('.e-btn-findPrevious');\n                var prevButtonObj = getComponent(prevButton, 'btn');\n                prevButtonObj.disabled = false;\n                getComponent(this.parent.element.querySelector('.e-btn-findNext'), 'btn').disabled = false;\n            }\n            else {\n                getComponent(this.parent.element.querySelector('.e-btn-findPrevious'), 'btn').disabled = true;\n                getComponent(this.parent.element.querySelector('.e-btn-findNext'), 'btn').disabled = true;\n                this.dialogMessage();\n            }\n        }\n        var findValue = this.parent.element.querySelector('.e-text-findNext').value;\n        var replaceValue = this.parent.element.querySelector('.e-text-replaceInp').value;\n        if (!isNullOrUndefined(findValue) && !isNullOrUndefined(replaceValue) && (findValue !== '') && (replaceValue !== '')) {\n            if (this.parent.getActiveSheet().isProtected === false) {\n                getComponent(this.parent.element.querySelector('.e-btn-replace'), 'btn').disabled = false;\n                getComponent(this.parent.element.querySelector('.e-btn-replaceAll'), 'btn').disabled = false;\n            }\n        }\n        else {\n            getComponent(this.parent.element.querySelector('.e-btn-replace'), 'btn').disabled = true;\n            getComponent(this.parent.element.querySelector('.e-btn-replaceAll'), 'btn').disabled = true;\n            this.dialogMessage();\n        }\n    };\n    FindAndReplace.prototype.findandreplaceContent = function () {\n        if (this.parent.element.querySelector('.e-text-findNext-short')) {\n            this.shortValue = this.parent.element.querySelector('.e-text-findNext-short').value;\n        }\n        var dialogElem = this.parent.createElement('div', { className: 'e-link-dialog' });\n        var findElem = this.parent.createElement('div', { className: 'e-find' });\n        var findCheck = this.parent.createElement('div', { className: 'e-findCheck' });\n        var l10n = this.parent.serviceLocator.getService(locale);\n        dialogElem.appendChild(findElem);\n        var findTextE = this.parent.createElement('div', { className: 'e-cont' });\n        var findTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('FindWhat') });\n        var findTextIp = this.parent.createElement('input', {\n            className: 'e-input e-text-findNext', attrs: {\n                'type': 'Text', 'placeholder': l10n.getConstant('FindValue'),\n                'value': this.shortValue\n            }\n        });\n        findTextE.appendChild(findTextIp);\n        findTextE.insertBefore(findTextH, findTextIp);\n        findElem.appendChild(findTextE);\n        var findTextBox = new TextBox({ width: '70%' });\n        findTextBox.createElement = this.parent.createElement;\n        findTextBox.appendTo(findTextIp);\n        var replaceTextE = this.parent.createElement('div', { className: 'e-cont' });\n        var replaceTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('ReplaceWith') });\n        var replaceTextIp = this.parent.createElement('input', {\n            className: 'e-input e-text-replaceInp', attrs: { 'type': 'Text', 'placeholder': l10n.getConstant('ReplaceValue') }\n        });\n        replaceTextE.appendChild(replaceTextIp);\n        replaceTextE.insertBefore(replaceTextH, replaceTextIp);\n        findElem.appendChild(replaceTextE);\n        var replaceTextBox = new TextBox({ width: '70%' });\n        replaceTextBox.createElement = this.parent.createElement;\n        replaceTextBox.appendTo(replaceTextIp);\n        var withinData = [\n            { Id: 'Sheet', Within: l10n.getConstant('Sheet') },\n            { Id: 'Workbook', Within: l10n.getConstant('Workbook') }\n        ];\n        var withInDDL = new DropDownList({\n            dataSource: withinData,\n            cssClass: 'e-searchby',\n            fields: { value: 'Id', text: 'Within' }, width: '50%', index: 0\n        });\n        var withIn = this.parent.createElement('input', {\n            className: 'e-findnreplace-searchwithin', attrs: { type: 'select', label: l10n.getConstant('SearchBy') }\n        });\n        var withinTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('SearchWithin') });\n        findElem.appendChild(withinTextH);\n        findElem.appendChild(withIn);\n        withInDDL.createElement = this.parent.createElement;\n        withInDDL.appendTo(withIn);\n        var searchData = [\n            { Id: 'By Row', Search: l10n.getConstant('ByRow') },\n            { Id: 'By Column', Search: l10n.getConstant('ByColumn') }\n        ];\n        var searchDDL = new DropDownList({\n            dataSource: searchData,\n            cssClass: 'e-searchby',\n            fields: { value: 'Id', text: 'Search' }, width: '50%', index: 0\n        });\n        var searchIn = this.parent.createElement('input', {\n            className: 'e-findnreplace-searchby', attrs: { type: 'select', label: l10n.getConstant('SearchBy') }\n        });\n        var searchTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('SearchBy') });\n        findElem.appendChild(searchTextH);\n        findElem.appendChild(searchIn);\n        searchDDL.createElement = this.parent.createElement;\n        searchDDL.appendTo(searchIn);\n        var isCSen = new CheckBox({\n            label: l10n.getConstant('MatchCase'), checked: false,\n            cssClass: 'e-findnreplace-casecheckbox'\n        });\n        var caaseCheckbox = this.parent.createElement('input', {\n            className: 'e-findnreplace-checkcase', attrs: { type: 'checkbox' }\n        });\n        findCheck.appendChild(caaseCheckbox);\n        isCSen.createElement = this.parent.createElement;\n        isCSen.appendTo(caaseCheckbox);\n        var isEMatch = new CheckBox({\n            label: l10n.getConstant('MatchExactCellElements'), checked: false,\n            cssClass: 'e-findnreplace-exactmatchcheckbox',\n        });\n        var entirematchCheckbox = this.parent.createElement('input', {\n            className: 'e-findnreplace-checkmatch', attrs: { type: 'checkbox' }\n        });\n        findCheck.appendChild(entirematchCheckbox);\n        isEMatch.createElement = this.parent.createElement;\n        isEMatch.appendTo(entirematchCheckbox);\n        findElem.appendChild(findCheck);\n        return dialogElem;\n    };\n    FindAndReplace.prototype.GotoContent = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogElem = this.parent.createElement('div', { className: 'e-link-dialog' });\n        var gotoElem = this.parent.createElement('div', { className: 'e-goto' });\n        dialogElem.appendChild(gotoElem);\n        var gotoTextE = this.parent.createElement('div', { className: 'e-cont' });\n        var gotoTextH = this.parent.createElement('p', { className: 'e-header', innerHTML: l10n.getConstant('Reference') });\n        var gotoTextBox = new TextBox({\n            placeholder: l10n.getConstant('EntercellAddress')\n        });\n        var gotoTextIp = this.parent.createElement('input', { className: 'e-text-goto', attrs: { 'type': 'Text' } });\n        gotoTextE.appendChild(gotoTextIp);\n        gotoTextE.insertBefore(gotoTextH, gotoTextIp);\n        gotoElem.appendChild(gotoTextE);\n        gotoTextBox.createElement = this.parent.createElement;\n        gotoTextBox.appendTo(gotoTextIp);\n        return dialogElem;\n    };\n    /**\n     * To destroy the find-and-replace module.\n     * @return {void}\n     */\n    FindAndReplace.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    FindAndReplace.prototype.getModuleName = function () {\n        return 'findAndReplace';\n    };\n    return FindAndReplace;\n}());\nexport { FindAndReplace };\n","import { applyMerge, activeCellMergedRange } from '../../workbook/common/index';\nimport { hiddenMerge, dialog, locale, focus } from '../common/index';\nimport { checkPrevMerge, checkMerge } from '../common/index';\nimport { getCell, isHiddenCol, isHiddenRow } from '../../workbook/index';\n/**\n * The `Merge` module is used to to merge the range of cells.\n */\nvar Merge = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet merge module.\n     * @private\n     */\n    function Merge(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Merge.prototype.merge = function (args) {\n        var _this = this;\n        if (args.showDialog) {\n            this.parent.serviceLocator.getService(dialog).show({\n                target: this.parent.element,\n                height: 180, width: 400, isModal: true, showCloseIcon: true,\n                content: this.parent.serviceLocator.getService(locale).getConstant('PasteMergeAlert'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'MergeDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    focus(_this.parent.element);\n                },\n            });\n            return;\n        }\n        this.parent.serviceLocator.getService('cell').refresh(args.rowIdx, args.colIdx, args.lastCell, args.element);\n    };\n    Merge.prototype.hideHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var mergeArgs = { range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx] };\n        this.parent.notify(activeCellMergedRange, mergeArgs);\n        mergeArgs.range = mergeArgs.range;\n        var endIdx;\n        var cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet) || {};\n        var startIdx = args.model === 'row' ? mergeArgs.range[0] : mergeArgs.range[1];\n        endIdx = startIdx + ((cell[args.model + \"Span\"] || 1) - 1);\n        if ((!args.isEnd && (args.start === startIdx || isHiddenCol(sheet, startIdx))) || (args.isEnd && (args.start > startIdx &&\n            !isHiddenCol(sheet, startIdx)))) {\n            return;\n        }\n        if (cell[args.model + \"Span\"] > 1 && endIdx >= args.start) {\n            if (args.model === 'row' ? isHiddenRow(sheet, startIdx) : isHiddenCol(sheet, startIdx)) {\n                if (args.end < endIdx && (endIdx - args.end > 1 || cell.rowSpan > 1)) {\n                    var cellEle = this.parent.getCell(args.rowIdx, args.end + 1);\n                    if (cellEle) {\n                        if (endIdx - args.end > 1) {\n                            cellEle.colSpan = endIdx - args.end;\n                        }\n                        cellEle.style.display = '';\n                    }\n                    if (cell.rowSpan > 1) {\n                        var rowSpan = cell.rowSpan - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (cell.rowSpan - 1));\n                        if (rowSpan > 1) {\n                            cellEle.rowSpan = rowSpan;\n                        }\n                    }\n                }\n            }\n            else {\n                this.merge({ rowIdx: mergeArgs.range[0], colIdx: mergeArgs.range[1] });\n            }\n        }\n    };\n    Merge.prototype.checkPrevMerge = function (args) {\n        var cell;\n        var sheet = this.parent.getActiveSheet();\n        var mergeArgs;\n        var mergeCount;\n        if (args.isRow) {\n            if (args.rowIdx - 1 > -1 && isHiddenRow(sheet, args.rowIdx - 1)) {\n                cell = getCell(args.rowIdx - 1, args.colIdx, sheet) || {};\n                if ((cell.rowSpan !== undefined || cell.colSpan !== undefined) && (cell.colSpan === undefined || cell.colSpan > 1 ||\n                    (args.colIdx - 1 > -1 && isHiddenCol(sheet, args.colIdx - 1)))) {\n                    mergeArgs = { range: [args.rowIdx - 1, args.colIdx, args.rowIdx - 1, args.colIdx] };\n                    this.parent.notify(activeCellMergedRange, mergeArgs);\n                    mergeArgs.range = mergeArgs.range;\n                    if (isHiddenRow(sheet, mergeArgs.range[0]) && mergeArgs.range[2] >= args.rowIdx) {\n                        cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet) || {};\n                        if (cell.rowSpan > 1) {\n                            mergeCount = (mergeArgs.range[2] - args.rowIdx) + 1 - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (mergeArgs.range[2] - args.rowIdx));\n                            if (mergeCount > 1) {\n                                args.td.rowSpan = mergeCount;\n                                args.td.style.display = '';\n                            }\n                            if (cell.colSpan > 1 && !(args.colIdx - 1 > -1 && isHiddenCol(sheet, args.colIdx - 1))) {\n                                mergeCount = cell.colSpan - this.parent.hiddenCount(args.colIdx, args.colIdx + (cell.colSpan - 1), 'columns');\n                                if (mergeCount > 1) {\n                                    args.td.colSpan = mergeCount;\n                                    args.td.style.display = '';\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            return;\n        }\n        if (args.colIdx - 1 > -1 && isHiddenCol(sheet, args.colIdx - 1)) {\n            cell = getCell(args.rowIdx, args.colIdx - 1, sheet) || {};\n            if ((cell.colSpan !== undefined || cell.rowSpan !== undefined) && (cell.rowSpan === undefined || cell.rowSpan > 1 ||\n                (args.rowIdx - 1 > -1 && isHiddenRow(sheet, args.rowIdx - 1)))) {\n                mergeArgs = { range: [args.rowIdx, args.colIdx - 1, args.rowIdx, args.colIdx - 1] };\n                this.parent.notify(activeCellMergedRange, mergeArgs);\n                mergeArgs.range = mergeArgs.range;\n                if (isHiddenCol(sheet, mergeArgs.range[1]) && mergeArgs.range[3] >= args.colIdx) {\n                    cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet) || {};\n                    if (cell.colSpan > 1) {\n                        mergeCount = (mergeArgs.range[3] - args.colIdx) + 1 - this.parent.hiddenCount(args.colIdx, args.colIdx + (cell.colSpan - 1), 'columns');\n                        if (mergeCount > 1) {\n                            args.td.colSpan = mergeCount;\n                            args.td.style.display = '';\n                        }\n                        if (cell.rowSpan > 1 && !(args.rowIdx - 1 > -1 && isHiddenRow(sheet, args.rowIdx - 1))) {\n                            mergeCount = cell.rowSpan - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (cell.rowSpan - 1));\n                            if (mergeCount > 1) {\n                                args.td.rowSpan = mergeCount;\n                                args.td.style.display = '';\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Merge.prototype.checkMerge = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var cell = getCell(args.rowIdx, args.colIdx, sheet) || {};\n        if (args.isRow) {\n            if (cell.colSpan === undefined || isHiddenCol(sheet, args.colIdx - 1)) {\n                var mergeArgs = { range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx] };\n                mergeArgs.range = mergeArgs.range;\n                this.parent.notify(activeCellMergedRange, mergeArgs);\n                if (isHiddenCol(sheet, args.colIdx - 1) && !isHiddenCol(sheet, mergeArgs.range[1])) {\n                    return;\n                }\n                cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet);\n                var mergeCount = (mergeArgs.range[2] - args.rowIdx) + 1 - this.parent.hiddenCount(args.rowIdx, mergeArgs.range[2]);\n                if (mergeCount > 1) {\n                    this.merge({ rowIdx: mergeArgs.range[0], colIdx: mergeArgs.range[1], element: args.td });\n                    args.td.rowSpan = mergeCount;\n                    args.td.style.display = '';\n                }\n            }\n        }\n        else {\n            if (cell.rowSpan === undefined || isHiddenRow(sheet, args.rowIdx - 1)) {\n                var mergeArgs = { range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx] };\n                mergeArgs.range = mergeArgs.range;\n                this.parent.notify(activeCellMergedRange, mergeArgs);\n                if (isHiddenRow(sheet, args.rowIdx - 1) && !isHiddenRow(sheet, mergeArgs.range[0])) {\n                    return;\n                }\n                cell = getCell(mergeArgs.range[0], mergeArgs.range[1], sheet);\n                var mergeCount = (mergeArgs.range[3] - args.colIdx) + 1 - this.parent.hiddenCount(args.colIdx, mergeArgs.range[3], 'columns');\n                if (mergeCount > 1) {\n                    this.merge({ rowIdx: mergeArgs.range[0], colIdx: mergeArgs.range[1], element: args.td });\n                    args.td.colSpan = mergeCount;\n                    args.td.style.display = '';\n                }\n            }\n        }\n    };\n    Merge.prototype.addEventListener = function () {\n        this.parent.on(applyMerge, this.merge, this);\n        this.parent.on(hiddenMerge, this.hideHandler, this);\n        this.parent.on(checkPrevMerge, this.checkPrevMerge, this);\n        this.parent.on(checkMerge, this.checkMerge, this);\n    };\n    /**\n     * Destroy merge module.\n     */\n    Merge.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Merge.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applyMerge, this.merge);\n            this.parent.off(hiddenMerge, this.hideHandler);\n            this.parent.off(checkPrevMerge, this.checkPrevMerge);\n            this.parent.off(checkMerge, this.checkMerge);\n        }\n    };\n    /**\n     * Get the merge module name.\n     */\n    Merge.prototype.getModuleName = function () {\n        return 'merge';\n    };\n    return Merge;\n}());\nexport { Merge };\n","import { checkConditionalFormat, initiateConditionalFormat, locale, dialog, setCF, focus } from '../common/index';\nimport { beginAction, completeAction } from '../common/index';\nimport { getCell, setRow, setCell } from '../../workbook/base/index';\nimport { getRangeIndexes, checkDateFormat, cFInitialCheck, isNumber, cFRender, cFDelete } from '../../workbook/common/index';\nimport { isDateTime, dateToInt, applyCellFormat, clearCF } from '../../workbook/common/index';\nimport { setCFRule, clearCells } from '../../workbook/common/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\n/**\n * Represents Conditional Formatting support for Spreadsheet.\n */\nvar ConditionalFormatting = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Conditional Formatting module.\n     */\n    function ConditionalFormatting(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the Conditional Formatting module.\n     * @return {void}\n     */\n    ConditionalFormatting.prototype.destroy = function () {\n        this.removeEventListener();\n    };\n    ConditionalFormatting.prototype.addEventListener = function () {\n        this.parent.on(cFRender, this.cFInitialRender, this);\n        this.parent.on(cFInitialCheck, this.cFInitialCheckHandler, this);\n        this.parent.on(checkConditionalFormat, this.checkConditionalFormatHandler, this);\n        this.parent.on(initiateConditionalFormat, this.initiateCFHandler, this);\n        this.parent.on(setCF, this.setCFHandler, this);\n        this.parent.on(cFDelete, this.cFDeleteHandler, this);\n        this.parent.on(clearCF, this.clearCFHandler, this);\n        this.parent.on(clearCells, this.addClearCFHandler, this);\n    };\n    ConditionalFormatting.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(cFRender, this.cFInitialRender);\n            this.parent.off(cFInitialCheck, this.cFInitialCheckHandler);\n            this.parent.off(checkConditionalFormat, this.checkConditionalFormatHandler);\n            this.parent.off(initiateConditionalFormat, this.initiateCFHandler);\n            this.parent.off(setCF, this.setCFHandler);\n            this.parent.off(cFDelete, this.cFDeleteHandler);\n            this.parent.off(clearCF, this.clearCFHandler);\n        }\n    };\n    ConditionalFormatting.prototype.setCF = function (conditionalFormat) {\n        conditionalFormat.range = conditionalFormat.range || this.parent.getActiveSheet().selectedRange;\n        var eventArgs = {\n            range: conditionalFormat.range, type: conditionalFormat.type, cFColor: conditionalFormat.cFColor,\n            value: conditionalFormat.value, cancel: false\n        };\n        this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'conditionalFormat' });\n        if (!eventArgs.cancel) {\n            conditionalFormat.type = eventArgs.type;\n            conditionalFormat.cFColor = eventArgs.cFColor;\n            conditionalFormat.value = eventArgs.value;\n            conditionalFormat.range = eventArgs.range;\n            this.parent.notify(setCFRule, { conditionalFormat: conditionalFormat });\n            delete eventArgs.cancel;\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'conditionalFormat' });\n        }\n    };\n    ConditionalFormatting.prototype.addClearCFHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var clearCFormats = args.conditionalFormats;\n        var oldRange = args.oldRange;\n        var selectedRange = args.selectedRange;\n        var conditionalFormats = sheet.conditionalFormats;\n        for (var cCFIdx = 0; cCFIdx < clearCFormats.length; cCFIdx++) {\n            var isApply = false;\n            for (var cFIdx = 0; cFIdx < conditionalFormats.length; cFIdx++) {\n                if (conditionalFormats[cFIdx].type === clearCFormats[cCFIdx].type &&\n                    conditionalFormats[cFIdx].range === clearCFormats[cCFIdx].range) {\n                    isApply = true;\n                    conditionalFormats[cFIdx].range = oldRange[cCFIdx];\n                    sheet.conditionalFormats[cFIdx].range = oldRange[cCFIdx];\n                    var sRangeIdx = getRangeIndexes(selectedRange);\n                    var cFRanges = oldRange[cCFIdx].split(',');\n                    for (var cFRangeIdx = 0; cFRangeIdx < cFRanges.length; cFRangeIdx++) {\n                        var newRangeIdxs = getRangeIndexes(cFRanges[cFRangeIdx]);\n                        for (var cFRowIdx = newRangeIdxs[0]; cFRowIdx <= newRangeIdxs[2]; cFRowIdx++) {\n                            for (var cFColIdx = newRangeIdxs[1]; cFColIdx <= newRangeIdxs[3]; cFColIdx++) {\n                                for (var sRRowIdx = sRangeIdx[0]; sRRowIdx <= sRangeIdx[2]; sRRowIdx++) {\n                                    for (var sRColIdx = sRangeIdx[1]; sRColIdx <= sRangeIdx[3]; sRColIdx++) {\n                                        if (sRRowIdx === cFRowIdx && sRColIdx === cFColIdx) {\n                                            var td = this.parent.getCell(cFRowIdx, cFColIdx);\n                                            var cell = sheet.rows[cFRowIdx] ? sheet.rows[cFRowIdx].cells[cFColIdx] ?\n                                                sheet.rows[cFRowIdx].cells[cFColIdx] : null : null;\n                                            if (cell) {\n                                                this.cFInitialCheckHandler({\n                                                    rowIdx: cFRowIdx, colIdx: cFColIdx,\n                                                    cell: cell, td: td, conditionalFormat: conditionalFormats[cFIdx]\n                                                });\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            if (!isApply) {\n                var conditionalFormat = clearCFormats[cCFIdx];\n                conditionalFormat.range = oldRange[cCFIdx];\n                this.parent.notify(setCFRule, { conditionalFormat: conditionalFormat });\n            }\n        }\n    };\n    ConditionalFormatting.prototype.cFDeleteHandler = function (args) {\n        var td = this.parent.getCell(args.rowIdx, args.colIdx);\n        if (td) {\n            if (td.querySelector('.e-cf-databar')) {\n                td.removeChild(td.querySelector('.e-cf-databar'));\n            }\n            if (td.querySelector('.e-iconsetspan')) {\n                td.removeChild(td.querySelector('.e-iconsetspan'));\n            }\n        }\n    };\n    ConditionalFormatting.prototype.clearCFHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var tdEle = this.parent.getCell(args.rIdx, args.cIdx);\n        var cell = getCell(args.rIdx, args.cIdx, sheet);\n        if (!tdEle) {\n            return;\n        }\n        tdEle.classList.remove('e-redft');\n        tdEle.classList.remove('e-yellowft');\n        tdEle.classList.remove('e-greenft');\n        tdEle.classList.remove('e-redf');\n        tdEle.classList.remove('e-redt');\n        tdEle.classList.remove('e-iconset');\n        if (tdEle.style) {\n            if (tdEle.style.backgroundColor) {\n                tdEle.style.backgroundColor = '';\n                var style = this.parent.getCellStyleValue(['backgroundColor'], [args.rIdx, args.cIdx]);\n                this.parent.notify(applyCellFormat, {\n                    style: style, rowIdx: args.rIdx, colIdx: args.cIdx\n                });\n            }\n            if (tdEle.style.color) {\n                tdEle.style.color = '';\n                var style = this.parent.getCellStyleValue(['color'], [args.rIdx, args.cIdx]);\n                this.parent.notify(applyCellFormat, {\n                    style: style, rowIdx: args.rIdx, colIdx: args.cIdx\n                });\n            }\n        }\n        if (tdEle.querySelector('.e-cf-databar')) {\n            tdEle.removeChild(tdEle.querySelector('.e-cf-databar'));\n            tdEle.textContent = this.parent.getDisplayText(cell);\n        }\n        if (tdEle.querySelector('.e-iconsetspan')) {\n            tdEle.removeChild(tdEle.querySelector('.e-iconsetspan'));\n            tdEle.textContent = this.parent.getDisplayText(cell);\n        }\n    };\n    ConditionalFormatting.prototype.setCFHandler = function (args) {\n        if (args.action === 'cf_databars') {\n            this.setCF({ type: args.id });\n        }\n        else if (args.action === 'cf_colorscales') {\n            this.setCF({ type: args.id });\n        }\n        else if (args.action === 'cf_iconsets') {\n            this.setCF({ type: args.id });\n        }\n    };\n    ConditionalFormatting.prototype.initiateCFHandler = function (args) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            width: 375, showCloseIcon: true, isModal: true, cssClass: 'e-conditionalformatting-dlg',\n            header: args.action.replace('...', ''),\n            target: document.querySelector('.e-control.e-spreadsheet'),\n            beforeOpen: function () {\n                dialogInst.dialogInstance.content = _this.cFDlgContent(args.action);\n                dialogInst.dialogInstance.dataBind();\n                focus(_this.parent.element);\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Ok'),\n                        isPrimary: true,\n                        cssClass: 'e-btn e-clearall-btn e-flat'\n                    },\n                    click: function () {\n                        _this.dlgClickHandler(args.action);\n                        dialogInst.hide();\n                    }\n                }]\n        });\n        dialogInst.dialogInstance.refresh();\n    };\n    ConditionalFormatting.prototype.dlgClickHandler = function (action) {\n        var value1 = '';\n        var value2 = '';\n        var dlgCont = this.parent.element.querySelector('.e-conditionalformatting-dlg').\n            getElementsByClassName('e-dlg-content')[0].querySelector('.e-cf-dlg');\n        var mainCont = dlgCont.querySelector('.e-cfmain');\n        if (mainCont) {\n            var inpEle = mainCont.getElementsByTagName('input')[0];\n            if (inpEle && inpEle.parentElement.classList.contains('e-cfmain')) {\n                value1 = mainCont.getElementsByTagName('input')[0].value;\n            }\n            value2 = mainCont.getElementsByTagName('input')[1] ?\n                dlgCont.querySelector('.e-cfmain').getElementsByTagName('input')[1].value : '';\n        }\n        var cFColor = this.getCFColor(dlgCont.querySelector('.e-cfsub').getElementsByTagName('input')[0].value);\n        var cFType = action === 'Duplicate Values...' ?\n            dlgCont.querySelector('.e-cfmain').getElementsByTagName('input')[0].value : this.getType(action);\n        if (value1 !== '' && value2 !== '') {\n            this.setCF({\n                type: cFType,\n                cFColor: cFColor, value: value1 + ',' + value2\n            });\n        }\n        else if (value1 !== '') {\n            this.setCF({\n                type: cFType,\n                cFColor: cFColor, value: value1\n            });\n        }\n        else {\n            this.setCF({\n                type: cFType,\n                cFColor: cFColor, value: value2\n            });\n        }\n    };\n    ConditionalFormatting.prototype.getType = function (action) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var result = '';\n        switch (action) {\n            case l10n.getConstant('GreaterThan') + '...':\n                result = 'GreaterThan';\n                break;\n            case l10n.getConstant('LessThan') + '...':\n                result = 'LessThan';\n                break;\n            case l10n.getConstant('Between') + '...':\n                result = 'Between';\n                break;\n            case l10n.getConstant('CFEqualTo') + '...':\n                result = 'EqualTo';\n                break;\n            case l10n.getConstant('TextThatContains') + '...':\n                result = 'ContainsText';\n                break;\n            case l10n.getConstant('ADateOccuring') + '...':\n                result = 'DateOccur';\n                break;\n            case l10n.getConstant('Top10Items') + '...':\n                result = 'Top10Items';\n                break;\n            case l10n.getConstant('Bottom10Items') + '...':\n                result = 'Bottom10Items';\n                break;\n            case l10n.getConstant('Top10') + ' %...':\n                result = 'Top10Percentage';\n                break;\n            case l10n.getConstant('Bottom10') + ' %...':\n                result = 'Bottom10Percentage';\n                break;\n            case l10n.getConstant('AboveAverage') + '...':\n                result = 'AboveAverage';\n                break;\n            case l10n.getConstant('BelowAverage') + '...':\n                result = 'BelowAverage';\n                break;\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.getCFColor = function (value) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var result = 'RedFT';\n        switch (value) {\n            case l10n.getConstant('LightRedFillWithDarkRedText'):\n                result = 'RedFT';\n                break;\n            case l10n.getConstant('YellowFillWithDarkYellowText'):\n                result = 'YellowFT';\n                break;\n            case l10n.getConstant('GreenFillWithDarkGreenText'):\n                result = 'GreenFT';\n                break;\n            case l10n.getConstant('RedFill'):\n                result = 'RedF';\n                break;\n            case l10n.getConstant('RedText'):\n                result = 'RedT';\n                break;\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.cFDlgContent = function (action) {\n        var dlgText = this.getDlgText(action);\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var dlgContent = this.parent.createElement('div', { className: 'e-cf-dlg' });\n        var mainDiv = this.parent.createElement('div', { className: 'e-cfmain' });\n        var subDiv = this.parent.createElement('div', { className: 'e-cfsub' });\n        var value1Text = this.parent.createElement('span', { className: 'e-header e-top-header', innerHTML: dlgText });\n        var value1Inp = this.parent.createElement('input', { className: 'e-input', id: 'valueInput', attrs: { type: 'text' } });\n        var duplicateSelectEle = this.parent.createElement('input', { className: 'e-select' });\n        var subDivText = this.parent.createElement('span', { className: 'e-header', innerHTML: l10n.getConstant('With') });\n        var colorSelectEle = this.parent.createElement('input', { className: 'e-select' });\n        dlgContent.appendChild(mainDiv);\n        dlgContent.appendChild(subDiv);\n        mainDiv.appendChild(value1Text);\n        if (action !== l10n.getConstant('DuplicateValues') + '...') {\n            if (action !== l10n.getConstant('AboveAverage') + '...' && action !== l10n.getConstant('BelowAverage') + '...') {\n                mainDiv.appendChild(value1Inp);\n                if (action === l10n.getConstant('Top10Items') + '...' || action === l10n.getConstant('Top10') + ' %...' ||\n                    action === l10n.getConstant('Bottom10Items') + '...' || action === l10n.getConstant('Bottom10') + ' %...') {\n                    var numeric = new NumericTextBox({\n                        value: 10\n                    });\n                    numeric.appendTo(value1Inp);\n                }\n            }\n        }\n        else {\n            mainDiv.appendChild(duplicateSelectEle);\n            var dupData = [\n                { text: l10n.getConstant('Duplicate'), id: 'duplicate' },\n                { text: l10n.getConstant('Unique'), id: 'unique' },\n            ];\n            var dupList = new DropDownList({\n                dataSource: dupData,\n                index: 0,\n                popupHeight: '200px'\n            });\n            dupList.appendTo(duplicateSelectEle);\n        }\n        if (action === l10n.getConstant('Between') + '...') {\n            var value2Text = this.parent.createElement('span', { className: 'e-header e-header-2', innerHTML: l10n.getConstant('And') });\n            var value2Inp = this.parent.createElement('input', { className: 'e-input' });\n            mainDiv.appendChild(value2Text);\n            mainDiv.appendChild(value2Inp);\n        }\n        subDiv.appendChild(subDivText);\n        subDiv.appendChild(colorSelectEle);\n        var colorData = [\n            { text: l10n.getConstant('LightRedFillWithDarkRedText'), value: 'redft', id: 'redft' },\n            { text: l10n.getConstant('YellowFillWithDarkYellowText'), id: 'yellowft' },\n            { text: l10n.getConstant('GreenFillWithDarkGreenText'), id: 'greenft' },\n            { text: l10n.getConstant('RedFill'), id: 'redf' },\n            { text: l10n.getConstant('RedText'), id: 'redt' },\n        ];\n        var colorList = new DropDownList({\n            dataSource: colorData,\n            index: 0,\n            popupHeight: '200px'\n        });\n        colorList.appendTo(colorSelectEle);\n        return dlgContent;\n    };\n    ConditionalFormatting.prototype.checkCellHandler = function (rowIdx, colIdx, conditionalFormat) {\n        var isApply = false;\n        var ranges = conditionalFormat.range.trim().split(',');\n        for (var rangeIdx = 0; rangeIdx < ranges.length; rangeIdx++) {\n            var cFrange = ranges[rangeIdx];\n            cFrange = cFrange.indexOf(':') > -1 ? cFrange : cFrange + ':' + cFrange;\n            var indexes = getRangeIndexes(cFrange);\n            if (rowIdx >= indexes[0] && rowIdx <= indexes[2] && colIdx >= indexes[1] && colIdx <= indexes[3]) {\n                isApply = true;\n                break;\n            }\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.getDlgText = function (action) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var result = '';\n        switch (action) {\n            case l10n.getConstant('GreaterThan') + '...':\n                result = l10n.getConstant('FormatCellsGreaterThan');\n                break;\n            case l10n.getConstant('LessThan') + '...':\n                result = l10n.getConstant('FormatCellsLessThan');\n                break;\n            case l10n.getConstant('Between') + '...':\n                result = l10n.getConstant('FormatCellsBetween');\n                break;\n            case l10n.getConstant('CFEqualTo') + '...':\n                result = l10n.getConstant('FormatCellsEqualTo');\n                break;\n            case l10n.getConstant('TextThatContains') + '...':\n                result = l10n.getConstant('FormatCellsThatContainTheText');\n                break;\n            case l10n.getConstant('ADateOccuring') + '...':\n                result = l10n.getConstant('FormatCellsThatContainADateOccurring');\n                break;\n            case l10n.getConstant('DuplicateValues') + '...':\n                result = l10n.getConstant('FormatCellsDuplicate');\n                break;\n            case l10n.getConstant('Top10Items') + '...':\n                result = l10n.getConstant('FormatCellsTop');\n                break;\n            case l10n.getConstant('Top10') + ' %...':\n                result = l10n.getConstant('FormatCellsTop');\n                break;\n            case l10n.getConstant('Bottom10Items') + '...':\n                result = l10n.getConstant('FormatCellsBottom');\n                break;\n            case l10n.getConstant('Bottom10') + ' %...':\n                result = l10n.getConstant('FormatCellsBottom');\n                break;\n            case l10n.getConstant('AboveAverage') + '...':\n                result = l10n.getConstant('FormatCellsAbove');\n                break;\n            case l10n.getConstant('BelowAverage') + '...':\n                result = l10n.getConstant('FormatCellsBelow');\n                break;\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.cFInitialRender = function (args) {\n        var cFRules = this.parent.getActiveSheet().conditionalFormats;\n        if (cFRules) {\n            for (var cFRIdx = 0; cFRIdx < cFRules.length; cFRIdx++) {\n                var isApply = false;\n                isApply = this.checkCellHandler(args.rowIdx, args.colIdx, cFRules[cFRIdx]);\n                if (isApply) {\n                    this.cFInitialCheckHandler({\n                        rowIdx: args.rowIdx, colIdx: args.colIdx,\n                        cell: args.cell, td: args.td, conditionalFormat: cFRules[cFRIdx]\n                    });\n                }\n            }\n        }\n    };\n    ConditionalFormatting.prototype.cFInitialCheckHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var formatStyle;\n        var isApply = false;\n        var cFColors = ['e-redft', 'e-yellowft', 'e-greenft', 'e-redf', 'e-redt'];\n        var value = args.cell.value || '';\n        var cFRule = args.conditionalFormat;\n        var td = args.td || this.parent.getCell(args.rowIdx, args.colIdx);\n        if (!td) {\n            return;\n        }\n        cFRule.type = cFRule.type || 'GreaterThan';\n        cFRule.cFColor = cFRule.cFColor ? cFRule.cFColor : cFRule.format ? cFRule.cFColor : 'RedFT';\n        isApply = this.cFRCheck(cFRule, value, td, args.rowIdx, args.colIdx, true);\n        if (isApply) {\n            for (var idx = 0; idx < cFColors.length; idx++) {\n                if (td.classList.contains(cFColors[idx])) {\n                    td.classList.remove(cFColors[idx]);\n                    break;\n                }\n            }\n            if (cFRule.format && cFRule.format.style) {\n                formatStyle = cFRule.format.style;\n            }\n            var style = {};\n            if (cFRule.cFColor) {\n                td.classList.add('e-' + cFRule.cFColor.toLowerCase());\n                style = this.setFormat(style, cFRule);\n            }\n            else {\n                style = formatStyle;\n            }\n            if (style.backgroundColor) {\n                td.style.setProperty('background-color', style.backgroundColor);\n            }\n            if (style.color) {\n                td.style.setProperty('color', style.color);\n            }\n            if (style.fontWeight) {\n                td.style.setProperty('font-weight', style.fontWeight);\n            }\n            if (style.fontStyle) {\n                td.style.setProperty('font-style', style.fontStyle);\n            }\n            if (style.textDecoration) {\n                td.style.setProperty('text-decoration', style.textDecoration);\n            }\n        }\n    };\n    ConditionalFormatting.prototype.checkConditionalFormatHandler = function (args) {\n        var indexes;\n        var isApply = false;\n        var result = false;\n        var sheet = this.parent.getActiveSheet();\n        var cell = args.cell;\n        var td;\n        var cFRules = sheet.conditionalFormats;\n        var mainCnt = this.parent.getMainContent();\n        var value = !cell ? '' : !isNullOrUndefined(cell.value) ? cell.value : '';\n        var cFColors = ['e-redft', 'e-yellowft', 'e-greenft', 'e-redf', 'e-redt'];\n        var cFRIdx;\n        td = this.parent.getCell(args.rowIdx, args.colIdx);\n        if (!cFRules || cFRules.length < 1) {\n            return;\n        }\n        for (var cFRuleIdx = cFRules.length - 1; cFRuleIdx >= 0; cFRuleIdx--) {\n            var cFRanges = cFRules[cFRuleIdx].range.trim().split(',');\n            for (var rangeIdx = 0; rangeIdx < cFRanges.length; rangeIdx++) {\n                var range = cFRanges[rangeIdx];\n                range = range.indexOf(':') > -1 ? range : range + ':' + range;\n                indexes = getRangeIndexes(range);\n                if (args.rowIdx >= indexes[0] && args.colIdx >= indexes[1] && args.rowIdx <= indexes[2] && args.colIdx <= indexes[3]) {\n                    cFRIdx = cFRuleIdx;\n                    result = true;\n                    break;\n                }\n            }\n            if (result) {\n                if (('GreaterThan' + 'LessThan' + 'EqualTo' + 'Between' + 'ContainsText' +\n                    'DateOccur').includes(sheet.conditionalFormats[cFRuleIdx].type)) {\n                    var cellVal = getCell(args.rowIdx, args.colIdx, sheet) && getCell(args.rowIdx, args.colIdx, sheet).value ?\n                        getCell(args.rowIdx, args.colIdx, sheet).value : '';\n                    if (isNullOrUndefined(cellVal) && cellVal === '') {\n                        isApply = false;\n                    }\n                    else {\n                        isApply = this.cFRCheck(sheet.conditionalFormats[cFRuleIdx], cellVal, td);\n                    }\n                    this.setColor(td, args.rowIdx, args.colIdx, cFRuleIdx, isApply);\n                }\n                else if (('Top10Items' + 'Bottom10Items' + 'Top10%' + 'Bottom10%' + 'AboveAverage' +\n                    'BelowAverage' + 'Duplicate' + 'Unique').includes(sheet.conditionalFormats[cFRuleIdx].type)) {\n                    for (var rangeIdx = 0; rangeIdx < cFRanges.length; rangeIdx++) {\n                        var range = cFRanges[rangeIdx];\n                        range = range.indexOf(':') > -1 ? range : range + ':' + range;\n                        indexes = getRangeIndexes(range);\n                        for (var rIdx = indexes[0]; rIdx <= indexes[2]; rIdx++) {\n                            if (!sheet.rows[rIdx]) {\n                                setRow(sheet, rIdx, {});\n                            }\n                            for (var cIdx = indexes[1]; cIdx <= indexes[3]; cIdx++) {\n                                if (!sheet.rows[rIdx].cells || !sheet.rows[rIdx].cells[cIdx]) {\n                                    setCell(rIdx, cIdx, sheet, {});\n                                }\n                                var cellVal = getCell(rIdx, cIdx, sheet) && getCell(rIdx, cIdx, sheet).value ?\n                                    getCell(rIdx, cIdx, sheet).value : '';\n                                isApply = this.cFRCheck(sheet.conditionalFormats[cFRuleIdx], cellVal, td, rIdx, cIdx, false);\n                                td = this.parent.getCell(rIdx, cIdx);\n                                this.setColor(td, rIdx, cIdx, cFRuleIdx, isApply);\n                            }\n                        }\n                    }\n                }\n                else if (('BlueDataBar' + 'GreenDataBar' + 'RedDataBar' + 'OrangeDataBar' + 'LightBlueDataBar' + 'PurpleColorScale' +\n                    'GYRColorScale' + 'RYGColorScale' + 'GWRColorScale' + 'RWGColorScale' + 'BWRColorScale' + 'RWBColorScale' +\n                    'WRColorScale' + 'RWColorScale' + 'GWColorScale' + 'WGColorScale' + 'GYColorScale' + 'YGColorScale' + 'ThreeArrows' +\n                    'ThreeArrowsGray' + 'FourArrowsGray' + 'FourArrows' + 'FiveArrowsGray' + 'FiveArrows' + 'ThreeTrafficLights1' +\n                    'ThreeTrafficLights2' + 'ThreeSigns' + 'FourTrafficLights' + 'FourRedToBlack' + 'ThreeSymbols' + 'ThreeSymbols2' +\n                    'ThreeFlags' + 'FourRating' + 'FiveQuarters' + 'FiveRating' + 'ThreeTriangles' + 'ThreeStars' + 'FiveBoxes').\n                    includes(sheet.conditionalFormats[cFRuleIdx].type)) {\n                    for (var idx = 0; idx < cFColors.length; idx++) {\n                        if (td.classList.contains(cFColors[idx])) {\n                            td.classList.remove(cFColors[idx]);\n                        }\n                    }\n                    isApply = this.cFRCheck(sheet.conditionalFormats[cFRuleIdx], value, td, args.rowIdx, args.colIdx, false);\n                }\n                result = false;\n            }\n            if (isApply) {\n                break;\n            }\n        }\n    };\n    ConditionalFormatting.prototype.setColor = function (td, rIdx, cIdx, cFRuleIdx, isApply) {\n        var sheet = this.parent.getActiveSheet();\n        var cFRules = sheet.conditionalFormats;\n        var cFColors = ['e-redft', 'e-yellowft', 'e-greenft', 'e-redf', 'e-redt'];\n        var isActiveCF = false;\n        if (cFRules[cFRuleIdx].cFColor) {\n            if (td && td.classList.contains('e-' + cFRules[cFRuleIdx].cFColor.toLowerCase())) {\n                isActiveCF = true;\n            }\n        }\n        else if (cFRules[cFRuleIdx].format.style.backgroundColor && td.style.backgroundColor) {\n            var rgb = this.hexToRgb(cFRules[cFRuleIdx].format.style.backgroundColor);\n            if ('rgb(' + rgb.r + ', ' + rgb.g + ', ' + rgb.b + ')' === td.style.backgroundColor) {\n                isActiveCF = true;\n            }\n        }\n        if (isApply) {\n            if (isActiveCF) {\n                for (var idx = 0; idx < cFColors.length; idx++) {\n                    if (td.classList.contains(cFColors[idx])) {\n                        td.classList.remove(cFColors[idx]);\n                        break;\n                    }\n                }\n            }\n            var style = {};\n            if (cFRules[cFRuleIdx].cFColor) {\n                td.classList.add('e-' + cFRules[cFRuleIdx].cFColor.toLowerCase());\n                style = this.setFormat(style, cFRules[cFRuleIdx]);\n            }\n            else {\n                style = cFRules[cFRuleIdx].format.style;\n            }\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: rIdx, colIdx: cIdx,\n                lastCell: true, isHeightCheckNeeded: true, manualUpdate: true\n            });\n        }\n        else {\n            if (isActiveCF) {\n                for (var idx = 0; idx < cFColors.length; idx++) {\n                    if (td.classList.contains(cFColors[idx])) {\n                        td.classList.remove(cFColors[idx]);\n                        break;\n                    }\n                }\n                td.removeAttribute('style');\n            }\n            var cell = getCell(rIdx, cIdx, this.parent.getActiveSheet());\n            var style = cell.style ? cell.style : {};\n            this.parent.notify(applyCellFormat, {\n                style: style, rowIdx: rIdx, colIdx: cIdx\n            });\n        }\n    };\n    ConditionalFormatting.prototype.hexToRgb = function (hex) {\n        var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n        return result ? {\n            r: parseInt(result[1], 16),\n            g: parseInt(result[2], 16),\n            b: parseInt(result[3], 16)\n        } : null;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    ConditionalFormatting.prototype.cFRCheck = function (cFRule, value, td, rIdx, cIdx, isInitial) {\n        var cFRuleValue1 = '';\n        var cFRuleValue2 = '';\n        var cellValue = value.toString();\n        if (cFRule.value) {\n            var valueArr = cFRule.value.split(',');\n            if (valueArr.length > 1) {\n                if (valueArr[0].split('(').length > 1) {\n                    var valueStr = '';\n                    for (var idx = 0; idx < valueArr.length; idx++) {\n                        valueStr += valueArr[idx] + ',';\n                        if (valueStr.split('(').length === valueStr.split(')').length && cFRuleValue1 === '') {\n                            cFRuleValue1 = valueStr.substring(0, valueStr.length - 1);\n                            valueStr = '';\n                        }\n                    }\n                    cFRuleValue2 = valueStr.substring(0, valueStr.length - 1);\n                }\n                else {\n                    cFRuleValue1 = valueArr[0];\n                    for (var idx = 1; idx < valueArr.length; idx++) {\n                        cFRuleValue2 += idx + 1 === valueArr.length ? valueArr[idx] : valueArr[idx] + ',';\n                    }\n                }\n            }\n            else {\n                cFRuleValue1 = cFRule.value;\n            }\n        }\n        var isApply = false;\n        var type = cFRule.type;\n        if (('BlueDataBar' + 'GreenDataBar' + 'RedDataBar' + 'OrangeDataBar' + 'LightBlueDataBar' + 'PurpleDataBar').includes(type)) {\n            type = 'DataBar';\n        }\n        if (('GYRColorScale' + 'RYGColorScale' + 'GWRColorScale' + 'RWGColorScale' + 'BWRColorScale' + 'RWBColorScale' + 'WRColorScale' +\n            'RWColorScale' + 'GWColorScale' + 'WGColorScale' + 'GYColorScale' + 'YGColorScale').includes(type)) {\n            type = 'ColorScale';\n        }\n        if (('ThreeArrows' + 'ThreeArrowsGray' + 'FourArrowsGray' + 'FourArrows' + 'FiveArrowsGray' +\n            'FiveArrows' + 'ThreeTrafficLights1' + 'ThreeTrafficLights2' + 'ThreeSigns' + 'FourTrafficLights' +\n            'FourRedToBlack' + 'ThreeSymbols' + 'ThreeSymbols2' + 'ThreeFlags' + 'FourRating' + 'FiveQuarters' +\n            'FiveRating' + 'ThreeTriangles' + 'ThreeStars' + 'FiveBoxes').includes(type)) {\n            type = 'IconSet';\n        }\n        switch (type) {\n            case 'GreaterThan':\n                isApply = this.isGreaterThanLessThan(cFRule, cellValue, cFRuleValue1, true);\n                break;\n            case 'LessThan':\n                isApply = this.isGreaterThanLessThan(cFRule, cellValue, cFRuleValue1, false);\n                break;\n            case 'Between':\n                isApply = this.isBetWeen(cFRule, cellValue, cFRuleValue1, cFRuleValue2);\n                break;\n            case 'EqualTo':\n                isApply = this.isEqualTo(cFRule, cellValue, cFRuleValue1);\n                break;\n            case 'ContainsText':\n                isApply = this.isContainsText(cellValue, cFRuleValue1);\n                break;\n            case 'DateOccur':\n                var dateEventArgs = {\n                    value: cFRuleValue1,\n                    rowIndex: 0,\n                    colIndex: 0,\n                    sheetIndex: 0,\n                    updatedVal: ''\n                };\n                this.parent.notify(checkDateFormat, dateEventArgs);\n                if (cellValue === dateEventArgs.updatedVal) {\n                    isApply = true;\n                }\n                break;\n            case 'Unique':\n            case 'Duplicate':\n                isApply = this.isDuplicateUnique(cellValue, cFRule, false);\n                break;\n            case 'Top10Items':\n                isApply = this.isTopBottomTenValue(cellValue, cFRuleValue1, cFRule, true);\n                break;\n            case 'Bottom10Items':\n                isApply = this.isTopBottomTenValue(cellValue, cFRuleValue1, cFRule, false);\n                break;\n            case 'Top10Percentage':\n                isApply = this.isTopBottomTenPercentage(cellValue, cFRuleValue1, cFRule, true);\n                break;\n            case 'Bottom10Percentage':\n                isApply = this.isTopBottomTenPercentage(cellValue, cFRuleValue1, cFRule, false);\n                break;\n            case 'AboveAverage':\n                isApply = this.isAboveBelowAverage(cellValue, cFRuleValue1, cFRule, true);\n                break;\n            case 'BelowAverage':\n                isApply = this.isAboveBelowAverage(cellValue, cFRuleValue1, cFRule, false);\n                break;\n            case 'DataBar':\n                this.isDataBarColorScalesIconSets(type, cellValue, cFRule, td, rIdx, cIdx, isInitial);\n                break;\n            case 'ColorScale':\n                this.isDataBarColorScalesIconSets(type, cellValue, cFRule, td, rIdx, cIdx, isInitial);\n                break;\n            case 'IconSet':\n                this.isDataBarColorScalesIconSets(type, cellValue, cFRule, td, rIdx, cIdx, isInitial);\n                break;\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isDataBarColorScalesIconSets = function (type, cellValue, cFRule, td, rIdx, cIdx, isInitial) {\n        var sheet = this.parent.getActiveSheet();\n        if (isInitial) {\n            type === 'DataBar' ? this.applyDataBars(cellValue, cFRule, td, rIdx, cIdx) : type === 'ColorScale' ?\n                this.applyColorScale(cellValue, cFRule, td, rIdx, cIdx, isInitial) :\n                this.applyIconSet(cellValue, cFRule, td, rIdx, cIdx, isInitial);\n        }\n        else {\n            td = null;\n            var rangeArr = cFRule.range.split(',');\n            for (var rangeIdx = 0; rangeIdx < rangeArr.length; rangeIdx++) {\n                var selIndexes = getRangeIndexes(rangeArr[rangeIdx]);\n                for (var rIdx_1 = selIndexes[0]; rIdx_1 <= selIndexes[2]; rIdx_1++) {\n                    for (var cIdx_1 = selIndexes[1]; cIdx_1 <= selIndexes[3]; cIdx_1++) {\n                        if (getCell(rIdx_1, cIdx_1, sheet)) {\n                            var cellVal = getCell(rIdx_1, cIdx_1, sheet).value;\n                            td = this.parent.getCell(rIdx_1, cIdx_1);\n                            type === 'DataBar' ? this.applyDataBars(cellVal, cFRule, td, rIdx_1, cIdx_1) :\n                                type === 'ColorScale' ?\n                                    this.applyColorScale(cellVal, cFRule, td, rIdx_1, cIdx_1, isInitial) :\n                                    this.applyIconSet(cellVal, cFRule, td, rIdx_1, cIdx_1, isInitial);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    ConditionalFormatting.prototype.applyIconSet = function (val, cFRule, tdEle, rIdx, cIdx, isInitial) {\n        var value = parseInt(val, 10);\n        var rowIdx;\n        var colIdx;\n        var iconList = this.getIconList(cFRule.type).split(',');\n        var min;\n        var max;\n        var valArr = [];\n        var sheet = this.parent.getActiveSheet();\n        var actCell = sheet.rows[rIdx] && sheet.rows[rIdx].cells[cIdx] ? sheet.rows[rIdx].cells[cIdx] : null;\n        if (!actCell) {\n            return;\n        }\n        var td = tdEle ||\n            this.parent.getMainContent().getElementsByClassName('e-row')[rIdx].getElementsByClassName('e-cell')[cIdx];\n        var rangeArr = cFRule.range.split(',');\n        for (var rIdx_2 = 0; rIdx_2 < rangeArr.length; rIdx_2++) {\n            var selIndexes = getRangeIndexes(rangeArr[rIdx_2]);\n            valArr = this.getNumericArray(selIndexes, valArr);\n        }\n        valArr = valArr.sort(function (n1, n2) { return n1 - n2; });\n        min = valArr[0];\n        max = valArr[valArr.length - 1];\n        var currentSymbol;\n        if (iconList.length === 3) {\n            var maxPercent = min + (0.67 * ((max) - (min)));\n            var minPercent = min + (0.33 * ((max) - (min)));\n            currentSymbol =\n                'e-' + (value >= maxPercent ? iconList[0].trim() : value >= minPercent ? iconList[1].trim() : iconList[2].trim());\n        }\n        else if (iconList.length === 4) {\n            var percent1 = min + (0.25 * ((max) - (min)));\n            var percent2 = min + (0.50 * ((max) - (min)));\n            var percent3 = min + (0.75 * ((max) - (min)));\n            currentSymbol =\n                'e-' + (value >= percent3 ? iconList[0].trim() : value >= percent2 ? iconList[1].trim() : value >= percent1 ?\n                    iconList[2].trim() : iconList[3].trim());\n        }\n        else if (iconList.length === 5) {\n            var percent1 = min + (0.20 * ((max) - (min)));\n            var percent2 = min + (0.40 * ((max) - (min)));\n            var percent3 = min + (0.60 * ((max) - (min)));\n            var percent4 = min + (0.80 * ((max) - (min)));\n            currentSymbol =\n                'e-' + (value >= percent4 ? iconList[0].trim() : value >= percent3 ? iconList[1].trim() : value >= percent2 ?\n                    iconList[2].trim() : value >= percent1 ? iconList[3].trim() : iconList[4].trim());\n        }\n        if (!isNullOrUndefined(actCell)) {\n            var cfIcon = this.parent.createElement('span', { className: 'e-icon' });\n            cfIcon.classList.add('e-iconsetspan');\n            cfIcon.classList.add(currentSymbol);\n            this.applyIconSetIcon({ rowIndex: rIdx, colIndex: cIdx }, cfIcon, td);\n        }\n    };\n    ConditionalFormatting.prototype.applyIconSetIcon = function (activeObj, cfIcon, td) {\n        var sheet = this.parent.getActiveSheet();\n        var rowIdx = activeObj.rowIndex;\n        var colIdx = activeObj.colIndex;\n        var cellVal = getCell(rowIdx, colIdx, sheet).value;\n        var activeEle = td;\n        var sheetIdx = sheet.index;\n        if (activeEle.classList.contains('e-iconset') && activeEle.querySelector('.e-iconsetspan')) {\n            activeEle.removeChild(activeEle.querySelector('.e-iconsetspan'));\n        }\n        if (isNumber(cellVal)) {\n            activeEle.insertBefore(cfIcon, activeEle.childNodes[0]);\n            activeEle.classList.add('e-iconset');\n        }\n    };\n    ConditionalFormatting.prototype.getIconList = function (iconName) {\n        var result = '3arrows-1,3arrows-2,3arrows-3';\n        switch (iconName) {\n            case 'ThreeArrows':\n                return '3arrows-1,3arrows-2,3arrows-3';\n            case 'ThreeArrowsGray':\n                return '3arrowsgray-1,3arrowsgray-2,3arrowsgray-3';\n            case 'FourArrowsGray':\n                return '4arrowsgray-1,4arrowsgray-2,4arrowsgray-3,4arrowsgray-4';\n            case 'FourArrows':\n                return '4arrows-1,4arrows-2,4arrows-3,4arrows-4';\n            case 'FiveArrowsGray':\n                return '5arrowsgray-1,5arrowsgray-2,5arrowsgray-3,5arrowsgray-4,5arrowsgray-5';\n            case 'FiveArrows':\n                return '5arrows-1,5arrows-2,5arrows-3,5arrows-4,5arrows-5';\n            case 'ThreeTrafficLights1':\n                return '3trafficlights-1,3trafficlights-2,3trafficlights-3';\n            case 'ThreeTrafficLights2':\n                return '3rafficlights2-1,3rafficlights2-2,3rafficlights2-3';\n            case 'ThreeSigns':\n                return '3signs-1,3signs-2,3signs-3';\n            case 'FourTrafficLights':\n                return '4trafficlights-1,4trafficlights-2,4trafficlights-3,4trafficlights-4';\n            case 'FourRedToBlack':\n                return '4redtoblack-1,4redtoblack-2,4redtoblack-3,4redtoblack-4';\n            case 'ThreeSymbols':\n                return '3symbols-1,3symbols-2,3symbols-3';\n            case 'ThreeSymbols2':\n                return '3symbols2-1,3symbols2-2,3symbols2-3';\n            case 'ThreeFlags':\n                return '3flags-1,3flags-2,3flags-3';\n            case 'FourRating':\n                return '4rating-1,4rating-2,4rating-3,4rating-4';\n            case 'FiveQuarters':\n                return '5quarters-1,5quarters-2,5quarters-3,5quarters-4,5quarters-5';\n            case 'FiveRating':\n                return '5rating-1,5rating-2,5rating-3,5rating-4,5rating-5';\n            case 'ThreeTriangles':\n                return '3triangles-1,3triangles-2,3triangles-3';\n            case 'ThreeStars':\n                return '3stars-1,3stars-2,3stars-3';\n            case 'FiveBoxes':\n                return '5boxes-1,5boxes-2,5boxes-3,5boxes-4,5boxes-5';\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.applyColorScale = function (val, cFRule, tdEle, rIdx, cIdx, isInitial) {\n        var sheet = this.parent.getActiveSheet();\n        var value = parseInt(val, 10);\n        var rowIdx;\n        var colIdx;\n        var id;\n        var valArr = [];\n        var colors = this.getColor(cFRule.type);\n        var actCell = sheet.rows[rIdx] && sheet.rows[rIdx].cells[cIdx] ? sheet.rows[rIdx].cells[cIdx] : null;\n        if (!actCell) {\n            return;\n        }\n        var rangeArr = cFRule.range.split(',');\n        var td = tdEle ||\n            this.parent.getMainContent().getElementsByClassName('e-row')[rIdx].getElementsByClassName('e-cell')[cIdx];\n        for (var rIdx_3 = 0; rIdx_3 < rangeArr.length; rIdx_3++) {\n            var selIndexes = getRangeIndexes(rangeArr[rIdx_3]);\n            valArr = this.getNumericArray(selIndexes, valArr);\n        }\n        valArr = valArr.sort(function (n1, n2) { return n1 - n2; }).reverse();\n        for (var i = 0; i < valArr.length; i++) {\n            if (valArr[i] === value) {\n                id = i;\n                break;\n            }\n        }\n        var hexcode = (id === 0) ? colors[0] : (id === valArr.length - 1) ? colors[colors.length - 1] :\n            (valArr.length === 3 && id === 1) ? colors[1] : this.getGradient(id, colors[0], colors[1], colors[2], valArr.length);\n        if (!isNullOrUndefined(actCell)) {\n            var style = {};\n            if (!isNullOrUndefined(id)) {\n                style = { backgroundColor: hexcode };\n                td.style.backgroundColor = hexcode;\n            }\n            else {\n                style = this.parent.getCellStyleValue(['backgroundColor'], [rIdx, cIdx]);\n                td.style.backgroundColor = style.backgroundColor;\n            }\n        }\n    };\n    // tslint:disable-next-line:max-func-body-length\n    ConditionalFormatting.prototype.applyDataBars = function (val, cFRule, tdEle, rIdx, cIdx) {\n        var value;\n        var rowIdx;\n        var colIdx;\n        var sheet = this.parent.getActiveSheet();\n        var left = {};\n        var right = {};\n        var posColor = '';\n        var negColor = '';\n        var cFColor = cFRule.type;\n        var actCell = sheet.rows[rIdx] && sheet.rows[rIdx].cells[cIdx] ? sheet.rows[rIdx].cells[cIdx] : null;\n        if (!actCell) {\n            return;\n        }\n        var valArr = [];\n        var row = this.parent.getMainContent().getElementsByClassName('e-row')[rIdx];\n        var td = tdEle ||\n            this.parent.getMainContent().getElementsByClassName('e-row')[rIdx].getElementsByClassName('e-cell')[cIdx];\n        var rowHeight = !row ? 20 : row.style ? parseInt(row.style.height, 10) : 20;\n        var posArr = [];\n        var negArr = [];\n        var topVal;\n        var leftStandardWidth = 0;\n        value = parseInt(val, 10);\n        var rangeArr = cFRule.range.split(',');\n        for (var rIdx_4 = 0; rIdx_4 < rangeArr.length; rIdx_4++) {\n            var selIndexes = getRangeIndexes(rangeArr[rIdx_4]);\n            valArr = this.getNumericArray(selIndexes, valArr);\n        }\n        for (var idx = 0; idx < valArr.length; idx++) {\n            valArr[idx] > 0 ? posArr.push(valArr[idx]) : negArr.push(valArr[idx]);\n        }\n        cFColor = cFColor === 'BlueDataBar' ? 'B' : cFColor === 'GreenDataBar' ? 'G' : cFColor === 'RedDataBar' ? 'R' :\n            cFColor === 'OrangeDataBar' ? 'O' : cFColor === 'LightBlueDataBar' ? 'LB' : cFColor === 'PurpleDataBar' ? 'P' : '';\n        posColor = this.getColor(cFColor)[0];\n        negColor = this.getColor('R')[0];\n        posArr = posArr.sort(function (n1, n2) { return n1 - n2; }).reverse();\n        negArr = negArr.sort(function (n1, n2) { return n1 - n2; });\n        if (negArr.length && posArr.length) {\n            topVal = posArr[0] + Math.abs(negArr[0]);\n            leftStandardWidth = (Math.abs((negArr[0] / topVal) * 100));\n        }\n        else if (negArr.length || posArr.length) {\n            topVal = negArr.length ? negArr[0] : posArr[0];\n        }\n        else {\n            return;\n        }\n        if (td) {\n            if (isNullOrUndefined(value) || val === '') {\n                if (td.getElementsByClassName('e-cf-databar')[0]) {\n                    td.removeChild(td.getElementsByClassName('e-cf-databar')[0]);\n                }\n            }\n        }\n        if (isNumber(value)) {\n            var databar = this.parent.createElement('div', { id: 'spreadsheet-databar', className: 'e-cf-databar' });\n            var leftSpan = this.parent.createElement('span', { id: 'spreadsheet-leftspan', className: 'e-databar' });\n            var rightSpan = this.parent.createElement('span', { id: 'spreadsheet-rightspan', className: 'e-databar' });\n            var dataSpan = this.parent.createElement('span', { id: 'spreadsheet-dataspan', className: 'e-databar-value' });\n            var iconSetSpan = void 0;\n            left = leftSpan.style;\n            right = rightSpan.style;\n            databar.appendChild(dataSpan);\n            databar.insertBefore(rightSpan, dataSpan);\n            databar.insertBefore(leftSpan, rightSpan);\n            if (td.querySelector('.e-iconsetspan')) {\n                iconSetSpan = td.querySelector('.e-iconsetspan');\n            }\n            td.textContent = '';\n            td.appendChild(databar);\n            if (iconSetSpan) {\n                td.insertBefore(iconSetSpan, td.firstElementChild);\n            }\n            dataSpan.innerHTML = this.parent.getDisplayText(actCell);\n            databar.style.height = rowHeight - 1 + 'px';\n            dataSpan.style.fontSize = '11pt';\n            if (!negArr.length) {\n                right.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                right.height = rowHeight - 3 + 'px';\n                right.backgroundColor = cFColor = posColor;\n                right.left = '0px';\n            }\n            else if (!posArr.length) {\n                right.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                right.height = rowHeight - 3 + 'px';\n                right.backgroundColor = cFColor = negColor;\n                right.left = '0px';\n            }\n            else {\n                if (value > -1) {\n                    left.width = leftStandardWidth + '%';\n                    left.height = rowHeight - 3 + 'px'; // -3 buffer of data bar.\n                    left.backgroundColor = 'transparent';\n                    left.left = '0px';\n                    right.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                    right.height = rowHeight - 3 + 'px';\n                    right.backgroundColor = cFColor = posColor;\n                    right.left = leftStandardWidth + '%';\n                }\n                else if (value < 0) {\n                    left.width = '' + Math.ceil(Math.abs((value / topVal) * 100)) + '%';\n                    left.height = rowHeight - 3 + 'px';\n                    left.backgroundColor = negColor;\n                    if (left.width === leftStandardWidth + '%') {\n                        left.left = '0px';\n                    }\n                    else {\n                        left.right = (100 - leftStandardWidth) + '%';\n                    }\n                }\n            }\n        }\n    };\n    ConditionalFormatting.prototype.getNumericArray = function (selIndexes, valArr) {\n        var sheet = this.parent.getActiveSheet();\n        for (var rIdx = selIndexes[0]; rIdx <= selIndexes[2]; rIdx++) {\n            for (var cIdx = selIndexes[1]; cIdx <= selIndexes[3]; cIdx++) {\n                var cellVal = getCell(rIdx, cIdx, sheet) && getCell(rIdx, cIdx, sheet).value ? getCell(rIdx, cIdx, sheet).value : '';\n                if (!isNullOrUndefined(cellVal) && !isNumber(cellVal) && !isDateTime(cellVal)) {\n                    continue;\n                }\n                else {\n                    var cellValue = parseInt(cellVal, 10);\n                    if (!isNullOrUndefined(cellVal) && cellVal !== '') {\n                        valArr.push(cellValue);\n                    }\n                }\n            }\n        }\n        return valArr;\n    };\n    ConditionalFormatting.prototype.getColor = function (cfColor) {\n        if (cfColor === 'LB') {\n            return ['#008aef'];\n        }\n        var colorCodeArr = cfColor.split('');\n        var colorArr = [];\n        for (var i = 0; i < colorCodeArr.length; i++) {\n            switch (colorCodeArr[i]) {\n                case 'G':\n                    colorArr.push('#63be7b');\n                    break;\n                case 'Y':\n                    colorArr.push('#ffeb84');\n                    break;\n                case 'R':\n                    colorArr.push('#f8696b');\n                    break;\n                case 'W':\n                    colorArr.push('#ffffff');\n                    break;\n                case 'B':\n                    colorArr.push('#5a8ac6');\n                    break;\n                case 'O':\n                    colorArr.push('#ffb628');\n                    break;\n                case 'LB':\n                    colorArr.push('#008aef');\n                    break;\n                case 'P':\n                    colorArr.push('#d6007b');\n                    break;\n            }\n        }\n        return colorArr;\n    };\n    ConditionalFormatting.prototype.getGradient = function (t, start, middle, end, large) {\n        if (isNullOrUndefined(end)) {\n            return this.getLinear(start, middle, t / large);\n        }\n        else {\n            var center = large / 2;\n            return t >= center ? this.getLinear(middle, end, Math.abs((t - center) / center)) : this.getLinear(start, middle, t / center);\n        }\n    };\n    ConditionalFormatting.prototype.getLinear = function (s, e, x) {\n        var r = this.byteLinear(s[1] + s[2], e[1] + e[2], x);\n        var g = this.byteLinear(s[3] + s[4], e[3] + e[4], x);\n        var b = this.byteLinear(s[5] + s[6], e[5] + e[6], x);\n        return '#' + r + g + b;\n    };\n    ConditionalFormatting.prototype.byteLinear = function (a, b, x) {\n        var y = (parseInt(a, 16) * (1 - x) + parseInt(b, 16) * x) | 0;\n        return Math.abs(y).toString(16);\n    };\n    ConditionalFormatting.prototype.isGreaterThanLessThan = function (cFRule, value, input, isGrearThan) {\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        if (isNumber(value)) {\n            if (isNumber(input)) {\n                isApply = isGrearThan ? parseFloat(value) > parseFloat(input.replace(txtRegx, '')) :\n                    parseFloat(value) < parseFloat(input.replace(txtRegx, ''));\n            }\n            else {\n                var dateEventArgs = {\n                    value: input,\n                    rowIndex: 0,\n                    colIndex: 0,\n                    sheetIndex: 0,\n                    isDate: false,\n                    updatedVal: '',\n                    isTime: false\n                };\n                this.parent.notify(checkDateFormat, dateEventArgs);\n                if (dateEventArgs.isDate || dateEventArgs.isTime) {\n                    isApply = isGrearThan ? value > dateEventArgs.updatedVal : value < dateEventArgs.updatedVal;\n                    cFRule.value = dateEventArgs.updatedVal.toString();\n                }\n                else {\n                    isApply = isGrearThan ? value.toLowerCase() > input.toLowerCase() : value.toLowerCase() < input.toLowerCase();\n                }\n            }\n        }\n        else if (value === '' && !isGrearThan) {\n            isApply = true;\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isBetWeen = function (cFRule, value, input1, input2) {\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        input1 = input1.replace(txtRegx, '');\n        input2 = input2.replace(txtRegx, '');\n        if (isNumber(value)) {\n            if (isNumber(input1)) {\n                isApply = parseFloat(value) >= parseFloat(input1) && parseFloat(value) <= parseFloat(input2);\n            }\n            else {\n                if (input1 && input2) {\n                    var dateEventArgs1 = {\n                        value: input1,\n                        rowIndex: 0,\n                        colIndex: 0,\n                        sheetIndex: 0,\n                        isDate: false,\n                        updatedVal: '',\n                        isTime: false\n                    };\n                    var dateEventArgs2 = {\n                        value: input2,\n                        rowIndex: 0,\n                        colIndex: 0,\n                        sheetIndex: 0,\n                        isDate: false,\n                        updatedVal: '',\n                        isTime: false\n                    };\n                    this.parent.notify(checkDateFormat, dateEventArgs1);\n                    this.parent.notify(checkDateFormat, dateEventArgs2);\n                    if ((dateEventArgs1.isDate || dateEventArgs1.isTime) && (dateEventArgs2.isDate || dateEventArgs2.isTime)) {\n                        isApply = value >= dateEventArgs1.updatedVal && value <= dateEventArgs2.updatedVal;\n                        cFRule.value = dateEventArgs1.updatedVal.toString() + ',' + dateEventArgs2.updatedVal.toString();\n                    }\n                    else {\n                        isApply = value.toLowerCase() >= input1.toLowerCase() && value.toLowerCase() <= input2.toLowerCase();\n                    }\n                }\n            }\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isEqualTo = function (cFRule, value, input) {\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        if (isNumber(value)) {\n            if (isNumber(input)) {\n                isApply = parseFloat(value) === parseFloat(input.replace(txtRegx, ''));\n            }\n            else {\n                var dateTimeArgs = {\n                    value: input,\n                    rowIndex: 0,\n                    colIndex: 0,\n                    sheetIndex: 0,\n                    isDate: false,\n                    updatedVal: '',\n                    isTime: false\n                };\n                this.parent.notify(checkDateFormat, dateTimeArgs);\n                if (dateTimeArgs.isTime || dateTimeArgs.isDate) {\n                    isApply = value === dateTimeArgs.updatedVal;\n                    cFRule.value = dateTimeArgs.updatedVal.toString();\n                }\n                else {\n                    isApply = value.toLowerCase() === input.toLowerCase();\n                }\n            }\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isContainsText = function (value, input) {\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var isApply = false;\n        if (isNullOrUndefined(value) || !value.length) {\n            isApply = false;\n        }\n        else if (isNumber(input.replace(txtRegx, ''))) {\n            input = input.replace(txtRegx, '');\n            if (isDateTime(value)) {\n                value = ((dateToInt(value))).toString();\n            }\n            isApply = value.indexOf(input) > -1;\n        }\n        else if (isDateTime(input)) {\n            if (isDateTime(value)) {\n                value = dateToInt(value).toString();\n            }\n            isApply = value.indexOf(dateToInt(input).toString()) > -1;\n        }\n        else {\n            isApply = value.toLowerCase().indexOf(input.toLowerCase()) > -1;\n        }\n        return isApply;\n    };\n    ConditionalFormatting.prototype.isTopBottomTenValue = function (cellValue, inp, cFRule, isTop) {\n        var sheet = this.parent.getActiveSheet();\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var value = parseInt(cellValue, 10);\n        var input = parseInt(inp, 10);\n        var result = false;\n        if (isNumber(inp)) {\n            if (isNumber(cellValue)) {\n                value = parseFloat(cellValue);\n                input = parseFloat(inp.replace(txtRegx, ''));\n            }\n            else if (isDateTime(cellValue)) {\n                value = dateToInt(cellValue);\n                input = parseFloat(inp);\n            }\n            var dataArray = [];\n            var cellVal = void 0;\n            var rangeArr = cFRule.range.split(',');\n            for (var rangeIdx = 0; rangeIdx < rangeArr.length; rangeIdx++) {\n                var cFRuleIndexes = getRangeIndexes(rangeArr[rangeIdx]);\n                for (var rowIdx = cFRuleIndexes[0]; rowIdx <= cFRuleIndexes[2]; rowIdx++) {\n                    for (var colIdx = cFRuleIndexes[1]; colIdx <= cFRuleIndexes[3]; colIdx++) {\n                        cellVal = getCell(rowIdx, colIdx, sheet) && getCell(rowIdx, colIdx, sheet).value ?\n                            getCell(rowIdx, colIdx, sheet).value : '';\n                        if (cellVal && isNumber(cellVal)) {\n                            cellVal = parseFloat(cellVal);\n                            dataArray.push(cellVal);\n                        }\n                    }\n                }\n            }\n            dataArray =\n                isTop ? dataArray.sort(function (n1, n2) { return n1 - n2; }).reverse() : dataArray.sort(function (n1, n2) { return n1 - n2; });\n            dataArray = dataArray.slice(0, input);\n            result = (dataArray.indexOf(value) > -1);\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.isTopBottomTenPercentage = function (val, inp, cFRule, isTop) {\n        var sheet = this.parent.getActiveSheet();\n        var numRegx = new RegExp(/[^.0-9]+/g);\n        var txtRegx = new RegExp(/[^.-a-zA-Z 0-9]+/g);\n        var value = parseInt(val, 10);\n        var input = parseInt(inp, 10);\n        var result = false;\n        if (isNumber(inp)) {\n            if (isNumber(val)) {\n                value = parseFloat(val);\n                input = parseFloat(inp.replace(txtRegx, ''));\n            }\n            else if (isDateTime(val)) {\n                value = dateToInt(val);\n                input = parseFloat(inp);\n            }\n            var dataArr = [];\n            var cellVal = void 0;\n            var diff = void 0;\n            var count = 0;\n            var considerCount = void 0;\n            var rangeArr = cFRule.range.split(',');\n            for (var rangeIdx = 0; rangeIdx < rangeArr.length; rangeIdx++) {\n                var cFRuleIndexes = getRangeIndexes(rangeArr[rangeIdx]);\n                for (var rIdx = cFRuleIndexes[0]; rIdx <= cFRuleIndexes[2]; rIdx++) {\n                    for (var cIdx = cFRuleIndexes[1]; cIdx <= cFRuleIndexes[3]; cIdx++) {\n                        cellVal = getCell(rIdx, cIdx, sheet) && getCell(rIdx, cIdx, sheet).value ? getCell(rIdx, cIdx, sheet).value : '';\n                        if (cellVal && isNumber(cellVal)) {\n                            cellVal = parseFloat(cellVal);\n                            dataArr.push(cellVal);\n                        }\n                        count++;\n                    }\n                }\n            }\n            diff = 100 / count;\n            considerCount = input / diff;\n            considerCount = Math.ceil(considerCount);\n            dataArr =\n                isTop ? dataArr.sort(function (n1, n2) { return n1 - n2; }).reverse() : dataArr.sort(function (n1, n2) { return n1 - n2; });\n            dataArr = dataArr.slice(0, considerCount ? considerCount : 1);\n            result = (dataArr.indexOf(value) > -1);\n        }\n        return result;\n    };\n    ConditionalFormatting.prototype.isAboveBelowAverage = function (val, inp, cFRule, isAbove) {\n        var sheet = this.parent.getActiveSheet();\n        var value = parseFloat(val);\n        var rangeColl = cFRule.range.split(',');\n        var result = false;\n        var dataArr = [];\n        var cellValue;\n        var average = 0;\n        for (var rangeIdx = 0; rangeIdx < rangeColl.length; rangeIdx++) {\n            var cFRuleIndexes = getRangeIndexes(rangeColl[rangeIdx]);\n            for (var rIdx = cFRuleIndexes[0]; rIdx <= cFRuleIndexes[2]; rIdx++) {\n                for (var cIdx = cFRuleIndexes[1]; cIdx <= cFRuleIndexes[3]; cIdx++) {\n                    cellValue = getCell(rIdx, cIdx, sheet) && getCell(rIdx, cIdx, sheet).value ? getCell(rIdx, cIdx, sheet).value : '';\n                    if (cellValue && isNumber(cellValue)) {\n                        cellValue = parseFloat(cellValue);\n                        dataArr.push(cellValue);\n                    }\n                }\n            }\n        }\n        for (var idx = 0; idx < dataArr.length; idx++) {\n            average += dataArr[idx];\n        }\n        average = average / dataArr.length;\n        result = isAbove ? (value > average) : (value < average);\n        return result;\n    };\n    ConditionalFormatting.prototype.isDuplicateUnique = function (val, cFRule, isAbove) {\n        var type = cFRule.type;\n        var count = 0;\n        var sheet = this.parent.getActiveSheet();\n        var value = val;\n        var rangeColl = cFRule.range.split(',');\n        var cellValue;\n        if (isNullOrUndefined(value) || value === '') {\n            return false;\n        }\n        for (var rIdx = 0; rIdx < rangeColl.length; rIdx++) {\n            var cFRuleIndexes = getRangeIndexes(rangeColl[rIdx]);\n            for (var rowIdx = cFRuleIndexes[0]; rowIdx <= cFRuleIndexes[2]; rowIdx++) {\n                for (var colIdx = cFRuleIndexes[1]; colIdx <= cFRuleIndexes[3]; colIdx++) {\n                    cellValue = getCell(rowIdx, colIdx, sheet) && getCell(rowIdx, colIdx, sheet).value ?\n                        getCell(rowIdx, colIdx, sheet).value.toString() : '';\n                    if (cellValue && cellValue !== '') {\n                        count = value.toLowerCase() === cellValue.toLowerCase() ? count + 1 : count;\n                        if (count === 2) {\n                            return type === 'Duplicate' ? true : false;\n                        }\n                    }\n                }\n            }\n        }\n        return type === 'Duplicate' ? false : true;\n    };\n    ConditionalFormatting.prototype.setFormat = function (style, cFRule) {\n        switch (cFRule.cFColor) {\n            case 'RedFT':\n                style.backgroundColor = '#ffc7ce';\n                style.color = '#9c0055';\n                break;\n            case 'YellowFT':\n                style.backgroundColor = '#ffeb9c';\n                style.color = '#9c6500';\n                break;\n            case 'GreenFT':\n                style.backgroundColor = '#c6efce';\n                style.color = '#006100';\n                break;\n            case 'RedF':\n                style.backgroundColor = '#ffc7ce';\n                break;\n            case 'RedT':\n                style.color = '#9c0055';\n                break;\n        }\n        return style;\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    ConditionalFormatting.prototype.getModuleName = function () {\n        return 'conditionalFormatting';\n    };\n    return ConditionalFormatting;\n}());\nexport { ConditionalFormatting };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, Property, NotifyPropertyChanges, Event, ChildProperty } from '@syncfusion/ej2-base';\nimport { getComponent, closest, EventHandler, getUniqueID, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Collection, Complex } from '@syncfusion/ej2-base';\nimport { Tab, Toolbar } from '@syncfusion/ej2-navigations';\nimport { Menu, Item, MenuItem } from '@syncfusion/ej2-navigations';\n/**\n * Objects used for configuring the Ribbon tab header properties.\n */\nvar RibbonHeader = /** @class */ (function (_super) {\n    __extends(RibbonHeader, _super);\n    function RibbonHeader() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], RibbonHeader.prototype, \"text\", void 0);\n    __decorate([\n        Property('')\n    ], RibbonHeader.prototype, \"iconCss\", void 0);\n    __decorate([\n        Property('left')\n    ], RibbonHeader.prototype, \"iconPosition\", void 0);\n    return RibbonHeader;\n}(ChildProperty));\nexport { RibbonHeader };\n/**\n * An array of object that is used to configure the Tab.\n */\nvar RibbonItem = /** @class */ (function (_super) {\n    __extends(RibbonItem, _super);\n    function RibbonItem() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Complex({}, RibbonHeader)\n    ], RibbonItem.prototype, \"header\", void 0);\n    __decorate([\n        Collection([], Item)\n    ], RibbonItem.prototype, \"content\", void 0);\n    __decorate([\n        Property('')\n    ], RibbonItem.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(false)\n    ], RibbonItem.prototype, \"disabled\", void 0);\n    return RibbonItem;\n}(ChildProperty));\nexport { RibbonItem };\n/**\n * Represents Ribbon component.\n */\nvar Ribbon = /** @class */ (function (_super) {\n    __extends(Ribbon, _super);\n    /**\n     * Constructor for creating the widget.\n     * @param  {RibbonModel} options?\n     * @param  {string|HTMLDivElement} element?\n     */\n    function Ribbon(options, element) {\n        return _super.call(this, options) || this;\n    }\n    /**\n     * For internal use only.\n     * @returns void\n     * @private\n     */\n    Ribbon.prototype.preRender = function () {\n        /** */\n    };\n    /**\n     * For internal use only.\n     * @returns void\n     * @private\n     */\n    Ribbon.prototype.render = function () {\n        if (!this.element.id) {\n            this.element.id = getUniqueID('ribbon');\n        }\n        this.renderRibbon();\n    };\n    /**\n     * Destroys the component (detaches/removes all event handlers, attributes, classes, and empties the component element).\n     * {% codeBlock src='spreadsheet/destroy/index.md' %}{% endcodeBlock %}\n     * @method destroy\n     * @return {void}\n     */\n    Ribbon.prototype.destroy = function () {\n        var expandCollapseElem = this.element.querySelector('.e-drop-icon');\n        if (expandCollapseElem) {\n            expandCollapseElem.removeEventListener('click', this.ribbonExpandCollapse.bind(this));\n        }\n        if (this.menuItems.length) {\n            var fileMenu = document.getElementById(this.element.id + \"_menu\");\n            if (fileMenu) {\n                getComponent(fileMenu, 'menu').destroy();\n            }\n        }\n        this.toolbarObj.destroy();\n        this.tabObj.destroy();\n        this.element.innerHTML = '';\n        this.toolbarObj = null;\n        this.tabObj = null;\n        _super.prototype.destroy.call(this);\n    };\n    Ribbon.prototype.getTabItems = function () {\n        var _this = this;\n        var tabItems = [];\n        if (this.menuItems.length) {\n            tabItems.push({\n                header: { text: this.initMenu(this.menuItems) },\n                content: this.toolbarObj.element,\n                cssClass: 'e-menu-tab'\n            });\n        }\n        this.items.forEach(function (item) {\n            tabItems.push({\n                header: item.header,\n                content: _this.toolbarObj.element\n            });\n        });\n        return tabItems;\n    };\n    Ribbon.prototype.initMenu = function (menuItems) {\n        var _this = this;\n        var menu = this.createElement('ul', { id: this.element.id + \"_menu\" });\n        this.element.appendChild(menu);\n        var menuObj = new Menu({\n            cssClass: 'e-file-menu',\n            items: menuItems,\n            showItemOnClick: true,\n            beforeOpen: function (args) {\n                if (args.parentItem.text === menuItems[0].text) {\n                    menuObj.showItemOnClick = false;\n                }\n                _this.trigger('beforeOpen', args);\n            },\n            select: function (args) {\n                _this.trigger('fileMenuItemSelect', args);\n            },\n            beforeClose: function (args) {\n                if (args.event.type === 'mouseover' && !closest(args.event.target, '.e-menu-popup')) {\n                    args.cancel = true;\n                    return;\n                }\n                _this.trigger('beforeClose', args);\n                if (!args.parentItem || args.parentItem.text === menuItems[0].text) {\n                    requestAnimationFrame(function () { return menuObj.setProperties({ showItemOnClick: true }, true); });\n                }\n            },\n            beforeItemRender: function (args) {\n                _this.trigger('beforeFileMenuItemRender', args);\n            }\n        });\n        menuObj.createElement = this.createElement;\n        menuObj.appendTo(menu);\n        return menu.parentElement;\n    };\n    Ribbon.prototype.renderRibbon = function () {\n        var _this = this;\n        var tabElement = this.createElement('div');\n        var tBarElement = this.createElement('div');\n        this.toolbarObj = new Toolbar({\n            items: this.items[this.selectedTab].content,\n            clicked: function (args) { return _this.trigger('clicked', args); }\n        });\n        this.toolbarObj.createElement = this.createElement;\n        this.toolbarObj.appendTo(tBarElement);\n        this.tabObj = new Tab({\n            selectedItem: this.getIndex(this.selectedTab),\n            animation: { next: { duration: 0 }, previous: { duration: 0 } },\n            items: this.getTabItems(),\n            selecting: function (args) {\n                if (_this.menuItems.length && args.selectingIndex === 0) {\n                    args.cancel = true;\n                }\n                else {\n                    if (args.selectingIndex === _this.getIndex(_this.selectedTab)) {\n                        return;\n                    }\n                    _this.updateToolbar(_this.getIndex(args.selectingIndex, true));\n                    _this.toolbarObj.dataBind();\n                    if (_this.element.classList.contains('e-collapsed')) {\n                        EventHandler.remove(args.selectedItem, 'click', _this.ribbonExpandCollapse);\n                    }\n                    var eventArgs = void 0;\n                    if (_this.menuItems.length) {\n                        eventArgs = __assign({}, args);\n                        eventArgs.selectingIndex -= 1;\n                        eventArgs.selectedIndex -= 1;\n                    }\n                    else {\n                        eventArgs = args;\n                    }\n                    _this.trigger('selecting', eventArgs);\n                }\n            },\n            selected: function (args) {\n                if (args.selectedIndex === _this.getIndex(_this.selectedTab)) {\n                    return;\n                }\n                _this.setProperties({ 'selectedTab': _this.getIndex(args.selectedIndex, true) }, true);\n                if (_this.element.classList.contains('e-collapsed')) {\n                    _this.element.classList.remove('e-collapsed');\n                    _this.trigger('expandCollapse', { element: _this.toolbarObj.element, expanded: true });\n                }\n            },\n            created: function () {\n                _this.toolbarObj.refreshOverflow();\n            }\n        });\n        this.element.appendChild(tabElement);\n        this.tabObj.createElement = this.createElement;\n        this.tabObj.appendTo(tabElement);\n        var collapseBtn = this.createElement('span', { className: 'e-drop-icon e-icons' });\n        collapseBtn.addEventListener('click', this.ribbonExpandCollapse.bind(this));\n        this.element.appendChild(collapseBtn);\n    };\n    Ribbon.prototype.ribbonExpandCollapse = function (e) {\n        var eventArgs = { element: this.toolbarObj.element, expanded: true };\n        var activeTab;\n        if (this.element.classList.contains('e-collapsed')) {\n            activeTab = this.tabObj.element.querySelector('.e-tab-header').getElementsByClassName('e-toolbar-item')[this.tabObj.selectedItem];\n            this.element.classList.remove('e-collapsed');\n            activeTab.classList.add('e-active');\n            EventHandler.remove(activeTab, 'click', this.ribbonExpandCollapse);\n            this.trigger('expandCollapse', eventArgs);\n        }\n        else {\n            activeTab = this.tabObj.element.querySelector('.e-tab-header .e-toolbar-item.e-active');\n            this.element.classList.add('e-collapsed');\n            eventArgs.expanded = false;\n            activeTab.classList.remove('e-active');\n            EventHandler.add(activeTab, 'click', this.ribbonExpandCollapse, this);\n            this.trigger('expandCollapse', eventArgs);\n        }\n    };\n    Ribbon.prototype.getIndex = function (index, decrement) {\n        return this.menuItems.length ? (decrement ? index - 1 : index + 1) : index;\n    };\n    Ribbon.prototype.updateToolbar = function (index) {\n        this.toolbarObj.items = this.items[index].content;\n        this.toolbarObj.dataBind();\n    };\n    /**\n     * To enable / disable the ribbon menu items.\n     * @param {string[]} items - Items that needs to be enabled / disabled.\n     * @param {boolean} enable - Set `true` / `false` to enable / disable the menu items.\n     * @param {boolean} isUniqueId? - Set `true` if the given menu items `text` is a unique id.\n     * @returns void.\n     */\n    Ribbon.prototype.enableMenuItems = function (items, enable, isUniqueId) {\n        if (enable === void 0) { enable = true; }\n        if (!this.menuItems.length) {\n            return;\n        }\n        getComponent(document.getElementById(this.element.id + \"_menu\"), 'menu').enableItems(items, enable, isUniqueId);\n    };\n    /**\n     * To show/hide the menu items in Ribbon.\n     * @param {string[]} items - Specifies the menu items text which is to be show/hide.\n     * @param {boolean} hide - Set `true` / `false` to hide / show the menu items.\n     * @param {boolean} isUniqueId? - Set `true` if the given menu items `text` is a unique id.\n     * @returns void.\n     */\n    Ribbon.prototype.hideMenuItems = function (items, hide, isUniqueId) {\n        if (hide === void 0) { hide = true; }\n        if (!this.menuItems.length) {\n            return;\n        }\n        var menuInstance = getComponent(document.getElementById(this.element.id + \"_menu\"), 'menu');\n        hide ? menuInstance.hideItems(items, isUniqueId) : menuInstance.showItems(items, isUniqueId);\n    };\n    /**\n     * To add custom menu items.\n     * @param {MenuItemModel[]} items - Specifies the Ribbon menu items to be inserted.\n     * @param {string} text - Specifies the existing file menu item text before / after which the new file menu items to be inserted.\n     * @param {boolean} insertAfter? - Set `false` if the `items` need to be inserted before the `text`.\n     * By default, `items` are added after the `text`.\n     * @param {boolean} isUniqueId? - Set `true` if the given menu items `text` is a unique id.\n     * @returns void.\n     */\n    Ribbon.prototype.addMenuItems = function (items, text, insertAfter, isUniqueId) {\n        if (insertAfter === void 0) { insertAfter = true; }\n        if (!this.menuItems.length) {\n            return;\n        }\n        var menuInstance = getComponent(document.getElementById(this.element.id + \"_menu\"), 'menu');\n        insertAfter ? menuInstance.insertAfter(items.reverse(), text, isUniqueId) : menuInstance.insertBefore(items, text, isUniqueId);\n    };\n    /**\n     * To show/hide the Ribbon tabs.\n     * @param {string[]} tabs - Specifies the tab header text which needs to be shown/hidden.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the ribbon tabs.\n     * @returns void.\n     */\n    Ribbon.prototype.hideTabs = function (tabs, hide) {\n        var _this = this;\n        if (hide === void 0) { hide = true; }\n        var idx;\n        var activeTab;\n        var stateChanged;\n        var isAllHidden;\n        if (!hide) {\n            isAllHidden = this.isAllHidden();\n        }\n        tabs.forEach(function (tab) {\n            idx = _this.getTabIndex(tab, -1);\n            if (idx > -1) {\n                if (hide) {\n                    if (!_this.items[idx].cssClass.includes(' e-hide')) {\n                        _this.items[idx].cssClass = _this.items[idx].cssClass + \" e-hide\";\n                        _this.tabObj.items[_this.getIndex(idx)].cssClass = _this.items[idx].cssClass;\n                        if (activeTab === undefined && idx === _this.selectedTab) {\n                            activeTab = true;\n                        }\n                        stateChanged = true;\n                    }\n                }\n                else {\n                    if (_this.items[idx].cssClass.includes(' e-hide')) {\n                        _this.items[idx].cssClass = _this.items[idx].cssClass.replace(' e-hide', '');\n                        _this.tabObj.items[_this.getIndex(idx)].cssClass = _this.items[idx].cssClass;\n                        if (activeTab === undefined && idx === _this.selectedTab) {\n                            activeTab = true;\n                        }\n                        stateChanged = true;\n                    }\n                }\n            }\n        });\n        this.setProperties({ 'items': this.items }, true);\n        this.tabObj.items = this.tabObj.items;\n        this.tabObj.dataBind();\n        if (hide) {\n            isAllHidden = this.isAllHidden();\n            if (isAllHidden) {\n                activeTab = false;\n            }\n        }\n        if (!hide && isAllHidden) {\n            activeTab = activeTab ? false : true;\n        }\n        if (stateChanged && isAllHidden) {\n            if (this.element.classList.contains('e-collapsed')) {\n                this.element.classList.remove('e-collapsed');\n                this.element.querySelector('.e-drop-icon').classList.remove('e-hide');\n            }\n            else {\n                this.element.classList.add('e-collapsed');\n                this.element.querySelector('.e-drop-icon').classList.add('e-hide');\n            }\n        }\n        if (activeTab) {\n            for (var i = 0; i < this.items.length; i++) {\n                if (!this.items[i].cssClass.includes(' e-hide')) {\n                    this.tabObj.selectedItem = this.getIndex(i);\n                    this.tabObj.dataBind();\n                    break;\n                }\n            }\n        }\n    };\n    Ribbon.prototype.isAllHidden = function () {\n        var allHidden = true;\n        for (var i = 0; i < this.items.length; i++) {\n            if (!this.items[i].cssClass.includes(' e-hide')) {\n                allHidden = false;\n                break;\n            }\n        }\n        return allHidden;\n    };\n    /**\n     * To enable / disable the Ribbon tabs.\n     * @param {string[]} tabs - Specifies the tab header text which needs to be enabled / disabled.\n     * @param {boolean} enable? - Set `true` / `false` to enable / disable the ribbon tabs.\n     * @returns void.\n     */\n    Ribbon.prototype.enableTabs = function (tabs, enable) {\n        var _this = this;\n        if (enable === void 0) { enable = true; }\n        tabs.forEach(function (tab) {\n            var idx = (_this.getTabIndex(tab, -1));\n            if (idx > -1) {\n                _this.items[idx].disabled = !enable;\n                idx = _this.getIndex(idx);\n                _this.tabObj.enableTab(idx, enable);\n            }\n        });\n        this.setProperties({ 'items': this.items }, true);\n    };\n    /**\n     * To add custom tabs.\n     * @param {RibbonItemModel[]} items - Specifies the Ribbon tab items to be inserted.\n     * @param {string} insertBefore? - Specifies the existing Ribbon header text before which the new tabs will be inserted.\n     * If not specified, the new tabs will be inserted at the end.\n     * @returns void.\n     */\n    Ribbon.prototype.addTabs = function (items, insertBefore) {\n        var _this = this;\n        var idx = this.getTabIndex(insertBefore);\n        items.forEach(function (item) {\n            item = new RibbonItem(_this.items[0], 'items', item, true);\n            _this.items.splice(idx, 0, item);\n            _this.tabObj.addTab([{ header: item.header, content: _this.toolbarObj.element }], _this.getIndex(idx));\n            idx++;\n        });\n        this.setProperties({ 'items': this.items }, true);\n        this.setProperties({ 'selectedTab': this.getIndex(this.tabObj.selectedItem, true) }, true);\n    };\n    Ribbon.prototype.getTabIndex = function (headerText, idx) {\n        if (idx === void 0) { idx = this.items.length; }\n        if (headerText) {\n            for (var i = 0; i < this.items.length; i++) {\n                if (this.items[i].header.text === headerText) {\n                    idx = i;\n                    break;\n                }\n            }\n        }\n        return idx;\n    };\n    /**\n     * To add the custom items in Ribbon toolbar.\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items will be inserted..\n     * @param {ItemModel[]} items - Specifies the ribbon toolbar items that needs to be inserted.\n     * @param {number} index? - Specifies the index text before which the new items will be inserted.\n     * If not specified, the new items will be inserted at the end of the toolbar.\n     */\n    Ribbon.prototype.addToolbarItems = function (tab, items, index) {\n        var _this = this;\n        var tabIdx = this.getTabIndex(tab);\n        if (isNullOrUndefined(index)) {\n            index = this.items[tabIdx].content.length;\n        }\n        items.forEach(function (item) {\n            item = new Item(_this.items[tabIdx].content[0], 'content', item, true);\n            _this.items[tabIdx].content.splice(index, 0, item);\n            index++;\n        });\n        this.setProperties({ 'items': this.items }, true);\n        if (tabIdx === this.selectedTab && items.length) {\n            this.updateToolbar(tabIdx);\n        }\n    };\n    /**\n     * Enables or disables the specified Ribbon toolbar items or all ribbon items.\n     * @param {string} tab - Specifies the ribbon tab header text under which the toolbar items need to be enabled / disabled.\n     * @param {string[]} items? - Specifies the toolbar item indexes / unique id's which needs to be enabled / disabled.\n     * If it is not specified the entire toolbar items will be enabled / disabled.\n     * @param  {boolean} enable? - Boolean value that determines whether the toolbar items should be enabled or disabled.\n     * @returns void.\n     */\n    Ribbon.prototype.enableItems = function (tab, items, enable) {\n        if (enable === undefined) {\n            enable = true;\n        }\n        if (items) {\n            var tabIdx = this.getTabIndex(tab, -1);\n            if (tabIdx < 0) {\n                return;\n            }\n            for (var i = 0; i < items.length; i++) {\n                if (typeof (items[i]) === 'string') {\n                    for (var j = 0; j < this.items[tabIdx].content.length; j++) {\n                        if (this.items[tabIdx].content[j].id === items[i]) {\n                            items[i] = j;\n                            break;\n                        }\n                    }\n                }\n                if (typeof (items[i]) === 'string') {\n                    return;\n                }\n                this.items[tabIdx].content[items[i]].disabled = !enable;\n            }\n            if (tabIdx === this.selectedTab) {\n                this.updateToolbar(tabIdx);\n            }\n        }\n        else {\n            this.toolbarObj.disable(!enable);\n        }\n    };\n    /**\n     * To show/hide the existing Ribbon toolbar items.\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items need to be hidden / shown.\n     * @param {string[]} indexes - Specifies the toolbar indexes which needs to be shown/hidden from UI.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the toolbar items.\n     * @returns void.\n     */\n    Ribbon.prototype.hideToolbarItems = function (tab, indexes, hide) {\n        var _this = this;\n        if (hide === void 0) { hide = true; }\n        var tabIdx;\n        for (var i = 0; i < this.items.length; i++) {\n            if (this.items[i].header.text === tab) {\n                tabIdx = i;\n                indexes.forEach(function (idx) {\n                    if (_this.items[tabIdx].content[idx]) {\n                        if (hide) {\n                            if (!_this.items[tabIdx].content[idx].cssClass.includes(' e-hide')) {\n                                _this.items[tabIdx].content[idx].cssClass = _this.items[tabIdx].content[idx].cssClass + ' e-hide';\n                            }\n                        }\n                        else {\n                            if (_this.items[tabIdx].content[idx].cssClass.includes(' e-hide')) {\n                                _this.items[tabIdx].content[idx].cssClass = _this.items[tabIdx].content[idx].cssClass.replace(' e-hide', '');\n                            }\n                        }\n                    }\n                });\n                break;\n            }\n        }\n        this.setProperties({ 'items': this.items }, true);\n        if (tabIdx !== undefined && tabIdx === this.selectedTab) {\n            this.updateToolbar(tabIdx);\n        }\n    };\n    /**\n     * Get component name.\n     * @returns string\n     * @private\n     */\n    Ribbon.prototype.getModuleName = function () {\n        return 'ribbon';\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     * @returns string\n     * @private\n     */\n    Ribbon.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @param  {RibbonModel} newProp\n     * @param  {RibbonModel} oldProp\n     * @returns void\n     * @private\n     */\n    Ribbon.prototype.onPropertyChanged = function (newProp, oldProp) {\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'selectedTab':\n                    this.tabObj.selectedItem = this.getIndex(newProp.selectedTab);\n                    this.tabObj.dataBind();\n                    break;\n            }\n        }\n    };\n    __decorate([\n        Property('')\n    ], Ribbon.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(true)\n    ], Ribbon.prototype, \"menuType\", void 0);\n    __decorate([\n        Collection([], MenuItem)\n    ], Ribbon.prototype, \"menuItems\", void 0);\n    __decorate([\n        Property(0)\n    ], Ribbon.prototype, \"selectedTab\", void 0);\n    __decorate([\n        Collection([], RibbonItem)\n    ], Ribbon.prototype, \"items\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"selecting\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"fileMenuItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeFileMenuItemRender\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"beforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"selectFormat\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"clicked\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], Ribbon.prototype, \"expandCollapse\", void 0);\n    Ribbon = __decorate([\n        NotifyPropertyChanges\n    ], Ribbon);\n    return Ribbon;\n}(Component));\nexport { Ribbon };\n","import { ColorPicker as ColorPickerComponent } from '@syncfusion/ej2-inputs';\nimport { addClass } from '@syncfusion/ej2-base';\nimport { spreadsheetDestroyed, fontColor, fillColor, beforeRibbonCreate, locale, focus } from '../common/index';\nimport { setCellFormat } from '../../workbook/common/index';\n/**\n * `Color Picker` module is used to handle ColorPicker functionality.\n * @hidden\n */\nvar ColorPicker = /** @class */ (function () {\n    function ColorPicker(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    ColorPicker.prototype.render = function () {\n        var _this = this;\n        var id = this.parent.element.id;\n        var input = this.parent.createElement('input', { attrs: { 'type': 'color' } });\n        this.fontColorPicker = new ColorPickerComponent({\n            value: '#000000ff',\n            mode: 'Palette',\n            showButtons: false,\n            presetColors: fontColor,\n            enableOpacity: false,\n            beforeClose: function (args) { return _this.beforeCloseHandler(_this.fontColorPicker); },\n            open: this.openHandler.bind(this),\n            beforeModeSwitch: function (args) { return _this.beforeModeSwitch(_this.fontColorPicker, args); },\n            change: function (args) {\n                var color = _this.fontColorPicker.getValue(args.currentValue.rgba);\n                var eventArgs = { style: { color: color }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (eventArgs.cancel) {\n                    _this.fontColorPicker.setProperties({ 'value': _this.fontColorPicker.getValue(args.previousValue.rgba, 'HEXA') }, true);\n                }\n                else {\n                    _this.updateSelectedColor(eventArgs.style.color, _this.fontColorPicker.element);\n                }\n                focus(_this.parent.element);\n            },\n            created: function () { return _this.wireFocusEvent(_this.fontColorPicker.element, '#000000'); }\n        });\n        this.fontColorPicker.createElement = this.parent.createElement;\n        this.parent.element.appendChild(input);\n        this.fontColorPicker.appendTo(input);\n        input.parentElement.id = id + \"_font_color_picker\";\n        addClass([input.nextElementSibling.getElementsByClassName('e-selected-color')[0]], ['e-icons', 'e-font-color']);\n        input = this.parent.createElement('input', { attrs: { 'type': 'color' } });\n        this.filColorPicker = new ColorPickerComponent({\n            value: '#ffff00ff',\n            mode: 'Palette',\n            presetColors: fillColor,\n            showButtons: false,\n            enableOpacity: false,\n            open: this.openHandler.bind(this),\n            beforeClose: function (args) { return _this.beforeCloseHandler(_this.filColorPicker); },\n            beforeModeSwitch: function (args) { return _this.beforeModeSwitch(_this.filColorPicker, args); },\n            change: function (args) {\n                var color = _this.filColorPicker.getValue(args.currentValue.rgba);\n                var eventArgs = { style: { backgroundColor: color }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (eventArgs.cancel) {\n                    _this.filColorPicker.setProperties({ 'value': _this.filColorPicker.getValue(args.previousValue.rgba, 'HEXA') }, true);\n                }\n                else {\n                    _this.updateSelectedColor(eventArgs.style.backgroundColor, _this.filColorPicker.element);\n                }\n                focus(_this.parent.element);\n            },\n            created: function () { return _this.wireFocusEvent(_this.filColorPicker.element, '#ffff00'); }\n        });\n        this.filColorPicker.createElement = this.parent.createElement;\n        this.parent.element.appendChild(input);\n        this.filColorPicker.appendTo(input);\n        input.parentElement.id = id + \"_fill_color_picker\";\n        addClass([input.nextElementSibling.getElementsByClassName('e-selected-color')[0]], ['e-icons', 'e-fill-color']);\n    };\n    ColorPicker.prototype.updateSelectedColor = function (color, ele) {\n        ele.nextElementSibling.querySelector('.e-selected-color').style.borderBottomColor = color;\n    };\n    ColorPicker.prototype.wireFocusEvent = function (element, color) {\n        var _this = this;\n        this.updateSelectedColor(color, element);\n        element = element.parentElement.querySelector('.e-split-colorpicker');\n        element.addEventListener('focus', function () {\n            focus(_this.parent.element);\n        });\n    };\n    ColorPicker.prototype.openHandler = function (args) {\n        args.element.querySelector('.e-mode-switch-btn').title =\n            this.parent.serviceLocator.getService(locale).getConstant('MoreColors');\n    };\n    ColorPicker.prototype.beforeCloseHandler = function (inst) {\n        if (!inst.modeSwitcher) {\n            inst.setProperties({ modeSwitcher: true }, true);\n        }\n        if (inst.showButtons) {\n            inst.setProperties({ showButtons: false }, true);\n        }\n    };\n    ColorPicker.prototype.beforeModeSwitch = function (inst, args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.mode === 'Picker') {\n            inst.showButtons = true;\n            inst.dataBind();\n            args.element.querySelector('.e-apply').title = l10n.getConstant('Apply');\n            args.element.querySelector('.e-cancel').title = l10n.getConstant('Cancel');\n            args.element.querySelector('.e-mode-switch-btn').title = l10n.getConstant('StandardColors');\n        }\n        else {\n            inst.showButtons = false;\n            inst.dataBind();\n            args.element.querySelector('.e-mode-switch-btn').title = l10n.getConstant('MoreColors');\n        }\n    };\n    ColorPicker.prototype.destroy = function () {\n        if (this.parent) {\n            this.removeEventListener();\n            this.fontColorPicker.destroy();\n            this.fontColorPicker = null;\n            this.filColorPicker.destroy();\n            this.filColorPicker = null;\n            this.parent = null;\n        }\n    };\n    ColorPicker.prototype.addEventListener = function () {\n        this.parent.on(beforeRibbonCreate, this.render, this);\n        this.parent.on('destroyRibbonComponents', this.destroy, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    ColorPicker.prototype.removeEventListener = function () {\n        this.parent.off(beforeRibbonCreate, this.render);\n        this.parent.off('destroyRibbonComponents', this.destroy);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    return ColorPicker;\n}());\nexport { ColorPicker };\n","import { Ribbon as RibbonComponent } from '../../ribbon/index';\nimport { ribbon, selectionComplete, beforeRibbonCreate, removeDataValidation, clearViewer } from '../common/index';\nimport { initiateDataValidation, invalidData, setUndoRedo, initiateConditionalFormat, setCF, focus } from '../common/index';\nimport { dialog, reapplyFilter, enableFileMenuItems, applyProtect, protectCellFormat } from '../common/index';\nimport { findHandler, insertChart } from '../common/index';\nimport { destroyComponent, performUndoRedo, beginAction, completeAction, applySort, hideRibbonTabs } from '../common/index';\nimport { enableToolbarItems, ribbonClick, paste, locale, refreshSheetTabs, initiateCustomSort, getFilteredColumn } from '../common/index';\nimport { tabSwitch, getUpdateUsingRaf, updateToggleItem, initiateHyperlink, editHyperlink } from '../common/index';\nimport { addRibbonTabs, addToolbarItems, hideFileMenuItems, addFileMenuItems, hideToolbarItems, enableRibbonTabs } from '../common/index';\nimport { Toolbar, Menu } from '@syncfusion/ej2-navigations';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\nimport { extend, isNullOrUndefined, getComponent, closest, detach, selectAll, select, EventHandler } from '@syncfusion/ej2-base';\nimport { getCellIndexes, getFormatFromType, getTypeFromFormat, setCell } from '../../workbook/index';\nimport { DropDownButton, SplitButton } from '@syncfusion/ej2-splitbuttons';\nimport { calculatePosition } from '@syncfusion/ej2-popups';\nimport { applyNumberFormatting, getFormattedCellObject, getRangeIndexes, setMerge } from '../../workbook/common/index';\nimport { activeCellChanged, textDecorationUpdate, isNumber } from '../../workbook/common/index';\nimport { sheetsDestroyed, getRangeAddress, clearCFRule } from '../../workbook/common/index';\nimport { getCell, setCellFormat } from '../../workbook/index';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { ColorPicker as RibbonColorPicker } from './color-picker';\nimport { Dialog as FindDialog } from '@syncfusion/ej2-popups';\nimport { findDlg } from '../common/index';\nimport { refreshRibbonIcons } from '../../workbook/common/index';\n/**\n * Represents Ribbon for Spreadsheet.\n */\nvar Ribbon = /** @class */ (function () {\n    function Ribbon(parent) {\n        this.border = '1px solid #000000';\n        this.fontNameIndex = 5;\n        this.numPopupWidth = 0;\n        this.findValue = '';\n        this.parent = parent;\n        this.addEventListener();\n        new RibbonColorPicker(parent);\n    }\n    Ribbon.prototype.getModuleName = function () {\n        return 'ribbon';\n    };\n    Ribbon.prototype.initRibbon = function (args) {\n        if (!this.parent.showRibbon && this.ribbon) {\n            this.destroy();\n            return;\n        }\n        this.parent.notify(beforeRibbonCreate, {});\n        if (this.parent.isMobileView()) {\n            this.createMobileView();\n        }\n        else {\n            this.createRibbon(args);\n        }\n    };\n    Ribbon.prototype.getRibbonMenuItems = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var id = this.parent.element.id;\n        return [{\n                text: this.parent.isMobileView() ? '' : l10n.getConstant('File'),\n                iconCss: this.parent.isMobileView() ? 'e-icons e-file-menu-icon' : null, id: id + \"_File\",\n                items: [\n                    { text: l10n.getConstant('New'), id: id + \"_New\", iconCss: 'e-new e-icons' },\n                    { text: l10n.getConstant('Open'), id: id + \"_Open\", iconCss: 'e-open e-icons' },\n                    {\n                        text: l10n.getConstant('SaveAs'), iconCss: 'e-save e-icons', id: id + \"_Save_As\",\n                        items: [\n                            { text: l10n.getConstant('ExcelXlsx'), id: id + \"_Xlsx\", iconCss: 'e-xlsx e-icons' },\n                            { text: l10n.getConstant('ExcelXls'), id: id + \"_Xls\", iconCss: 'e-xls e-icons' },\n                            { text: l10n.getConstant('CSV'), id: id + \"_Csv\", iconCss: 'e-csv e-icons' }\n                        ]\n                    }\n                ]\n            }];\n    };\n    // tslint:disable-next-line:max-func-body-length\n    Ribbon.prototype.getRibbonItems = function () {\n        var _this = this;\n        var id = this.parent.element.id;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var items = [{\n                header: { text: l10n.getConstant('Home') },\n                content: [\n                    { prefixIcon: 'e-undo-icon', tooltipText: l10n.getConstant('Undo') + \" (Ctrl+Z)\", id: id + '_undo', disabled: true },\n                    { prefixIcon: 'e-redo-icon', tooltipText: l10n.getConstant('Redo') + \" (Ctrl+Y)\", id: id + '_redo', disabled: true },\n                    { type: 'Separator', id: id + '_separator_1' },\n                    { prefixIcon: 'e-cut-icon', tooltipText: l10n.getConstant('Cut') + \" (Ctrl+X)\", id: id + '_cut' },\n                    { prefixIcon: 'e-copy-icon', tooltipText: l10n.getConstant('Copy') + \" (Ctrl+C)\", id: id + '_copy' },\n                    { tooltipText: l10n.getConstant('Paste') + \" (Ctrl+V)\", template: this.getPasteBtn(id), id: id + '_paste',\n                        disabled: true\n                    }, { type: 'Separator', id: id + '_separator_2' },\n                    { template: this.getNumFormatDDB(id), tooltipText: l10n.getConstant('NumberFormat'), id: id + '_number_format' },\n                    { type: 'Separator', id: id + '_separator_3' },\n                    { template: this.getFontNameDDB(id), tooltipText: l10n.getConstant('Font'), id: id + '_font_name' },\n                    { type: 'Separator', id: id + '_separator_4' },\n                    { template: this.getFontSizeDDB(id), tooltipText: l10n.getConstant('FontSize'), id: id + '_font_size' },\n                    { type: 'Separator', id: id + '_separator_5' },\n                    { template: this.getBtn(id, 'bold'), tooltipText: l10n.getConstant('Bold') + \" (Ctrl+B)\", id: id + '_bold' },\n                    { template: this.getBtn(id, 'italic'), tooltipText: l10n.getConstant('Italic') + \" (Ctrl+I)\", id: id + '_italic' },\n                    { template: this.getBtn(id, 'line-through'), tooltipText: l10n.getConstant('Strikethrough') + \" (Ctrl+5)\",\n                        id: id + '_line-through' },\n                    { template: this.getBtn(id, 'underline'), tooltipText: l10n.getConstant('Underline') + \" (Ctrl+U)\",\n                        id: id + '_underline' },\n                    { template: document.getElementById(id + \"_font_color_picker\"), tooltipText: l10n.getConstant('TextColor'),\n                        id: id + '_font_color_picker' }, { type: 'Separator', id: id + '_separator_6' },\n                    { template: document.getElementById(id + \"_fill_color_picker\"), tooltipText: l10n.getConstant('FillColor'),\n                        id: id + '_fill_color_picker' },\n                    { template: this.getBordersDBB(id), tooltipText: l10n.getConstant('Borders'), id: id + '_borders' }, {\n                        template: this.getMergeSplitBtn(id), tooltipText: l10n.getConstant('MergeCells'), id: id + '_merge_cells',\n                        disabled: true\n                    }, { type: 'Separator', id: id + '_separator_7' },\n                    { template: this.getTextAlignDDB(id), tooltipText: l10n.getConstant('HorizontalAlignment'), id: id + '_text_align' }, { template: this.getVerticalAlignDDB(id), tooltipText: l10n.getConstant('VerticalAlignment'), id: id + '_vertical_align' },\n                    { template: this.getBtn(id, 'wrap', false), tooltipText: \"\" + l10n.getConstant('WrapText'), id: id + '_wrap' }\n                ]\n            },\n            {\n                header: { text: l10n.getConstant('Insert') }, content: [\n                    {\n                        prefixIcon: 'e-hyperlink-icon', text: l10n.getConstant('Link'),\n                        id: id + '_hyperlink', tooltipText: l10n.getConstant('Link'), click: function () { _this.getHyperlinkDlg(); }\n                    },\n                    {\n                        prefixIcon: 'e-image-icon', text: l10n.getConstant('Image'),\n                        id: id + '_', tooltipText: l10n.getConstant('Image'), click: function () {\n                            select('#' + id + '_imageUpload', _this.parent.element).click();\n                        }\n                    }\n                ]\n            },\n            {\n                header: { text: l10n.getConstant('Formulas') }, content: [{\n                        prefixIcon: 'e-insert-function', tooltipText: l10n.getConstant('InsertFunction'),\n                        text: l10n.getConstant('InsertFunction'), id: id + '_insert_function'\n                    }]\n            },\n            {\n                header: { text: l10n.getConstant('Data') }, content: [\n                    {\n                        prefixIcon: 'e-protect-icon', text: l10n.getConstant('ProtectSheet'), id: id + '_protect',\n                        tooltipText: l10n.getConstant('ProtectSheet')\n                    }, { type: 'Separator', id: id + '_separator_8' },\n                    {\n                        template: this.datavalidationDDB(id), tooltipText: l10n.getConstant('DataValidation'),\n                        id: id + '_datavalidation'\n                    }\n                ]\n            },\n            {\n                header: { text: l10n.getConstant('View') }, content: [\n                    {\n                        prefixIcon: 'e-hide-headers', text: this.getLocaleText('Headers'), id: id + '_headers',\n                        tooltipText: this.getLocaleText('Headers')\n                    }, { type: 'Separator', id: id + '_separator_9' },\n                    {\n                        prefixIcon: 'e-hide-gridlines', text: this.getLocaleText('GridLines'), id: id + '_gridlines',\n                        tooltipText: this.getLocaleText('GridLines')\n                    }\n                ]\n            }];\n        if (this.parent.allowConditionalFormat) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({ type: 'Separator', id: id + '_separator_10' }, { template: this.getCFDBB(id), tooltipText: l10n.getConstant('ConditionalFormatting'), id: id + '_conditionalformatting' });\n        }\n        if (this.parent.allowChart) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Insert'); }).content.push({ type: 'Separator', id: id + '_separator_11' }, {\n                template: this.getChartDBB(id), text: l10n.getConstant('Chart'),\n                tooltipText: l10n.getConstant('Chart'), id: id + '_chart'\n            });\n        }\n        if (this.parent.allowCellFormatting) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({ type: 'Separator', id: id + '_separator_12' }, { template: this.getClearDDB(id), tooltipText: l10n.getConstant('Clear'), id: id + '_clear' });\n        }\n        if (this.parent.allowSorting || this.parent.allowFiltering) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({ template: this.getSortFilterDDB(id), tooltipText: l10n.getConstant('SortAndFilter'), id: id + '_sorting' });\n        }\n        if (this.parent.allowFindAndReplace) {\n            items.find(function (x) { return x.header && x.header.text === l10n.getConstant('Home'); }).content.push({\n                template: this.getFindDDb(id), prefixIcon: 'e-tbar-search-icon tb-icons',\n                tooltipText: l10n.getConstant('FindReplaceTooltip'), id: id + '_find'\n            });\n        }\n        return items;\n    };\n    Ribbon.prototype.getPasteBtn = function (id) {\n        var _this = this;\n        var btn = this.parent.element.appendChild(this.parent.createElement('button', { id: id + '_paste' }));\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.pasteSplitBtn = new SplitButton({\n            iconCss: 'e-icons e-paste-icon',\n            items: [\n                { text: l10n.getConstant('All'), id: 'All' },\n                { text: l10n.getConstant('Values'), id: 'Values' },\n                { text: l10n.getConstant('Formats'), id: 'Formats' }\n            ],\n            select: function (args) {\n                _this.parent.notify(paste, { type: args.item.id, isAction: true, isInternal: true });\n            },\n            click: function () {\n                _this.parent.notify(paste, { isAction: true, isInternal: true });\n            },\n            close: function () { focus(_this.parent.element); }\n        });\n        this.pasteSplitBtn.createElement = this.parent.createElement;\n        this.pasteSplitBtn.appendTo(btn);\n        return btn.parentElement;\n    };\n    Ribbon.prototype.getHyperlinkDlg = function () {\n        var indexes = getRangeIndexes(this.parent.getActiveSheet().activeCell);\n        var row = this.parent.sheets[this.parent.getActiveSheet().id - 1].rows[indexes[0]];\n        var cell;\n        if (!isNullOrUndefined(row)) {\n            cell = row.cells[indexes[1]];\n        }\n        if (isNullOrUndefined(cell)) {\n            setCell(indexes[0], indexes[1], this.parent.getActiveSheet(), cell, false);\n        }\n        if (cell && cell.hyperlink) {\n            this.parent.notify(editHyperlink, null);\n        }\n        else {\n            this.parent.notify(initiateHyperlink, null);\n        }\n    };\n    Ribbon.prototype.getLocaleText = function (str, setClass) {\n        var text;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        if (sheet['show' + str]) {\n            if (setClass) {\n                this.parent.getMainContent().classList.remove('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Hide' + str);\n        }\n        else {\n            if (setClass) {\n                this.parent.getMainContent().classList.add('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Show' + str);\n        }\n        return text;\n    };\n    Ribbon.prototype.getLocaleProtectText = function (str, setClass) {\n        var text;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.isProtected) {\n            if (setClass) {\n                this.parent.getMainContent().classList.remove('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Unprotect' + str);\n        }\n        else {\n            if (setClass) {\n                this.parent.getMainContent().classList.add('e-hide-' + str.toLowerCase());\n            }\n            text = l10n.getConstant('Protect' + str);\n        }\n        return text;\n    };\n    Ribbon.prototype.createRibbon = function (args) {\n        var ribbonElement = this.parent.createElement('div', { id: this.parent.element.id + \"_ribbon\" });\n        this.ribbon = new RibbonComponent({\n            selectedTab: 0,\n            menuItems: this.getRibbonMenuItems(),\n            items: this.getRibbonItems(),\n            fileMenuItemSelect: this.fileMenuItemSelect.bind(this),\n            beforeOpen: this.fileMenuBeforeOpen.bind(this),\n            beforeClose: this.fileMenuBeforeClose.bind(this),\n            clicked: this.toolbarClicked.bind(this),\n            created: this.ribbonCreated.bind(this),\n            selecting: this.tabSelecting.bind(this),\n            expandCollapse: this.expandCollapseHandler.bind(this),\n            beforeFileMenuItemRender: this.beforeRenderHandler.bind(this)\n        });\n        this.ribbon.createElement = this.parent.createElement;\n        if (args && args.uiUpdate) {\n            var refEle = this.parent.element.querySelector('.e-formula-bar-panel') ||\n                document.getElementById(this.parent.element.id + '_sheet_panel');\n            this.parent.element.insertBefore(ribbonElement, refEle);\n        }\n        else {\n            this.parent.element.appendChild(ribbonElement);\n        }\n        this.ribbon.appendTo(ribbonElement);\n    };\n    Ribbon.prototype.tabSelecting = function (args) {\n        if (args.selectingIndex !== this.ribbon.selectedTab) {\n            this.refreshRibbonContent(args.selectingIndex);\n            this.parent.notify(tabSwitch, { activeTab: args.selectingIndex });\n        }\n    };\n    Ribbon.prototype.beforeRenderHandler = function (args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.item.text === l10n.getConstant('Open') && (!this.parent.openUrl || !this.parent.allowOpen)) {\n            args.element.classList.add('e-disabled');\n        }\n        if (args.item.text === l10n.getConstant('SaveAs') && (!this.parent.saveUrl || !this.parent.allowSave)) {\n            args.element.classList.add('e-disabled');\n        }\n    };\n    Ribbon.prototype.getNumFormatDDB = function (id) {\n        var _this = this;\n        var numFormatBtn = this.parent.createElement('button', { id: id + '_number_format' });\n        numFormatBtn.appendChild(this.parent.createElement('span', { className: 'e-tbar-btn-text', innerHTML: 'General' }));\n        this.numFormatDDB = new DropDownButton({\n            items: this.getNumFormatDdbItems(id),\n            content: '',\n            select: function (args) { return _this.numDDBSelect(args); },\n            open: function (args) { return _this.numDDBOpen(args); },\n            beforeItemRender: function (args) { return _this.previewNumFormat(args); },\n            close: function () { return focus(_this.parent.element); },\n            cssClass: 'e-flat e-numformat-ddb',\n            beforeOpen: function (args) { return _this.tBarDdbBeforeOpen(args.element, args.items); }\n        });\n        this.numFormatDDB.createElement = this.parent.createElement;\n        this.numFormatDDB.appendTo(numFormatBtn);\n        return numFormatBtn;\n    };\n    Ribbon.prototype.getFontSizeDDB = function (id) {\n        var _this = this;\n        this.fontSizeDdb = new DropDownButton({\n            cssClass: 'e-font-size-ddb',\n            content: '11',\n            items: [{ text: '8' }, { text: '9' }, { text: '10' }, { text: '11' }, { text: '12' }, { text: '14' }, { text: '16' },\n                { text: '18' }, { text: '20' }, { text: '22' }, { text: '24' }, { text: '26' }, { text: '28' }, { text: '36' },\n                { text: '48' }, { text: '72' }],\n            beforeOpen: function (args) {\n                _this.tBarDdbBeforeOpen(args.element, args.items);\n                _this.refreshSelected(_this.fontSizeDdb, args.element, 'content', 'text');\n            },\n            select: function (args) {\n                var eventArgs = { style: { fontSize: args.item.text + \"pt\" }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.fontSizeDdb.content = eventArgs.style.fontSize.split('pt')[0];\n                    _this.fontSizeDdb.dataBind();\n                }\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.fontSizeDdb.createElement = this.parent.createElement;\n        this.fontSizeDdb.appendTo(this.parent.createElement('button', { id: id + '_font_size' }));\n        return this.fontSizeDdb.element;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    Ribbon.prototype.getChartDBB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.chartMenu = new Menu({\n            cssClass: 'e-chart-menu',\n            items: [\n                {\n                    iconCss: 'e-icons e-column', text: l10n.getConstant('Column'),\n                    items: [{ id: 'column_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-bar', text: l10n.getConstant('Bar'),\n                    items: [{ id: 'bar_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-area', text: l10n.getConstant('Area'),\n                    items: [{ id: 'area_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-pie-doughnut', text: l10n.getConstant('PieAndDoughnut'),\n                    items: [{ id: 'pie_doughnut_chart' }]\n                },\n                {\n                    iconCss: 'e-icons e-line', text: l10n.getConstant('Line'),\n                    items: [{ id: 'line_chart' }]\n                },\n                // {\n                //     iconCss: 'e-icons e-radar', text: l10n.getConstant('Radar'),\n                //     items: [{ id: 'radar_chart' }]\n                // },\n                {\n                    iconCss: 'e-icons e-scatter', text: l10n.getConstant('Scatter'),\n                    items: [{ id: 'scatter_chart' }]\n                }\n            ],\n            orientation: 'Vertical',\n            beforeOpen: function (args) {\n                if (args.parentItem.text === l10n.getConstant('Column')) {\n                    args.element.firstChild.appendChild(column);\n                    args.element.parentElement.classList.add('e-column-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Bar')) {\n                    args.element.firstChild.appendChild(bar);\n                    args.element.parentElement.classList.add('e-bar-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Area')) {\n                    args.element.firstChild.appendChild(area);\n                    args.element.parentElement.classList.add('e-area-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Line')) {\n                    args.element.firstChild.appendChild(line);\n                    args.element.parentElement.classList.add('e-line-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('PieAndDoughnut')) {\n                    args.element.firstChild.appendChild(pie);\n                    args.element.parentElement.classList.add('e-pie-doughnut-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Radar')) {\n                    args.element.firstChild.appendChild(radar);\n                    args.element.parentElement.classList.add('e-radar-chart');\n                }\n                else if (args.parentItem.text === l10n.getConstant('Scatter')) {\n                    args.element.firstChild.appendChild(scatter);\n                    args.element.parentElement.classList.add('e-scatter-chart');\n                }\n            },\n            select: this.chartSelected.bind(this)\n        });\n        this.chartMenu.createElement = this.parent.createElement;\n        var column = this.parent.createElement('div', { id: 'column_main', className: 'e-column-main' });\n        var column1Text = this.parent.createElement('div', { id: 'column1_text', className: 'e-column1-text', innerHTML: l10n.getConstant('Column') });\n        var column1Cont = this.parent.createElement('div', { id: 'column1_cont', className: 'e-column1-cont' });\n        var column2Text = this.parent.createElement('div', { id: 'column2_text', className: 'e-column2-text' });\n        var column2Cont = this.parent.createElement('div', { id: 'column2_cont', className: 'e-column2-cont' });\n        column.appendChild(column1Text);\n        column.appendChild(column1Cont);\n        //column.appendChild(column2Text);\n        //column.appendChild(column2Cont);\n        var clusteredColumn = this.parent.createElement('span', { id: 'clusteredColumn', className: 'e-clusteredcolumn e-column-icon e-menu-icon e-icons' });\n        var stackedColumn = this.parent.createElement('span', {\n            id: 'stackedColumn', className: 'e-stackedcolumn e-column-icon e-menu-icon e-icons'\n        });\n        var stackedColumn100 = this.parent.createElement('span', {\n            id: 'stackedColumn100', className: 'e-stackedcolumn100 e-column-icon e-menu-icon e-icons'\n        });\n        var clusteredColumn3D = this.parent.createElement('span', {\n            id: 'clusteredColumn3D', className: 'e-clusteredColumn3D e-column-icon'\n        });\n        var stackedColumn3D = this.parent.createElement('span', { id: 'stackedColumn3D', className: 'e-stackedColumn3D e-column-icon' });\n        var stackedColumn1003D = this.parent.createElement('span', { id: 'stackedColumn1003D', className: 'e-stackedColumn1003D e-column-icon' });\n        clusteredColumn.title = l10n.getConstant('ClusteredColumn');\n        stackedColumn.title = l10n.getConstant('StackedColumn');\n        stackedColumn100.title = l10n.getConstant('StackedColumn100');\n        stackedColumn1003D.title = l10n.getConstant('OrangeDataBar');\n        stackedColumn3D.title = l10n.getConstant('LightblueDataBar');\n        clusteredColumn3D.title = l10n.getConstant('PurpleDataBar');\n        column1Cont.appendChild(clusteredColumn);\n        column1Cont.appendChild(stackedColumn);\n        column1Cont.appendChild(stackedColumn100);\n        column2Cont.appendChild(clusteredColumn3D);\n        column2Cont.appendChild(stackedColumn3D);\n        column2Cont.appendChild(stackedColumn1003D);\n        var bar = this.parent.createElement('div', { id: 'bar_main', className: 'e-bar-main' });\n        var bar1Text = this.parent.createElement('div', { id: 'bar1_text', className: 'e-bar1-text', innerHTML: l10n.getConstant('Bar') });\n        var bar1Cont = this.parent.createElement('div', { id: 'bar1_cont', className: 'e-bar1-cont' });\n        var bar2Text = this.parent.createElement('div', { id: 'bar2_text', className: 'e-bar2-text' });\n        var bar2Cont = this.parent.createElement('div', { id: 'bar2_cont', className: 'e-bar2-cont' });\n        bar.appendChild(bar1Text);\n        bar.appendChild(bar1Cont);\n        //bar.appendChild(bar2Text);\n        //bar.appendChild(bar2Cont);\n        var clusteredBar = this.parent.createElement('span', { id: 'clusteredBar', className: 'e-clusteredbar e-bar-icon e-menu-icon e-icons' });\n        var stackedBar = this.parent.createElement('span', { id: 'stackedBar', className: 'e-stackedbar e-bar-icon e-menu-icon e-icons' });\n        var stackedBar100 = this.parent.createElement('span', { id: 'stackedBar100', className: 'e-stackedbar100 e-bar-icon e-menu-icon e-icons' });\n        var clusteredBar3D = this.parent.createElement('span', { id: 'clusteredBar3D', className: 'e-clusteredBar3D e-bar-icon' });\n        var stackedBar3D = this.parent.createElement('span', { id: 'stackedBar3D', className: 'e-stackedBar3D e-bar-icon' });\n        var stackedBar1003D = this.parent.createElement('span', { id: 'stackedBar1003D', className: 'e-stackedBar1003D e-bar-icon' });\n        clusteredBar.title = l10n.getConstant('ClusteredBar');\n        stackedBar.title = l10n.getConstant('StackedBar');\n        stackedBar100.title = l10n.getConstant('StackedBar100');\n        stackedBar1003D.title = l10n.getConstant('OrangeDataBar');\n        stackedBar3D.title = l10n.getConstant('LightblueDataBar');\n        clusteredBar3D.title = l10n.getConstant('PurpleDataBar');\n        bar1Cont.appendChild(clusteredBar);\n        bar1Cont.appendChild(stackedBar);\n        bar1Cont.appendChild(stackedBar100);\n        bar2Cont.appendChild(clusteredBar3D);\n        bar2Cont.appendChild(stackedBar3D);\n        bar2Cont.appendChild(stackedBar1003D);\n        var area = this.parent.createElement('div', { id: 'area_main', className: 'e-area-main' });\n        var areaText = this.parent.createElement('div', { id: 'area_text', className: 'e-area-text', innerHTML: l10n.getConstant('Area') });\n        var areaCont = this.parent.createElement('div', { id: 'area_cont', className: 'e-area-cont' });\n        area.appendChild(areaText);\n        area.appendChild(areaCont);\n        var defArea = this.parent.createElement('span', { id: 'area', className: 'e-area e-area-icon e-menu-icon e-icons' });\n        var stackedArea = this.parent.createElement('span', { id: 'stackedArea', className: 'e-stackedarea e-area-icon e-menu-icon e-icons' });\n        var stackedArea100 = this.parent.createElement('span', { id: 'stackedArea100', className: 'e-stackedarea100 e-area-icon e-menu-icon e-icons' });\n        defArea.title = l10n.getConstant('Area');\n        stackedArea.title = l10n.getConstant('StackedArea');\n        stackedArea100.title = l10n.getConstant('StackedArea100');\n        areaCont.appendChild(defArea);\n        areaCont.appendChild(stackedArea);\n        areaCont.appendChild(stackedArea100);\n        var line = this.parent.createElement('div', { id: 'line_main', className: 'e-line-main' });\n        var lineText = this.parent.createElement('div', { id: 'line_text', className: 'e-line-text', innerHTML: l10n.getConstant('Line') });\n        var lineCont = this.parent.createElement('div', { id: 'line_cont', className: 'e-line-cont' });\n        line.appendChild(lineText);\n        line.appendChild(lineCont);\n        var defLine = this.parent.createElement('span', { id: 'line', className: 'e-line e-line-icon e-menu-icon e-icons' });\n        var stackedLine = this.parent.createElement('span', { id: 'stackedLine', className: 'e-stackedline e-line-icon e-menu-icon e-icons' });\n        var stackedLine100 = this.parent.createElement('span', {\n            id: 'stackedline100', className: 'e-stackedline100 e-line-icon e-menu-icon e-icons'\n        });\n        defLine.title = l10n.getConstant('Line');\n        stackedLine.title = l10n.getConstant('StackedLine');\n        stackedLine100.title = l10n.getConstant('StackedLine100');\n        lineCont.appendChild(defLine);\n        lineCont.appendChild(stackedLine);\n        lineCont.appendChild(stackedLine100);\n        var pie = this.parent.createElement('div', { id: 'pie_main', className: 'e-pie-main' });\n        var pieText = this.parent.createElement('div', { id: 'pie_text', className: 'e-pie-text', innerHTML: l10n.getConstant('Pie') });\n        var pieCont = this.parent.createElement('div', { id: 'pie_cont', className: 'e-pie-cont' });\n        pie.appendChild(pieText);\n        pie.appendChild(pieCont);\n        var defPie = this.parent.createElement('span', { id: 'pie', className: 'e-pie e-pie-icon e-menu-icon e-icons' });\n        var doughnut = this.parent.createElement('span', { id: 'doughnut', className: 'e-doughnut e-pie-icon e-menu-icon e-icons' });\n        defPie.title = l10n.getConstant('Pie');\n        doughnut.title = l10n.getConstant('Doughnut');\n        pieCont.appendChild(defPie);\n        pieCont.appendChild(doughnut);\n        var radar = this.parent.createElement('div', { id: 'radar_main', className: 'e-radar-main' });\n        var radarText = this.parent.createElement('div', { id: 'radar_text', className: 'e-radar-text', innerHTML: 'Radar' });\n        var radarCont = this.parent.createElement('div', { id: 'radar_cont', className: 'e-radar-cont' });\n        radar.appendChild(radarText);\n        radar.appendChild(radarCont);\n        var defradar = this.parent.createElement('span', { id: 'radar', className: 'e-radar e-radar-icon e-menu-icon e-icons' });\n        var radarMarkers = this.parent.createElement('span', { id: 'radar_markers', className: 'e-radar-markers e-radar-icon e-menu-icon e-icons' });\n        defradar.title = l10n.getConstant('BlueDataBar');\n        radarMarkers.title = l10n.getConstant('GreenDataBar');\n        radarCont.appendChild(defradar);\n        radarCont.appendChild(radarMarkers);\n        var scatter = this.parent.createElement('div', { id: 'scatter_main', className: 'e-scatter-main' });\n        var scatterText = this.parent.createElement('div', { id: 'scatter_text', className: 'e-scatter-text', innerHTML: l10n.getConstant('Scatter') });\n        var scatterCont = this.parent.createElement('div', { id: 'scatter_cont', className: 'e-scatter-cont' });\n        scatter.appendChild(scatterText);\n        scatter.appendChild(scatterCont);\n        var defscatter = this.parent.createElement('span', { id: 'scatter', className: 'e-scatter e-scatter-icon e-menu-icon e-icons' });\n        defscatter.title = l10n.getConstant('Scatter');\n        scatterCont.appendChild(defscatter);\n        var ul = this.parent.element.appendChild(this.parent.createElement('ul', {\n            id: id + '_chart_menu', styles: 'display: none;'\n        }));\n        this.chartMenu.appendTo(ul);\n        ul.classList.add('e-ul');\n        this.chartDdb = new DropDownButton({\n            iconCss: 'e-icons e-chart-icon',\n            cssClass: 'e-chart-ddb',\n            target: this.chartMenu.element.parentElement,\n            created: function () { _this.chartMenu.element.style.display = ''; },\n            beforeClose: function (args) {\n                if (args.event && closest(args.event.target, '.e-chart-ddb')) {\n                    args.cancel = true;\n                }\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.chartDdb.createElement = this.parent.createElement;\n        var chartBtn = this.parent.createElement('button', { id: id + '_chart-btn' });\n        chartBtn.appendChild(this.parent.createElement('span', { id: id + '_chart', innerHTML: 'Chart' }));\n        this.chartDdb.appendTo(chartBtn);\n        return this.chartDdb.element;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    Ribbon.prototype.getCFDBB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.cFMenu = new Menu({\n            cssClass: 'e-cf-menu',\n            items: [{\n                    iconCss: 'e-icons e-hlcellrules', text: l10n.getConstant('HighlightCellsRules'),\n                    items: [{ iconCss: 'e-icons e-greaterthan', id: 'cf_greaterthan', text: l10n.getConstant('GreaterThan') + '...' },\n                        { iconCss: 'e-icons e-lessthan', id: 'cf_lessthan', text: l10n.getConstant('LessThan') + '...' },\n                        { iconCss: 'e-icons e-between', id: 'cf_between', text: l10n.getConstant('Between') + '...' },\n                        { iconCss: 'e-icons e-equalto', id: 'cf_eqaulto', text: l10n.getConstant('CFEqualTo') + '...' }, {\n                            iconCss: 'e-icons e-textcontains', id: 'cf_textthatcontains',\n                            text: l10n.getConstant('TextThatContains') + '...'\n                        }, { iconCss: 'e-icons e-adateoccuring', id: 'cf_adateoccuring', text: l10n.getConstant('ADateOccuring') + '...' }, {\n                            iconCss: 'e-icons e-duplicate', id: 'cf_duplicatevalues',\n                            text: l10n.getConstant('DuplicateValues') + '...'\n                        }]\n                },\n                {\n                    iconCss: 'e-icons e-topbottomrules', text: l10n.getConstant('TopBottomRules'),\n                    items: [{ iconCss: 'e-icons e-top10items', id: 'cf_top10items', text: l10n.getConstant('Top10Items') + '...' },\n                        { iconCss: 'e-icons e-top10', id: 'cf_top10', text: l10n.getConstant('Top10') + ' %...' },\n                        { iconCss: 'e-icons e-bottom10items', id: 'cf_bottom10items', text: l10n.getConstant('Bottom10Items') + '...' },\n                        { iconCss: 'e-icons e-bottom10', id: 'cf_bottom10', text: l10n.getConstant('Bottom10') + ' %...' },\n                        { iconCss: 'e-icons e-aboveaverage', id: 'cf_aboveaverage', text: l10n.getConstant('AboveAverage') + '...' },\n                        { iconCss: 'e-icons e-belowaverage', id: 'cf_belowaverage', text: l10n.getConstant('BelowAverage') + '...' }]\n                },\n                {\n                    iconCss: 'e-icons e-databars', text: l10n.getConstant('DataBars'),\n                    items: [{ id: 'cf_databars' }]\n                },\n                {\n                    iconCss: 'e-icons e-colorscales', text: l10n.getConstant('ColorScales'),\n                    items: [{ id: 'cf_colorscales' }]\n                },\n                {\n                    iconCss: 'e-icons e-iconsets', text: l10n.getConstant('IconSets'),\n                    items: [{ id: 'cf_iconsets' }]\n                },\n                {\n                    iconCss: 'e-icons e-clearrules', text: l10n.getConstant('ClearRules'),\n                    items: [{ id: 'cf_cr_cells', text: l10n.getConstant('SelectedCells') },\n                        { id: 'cf_cr_sheet', text: l10n.getConstant('EntireSheet') }]\n                }],\n            orientation: 'Vertical',\n            beforeOpen: function (args) {\n                if (args.parentItem.text === l10n.getConstant('DataBars')) {\n                    args.element.firstChild.appendChild(dataBars);\n                    args.element.parentElement.classList.add('e-databars');\n                }\n                else if (args.parentItem.text === l10n.getConstant('ColorScales')) {\n                    args.element.firstChild.appendChild(colorScales);\n                    args.element.parentElement.classList.add('e-colorscales');\n                }\n                else if (args.parentItem.text === l10n.getConstant('IconSets')) {\n                    args.element.firstChild.appendChild(iconSets);\n                    args.element.parentElement.classList.add('e-iconsets');\n                }\n            },\n            select: this.cFSelected.bind(this)\n        });\n        var dataBars = this.parent.createElement('div', { id: 'db', className: 'e-db' });\n        var db1 = this.parent.createElement('div', { id: 'db1', className: 'e-db1' });\n        var db2 = this.parent.createElement('div', { id: 'db2', className: 'e-db2' });\n        dataBars.appendChild(db1);\n        dataBars.appendChild(db2);\n        var bBar = this.parent.createElement('span', { id: 'BlueDataBar', className: 'e-bdatabar e-databar-icon' });\n        var gBar = this.parent.createElement('span', { id: 'GreenDataBar', className: 'e-gdatabar e-databar-icon' });\n        var rBar = this.parent.createElement('span', { id: 'RedDataBar', className: 'e-rdatabar e-databar-icon' });\n        var oBar = this.parent.createElement('span', { id: 'OrangeDataBar', className: 'e-odatabar e-databar-icon' });\n        var lBBar = this.parent.createElement('span', { id: 'LightBlueDataBar', className: 'e-lbdatabar e-databar-icon' });\n        var pBar = this.parent.createElement('span', { id: 'PurpleDataBar', className: 'e-pdatabar e-databar-icon' });\n        bBar.title = l10n.getConstant('BlueDataBar');\n        gBar.title = l10n.getConstant('GreenDataBar');\n        rBar.title = l10n.getConstant('RedDataBar');\n        oBar.title = l10n.getConstant('OrangeDataBar');\n        lBBar.title = l10n.getConstant('LightblueDataBar');\n        pBar.title = l10n.getConstant('PurpleDataBar');\n        db1.appendChild(bBar);\n        db1.appendChild(gBar);\n        db1.appendChild(rBar);\n        db2.appendChild(oBar);\n        db2.appendChild(lBBar);\n        db2.appendChild(pBar);\n        this.cFMenu.createElement = this.parent.createElement;\n        var colorScales = this.parent.createElement('div', { id: 'db', className: 'e-cs' });\n        var cs1 = this.parent.createElement('div', { id: 'cs1', className: 'e-cs1' });\n        var cs2 = this.parent.createElement('div', { id: 'cs2', className: 'e-cs2' });\n        var cs3 = this.parent.createElement('div', { id: 'cs3', className: 'e-cs3' });\n        colorScales.appendChild(cs1);\n        colorScales.appendChild(cs2);\n        colorScales.appendChild(cs3);\n        var gyr = this.parent.createElement('span', { id: 'GYRColorScale', className: 'e-gyr e-colorscale-icon' });\n        var ryg = this.parent.createElement('span', { id: 'RYGColorScale', className: 'e-ryg e-colorscale-icon' });\n        var gwr = this.parent.createElement('span', { id: 'GWRColorScale', className: 'e-gwr e-colorscale-icon' });\n        var rwg = this.parent.createElement('span', { id: 'RWGColorScale', className: 'e-rwg e-colorscale-icon' });\n        var bwr = this.parent.createElement('span', { id: 'BWRColorScale', className: 'e-bwr e-colorscale-icon' });\n        var rwb = this.parent.createElement('span', { id: 'RWBColorScale', className: 'e-rwb e-colorscale-icon' });\n        var wr = this.parent.createElement('span', { id: 'WRColorScale', className: 'e-wr e-colorscale-icon' });\n        var rw = this.parent.createElement('span', { id: 'RWColorScale', className: 'e-rw e-colorscale-icon' });\n        var gw = this.parent.createElement('span', { id: 'GWColorScale', className: 'e-gw e-colorscale-icon' });\n        var wg = this.parent.createElement('span', { id: 'WGColorScale', className: 'e-wg e-colorscale-icon' });\n        var gy = this.parent.createElement('span', { id: 'GYColorScale', className: 'e-gy e-colorscale-icon' });\n        var yg = this.parent.createElement('span', { id: 'YGColorScale', className: 'e-yg e-colorscale-icon' });\n        gyr.title = l10n.getConstant('GYRColorScale');\n        ryg.title = l10n.getConstant('RYGColorScale');\n        gwr.title = l10n.getConstant('GWRColorScale');\n        rwg.title = l10n.getConstant('RWGColorScale');\n        bwr.title = l10n.getConstant('BWRColorScale');\n        rwb.title = l10n.getConstant('RWBColorScale');\n        wr.title = l10n.getConstant('WRColorScale');\n        rw.title = l10n.getConstant('RWColorScale');\n        gw.title = l10n.getConstant('GWColorScale');\n        wg.title = l10n.getConstant('WGColorScale');\n        gy.title = l10n.getConstant('GYColorScale');\n        yg.title = l10n.getConstant('YGColorScale');\n        cs1.appendChild(gyr);\n        cs1.appendChild(ryg);\n        cs1.appendChild(gwr);\n        cs1.appendChild(rwg);\n        cs2.appendChild(bwr);\n        cs2.appendChild(rwb);\n        cs2.appendChild(wr);\n        cs2.appendChild(rw);\n        cs3.appendChild(gw);\n        cs3.appendChild(wg);\n        cs3.appendChild(gy);\n        cs3.appendChild(yg);\n        var iconSets = this.parent.createElement('div', { id: 'is', className: 'e-is' });\n        var is1 = this.parent.createElement('div', { id: 'is1', className: 'e-is1', innerHTML: 'Directional' });\n        var is2 = this.parent.createElement('div', { id: 'is2', className: 'e-is2' });\n        var is3 = this.parent.createElement('div', { id: 'is3', className: 'e-is3', innerHTML: 'Shapes' });\n        var is4 = this.parent.createElement('div', { id: 'is4', className: 'e-is4' });\n        var is5 = this.parent.createElement('div', { id: 'is5', className: 'e-is5', innerHTML: 'Indicators' });\n        var is6 = this.parent.createElement('div', { id: 'is6', className: 'e-is6' });\n        var is7 = this.parent.createElement('div', { id: 'is7', className: 'e-is7', innerHTML: 'Ratings' });\n        var is8 = this.parent.createElement('div', { id: 'is8', className: 'e-is8' });\n        is1.title = l10n.getConstant('GYColorScale');\n        is2.title = l10n.getConstant('YGColorScale');\n        is3.title = l10n.getConstant('GYColorScale');\n        is4.title = l10n.getConstant('YGColorScale');\n        is5.title = l10n.getConstant('GYColorScale');\n        is6.title = l10n.getConstant('YGColorScale');\n        is7.title = l10n.getConstant('GYColorScale');\n        is8.title = l10n.getConstant('YGColorScale');\n        iconSets.appendChild(is1);\n        iconSets.appendChild(is2);\n        iconSets.appendChild(is3);\n        iconSets.appendChild(is4);\n        iconSets.appendChild(is5);\n        iconSets.appendChild(is6);\n        iconSets.appendChild(is7);\n        iconSets.appendChild(is8);\n        var directional1 = this.parent.createElement('div', { id: 'ThreeArrows', className: 'e-3arrows e-is-wrapper' });\n        var directional2 = this.parent.createElement('div', { id: 'ThreeArrowsGray', className: 'e-3arrowsgray e-is-wrapper' });\n        var directional3 = this.parent.createElement('div', { id: 'ThreeTriangles', className: 'e-3triangles e-is-wrapper' });\n        var directional4 = this.parent.createElement('div', { id: 'FourArrowsGray', className: 'e-4arrowsgray e-is-wrapper' });\n        var directional5 = this.parent.createElement('div', { id: 'FourArrows', className: 'e-4arrows e-is-wrapper' });\n        var directional6 = this.parent.createElement('div', { id: 'FiveArrowsGray', className: 'e-5arrowsgray e-is-wrapper' });\n        var directional7 = this.parent.createElement('div', { id: 'FiveArrows', className: 'e-5arrows e-is-wrapper' });\n        directional1.title = l10n.getConstant('ThreeArrowsColor');\n        directional2.title = l10n.getConstant('ThreeArrowsGray');\n        directional3.title = l10n.getConstant('ThreeTriangles');\n        directional4.title = l10n.getConstant('FourArrowsColor');\n        directional5.title = l10n.getConstant('FourArrowsGray');\n        directional6.title = l10n.getConstant('FiveArrowsColor');\n        directional7.title = l10n.getConstant('FiveArrowsGray');\n        is2.appendChild(directional1);\n        is2.appendChild(directional2);\n        is2.appendChild(directional3);\n        is2.appendChild(directional4);\n        is2.appendChild(directional5);\n        is2.appendChild(directional6);\n        is2.appendChild(directional7);\n        var shapes1 = this.parent.createElement('div', { id: 'ThreeTrafficLights1', className: 'e-3trafficlights e-is-wrapper' });\n        var shapes2 = this.parent.createElement('div', { id: 'ThreeTrafficLights2', className: 'e-3rafficlights2 e-is-wrapper' });\n        var shapes3 = this.parent.createElement('div', { id: 'ThreeSigns', className: 'e-3signs e-is-wrapper' });\n        var shapes4 = this.parent.createElement('div', { id: 'FourTrafficLights', className: 'e-4trafficlights e-is-wrapper' });\n        var shapes5 = this.parent.createElement('div', { id: 'FourRedToBlack', className: 'e-4redtoblack e-is-wrapper' });\n        shapes1.title = l10n.getConstant('ThreeTrafficLights1');\n        shapes2.title = l10n.getConstant('ThreeTrafficLights2');\n        shapes3.title = l10n.getConstant('ThreeSigns');\n        shapes4.title = l10n.getConstant('FourTrafficLights');\n        shapes5.title = l10n.getConstant('RedToBlack');\n        is4.appendChild(shapes1);\n        is4.appendChild(shapes2);\n        is4.appendChild(shapes3);\n        is4.appendChild(shapes4);\n        is4.appendChild(shapes5);\n        var indicators1 = this.parent.createElement('div', { id: 'ThreeSymbols', className: 'e-3symbols e-is-wrapper' });\n        var indicators2 = this.parent.createElement('div', { id: 'ThreeSymbols2', className: 'e-3symbols2 e-is-wrapper' });\n        var indicators3 = this.parent.createElement('div', { id: 'ThreeFlags', className: 'e-3flags e-is-wrapper' });\n        indicators1.title = l10n.getConstant('ThreeSymbols1');\n        indicators2.title = l10n.getConstant('ThreeSymbols2');\n        indicators3.title = l10n.getConstant('ThreeFlags');\n        is6.appendChild(indicators1);\n        is6.appendChild(indicators2);\n        is6.appendChild(indicators3);\n        var ratings1 = this.parent.createElement('div', { id: 'ThreeStars', className: 'e-3stars e-is-wrapper' });\n        var ratings2 = this.parent.createElement('div', { id: 'FourRating', className: 'e-4rating e-is-wrapper' });\n        var ratings3 = this.parent.createElement('div', { id: 'FiveQuarters', className: 'e-5quarters e-is-wrapper' });\n        var ratings4 = this.parent.createElement('div', { id: 'FiveRating', className: 'e-5rating e-is-wrapper' });\n        var ratings5 = this.parent.createElement('div', { id: 'FiveBoxes', className: 'e-5boxes e-is-wrapper' });\n        ratings1.title = l10n.getConstant('ThreeStars');\n        ratings2.title = l10n.getConstant('FourRatings');\n        ratings3.title = l10n.getConstant('FiveQuarters');\n        ratings4.title = l10n.getConstant('FiveRatings');\n        ratings5.title = l10n.getConstant('FiveBoxes');\n        is8.appendChild(ratings1);\n        is8.appendChild(ratings2);\n        is8.appendChild(ratings3);\n        is8.appendChild(ratings4);\n        is8.appendChild(ratings5);\n        directional1.appendChild(this.createElement('span', 'e-3arrows-1 e-iconsetspan'));\n        directional1.appendChild(this.createElement('span', 'e-3arrows-2 e-iconsetspan'));\n        directional1.appendChild(this.createElement('span', 'e-3arrows-3 e-iconsetspan'));\n        directional2.appendChild(this.createElement('span', 'e-3arrowsgray-1 e-iconsetspan'));\n        directional2.appendChild(this.createElement('span', 'e-3arrowsgray-2 e-iconsetspan'));\n        directional2.appendChild(this.createElement('span', 'e-3arrowsgray-3 e-iconsetspan'));\n        directional3.appendChild(this.createElement('span', 'e-3triangles-1 e-iconsetspan'));\n        directional3.appendChild(this.createElement('span', 'e-3triangles-2 e-iconsetspan'));\n        directional3.appendChild(this.createElement('span', 'e-3triangles-3 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-1 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-2 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-3 e-iconsetspan'));\n        directional4.appendChild(this.createElement('span', 'e-4arrowsgray-4 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-1 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-2 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-3 e-iconsetspan'));\n        directional5.appendChild(this.createElement('span', 'e-4arrows-4 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-1 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-2 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-3 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-4 e-iconsetspan'));\n        directional6.appendChild(this.createElement('span', 'e-5arrowsgray-5 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-1 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-2 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-3 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-4 e-iconsetspan'));\n        directional7.appendChild(this.createElement('span', 'e-5arrows-5 e-iconsetspan'));\n        shapes1.appendChild(this.createElement('span', 'e-3trafficlights-1 e-iconsetspan'));\n        shapes1.appendChild(this.createElement('span', 'e-3trafficlights-2 e-iconsetspan'));\n        shapes1.appendChild(this.createElement('span', 'e-3trafficlights-3 e-iconsetspan'));\n        shapes2.appendChild(this.createElement('span', 'e-3rafficlights2-1 e-iconsetspan'));\n        shapes2.appendChild(this.createElement('span', 'e-3rafficlights2-2 e-iconsetspan'));\n        shapes2.appendChild(this.createElement('span', 'e-3rafficlights2-3 e-iconsetspan'));\n        shapes3.appendChild(this.createElement('span', 'e-3signs-1 e-iconsetspan'));\n        shapes3.appendChild(this.createElement('span', 'e-3signs-2 e-iconsetspan'));\n        shapes3.appendChild(this.createElement('span', 'e-3signs-3 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-1 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-2 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-3 e-iconsetspan'));\n        shapes4.appendChild(this.createElement('span', 'e-4trafficlights-4 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-1 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-2 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-3 e-iconsetspan'));\n        shapes5.appendChild(this.createElement('span', 'e-4redtoblack-4 e-iconsetspan'));\n        indicators1.appendChild(this.createElement('span', 'e-3symbols-1 e-iconsetspan'));\n        indicators1.appendChild(this.createElement('span', 'e-3symbols-2 e-iconsetspan'));\n        indicators1.appendChild(this.createElement('span', 'e-3symbols-3 e-iconsetspan'));\n        indicators2.appendChild(this.createElement('span', 'e-3symbols2-1 e-iconsetspan'));\n        indicators2.appendChild(this.createElement('span', 'e-3symbols2-2 e-iconsetspan'));\n        indicators2.appendChild(this.createElement('span', 'e-3symbols2-3 e-iconsetspan'));\n        indicators3.appendChild(this.createElement('span', 'e-3flags-1 e-iconsetspan'));\n        indicators3.appendChild(this.createElement('span', 'e-3flags-2 e-iconsetspan'));\n        indicators3.appendChild(this.createElement('span', 'e-3flags-3 e-iconsetspan'));\n        ratings1.appendChild(this.createElement('span', 'e-3stars-1 e-iconsetspan'));\n        ratings1.appendChild(this.createElement('span', 'e-3stars-2 e-iconsetspan'));\n        ratings1.appendChild(this.createElement('span', 'e-3stars-3 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-1 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-2 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-3 e-iconsetspan'));\n        ratings2.appendChild(this.createElement('span', 'e-4rating-4 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-1 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-2 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-3 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-4 e-iconsetspan'));\n        ratings3.appendChild(this.createElement('span', 'e-5quarters-5 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-1 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-2 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-3 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-4 e-iconsetspan'));\n        ratings4.appendChild(this.createElement('span', 'e-5rating-5 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-1 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-2 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-3 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-4 e-iconsetspan'));\n        ratings5.appendChild(this.createElement('span', 'e-5boxes-5 e-iconsetspan'));\n        var ul = this.parent.element.appendChild(this.parent.createElement('ul', {\n            id: id + '_cf_menu', styles: 'display: none;'\n        }));\n        this.cFMenu.appendTo(ul);\n        ul.classList.add('e-ul');\n        this.cFDdb = new DropDownButton({\n            iconCss: 'e-icons e-conditionalformatting-icon',\n            cssClass: 'e-cf-ddb',\n            target: this.cFMenu.element.parentElement,\n            created: function () { _this.cFMenu.element.style.display = ''; },\n            beforeClose: function (args) {\n                if (args.event && closest(args.event.target, '.e-cf-ddb')) {\n                    args.cancel = true;\n                }\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.cFDdb.createElement = this.parent.createElement;\n        this.cFDdb.appendTo(this.parent.createElement('button', { id: id + '_conditionalformatting' }));\n        return this.cFDdb.element;\n    };\n    Ribbon.prototype.createElement = function (tag, className, id) {\n        return this.parent.createElement(tag, { className: className });\n    };\n    Ribbon.prototype.getBordersDBB = function (id) {\n        var _this = this;\n        var cPickerWrapper;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.bordersMenu = new Menu({\n            cssClass: 'e-borders-menu',\n            items: [{ iconCss: 'e-icons e-top-borders', text: l10n.getConstant('TopBorders') }, {\n                    iconCss: 'e-icons e-left-borders',\n                    text: l10n.getConstant('LeftBorders')\n                }, { iconCss: 'e-icons e-right-borders', text: l10n.getConstant('RightBorders') }, {\n                    iconCss: 'e-icons e-bottom-borders', text: l10n.getConstant('BottomBorders')\n                }, {\n                    iconCss: 'e-icons e-all-borders', text: l10n.getConstant('AllBorders')\n                }, { iconCss: 'e-icons e-horizontal-borders', text: l10n.getConstant('HorizontalBorders') }, {\n                    iconCss: 'e-icons e-vertical-borders', text: l10n.getConstant('VerticalBorders')\n                }, {\n                    iconCss: 'e-icons e-outside-borders',\n                    text: l10n.getConstant('OutsideBorders')\n                }, { iconCss: 'e-icons e-inside-borders', text: l10n.getConstant('InsideBorders') },\n                { iconCss: 'e-icons e-no-borders', text: l10n.getConstant('NoBorders') }, { separator: true }, {\n                    text: l10n.getConstant('BorderColor'), items: [{ id: id + \"_border_colors\" }]\n                }, {\n                    text: l10n.getConstant('BorderStyle'), items: [\n                        { iconCss: 'e-icons e-selected-icon', id: id + \"_1px\" }, { id: id + \"_2px\" },\n                        { id: id + \"_3px\" }, { id: id + \"_dashed\" },\n                        { id: id + \"_dotted\" }, { id: id + \"_double\" }\n                    ]\n                }],\n            orientation: 'Vertical',\n            beforeOpen: function (args) {\n                if (args.parentItem.text === 'Border Color') {\n                    _this.colorPicker.refresh();\n                    cPickerWrapper = _this.colorPicker.element.parentElement;\n                    args.element.firstElementChild.appendChild(cPickerWrapper);\n                    cPickerWrapper.style.display = 'inline-block';\n                    args.element.parentElement.classList.add('e-border-color');\n                }\n                else {\n                    args.element.classList.add('e-border-style');\n                }\n            },\n            beforeClose: function (args) {\n                if (args.parentItem.text === 'Border Color') {\n                    if (!closest(args.event.target, '.e-border-colorpicker') ||\n                        closest(args.event.target, '.e-apply') || closest(args.event.target, '.e-cancel')) {\n                        _this.colorPicker = getComponent(cPickerEle, 'colorpicker');\n                        if (_this.colorPicker.mode === 'Picker') {\n                            _this.colorPicker.mode = 'Palette';\n                            _this.colorPicker.dataBind();\n                        }\n                        cPickerWrapper.style.display = '';\n                        _this.parent.element.appendChild(cPickerWrapper);\n                    }\n                    else {\n                        args.cancel = true;\n                    }\n                }\n            },\n            onOpen: function (args) {\n                if (args.parentItem.text === 'Border Color') {\n                    args.element.parentElement.style.overflow = 'visible';\n                }\n            },\n            select: this.borderSelected.bind(this)\n        });\n        this.bordersMenu.createElement = this.parent.createElement;\n        var ul = this.parent.element.appendChild(this.parent.createElement('ul', {\n            id: id + '_borders_menu', styles: 'display: none;'\n        }));\n        this.bordersMenu.appendTo(ul);\n        ul.classList.add('e-ul');\n        var cPickerEle = this.parent.createElement('input', { id: id + \"_cell_border_color\", attrs: { 'type': 'color' } });\n        this.parent.element.appendChild(cPickerEle);\n        this.colorPicker = new ColorPicker({\n            cssClass: 'e-border-colorpicker',\n            mode: 'Palette',\n            inline: true,\n            change: function (args) {\n                var border = _this.border.split(' ');\n                border[2] = args.currentValue.hex;\n                _this.border = border.join(' ');\n            },\n            created: function () { cPickerWrapper = _this.colorPicker.element.parentElement; }\n        });\n        this.colorPicker.createElement = this.parent.createElement;\n        this.colorPicker.appendTo(cPickerEle);\n        this.bordersDdb = new DropDownButton({\n            iconCss: 'e-icons e-bottom-borders',\n            cssClass: 'e-borders-ddb',\n            target: this.bordersMenu.element.parentElement,\n            created: function () { _this.bordersMenu.element.style.display = ''; },\n            beforeOpen: function (args) { return _this.tBarDdbBeforeOpen(args.element.firstElementChild, _this.bordersMenu.items, 1); },\n            beforeClose: function (args) {\n                if (args.event && closest(args.event.target, '.e-borders-menu')) {\n                    args.cancel = true;\n                }\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.bordersDdb.createElement = this.parent.createElement;\n        this.bordersDdb.appendTo(this.parent.createElement('button', { id: id + '_borders' }));\n        return this.bordersDdb.element;\n    };\n    Ribbon.prototype.chartSelected = function (args) {\n        var eleId = args.element.id;\n        if (('column_chart' + 'bar_chart' + 'area_chart' + 'pie_doughnut_chart' +\n            'line_chart' + 'radar_chart' + 'scatter_chart').includes(eleId)) {\n            var id = args.event.target.id;\n            this.parent.notify(insertChart, { action: eleId, id: id });\n        }\n    };\n    Ribbon.prototype.cFSelected = function (args) {\n        var eleId = args.element.id;\n        if (('cf_greaterthan' + 'cf_lessthan' + 'cf_between' + 'cf_eqaulto' + 'cf_textthatcontains' +\n            'cf_adateoccuring' + 'cf_duplicatevalues' + 'cf_top10items' + 'cf_top10' + 'cf_bottom10items' +\n            'cf_bottom10' + 'cf_aboveaverage' + 'cf_belowaverage').includes(eleId)) {\n            this.parent.notify(initiateConditionalFormat, { action: args.item.text });\n        }\n        else if (('cf_databars' + 'cf_colorscales').includes(eleId)) {\n            var id = args.event.target.id;\n            this.parent.notify(setCF, { action: eleId, id: id });\n        }\n        else if ('cf_iconsets' === args.element.id) {\n            var target = args.event.target;\n            var iconName = (target.id === '') ? target.parentElement.id : target.id;\n            this.parent.notify(setCF, { action: eleId, id: iconName });\n        }\n        if (eleId === 'cf_cr_cells') {\n            this.parent.notify(clearCFRule, { range: this.parent.getActiveSheet().selectedRange, isPublic: false });\n        }\n        else if (eleId === 'cf_cr_sheet') {\n            var sheet = this.parent.getActiveSheet();\n            var range = getRangeAddress([0, 0, sheet.rowCount - 1, sheet.colCount - 1]);\n            this.parent.conditionalFormat = null;\n            this.parent.notify(clearCFRule, { range: range, isPublic: false });\n        }\n    };\n    Ribbon.prototype.borderSelected = function (args) {\n        if (args.item.items.length || args.item.id === this.parent.element.id + \"_border_colors\") {\n            return;\n        }\n        if (!args.item.text) {\n            var id = this.parent.element.id;\n            var border = this.border.split(' ');\n            var prevStyleId_1 = border[1] === 'solid' ? id + \"_\" + border[0] : id + \"_\" + border[1];\n            if (prevStyleId_1 === args.item.id) {\n                return;\n            }\n            if (args.item.id === id + \"_1px\" || args.item.id === id + \"_2px\" || args.item.id === id + \"_3px\") {\n                border[0] = args.item.id.split(id + \"_\")[1];\n                border[1] = 'solid';\n            }\n            else {\n                border[1] = args.item.id.split(id + \"_\")[1];\n                border[0] = border[1] === 'double' ? '3px' : '1px';\n            }\n            this.border = border.join(' ');\n            this.bordersMenu.items[12].items.forEach(function (item) {\n                if (item.id === prevStyleId_1) {\n                    item.iconCss = null;\n                }\n                if (item.id === args.item.id) {\n                    item.iconCss = 'e-icons e-selected-icon';\n                }\n            });\n            this.bordersMenu.setProperties({ 'items': this.bordersMenu.items }, true);\n            return;\n        }\n        this.bordersDdb.toggle();\n        this.parent.showSpinner();\n        switch (args.item.text) {\n            case 'Top Borders':\n                this.parent.notify(setCellFormat, { style: { borderTop: this.border }, onActionUpdate: true });\n                break;\n            case 'Left Borders':\n                this.parent.notify(setCellFormat, { style: { borderLeft: this.border }, onActionUpdate: true });\n                break;\n            case 'Right Borders':\n                this.parent.notify(setCellFormat, { style: { borderRight: this.border }, onActionUpdate: true });\n                break;\n            case 'Bottom Borders':\n                this.parent.notify(setCellFormat, { style: { borderBottom: this.border }, onActionUpdate: true });\n                break;\n            case 'All Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true });\n                break;\n            case 'Horizontal Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Horizontal' });\n                break;\n            case 'Vertical Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Vertical' });\n                break;\n            case 'Outside Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Outer' });\n                break;\n            case 'Inside Borders':\n                this.parent.notify(setCellFormat, { style: { border: this.border }, onActionUpdate: true, borderType: 'Inner' });\n                break;\n            case 'No Borders':\n                this.parent.notify(setCellFormat, { style: { border: '' }, onActionUpdate: true });\n                break;\n        }\n        this.parent.hideSpinner();\n    };\n    Ribbon.prototype.getFontNameDDB = function (id) {\n        var _this = this;\n        var fontNameBtn = this.parent.createElement('button', { id: id + '_font_name' });\n        fontNameBtn.appendChild(this.parent.createElement('span', { className: 'e-tbar-btn-text', innerHTML: 'Calibri' }));\n        this.fontNameDdb = new DropDownButton({\n            cssClass: 'e-font-family',\n            items: this.getFontFamilyItems(),\n            select: function (args) {\n                var eventArgs = { style: { fontFamily: args.item.text }, onActionUpdate: true };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.refreshFontNameSelection(eventArgs.style.fontFamily);\n                }\n            },\n            close: function () { return focus(_this.parent.element); },\n            beforeOpen: function (args) { return _this.tBarDdbBeforeOpen(args.element, args.items); }\n        });\n        this.fontNameDdb.createElement = this.parent.createElement;\n        this.fontNameDdb.appendTo(fontNameBtn);\n        return fontNameBtn;\n    };\n    Ribbon.prototype.getBtn = function (id, name, bindEvent) {\n        if (bindEvent === void 0) { bindEvent = true; }\n        var btnObj = new Button({ iconCss: \"e-icons e-\" + name + \"-icon\", isToggle: true });\n        btnObj.createElement = this.parent.createElement;\n        btnObj.appendTo(this.parent.createElement('button', { id: id + \"_\" + name }));\n        if (bindEvent) {\n            btnObj.element.addEventListener('click', this.toggleBtnClicked.bind(this));\n        }\n        return btnObj.element;\n    };\n    Ribbon.prototype.datavalidationDDB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.datavalidationDdb = new DropDownButton({\n            cssClass: 'e-datavalidation-ddb',\n            iconCss: 'e-datavalidation-icon e-icons',\n            items: [\n                { text: l10n.getConstant('DataValidation') },\n                { text: l10n.getConstant('HighlightInvalidData') },\n                { text: l10n.getConstant('ClearHighlight') },\n                { text: l10n.getConstant('ClearValidation') }\n            ],\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.datavalidationDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                switch (args.item.text) {\n                    case l10n.getConstant('DataValidation'):\n                        _this.parent.notify(initiateDataValidation, null);\n                        break;\n                    case l10n.getConstant('HighlightInvalidData'):\n                        _this.parent.notify(invalidData, { isRemoveHighlight: false });\n                        break;\n                    case l10n.getConstant('ClearHighlight'):\n                        _this.parent.notify(invalidData, { isRemoveHighlight: true });\n                        break;\n                    case l10n.getConstant('ClearValidation'):\n                        _this.parent.notify(removeDataValidation, null);\n                        break;\n                    default:\n                        var direction = args.item.text === l10n.getConstant('SortAscending') ? 'Ascending' : 'Descending';\n                        _this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: direction } } });\n                        break;\n                }\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.datavalidationDdb.createElement = this.parent.createElement;\n        this.datavalidationDdb.appendTo(this.parent.createElement('button', { id: id + '_datavalidation' }));\n        return this.datavalidationDdb.element;\n    };\n    Ribbon.prototype.getTextAlignDDB = function (id) {\n        var _this = this;\n        this.textAlignDdb = new DropDownButton({\n            cssClass: 'e-align-ddb',\n            iconCss: 'e-icons e-left-icon',\n            items: [{ iconCss: 'e-icons e-left-icon' }, { iconCss: 'e-icons e-center-icon' }, { iconCss: 'e-icons e-right-icon' }],\n            beforeItemRender: this.alignItemRender.bind(this),\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.textAlignDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                var eventArgs = {\n                    style: { textAlign: args.item.iconCss.split(' e-')[1].split('-icon')[0] }, onActionUpdate: true\n                };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.textAlignDdb.iconCss = \"e-icons e-\" + eventArgs.style.textAlign + \"-icon\";\n                    _this.textAlignDdb.dataBind();\n                }\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.textAlignDdb.createElement = this.parent.createElement;\n        this.textAlignDdb.appendTo(this.parent.createElement('button', { id: id + '_text_align' }));\n        return this.textAlignDdb.element;\n    };\n    Ribbon.prototype.getVerticalAlignDDB = function (id) {\n        var _this = this;\n        this.verticalAlignDdb = new DropDownButton({\n            cssClass: 'e-align-ddb',\n            iconCss: 'e-icons e-bottom-icon',\n            items: [{ iconCss: 'e-icons e-top-icon' }, { iconCss: 'e-icons e-middle-icon' }, { iconCss: 'e-icons e-bottom-icon' }],\n            beforeItemRender: this.alignItemRender.bind(this),\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.verticalAlignDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                var eventArgs = {\n                    style: { verticalAlign: args.item.iconCss.split(' e-')[1].split('-icon')[0] }, onActionUpdate: true\n                };\n                _this.parent.notify(setCellFormat, eventArgs);\n                if (!eventArgs.cancel) {\n                    _this.verticalAlignDdb.iconCss = \"e-icons e-\" + eventArgs.style.verticalAlign + \"-icon\";\n                    _this.verticalAlignDdb.dataBind();\n                }\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.verticalAlignDdb.createElement = this.parent.createElement;\n        this.verticalAlignDdb.appendTo(this.parent.createElement('button', { id: id + '_vertical_align' }));\n        return this.verticalAlignDdb.element;\n    };\n    Ribbon.prototype.getMergeSplitBtn = function (id) {\n        var _this = this;\n        this.parent.element.appendChild(this.parent.createElement('button', { id: id + '_merge' }));\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.mergeSplitBtn = new SplitButton({\n            cssClass: 'e-merge-ddb',\n            iconCss: 'e-icons e-merge-icon',\n            items: [{ text: l10n.getConstant('MergeAll'), id: id + \"_merge_all\" }, { text: l10n.getConstant('MergeHorizontally'), id: id + \"_merge_horizontally\" }, { text: l10n.getConstant('MergeVertically'), id: id + \"_merge_vertically\" },\n                { separator: true, id: id + \"_merge_separator\" }, { text: l10n.getConstant('Unmerge'), id: id + \"_unmerge\" }],\n            select: this.mergeSelectHandler.bind(this),\n            close: function () { return focus(_this.parent.element); },\n            click: function (args) {\n                if (args.element.classList.contains('e-active')) {\n                    _this.toggleActiveState(false);\n                    _this.unMerge();\n                }\n                else {\n                    _this.toggleActiveState(true);\n                    _this.merge(_this.parent.element.id + \"_merge_all\");\n                }\n            },\n            created: function () {\n                _this.mergeSplitBtn.element.title = l10n.getConstant('MergeCells');\n                _this.mergeSplitBtn.element.nextElementSibling.title = l10n.getConstant('SelectMergeType');\n            }\n        });\n        this.mergeSplitBtn.createElement = this.parent.createElement;\n        this.mergeSplitBtn.appendTo('#' + id + '_merge');\n        return this.mergeSplitBtn.element.parentElement;\n    };\n    Ribbon.prototype.mergeSelectHandler = function (args) {\n        args.item.id === this.parent.element.id + \"_unmerge\" ? this.unMerge() : this.merge(args.item.id);\n    };\n    Ribbon.prototype.unMerge = function () {\n        this.parent.showSpinner();\n        this.parent.notify(setMerge, { merge: false, range: this.parent.getActiveSheet().selectedRange,\n            isAction: true, refreshRibbon: true, type: 'All' });\n        this.parent.hideSpinner();\n    };\n    Ribbon.prototype.merge = function (itemId) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getRangeIndexes(sheet.selectedRange);\n        var cell;\n        var isDataPresent;\n        for (var i = indexes[0]; i <= indexes[2]; i++) {\n            for (var j = indexes[1]; j <= indexes[3]; j++) {\n                if (i === indexes[0] && j === indexes[1] && itemId.includes('merge_all')) {\n                    continue;\n                }\n                if (i === indexes[0] && itemId.includes('merge_vertically')) {\n                    continue;\n                }\n                if (j === indexes[1] && itemId.includes('_merge_horizontally')) {\n                    continue;\n                }\n                cell = getCell(i, j, sheet) || {};\n                if (cell.value || cell.formula) {\n                    isDataPresent = true;\n                }\n            }\n        }\n        if (!isDataPresent) {\n            this.performMerge(itemId);\n            return;\n        }\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            target: this.parent.element, height: 200, width: 400, isModal: true, showCloseIcon: true,\n            content: this.parent.serviceLocator.getService(locale).getConstant('MergeCellsAlert'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'MergeAlertDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                focus(_this.parent.element);\n            },\n            buttons: [{\n                    buttonModel: { content: this.parent.serviceLocator.getService(locale).getConstant('Ok'), isPrimary: true },\n                    click: function () { dialogInst.hide(); _this.performMerge(itemId); }\n                }]\n        });\n    };\n    Ribbon.prototype.performMerge = function (itemId) {\n        var id = this.parent.element.id;\n        this.parent.showSpinner();\n        switch (itemId) {\n            case id + \"_merge_all\":\n                this.parent.notify(setMerge, { merge: true, range: this.parent.getActiveSheet().selectedRange,\n                    type: 'All', isAction: true, refreshRibbon: true });\n                break;\n            case id + \"_merge_horizontally\":\n                this.parent.notify(setMerge, { merge: true, range: this.parent.getActiveSheet().selectedRange,\n                    type: 'Horizontally', isAction: true });\n                break;\n            case id + \"_merge_vertically\":\n                this.parent.notify(setMerge, { merge: true, range: this.parent.getActiveSheet().selectedRange,\n                    type: 'Vertically', isAction: true });\n                break;\n        }\n        this.parent.hideSpinner();\n    };\n    Ribbon.prototype.getSortFilterDDB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.sortingDdb = new DropDownButton({\n            cssClass: 'e-sort-filter-ddb',\n            iconCss: 'e-icons e-sort-filter-icon',\n            items: [\n                { text: l10n.getConstant('SortAscending'), iconCss: 'e-icons e-sort-asc' },\n                { text: l10n.getConstant('SortDescending'), iconCss: 'e-icons e-sort-desc' },\n                { text: l10n.getConstant('CustomSort') + '...', iconCss: 'e-icons e-sort-custom' },\n                { separator: true },\n                { text: l10n.getConstant('Filter'), iconCss: 'e-icons e-filter-apply', id: id + '_applyfilter' },\n                { text: l10n.getConstant('ClearAllFilter'), iconCss: 'e-icons e-filter-clear', id: id + '_clearfilter' },\n                { text: l10n.getConstant('ReapplyFilter'), iconCss: 'e-icons e-filter-reapply', id: id + '_reapplyfilter' }\n            ],\n            beforeItemRender: function (args) {\n                var eventArgs = { isFiltered: false, isClearAll: true };\n                _this.parent.notify(getFilteredColumn, eventArgs);\n                if (args.item.id === id + '_clearfilter' || args.item.id === id + '_reapplyfilter') {\n                    if (!eventArgs.isFiltered) {\n                        args.element.classList.add('e-disabled');\n                    }\n                    else {\n                        args.element.classList.remove('e-disabled');\n                    }\n                }\n            },\n            beforeOpen: function (args) {\n                _this.refreshSelected(_this.sortingDdb, args.element, 'iconCss');\n            },\n            select: function (args) {\n                switch (args.item.text) {\n                    case l10n.getConstant('Filter'):\n                        _this.parent.applyFilter();\n                        break;\n                    case l10n.getConstant('ClearAllFilter'):\n                        _this.parent.clearFilter();\n                        break;\n                    case l10n.getConstant('ReapplyFilter'):\n                        _this.parent.notify(reapplyFilter, null);\n                        break;\n                    case l10n.getConstant('CustomSort') + '...':\n                        _this.parent.notify(initiateCustomSort, null);\n                        break;\n                    default:\n                        var direction = args.item.text === l10n.getConstant('SortAscending') ? 'Ascending' : 'Descending';\n                        _this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: direction } } });\n                        break;\n                }\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.sortingDdb.createElement = this.parent.createElement;\n        this.sortingDdb.appendTo(this.parent.createElement('button', { id: id + '_sorting' }));\n        return this.sortingDdb.element;\n    };\n    Ribbon.prototype.getFindDDb = function (id) {\n        var _this = this;\n        var findToolbtn = this.parent.createElement('button', { id: id + '_findbtn' });\n        this.findDdb = new Button({\n            cssClass: 'e-spreadsheet-find-ddb e-caret-hide',\n            iconCss: 'e-icons e-search-icon'\n        });\n        this.findDdb.createElement = this.parent.createElement;\n        this.findDdb.appendTo(findToolbtn);\n        findToolbtn.onclick = function () {\n            _this.findToolDlg();\n        };\n        return this.findDdb.element;\n    };\n    Ribbon.prototype.findToolDlg = function () {\n        var _this = this;\n        var countArgs;\n        if (isNullOrUndefined(this.parent.element.querySelector('.e-findtool-dlg'))) {\n            var toolbarObj_1;\n            var findTextElement = this.parent.createElement('div', { className: 'e-input-group' });\n            var findTextInput = this.parent.createElement('input', {\n                className: 'e-input e-text-findNext-short', attrs: { 'type': 'Text', value: this.findValue },\n            });\n            findTextInput.setAttribute('placeholder', 'FindValue');\n            var findSpan_1 = this.parent.createElement('span', { className: 'e-input-group-icon' });\n            findTextInput.onkeyup = function () {\n                countArgs = { countOpt: 'count', findCount: '' };\n                _this.parent.notify(findHandler, { countArgs: countArgs });\n                findSpan_1.textContent = countArgs.findCount;\n                var element = document.querySelector('.e-text-findNext-short');\n                var value = element.value;\n                var nextElement = document.querySelector('.e-findRib-next');\n                var prevElement = document.querySelector('.e-findRib-prev');\n                if (isNullOrUndefined(value) || (value === '') || (countArgs.findCount === '0 of 0')) {\n                    toolbarObj_1.enableItems(nextElement, false);\n                    toolbarObj_1.enableItems(prevElement, false);\n                    findSpan_1.textContent = '0 of 0';\n                }\n                else if (!isNullOrUndefined(value) || (countArgs.findCount !== '0 of 0')) {\n                    toolbarObj_1.enableItems(nextElement, true);\n                    toolbarObj_1.enableItems(prevElement, true);\n                }\n            };\n            findTextInput.onkeydown = function (e) {\n                countArgs = { countOpt: 'count', findCount: '' };\n                _this.parent.notify(findHandler, { countArgs: countArgs });\n                var count = countArgs.findCount;\n                _this.findOnKeyDown(e, count);\n            };\n            findTextElement.appendChild(findTextInput);\n            findTextElement.appendChild(findSpan_1);\n            var toolItemModel = [\n                { type: 'Input', template: findTextElement },\n                {\n                    prefixIcon: 'e-icons e-prev-icon', tooltipText: 'Find Previous', type: 'Button', cssClass: 'e-findRib-prev',\n                    disabled: true\n                },\n                { prefixIcon: 'e-icons e-next-icon', tooltipText: 'Find Next', type: 'Button', cssClass: 'e-findRib-next', disabled: true },\n                { type: 'Separator' },\n                { prefixIcon: 'e-icons e-option-icon', tooltipText: 'More Options', type: 'Button', cssClass: 'e-findRib-more' },\n                { prefixIcon: 'e-icons e-close', tooltipText: 'Close', type: 'Button', cssClass: 'e-findRib-close' }\n            ];\n            toolbarObj_1 = new Toolbar({\n                clicked: function (args) {\n                    if (args.item.cssClass === 'e-findRib-next') {\n                        _this.parent.notify(findHandler, { findOption: 'next' });\n                        countArgs = { countOpt: 'count', findCount: '' };\n                        _this.parent.notify(findHandler, { countArgs: countArgs });\n                        findSpan_1.textContent = countArgs.findCount;\n                    }\n                    else if (args.item.cssClass === 'e-findRib-prev') {\n                        _this.parent.notify(findHandler, { findOption: 'prev' });\n                        countArgs = { countOpt: 'count', findCount: '' };\n                        _this.parent.notify(findHandler, { countArgs: countArgs });\n                        findSpan_1.textContent = countArgs.findCount;\n                    }\n                    else if (args.item.cssClass === 'e-findRib-more') {\n                        _this.parent.notify(findDlg, null);\n                        _this.findDialog.hide();\n                    }\n                }, width: 'auto', height: 'auto', items: toolItemModel, cssClass: 'e-find-toolObj'\n            });\n            var toolbarElement_1 = this.parent.createElement('div', { className: 'e-find-toolbar' });\n            var dialogDiv = this.parent.createElement('div', { className: 'e-dlg-div' });\n            this.findDialog = new FindDialog({\n                isModal: false, showCloseIcon: false, cssClass: 'e-findtool-dlg', content: toolbarElement_1, visible: false,\n                allowDragging: true, target: this.parent.element.querySelector('.e-main-panel'),\n                beforeOpen: function () {\n                    EventHandler.add(document, 'click', _this.closeDialog, _this);\n                },\n                open: function () {\n                    _this.textFocus(toolbarObj_1.element);\n                },\n                beforeClose: function () {\n                    _this.findValue = _this.parent.element.querySelector('.e-text-findNext-short').value;\n                    toolbarObj_1.destroy();\n                    var element = document.querySelector('.e-find-toolbar');\n                    EventHandler.remove(element, 'focus', _this.textFocus);\n                    EventHandler.remove(document, 'click', _this.closeDialog);\n                    focus(_this.parent.element);\n                },\n                created: function () {\n                    toolbarObj_1.createElement = _this.parent.createElement;\n                    toolbarObj_1.appendTo(toolbarElement_1);\n                    _this.findDialog.width = getComputedStyle(document.querySelector('.e-findtool-dlg')).width;\n                    var calculate = _this.parent.element.querySelector('.e-main-panel').getBoundingClientRect();\n                    var dialogWidth = _this.findDialog.width;\n                    var rightValue = calculate.width - parseInt(dialogWidth.toString(), 10) - 14; /** 14- width of scroll bar */\n                    /** 31- height of sheetHeader */\n                    var topValue = _this.parent.sheets[_this.parent.activeSheetIndex].showHeaders ? 31 : 0;\n                    _this.findDialog.position = { X: rightValue, Y: topValue };\n                    _this.findDialog.dataBind();\n                    _this.findDialog.show();\n                },\n            });\n            this.findDialog.createElement = this.parent.createElement;\n            this.findDialog.appendTo(dialogDiv);\n        }\n        else {\n            if (!isNullOrUndefined(this.parent.element.querySelector('.e-findtool-dlg'))) {\n                this.findDialog.hide();\n                detach(this.parent.element.querySelector('.e-findtool-dlg'));\n                this.findDialog = null;\n                focus(this.parent.element);\n            }\n        }\n    };\n    Ribbon.prototype.findOnKeyDown = function (e, count) {\n        if (document.querySelector('.e-text-findNext-short').value) {\n            if (count !== '0 of 0') {\n                if (e.shiftKey) {\n                    if (e.keyCode === 13) {\n                        var buttonArgs = { findOption: 'prev' };\n                        this.parent.notify(findHandler, buttonArgs);\n                    }\n                }\n                else if (e.keyCode === 13) {\n                    var buttonArg = { findOption: 'next' };\n                    this.parent.notify(findHandler, buttonArg);\n                }\n            }\n        }\n    };\n    Ribbon.prototype.closeDialog = function (e) {\n        if ((closest(e.target, '.e-findRib-close')) || (!closest(e.target, '.e-spreadsheet'))) {\n            if (!isNullOrUndefined(this.findDialog)) {\n                this.findDialog.hide();\n                detach(this.parent.element.querySelector('.e-findtool-dlg'));\n                this.findDialog = null;\n            }\n        }\n    };\n    Ribbon.prototype.textFocus = function (element) {\n        element = document.querySelector('.e-find-toolbar');\n        element.addEventListener('focus', function () {\n            var elements = document.querySelector('.e-text-findNext-short');\n            elements.focus();\n            elements.classList.add('e-input-focus');\n            (elements).setSelectionRange(0, elements.value.length);\n        });\n    };\n    Ribbon.prototype.getClearDDB = function (id) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        this.clearDdb = new DropDownButton({\n            cssClass: 'e-clear-ddb',\n            iconCss: 'e-icons e-clear-icon',\n            items: [\n                { text: l10n.getConstant('ClearAll') },\n                { text: l10n.getConstant('ClearFormats') },\n                { text: l10n.getConstant('ClearContents') },\n                { text: l10n.getConstant('ClearHyperlinks') }\n            ],\n            select: function (args) {\n                _this.parent.notify(clearViewer, { options: { type: args.item.text } });\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.clearDdb.createElement = this.parent.createElement;\n        this.clearDdb.appendTo(this.parent.createElement('button', { id: id + '_clear' }));\n        return this.clearDdb.element;\n    };\n    Ribbon.prototype.ribbonCreated = function () {\n        this.ribbon.element.querySelector('.e-drop-icon').title\n            = this.parent.serviceLocator.getService(locale).getConstant('CollapseToolbar');\n    };\n    Ribbon.prototype.alignItemRender = function (args) {\n        var text = args.item.iconCss.split(' e-')[1].split('-icon')[0];\n        text = text[0].toUpperCase() + text.slice(1, text.length);\n        args.element.title = this.parent.serviceLocator.getService(locale).getConstant('Align' + text);\n    };\n    Ribbon.prototype.toggleBtnClicked = function (e) {\n        var target = closest(e.target, '.e-btn');\n        var parentId = this.parent.element.id;\n        var id = target.id;\n        var property = setCellFormat;\n        var value;\n        var defaultModel;\n        var activeModel;\n        var eventArgs;\n        var key;\n        switch (id) {\n            case parentId + \"_bold\":\n                defaultModel = { fontWeight: 'normal' };\n                activeModel = { fontWeight: 'bold' };\n                key = 'fontWeight';\n                break;\n            case parentId + \"_italic\":\n                defaultModel = { fontStyle: 'normal' };\n                activeModel = { fontStyle: 'italic' };\n                key = 'fontStyle';\n                break;\n            case parentId + \"_line-through\":\n                property = textDecorationUpdate;\n                defaultModel = { textDecoration: 'line-through' };\n                activeModel = defaultModel;\n                key = 'textDecoration';\n                break;\n            case parentId + \"_underline\":\n                property = textDecorationUpdate;\n                defaultModel = { textDecoration: 'underline' };\n                activeModel = defaultModel;\n                key = 'textDecoration';\n                break;\n        }\n        if (target.classList.contains('e-active')) {\n            value = activeModel[key];\n            eventArgs = { style: activeModel, onActionUpdate: true };\n            this.parent.notify(property, eventArgs);\n            if (eventArgs.cancel) {\n                target.classList.remove('e-active');\n            }\n        }\n        else {\n            value = defaultModel[key];\n            eventArgs = { style: defaultModel, onActionUpdate: true };\n            this.parent.notify(property, eventArgs);\n            if (eventArgs.cancel) {\n                target.classList.add('e-active');\n            }\n        }\n        if (!eventArgs.cancel && value !== eventArgs.style[key]) {\n            this.refreshToggleBtn(getCellIndexes(this.parent.getActiveSheet().activeCell));\n        }\n        focus(this.parent.element);\n    };\n    Ribbon.prototype.getCellStyleValue = function (cssProp, indexes) {\n        var cell = getCell(indexes[0], indexes[1], this.parent.getActiveSheet());\n        var value = this.parent.cellStyle[cssProp];\n        if (cell && cell.style && cell.style[cssProp]) {\n            value = cell.style[cssProp];\n        }\n        return value;\n    };\n    Ribbon.prototype.refreshSelected = function (inst, element, key, itemKey) {\n        if (itemKey === void 0) { itemKey = key; }\n        for (var i = 0; i < inst.items.length; i++) {\n            if (inst.items[i][itemKey] === inst[key]) {\n                element.children[i].classList.add('e-selected');\n                break;\n            }\n        }\n    };\n    Ribbon.prototype.expandCollapseHandler = function (args) {\n        var target = this.ribbon.element.querySelector('.e-drop-icon');\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (args.expanded) {\n            target.title = l10n.getConstant('CollapseToolbar');\n        }\n        else {\n            target.title = l10n.getConstant('ExpandToolbar');\n        }\n        this.parent.setPanelSize();\n    };\n    Ribbon.prototype.getNumFormatDdbItems = function (id) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        return [\n            { id: id + 'item1', text: l10n.getConstant('General') },\n            { id: id + 'item2', text: l10n.getConstant('Number') },\n            { id: id + 'item3', text: l10n.getConstant('Currency') },\n            { id: id + 'item4', text: l10n.getConstant('Accounting') },\n            { id: id + 'item5', text: l10n.getConstant('ShortDate') },\n            { id: id + 'item6', text: l10n.getConstant('LongDate') },\n            { id: id + 'item7', text: l10n.getConstant('Time') },\n            { id: id + 'item8', text: l10n.getConstant('Percentage') },\n            { id: id + 'item9', text: l10n.getConstant('Fraction') },\n            { id: id + 'item10', text: l10n.getConstant('Scientific') },\n            { id: id + 'item11', text: l10n.getConstant('Text') }\n        ];\n    };\n    Ribbon.prototype.getFontFamilyItems = function () {\n        return [{ text: 'Arial' }, { text: 'Arial Black' }, { text: 'Axettac Demo' }, { text: 'Batang' }, { text: 'Book Antiqua' },\n            { text: 'Calibri', iconCss: 'e-icons e-selected-icon' }, { text: 'Courier' }, { text: 'Courier New' },\n            { text: 'Din Condensed' }, { text: 'Georgia' }, { text: 'Helvetica' }, { text: 'Helvetica New' }, { text: 'Roboto' },\n            { text: 'Tahoma' }, { text: 'Times New Roman' }, { text: 'Verdana' }];\n    };\n    Ribbon.prototype.numDDBSelect = function (args) {\n        var eventArgs = {\n            format: getFormatFromType(args.item.text),\n            range: this.parent.getActiveSheet().selectedRange, cancel: false, requestType: 'NumberFormat'\n        };\n        var actionArgs = {\n            range: this.parent.getActiveSheet().name + '!' + eventArgs.range,\n            format: eventArgs.format, requestType: 'NumberFormat'\n        };\n        this.parent.trigger('beforeCellFormat', eventArgs);\n        this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'format' });\n        if (eventArgs.cancel) {\n            return;\n        }\n        this.parent.notify(applyNumberFormatting, eventArgs);\n        this.parent.notify(selectionComplete, { type: 'mousedown' });\n        this.refreshNumFormatSelection(args.item.text);\n        this.parent.notify(completeAction, { eventArgs: actionArgs, action: 'format' });\n    };\n    Ribbon.prototype.tBarDdbBeforeOpen = function (element, items, separatorCount) {\n        if (separatorCount === void 0) { separatorCount = 0; }\n        var viewportHeight = this.parent.viewport.height;\n        var actualHeight = (parseInt(getComputedStyle(element.firstElementChild).height, 10) * (items.length - separatorCount)) +\n            (parseInt(getComputedStyle(element).paddingTop, 10) * 2);\n        if (separatorCount) {\n            var separatorStyle = getComputedStyle(element.querySelector('.e-separator'));\n            actualHeight += (separatorCount * (parseInt(separatorStyle.borderBottomWidth, 10) + (parseInt(separatorStyle.marginTop, 10) * 2)));\n        }\n        if (actualHeight > viewportHeight) {\n            element.style.height = viewportHeight + \"px\";\n            element.style.overflowY = 'auto';\n        }\n        else {\n            if (element.style.height) {\n                element.style.height = '';\n                element.style.overflowY = '';\n            }\n        }\n    };\n    Ribbon.prototype.numDDBOpen = function (args) {\n        this.numPopupWidth = 0;\n        var elemList = args.element.querySelectorAll('span.e-numformat-preview-text');\n        for (var i = 0, len = elemList.length; i < len; i++) {\n            if (this.numPopupWidth < elemList[i].offsetWidth) {\n                this.numPopupWidth = elemList[i].offsetWidth;\n            }\n        }\n        var popWidth = this.numPopupWidth + 160;\n        document.querySelector('.e-numformat-ddb.e-dropdown-popup').style.width = popWidth + \"px\";\n    };\n    Ribbon.prototype.previewNumFormat = function (args) {\n        var cellIndex = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var cell = getCell(cellIndex[0], cellIndex[1], this.parent.getActiveSheet());\n        var eventArgs = {\n            type: args.item.text,\n            formattedText: '',\n            value: cell && cell.value ? cell.value : '',\n            format: getFormatFromType(args.item.text),\n            sheetIndex: this.parent.activeSheetIndex,\n            onLoad: true\n        };\n        var numElem = this.parent.createElement('div', {\n            className: 'e-numformat-text',\n            styles: 'width:100%',\n            innerHTML: args.element.innerHTML\n        });\n        args.element.innerHTML = '';\n        this.parent.notify(getFormattedCellObject, eventArgs);\n        var previewElem = this.parent.createElement('span', {\n            className: 'e-numformat-preview-text',\n            styles: 'float:right;',\n            innerHTML: eventArgs.formattedText.toString()\n        });\n        numElem.appendChild(previewElem);\n        args.element.appendChild(numElem);\n    };\n    Ribbon.prototype.refreshRibbonContent = function (activeTab) {\n        if (!this.ribbon) {\n            return;\n        }\n        if (isNullOrUndefined(activeTab)) {\n            activeTab = this.ribbon.selectedTab;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var sheet = this.parent.getActiveSheet();\n        switch (this.ribbon.items[activeTab].header.text) {\n            case l10n.getConstant('Home'):\n                this.refreshHomeTabContent(getCellIndexes(sheet.activeCell));\n                break;\n            case l10n.getConstant('Insert'):\n                // Second tab functionality comes here\n                break;\n            case l10n.getConstant('Formulas'):\n                // Third tab functionality comes here\n                break;\n            case l10n.getConstant('Data'):\n                this.refreshDataTabContent(activeTab);\n                break;\n            case l10n.getConstant('View'):\n                this.refreshViewTabContent(activeTab);\n                break;\n        }\n    };\n    Ribbon.prototype.refreshHomeTabContent = function (indexes) {\n        if (!isNullOrUndefined(document.getElementById(this.parent.element.id + '_number_format'))) {\n            this.numFormatDDB = getComponent(document.getElementById(this.parent.element.id + '_number_format'), DropDownButton);\n        }\n        var sheet = this.parent.getActiveSheet();\n        var actCell = getCellIndexes(this.parent.getActiveSheet().activeCell);\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var cell = getCell(actCell[0], actCell[1], this.parent.getActiveSheet()) || {};\n        var type = getTypeFromFormat(cell.format ? cell.format : 'General');\n        if (this.numFormatDDB) {\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                type = 'General';\n                this.refreshNumFormatSelection(type);\n            }\n            else {\n                this.refreshNumFormatSelection(l10n.getConstant(type));\n            }\n        }\n        if (this.fontNameDdb) {\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.refreshFontNameSelection('Calibri');\n            }\n            else {\n                this.refreshFontNameSelection(this.getCellStyleValue('fontFamily', indexes));\n            }\n        }\n        if (this.fontSizeDdb) {\n            var value = this.getCellStyleValue('fontSize', indexes);\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.fontSizeDdb.content = '11';\n            }\n            else {\n                value = value.includes('pt') ? value.split('pt')[0] : '11';\n                if (value !== this.fontSizeDdb.content) {\n                    this.fontSizeDdb.content = value;\n                    this.fontSizeDdb.dataBind();\n                }\n            }\n        }\n        if (this.textAlignDdb) {\n            var style = this.getCellStyleValue('textAlign', indexes);\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.textAlignDdb.iconCss = 'e-icons e-left-icon';\n            }\n            else {\n                if (cell.value !== undefined && style === 'left' && (type === 'Accounting' || isNumber(cell.value))) {\n                    style = 'right';\n                }\n                var value = \"e-icons e-\" + style.toLowerCase() + \"-icon\";\n                if (value !== this.textAlignDdb.iconCss) {\n                    this.textAlignDdb.iconCss = value;\n                    this.textAlignDdb.dataBind();\n                }\n            }\n        }\n        if (this.verticalAlignDdb) {\n            var value = \"e-icons e-\" + this.getCellStyleValue('verticalAlign', indexes).toLowerCase() + \"-icon\";\n            if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                this.verticalAlignDdb.iconCss = 'e-icons e-bottom-icon';\n            }\n            else {\n                if (value !== this.verticalAlignDdb.iconCss) {\n                    this.verticalAlignDdb.iconCss = value;\n                    this.verticalAlignDdb.dataBind();\n                }\n            }\n        }\n        this.refreshToggleBtn(indexes);\n        if (!sheet.isProtected && (cell.rowSpan > 1 || cell.colSpan > 1)) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: [this.parent.element.id + \"_merge_cells\"],\n                    enable: true }]);\n            this.toggleActiveState(true);\n        }\n        else {\n            var indexes_1 = getRangeIndexes(sheet.selectedRange);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: [this.parent.element.id + \"_merge_cells\"],\n                    enable: indexes_1[0] !== indexes_1[2] || indexes_1[1] !== indexes_1[3] ? true : false }]);\n            this.toggleActiveState(false);\n        }\n    };\n    Ribbon.prototype.toggleActiveState = function (active) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (!this.parent.getActiveSheet().isProtected) {\n            if (active) {\n                this.mergeSplitBtn.element.classList.add('e-active');\n                this.mergeSplitBtn.element.title = l10n.getConstant('UnmergeCells');\n            }\n            else {\n                if (this.mergeSplitBtn.element.classList.contains('e-active')) {\n                    this.mergeSplitBtn.element.classList.remove('e-active');\n                }\n                this.mergeSplitBtn.element.title = l10n.getConstant('MergeCells');\n            }\n        }\n    };\n    Ribbon.prototype.refreshToggleBtn = function (indexes) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var btn;\n        var id = this.parent.element.id;\n        var value;\n        var isActive;\n        var cell = getCell(indexes[0], indexes[1], sheet);\n        var fontProps = ['fontWeight', 'fontStyle', 'textDecoration', 'textDecoration'];\n        ['bold', 'italic', 'line-through', 'underline', 'wrap'].forEach(function (name, index) {\n            btn = document.getElementById(id + \"_\" + name);\n            if (btn) {\n                if (sheet.isProtected && !sheet.protectSettings.formatCells) {\n                    btn.classList.remove('e-active');\n                }\n                else if (name === 'wrap') {\n                    isActive = cell && cell.wrap;\n                }\n                else {\n                    value = _this.getCellStyleValue(fontProps[index], indexes).toLowerCase();\n                    isActive = value.indexOf(name) > -1;\n                }\n                if (isActive) {\n                    btn.classList.add('e-active');\n                }\n                else {\n                    if (btn.classList.contains('e-active')) {\n                        btn.classList.remove('e-active');\n                    }\n                }\n            }\n        });\n    };\n    Ribbon.prototype.refreshFontNameSelection = function (fontFamily) {\n        if (fontFamily !== this.fontNameDdb.items[this.fontNameIndex].text) {\n            this.fontNameDdb.element.firstElementChild.textContent = fontFamily;\n            for (var i = 0; i < this.fontNameDdb.items.length; i++) {\n                if (this.fontNameDdb.items[i].text === fontFamily) {\n                    this.fontNameDdb.items[i].iconCss = 'e-icons e-selected-icon';\n                    this.fontNameDdb.items[this.fontNameIndex].iconCss = '';\n                    this.fontNameDdb.setProperties({ 'items': this.fontNameDdb.items }, true);\n                    this.fontNameIndex = i;\n                    break;\n                }\n            }\n        }\n    };\n    Ribbon.prototype.refreshNumFormatSelection = function (type) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        for (var i = 0; i < this.numFormatDDB.items.length; i++) {\n            if (this.numFormatDDB.items[i].iconCss !== '') {\n                this.numFormatDDB.items[i].iconCss = '';\n            }\n            if (this.numFormatDDB.items[i].text === type) {\n                this.numFormatDDB.items[i].iconCss = 'e-icons e-selected-icon';\n            }\n        }\n        this.numFormatDDB.element.firstElementChild.textContent = type;\n        this.numFormatDDB.setProperties({ 'items': this.numFormatDDB.items }, true);\n    };\n    Ribbon.prototype.fileMenuItemSelect = function (args) {\n        var _this = this;\n        var selectArgs = extend({ cancel: false }, args);\n        this.parent.trigger('fileMenuItemSelect', selectArgs);\n        var id = this.parent.element.id;\n        if (!selectArgs.cancel) {\n            switch (args.item.id) {\n                case id + \"_Open\":\n                    select('#' + id + '_fileUpload', this.parent.element).click();\n                    break;\n                case id + \"_Xlsx\":\n                case id + \"_Xls\":\n                case id + \"_Csv\":\n                    this.parent.save({ saveType: args.item.id.split(id + \"_\")[1] });\n                    break;\n                case id + \"_New\":\n                    var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n                    dialogInst_1.show({\n                        height: 200, width: 400, isModal: true, showCloseIcon: true,\n                        content: this.parent.serviceLocator.getService(locale).getConstant('DestroyAlert'),\n                        beforeOpen: function (args) {\n                            var dlgArgs = {\n                                dialogName: 'DestroySheetDialog',\n                                element: args.element, target: args.target, cancel: args.cancel\n                            };\n                            _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                            if (dlgArgs.cancel) {\n                                args.cancel = true;\n                            }\n                            focus(_this.parent.element);\n                        },\n                        buttons: [{\n                                buttonModel: {\n                                    content: this.parent.serviceLocator.getService(locale).getConstant('Ok'), isPrimary: true\n                                },\n                                click: function () {\n                                    _this.parent.sheets.length = 0;\n                                    _this.parent.createSheet();\n                                    dialogInst_1.hide();\n                                    _this.parent.activeSheetIndex = _this.parent.sheets.length - 1;\n                                    _this.parent.notify(refreshSheetTabs, {});\n                                    _this.parent.notify(sheetsDestroyed, {});\n                                    _this.parent.renderModule.refreshSheet();\n                                }\n                            }]\n                    });\n                    break;\n            }\n        }\n    };\n    Ribbon.prototype.toolbarClicked = function (args) {\n        if (!(args.item.id === 'spreadsheet_find')) {\n            var parentId = this.parent.element.id;\n            var sheet = this.parent.getActiveSheet();\n            switch (args.item.id) {\n                case parentId + '_headers':\n                    var evtHArgs = {\n                        isShow: !sheet.showHeaders,\n                        sheetIdx: this.parent.activeSheetIndex,\n                        cancel: false\n                    };\n                    this.parent.notify(completeAction, { eventArgs: evtHArgs, action: 'headers' });\n                    if (evtHArgs.cancel) {\n                        return;\n                    }\n                    this.parent.setSheetPropertyOnMute(sheet, 'showHeaders', !sheet.showHeaders);\n                    this.parent.serviceLocator.getService('sheet').showHideHeaders();\n                    this.toggleRibbonItems({ props: 'Headers', activeTab: this.ribbon.selectedTab });\n                    focus(this.parent.element);\n                    break;\n                case parentId + '_gridlines':\n                    var evtglArgs = {\n                        isShow: !sheet.showGridLines,\n                        sheetIdx: this.parent.activeSheetIndex,\n                        cancel: false\n                    };\n                    this.parent.notify(completeAction, { eventArgs: evtglArgs, action: 'gridLines' });\n                    if (evtglArgs.cancel) {\n                        return;\n                    }\n                    this.parent.setSheetPropertyOnMute(sheet, 'showGridLines', !sheet.showGridLines);\n                    this.toggleRibbonItems({ props: 'GridLines', activeTab: this.ribbon.selectedTab });\n                    focus(this.parent.element);\n                    break;\n                case parentId + '_protect':\n                    this.parent.setSheetPropertyOnMute(sheet, 'isProtected', !sheet.isProtected);\n                    var isActive = false;\n                    sheet.isProtected ? isActive = false : isActive = true;\n                    this.parent.notify(applyProtect, { isActive: isActive, id: parentId + '_protect' });\n                    break;\n                case parentId + '_undo':\n                    this.parent.notify(performUndoRedo, { isUndo: true });\n                    break;\n                case parentId + '_redo':\n                    this.parent.notify(performUndoRedo, { isUndo: false });\n                    break;\n            }\n            this.parent.notify(ribbonClick, args);\n        }\n    };\n    Ribbon.prototype.toggleRibbonItems = function (args) {\n        var viewtabHeader = this.parent.serviceLocator.getService(locale).getConstant('View');\n        var datatabHeader = this.parent.serviceLocator.getService(locale).getConstant('Data');\n        if (this.ribbon.items[this.ribbon.selectedTab].header.text === viewtabHeader) {\n            if (isNullOrUndefined(args.activeTab)) {\n                for (var i = 0, len_1 = this.ribbon.items.length; i < len_1; i++) {\n                    if (this.ribbon.items[i].header.text === viewtabHeader) {\n                        args.activeTab = i;\n                        break;\n                    }\n                }\n            }\n            var text = this.getLocaleText(args.props, true);\n            var id = this.parent.element.id + \"_\" + args.props.toLowerCase();\n            var len = this.ribbon.items[args.activeTab].content.length;\n            for (var i = void 0; i < len; i++) {\n                if (this.ribbon.items[args.activeTab].content[i].type === 'Separator') {\n                    continue;\n                }\n                if (this.ribbon.items[args.activeTab].content[i].id === id) {\n                    this.ribbon.items[args.activeTab].content[i].text = text;\n                    this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n                }\n            }\n            if (this.ribbon.items[this.ribbon.selectedTab].header.text === viewtabHeader) {\n                this.updateToggleText(args.props.toLowerCase(), text);\n            }\n        }\n        if (this.ribbon.items[this.ribbon.selectedTab].header.text === datatabHeader) {\n            if (isNullOrUndefined(args.activeTab)) {\n                for (var i = 0, len_2 = this.ribbon.items.length; i < len_2; i++) {\n                    if (this.ribbon.items[i].header.text === datatabHeader) {\n                        args.activeTab = i;\n                        break;\n                    }\n                }\n            }\n            var text = this.getLocaleProtectText('Sheet', true);\n            var id = this.parent.element.id + \"_\" + args.props.toLowerCase();\n            var len = this.ribbon.items[args.activeTab].content.length;\n            for (var i = void 0; i < len; i++) {\n                if (this.ribbon.items[args.activeTab].content[i].type === 'Separator') {\n                    continue;\n                }\n                if (this.ribbon.items[args.activeTab].content[i].id === id) {\n                    this.ribbon.items[args.activeTab].content[i].text = text;\n                    this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n                }\n            }\n            if (this.ribbon.items[this.ribbon.selectedTab].header.text === datatabHeader) {\n                this.updateToggleText(args.props.toLowerCase(), text);\n            }\n        }\n    };\n    Ribbon.prototype.enableFileMenuItems = function (args) {\n        this.ribbon.enableMenuItems(args.items, args.enable, args.isUniqueId);\n    };\n    Ribbon.prototype.hideRibbonTabs = function (args) {\n        this.ribbon.hideTabs(args.tabs, args.hide);\n    };\n    Ribbon.prototype.addRibbonTabs = function (args) {\n        this.ribbon.addTabs(args.items, args.insertBefore);\n        var nextTab = select('.e-ribbon .e-tab-header .e-toolbar-item:not(.e-menu-tab).e-hide', this.parent.element);\n        if (nextTab) {\n            this.parent.updateActiveBorder(selectAll('.e-ribbon .e-tab-header .e-toolbar-item:not(.e-menu-tab)', this.parent.element)[this.ribbon.selectedTab]);\n        }\n    };\n    Ribbon.prototype.updateToggleText = function (item, text) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            select(\"#\" + _this.parent.element.id + \"_\" + item + \" .e-tbar-btn-text\", _this.ribbon.element).textContent = text;\n        });\n    };\n    Ribbon.prototype.refreshViewTabContent = function (activeTab) {\n        var id = this.parent.element.id;\n        var updated;\n        for (var i = 0; i < this.ribbon.items[activeTab].content.length; i++) {\n            if (this.ribbon.items[activeTab].content[i].type === 'Separator') {\n                continue;\n            }\n            if (this.ribbon.items[activeTab].content[i].id === id + \"_headers\") {\n                this.updateViewTabContent(activeTab, 'Headers', i);\n                if (updated) {\n                    break;\n                }\n                updated = true;\n            }\n            if (this.ribbon.items[activeTab].content[i].id === id + \"_gridlines\") {\n                this.updateViewTabContent(activeTab, 'GridLines', i);\n                if (updated) {\n                    break;\n                }\n                updated = true;\n            }\n        }\n    };\n    Ribbon.prototype.updateViewTabContent = function (activeTab, item, idx) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (sheet['show' + item]) {\n            if (this.ribbon.items[activeTab].content[idx].text === l10n.getConstant('Show' + item)) {\n                this.updateShowHideBtn('Hide', item, idx, activeTab);\n            }\n        }\n        else {\n            if (this.ribbon.items[activeTab].content[idx].text === l10n.getConstant('Hide' + item)) {\n                this.updateShowHideBtn('Show', item, idx, activeTab);\n            }\n        }\n    };\n    Ribbon.prototype.updateShowHideBtn = function (showHideText, item, idx, activeTab) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var text = l10n.getConstant(showHideText + item);\n        this.ribbon.items[activeTab].content[idx].text = text;\n        this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n        this.updateToggleText(item.toLowerCase(), text);\n    };\n    Ribbon.prototype.refreshDataTabContent = function (activeTab) {\n        var id = this.parent.element.id;\n        var updated;\n        for (var j = 0; j < this.ribbon.items[activeTab].content.length; j++) {\n            if (this.ribbon.items[activeTab].content[j].type === 'Separator') {\n                continue;\n            }\n            if (this.ribbon.items[activeTab].content[j].id === id + \"_protect\") {\n                this.updateDataTabContent(activeTab, 'Sheet', j);\n                if (updated) {\n                    break;\n                }\n                updated = true;\n            }\n        }\n    };\n    Ribbon.prototype.updateDataTabContent = function (activeTab, item, idx) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (sheet.isProtected) {\n            if (this.ribbon.items[activeTab].content[idx].text === l10n.getConstant('Protect' + item)) {\n                this.ribbon.items[activeTab].content[idx].cssClass = 'e-active';\n                this.updateProtectBtn('Unprotect', item, idx, activeTab);\n            }\n        }\n        else {\n            this.updateProtectBtn('Protect', item, idx, activeTab);\n        }\n    };\n    Ribbon.prototype.updateProtectBtn = function (protectText, item, idx, activeTab) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var text = l10n.getConstant(protectText + item);\n        this.ribbon.items[activeTab].content[idx].text = text;\n        this.ribbon.setProperties({ 'items': this.ribbon.items }, true);\n        this.updateToggleText('protect', text);\n    };\n    Ribbon.prototype.addToolbarItems = function (args) {\n        this.ribbon.addToolbarItems(args.tab, args.items, args.index);\n    };\n    Ribbon.prototype.enableToolbarItems = function (args) {\n        var _this = this;\n        args.forEach(function (arg) {\n            _this.ribbon.enableItems(arg.tab || _this.ribbon.items[_this.ribbon.selectedTab].header.text, arg.items, arg.enable);\n        });\n    };\n    Ribbon.prototype.createMobileView = function () {\n        var _this = this;\n        var parentId = this.parent.element.id;\n        var toobar = this.parent.createElement('div', { className: 'e-header-toolbar' });\n        var menu = this.parent.createElement('ul');\n        toobar.appendChild(menu);\n        var toolbarObj = new Toolbar({\n            items: [\n                { prefixIcon: 'e-tick-icon', align: 'Left', id: parentId + 'focused_tick', cssClass: 'e-focused-tick' },\n                { template: menu, align: 'Right', id: parentId + 'file_menu' },\n            ],\n            clicked: function (args) {\n                switch (args.item.id) {\n                    case parentId + 'focused_tick':\n                        _this.parent.element.classList.remove('e-mobile-focused');\n                        _this.parent.renderModule.setSheetPanelSize();\n                        break;\n                }\n            },\n            created: function () {\n                var menuObj = new Menu({\n                    cssClass: 'e-mobile e-file-menu',\n                    enableRtl: true,\n                    showItemOnClick: true,\n                    items: _this.getRibbonMenuItems(),\n                    select: _this.fileMenuItemSelect.bind(_this),\n                    beforeOpen: function (args) {\n                        args.element.parentElement.classList.remove('e-rtl');\n                        _this.fileMenuBeforeOpen(args);\n                    },\n                    beforeClose: _this.fileMenuBeforeClose.bind(_this)\n                });\n                menuObj.createElement = _this.parent.createElement;\n                menuObj.appendTo(menu);\n            }\n        });\n        toolbarObj.createElement = this.parent.createElement;\n        toolbarObj.appendTo(toobar);\n        this.parent.element.insertBefore(toobar, this.parent.element.firstElementChild);\n        this.renderMobileToolbar();\n    };\n    Ribbon.prototype.renderMobileToolbar = function () {\n        var _this = this;\n        var toolbarPanel = this.parent.createElement('div', { className: 'e-toolbar-panel e-ribbon' });\n        var toolbar = this.parent.createElement('div');\n        var ddb = this.parent.createElement('button');\n        toolbarPanel.appendChild(toolbar);\n        toolbarPanel.appendChild(ddb);\n        toolbarPanel.style.display = 'block';\n        this.parent.element.appendChild(toolbarPanel);\n        var ddbObj = new DropDownButton({\n            cssClass: 'e-caret-hide',\n            content: this.ribbon.items[0].header.text,\n            items: [\n                { text: this.ribbon.items[0].header.text },\n                { text: this.ribbon.items[1].header.text },\n                { text: this.ribbon.items[2].header.text },\n                { text: this.ribbon.items[3].header.text }\n            ],\n            select: function (args) {\n                if (args.item.text !== ddbObj.content) {\n                    toolbarObj.element.style.display = 'none';\n                    ddbObj.content = args.item.text;\n                    ddbObj.dataBind();\n                    toolbarObj.items = _this.ribbon.items[ddbObj.items.indexOf(args.item) + 1].content;\n                    toolbarObj.width = \"calc(100% - \" + ddb.getBoundingClientRect().width + \"px)\";\n                    toolbarObj.element.style.display = '';\n                    toolbarObj.dataBind();\n                    toolbarObj.items[0].text = args.item.text;\n                    toolbarObj.dataBind();\n                }\n            },\n            open: function (args) {\n                var element = args.element.parentElement;\n                var clientRect = element.getBoundingClientRect();\n                var offset = calculatePosition(ddbObj.element, 'right', 'bottom');\n                element.style.left = offset.left - clientRect.width + \"px\";\n                element.style.top = offset.top - clientRect.height + \"px\";\n                for (var i = 0; i < ddbObj.items.length; i++) {\n                    if (ddbObj.content === ddbObj.items[i].text) {\n                        args.element.children[i].classList.add('e-selected');\n                        break;\n                    }\n                }\n            },\n            close: function () { return focus(_this.parent.element); }\n        });\n        ddbObj.createElement = this.parent.createElement;\n        ddbObj.appendTo(ddb);\n        var toolbarObj = new Toolbar({\n            width: \"calc(100% - \" + ddb.getBoundingClientRect().width + \"px)\",\n            items: this.ribbon.items[0].content,\n            clicked: this.toolbarClicked.bind(this)\n        });\n        toolbarObj.createElement = this.parent.createElement;\n        toolbarObj.appendTo(toolbar);\n        toolbarPanel.style.display = '';\n    };\n    Ribbon.prototype.fileMenuBeforeOpen = function (args) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var wrapper;\n        var contents = ['.xlsx', '.xls', '.csv'];\n        if (args.parentItem.text === l10n.getConstant('SaveAs')) {\n            [].slice.call(args.element.children).forEach(function (li, index) {\n                wrapper = _this.parent.createElement('div', { innerHTML: li.innerHTML });\n                li.innerHTML = '';\n                wrapper.appendChild(_this.parent.createElement('span', { className: 'e-extension', innerHTML: contents[index] }));\n                li.appendChild(wrapper);\n            });\n        }\n        this.parent.trigger('fileMenuBeforeOpen', args);\n    };\n    Ribbon.prototype.enableRibbonTabs = function (args) {\n        this.ribbon.enableTabs(args.tabs, args.enable);\n    };\n    Ribbon.prototype.fileMenuBeforeClose = function (args) {\n        this.parent.trigger('fileMenuBeforeClose', args);\n    };\n    Ribbon.prototype.hideFileMenuItems = function (args) {\n        this.ribbon.hideMenuItems(args.items, args.hide, args.isUniqueId);\n    };\n    Ribbon.prototype.addFileMenuItems = function (args) {\n        this.ribbon.addMenuItems(args.items, args.text, args.insertAfter, args.isUniqueId);\n    };\n    Ribbon.prototype.hideToolbarItems = function (args) {\n        this.ribbon.hideToolbarItems(args.tab, args.indexes, args.hide);\n    };\n    Ribbon.prototype.protectSheetHandler = function (args) {\n        var sheet = this.parent.getActiveSheet();\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if ((sheet.isProtected && sheet.protectSettings.formatCells) || !sheet.isProtected) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.enableHomeBtnId, enable: true }]);\n            this.parent.notify(setUndoRedo, null);\n        }\n        else {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.disableHomeBtnId, enable: false }]);\n        }\n        if ((sheet.isProtected && sheet.protectSettings.insertLink) || !sheet.isProtected) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.enableInsertBtnId, enable: true }]);\n        }\n        else {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.enableInsertBtnId, enable: false }]);\n        }\n        if ((sheet.isProtected && sheet.protectSettings.selectCells) || !sheet.isProtected) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.findBtnId, enable: true }]);\n        }\n        else {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Home'), items: args.findBtnId, enable: false }]);\n        }\n        if (sheet.isProtected) {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Data'), items: args.dataValidationBtnId, enable: false }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Formulas'), items: args.enableFrmlaBtnId, enable: false }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.imageBtnId, enable: false }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.chartBtnId, enable: false }]);\n        }\n        else {\n            this.enableToolbarItems([{ tab: l10n.getConstant('Data'), items: args.dataValidationBtnId, enable: true }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Formulas'), items: args.enableFrmlaBtnId, enable: true }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.imageBtnId, enable: true }]);\n            this.enableToolbarItems([{ tab: l10n.getConstant('Insert'), items: args.chartBtnId, enable: true }]);\n        }\n    };\n    Ribbon.prototype.updateMergeItem = function (e) {\n        if (e.type === 'mousemove' || e.type === 'pointermove' || (e.shiftKey && e.type === 'mousedown')) {\n            var indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n            if ((indexes[1] !== indexes[3] || indexes[0] !== indexes[2]) && !this.parent.getActiveSheet().isProtected) {\n                this.enableToolbarItems([{ tab: this.parent.serviceLocator.getService(locale).getConstant('Home'),\n                        items: [this.parent.element.id + \"_merge_cells\"], enable: true }]);\n                this.toggleActiveState(false);\n            }\n        }\n    };\n    Ribbon.prototype.addEventListener = function () {\n        this.parent.on(ribbon, this.initRibbon, this);\n        this.parent.on(enableToolbarItems, this.enableToolbarItems, this);\n        this.parent.on(activeCellChanged, this.refreshRibbonContent, this);\n        this.parent.on(updateToggleItem, this.toggleRibbonItems, this);\n        this.parent.on(enableFileMenuItems, this.enableFileMenuItems, this);\n        this.parent.on(hideRibbonTabs, this.hideRibbonTabs, this);\n        this.parent.on(addRibbonTabs, this.addRibbonTabs, this);\n        this.parent.on(addToolbarItems, this.addToolbarItems, this);\n        this.parent.on(hideFileMenuItems, this.hideFileMenuItems, this);\n        this.parent.on(addFileMenuItems, this.addFileMenuItems, this);\n        this.parent.on(hideToolbarItems, this.hideToolbarItems, this);\n        this.parent.on(enableRibbonTabs, this.enableRibbonTabs, this);\n        this.parent.on(protectCellFormat, this.protectSheetHandler, this);\n        this.parent.on(selectionComplete, this.updateMergeItem, this);\n        this.parent.on(refreshRibbonIcons, this.refreshRibbonContent, this);\n    };\n    Ribbon.prototype.destroy = function () {\n        var parentElem = this.parent.element;\n        var ribbonEle = this.ribbon.element;\n        var id = parentElem.id;\n        ['bold', 'italic', 'line-through', 'underline'].forEach(function (name) {\n            destroyComponent(select('#' + (id + \"_\" + name), parentElem), Button);\n        });\n        this.pasteSplitBtn.destroy();\n        this.pasteSplitBtn = null;\n        this.mergeSplitBtn.destroy();\n        this.mergeSplitBtn = null;\n        this.numFormatDDB.destroy();\n        this.numFormatDDB = null;\n        this.fontSizeDdb.destroy();\n        this.fontSizeDdb = null;\n        this.fontNameDdb.destroy();\n        this.fontNameDdb = null;\n        this.textAlignDdb.destroy();\n        this.textAlignDdb = null;\n        this.verticalAlignDdb.destroy();\n        this.verticalAlignDdb = null;\n        this.sortingDdb.destroy();\n        this.sortingDdb = null;\n        this.clearDdb.destroy();\n        this.clearDdb = null;\n        this.colorPicker.destroy();\n        this.colorPicker = null;\n        this.bordersMenu.destroy();\n        this.bordersMenu = null;\n        this.bordersDdb.destroy();\n        this.bordersDdb = null;\n        this.findDdb.destroy();\n        this.findDdb = null;\n        this.chartDdb.destroy();\n        this.chartDdb = null;\n        this.chartMenu.destroy();\n        this.chartMenu = null;\n        this.parent.notify('destroyRibbonComponents', null);\n        this.ribbon.destroy();\n        if (ribbonEle) {\n            detach(ribbonEle);\n        }\n        this.ribbon = null;\n        this.removeEventListener();\n    };\n    Ribbon.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(ribbon, this.initRibbon);\n            this.parent.off(enableToolbarItems, this.enableToolbarItems);\n            this.parent.off(activeCellChanged, this.refreshRibbonContent);\n            this.parent.off(updateToggleItem, this.toggleRibbonItems);\n            this.parent.off(enableFileMenuItems, this.enableFileMenuItems);\n            this.parent.off(hideRibbonTabs, this.hideRibbonTabs);\n            this.parent.off(addRibbonTabs, this.addRibbonTabs);\n            this.parent.off(addToolbarItems, this.addToolbarItems);\n            this.parent.off(hideFileMenuItems, this.hideFileMenuItems);\n            this.parent.off(addFileMenuItems, this.addFileMenuItems);\n            this.parent.off(hideToolbarItems, this.hideToolbarItems);\n            this.parent.off(enableRibbonTabs, this.enableRibbonTabs);\n            this.parent.off(protectCellFormat, this.protectSheetHandler);\n            this.parent.off(selectionComplete, this.updateMergeItem);\n            this.parent.off(refreshRibbonIcons, this.refreshRibbonContent);\n        }\n    };\n    return Ribbon;\n}());\nexport { Ribbon };\n","import { formulaBar, locale, selectionComplete, enableFormulaInput, focus } from '../common/index';\nimport { mouseUpAfterSelection, click } from '../common/index';\nimport { getRangeIndexes, getRangeFromAddress, getCellAddress, getCellIndexes } from './../../workbook/common/address';\nimport { getSheetName, getTypeFromFormat, getSheet, checkIsFormula } from '../../workbook/index';\nimport { updateSelectedRange, getSheetNameFromAddress, getSheetIndex } from '../../workbook/index';\nimport { ComboBox, DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { rippleEffect, EventHandler, detach, Internationalization, isNullOrUndefined, closest, select } from '@syncfusion/ej2-base';\nimport { isUndefined } from '@syncfusion/ej2-base';\nimport { editOperation, formulaBarOperation, keyDown, keyUp, formulaOperation, editAlert, editValue } from '../common/event';\nimport { intToDate } from '../../workbook/common/math';\nimport { ListView } from '@syncfusion/ej2-lists';\nimport { workbookFormulaOperation } from '../../workbook/common/event';\nimport { isFormulaBarEdit } from '../common/event';\n/**\n * Represents Formula bar for Spreadsheet.\n */\nvar FormulaBar = /** @class */ (function () {\n    function FormulaBar(parent) {\n        this.categoryCollection = [];\n        this.formulaCollection = [];\n        this.isGoto = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    FormulaBar.prototype.getModuleName = function () {\n        return 'formulaBar';\n    };\n    FormulaBar.prototype.createFormulaBar = function (args) {\n        if (!this.parent.showFormulaBar && this.insertFnRipple) {\n            this.destroy();\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var id = this.parent.element.id;\n        var fBarWrapper = this.parent.createElement('div', { className: 'e-formula-bar-panel' });\n        if (!this.parent.isMobileView()) {\n            var nameBox = this.parent.createElement('input', { id: id + '_name_box', attrs: { type: 'text' } });\n            fBarWrapper.appendChild(nameBox);\n            this.comboBoxInstance = new ComboBox({\n                value: 'A1',\n                cssClass: 'e-name-box',\n                width: '',\n                noRecordsTemplate: '',\n                fields: { text: 'name', value: 'refersTo' },\n                beforeOpen: this.nameBoxBeforeOpen.bind(this),\n                blur: this.nameBoxBlur.bind(this),\n                select: this.nameBoxSelect.bind(this),\n                change: function (args) {\n                    /** */\n                }\n            });\n            this.comboBoxInstance.createElement = this.parent.createElement;\n            this.comboBoxInstance.appendTo(nameBox);\n            this.comboBoxInstance.element.parentElement.title = l10n.getConstant('NameBox');\n        }\n        var insertFnBtn = fBarWrapper.appendChild(this.parent.createElement('button', {\n            className: 'e-btn e-css e-flat e-icon-btn e-insert-function', attrs: { 'title': l10n.getConstant('InsertFunction') }\n        }));\n        insertFnBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons' }));\n        this.insertFnRipple = rippleEffect(fBarWrapper, { selector: '.e-insert-function' });\n        fBarWrapper.appendChild(this.parent.createElement('div', { className: 'e-separator' }));\n        var textarea = fBarWrapper.appendChild(this.parent.createElement('textarea', {\n            className: 'e-formula-bar e-css', id: id + '_formula_input',\n            attrs: { 'title': l10n.getConstant('FormulaBar'), 'spellcheck': 'false' }\n        }));\n        textarea.rows = 1;\n        if (this.parent.isMobileView()) {\n            textarea.placeholder = l10n.getConstant('MobileFormulaBarPlaceHolder');\n            EventHandler.add(textarea, 'focus', this.textAreaFocusIn, this);\n            EventHandler.add(textarea, 'blur', this.textAreaFocusOut, this);\n        }\n        else {\n            fBarWrapper.appendChild(this.parent.createElement('span', {\n                className: 'e-drop-icon e-icons', attrs: { 'title': l10n.getConstant('ExpandFormulaBar') }\n            }));\n        }\n        if (args && args.uiUpdate) {\n            this.parent.element.insertBefore(fBarWrapper, document.getElementById(id + '_sheet_panel'));\n        }\n        else {\n            this.parent.element.appendChild(fBarWrapper);\n        }\n    };\n    FormulaBar.prototype.textAreaFocusIn = function (e) {\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        var tickBtn = this.parent.createElement('button', { className: 'e-btn e-css e-flat e-icon-btn e-formula-submit' });\n        tickBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons e-tick-icon' }));\n        formulaPanel.classList.add('e-focused');\n        formulaPanel.appendChild(tickBtn);\n    };\n    FormulaBar.prototype.textAreaFocusOut = function (e) {\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        formulaPanel.classList.remove('e-focused');\n        detach(formulaPanel.querySelector('.e-formula-submit'));\n    };\n    FormulaBar.prototype.keyDownHandler = function (e) {\n        var trgtElem = e.target;\n        if (this.parent.isEdit && !this.parent.getActiveSheet().isProtected) {\n            if ((checkIsFormula(trgtElem.value) || (trgtElem.validity && trgtElem.value.toString().indexOf('=') === 0)) &&\n                e.keyCode === 16) {\n                return;\n            }\n            if (trgtElem.classList.contains('e-formula-bar')) {\n                this.parent.notify(editOperation, { action: 'refreshEditor', value: trgtElem.value, refreshEditorElem: true });\n            }\n        }\n    };\n    FormulaBar.prototype.keyUpHandler = function (e) {\n        if (this.parent.isEdit) {\n            var trgtElem = e.target;\n            if (trgtElem.classList.contains('e-formula-bar')) {\n                var eventArg = { action: 'getCurrentEditValue', editedValue: '' };\n                this.parent.notify(editOperation, eventArg);\n                if (eventArg.editedValue !== trgtElem.value && e.keyCode !== 16) {\n                    this.parent.notify(editOperation, { action: 'refreshEditor', value: trgtElem.value, refreshEditorElem: true });\n                }\n            }\n        }\n    };\n    FormulaBar.prototype.nameBoxBeforeOpen = function (args) {\n        if (this.comboBoxInstance.element.classList.contains('e-name-editing')) {\n            args.cancel = true;\n        }\n        else {\n            this.comboBoxInstance.element.select();\n        }\n    };\n    FormulaBar.prototype.nameBoxBlur = function (args) {\n        if (this.comboBoxInstance.element.classList.contains('e-name-editing')) {\n            this.comboBoxInstance.element.classList.remove('e-name-editing');\n            this.UpdateValueAfterMouseUp();\n        }\n    };\n    FormulaBar.prototype.nameBoxSelect = function (args) {\n        if (args.isInteracted) {\n            var refersTo = args.itemData.refersTo.substr(1);\n            var sheetIdx = getSheetIndex(this.parent, getSheetNameFromAddress(refersTo));\n            var range = getRangeFromAddress(refersTo);\n            var sheet = getSheet(this.parent, sheetIdx);\n            if (range.indexOf(':') !== -1) {\n                var colIndex = range.indexOf(':');\n                var left = range.substr(0, colIndex);\n                var right = range.substr(colIndex + 1, range.length);\n                left = left.replace('$', '');\n                right = right.replace('$', '');\n                if (right.match(/\\D/g) && !right.match(/[0-9]/g) && left.match(/\\D/g) && !left.match(/[0-9]/g)) {\n                    left = left + '1';\n                    right = right + sheet.rowCount;\n                    range = left + ':' + right;\n                }\n                else if (!right.match(/\\D/g) && right.match(/[0-9]/g) && !left.match(/\\D/g) && left.match(/[0-9]/g)) {\n                    left = getCellAddress(parseInt(left, 10) - 1, 0);\n                    right = getCellAddress(parseInt(right, 10) - 1, sheet.colCount - 1);\n                    range = left + ':' + right;\n                }\n            }\n            if ((sheetIdx) === this.parent.activeSheetIndex) {\n                this.parent.selectRange(range);\n                focus(this.parent.element);\n            }\n            else {\n                updateSelectedRange(this.parent, range, sheet);\n                this.parent.activeSheetIndex = sheetIdx;\n            }\n        }\n    };\n    FormulaBar.prototype.formulaBarUpdateHandler = function (e) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var range = sheet.selectedRange.split(':');\n        var address;\n        var intl = new Internationalization();\n        if (e.type === 'mousemove' || e.type === 'pointermove') {\n            var indexes1 = getRangeIndexes(range[0]);\n            var indexes2 = getRangeIndexes(range[1]);\n            address = Math.abs(indexes1[0] - indexes2[0]) + 1 + \"R x \" + (Math.abs(indexes1[1] - indexes2[1]) + 1) + \"C\";\n            if (this.parent.isEdit) {\n                this.parent.notify(editValue, null);\n            }\n        }\n        else {\n            address = range[0];\n            var data = this.parent.getData(getSheetName(this.parent) + \"!\" + address);\n            data.then(function (values) {\n                var value = '';\n                var intDate;\n                values.forEach(function (cell, key) {\n                    var type = cell && cell.format ? getTypeFromFormat(cell.format) : 'General';\n                    if (cell) {\n                        if (!isNullOrUndefined(cell.value)) {\n                            intDate = intToDate(Number(cell.value));\n                            if (intDate.toString() !== 'Invalid Date' && (type === 'ShortDate' || type === 'LongDate')) {\n                                value = intl.formatDate(intDate, {\n                                    type: 'date',\n                                    skeleton: 'yMd'\n                                });\n                            }\n                            else if (intDate.toString() !== 'Invalid Date' && type === 'Time') {\n                                value = intl.formatDate(intDate, {\n                                    type: 'dateTime',\n                                    skeleton: 'yMd'\n                                }) + ' ' + intl.formatDate(intDate, {\n                                    type: 'dateTime',\n                                    skeleton: 'hms'\n                                });\n                            }\n                            else {\n                                value = cell.value;\n                            }\n                        }\n                        if (cell.formula) {\n                            value = cell.formula;\n                        }\n                    }\n                    var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n                    _this.parent.notify(editOperation, eventArgs);\n                    var isFormulaEdit = (eventArgs.editedValue && eventArgs.editedValue.toString().indexOf('=') === 0) ||\n                        checkIsFormula(eventArgs.editedValue);\n                    var formulaInp = document.getElementById(_this.parent.element.id + '_formula_input');\n                    var addressRange = getRangeIndexes(address);\n                    var cellEle = _this.parent.getCell(addressRange[0], addressRange[1]);\n                    if (cell && !cell.formula && cellEle) {\n                        formulaInp.value = cellEle.textContent;\n                    }\n                    else {\n                        formulaInp.value = value;\n                    }\n                    if (!isNullOrUndefined(value) && !isFormulaEdit) {\n                        _this.parent.notify(editOperation, { action: 'refreshEditor', value: formulaInp.value, refreshEditorElem: true });\n                    }\n                    if (_this.parent.isEdit) {\n                        _this.parent.notify(editValue, null);\n                    }\n                });\n            });\n        }\n        this.updateComboBoxValue(address);\n    };\n    FormulaBar.prototype.UpdateValueAfterMouseUp = function () {\n        this.updateComboBoxValue(this.parent.getActiveSheet().selectedRange.split(':')[0]);\n    };\n    FormulaBar.prototype.updateComboBoxValue = function (value) {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSheetName(this.parent) + '!' + sheet.selectedRange;\n        var eventArgs = {\n            action: 'getNameFromRange', range: range, definedName: null\n        };\n        this.parent.notify(formulaOperation, eventArgs);\n        if (eventArgs.definedName) {\n            value = eventArgs.definedName.name;\n        }\n        if (!this.parent.isMobileView()) {\n            if (this.comboBoxInstance.text === value) {\n                return;\n            }\n            this.comboBoxInstance.text = value;\n            this.comboBoxInstance.dataBind();\n        }\n    };\n    FormulaBar.prototype.disabletextarea = function () {\n        var element = this.getFormulaBar();\n        if (this.parent.getActiveSheet().isProtected) {\n            element.disabled = true;\n        }\n        else {\n            element.disabled = false;\n        }\n    };\n    FormulaBar.prototype.formulaBarScrollEdit = function () {\n        var index = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n        var viewportIndexes = getCellIndexes(this.parent.getActiveSheet().topLeftCell);\n        if (index[0] < viewportIndexes[0]) {\n            this.parent.goTo(this.parent.getActiveSheet().selectedRange);\n            this.isGoto = true;\n        }\n        this.parent.notify(editOperation, { action: 'startEdit', refreshCurPos: false });\n    };\n    FormulaBar.prototype.formulaBarClickHandler = function (e) {\n        var _this = this;\n        var target = e.target;\n        if (target.classList.contains('e-drop-icon') && closest(target, '.e-formula-bar-panel')) {\n            this.toggleFormulaBar(target);\n        }\n        else if (target.classList.contains('e-formula-bar')) {\n            if (!this.parent.isEdit && !this.parent.getActiveSheet().isProtected) {\n                this.formulaBarScrollEdit();\n            }\n            else if (this.parent.getActiveSheet().isProtected) {\n                this.parent.notify(editAlert, null);\n            }\n        }\n        else if (target.parentElement && target.parentElement.classList.contains('e-name-box')) {\n            if (target.classList.contains('e-ddl-icon')) {\n                var eventArgs = { action: 'getNames', names: [] };\n                this.parent.notify(formulaOperation, eventArgs);\n                this.comboBoxInstance.dataSource = eventArgs.names;\n            }\n            else {\n                this.comboBoxInstance.element.classList.add('e-name-editing');\n                this.comboBoxInstance.element.select();\n            }\n        }\n        if (!isNullOrUndefined(target.offsetParent) && ((target.offsetParent.classList.contains('e-insert-function')) ||\n            (target.classList.contains('e-insert-function')) || (this.parent.element.id + '_insert_function' === target.offsetParent.id)\n            || (this.parent.element.id + '_insert_function' === target.id) ||\n            target.parentElement.classList.contains('e-insert-function')\n            || (this.parent.element.id + '_insert_function' === target.parentElement.id))) {\n            if (this.parent.getActiveSheet().isProtected) {\n                this.parent.notify(editAlert, null);\n                return;\n            }\n            var isOpen = !this.parent.isEdit;\n            var args = { action: 'getCurrentEditValue', editedValue: '' };\n            if (!isOpen) {\n                var eventArgs = { action: 'isFormulaEditing', isFormulaEdit: false };\n                this.parent.notify(formulaOperation, eventArgs);\n                isOpen = eventArgs.isFormulaEdit;\n                this.parent.notify(editOperation, args);\n            }\n            if (isOpen || args.editedValue === '') {\n                if (args.editedValue === '') {\n                    this.parent.notify(editOperation, { action: 'refreshEditor', value: '=' });\n                }\n                var l10n = this.parent.serviceLocator.getService(locale);\n                var formulaDescription = this.parent.createElement('div', { className: 'e-formula-description', id: this.parent.element.id + '_description_content' });\n                var categoryContent = this.parent.createElement('div', {\n                    className: 'e-category-content', id: this.parent.element.id + '_category_content',\n                    innerHTML: l10n.getConstant('PickACategory')\n                });\n                var dropDownElement = this.parent.createElement('input', { className: 'e-formula-category', id: this.parent.element.id + '_formula_category' });\n                var listViewElement = this.parent.createElement('div', { className: 'e-formula-list', id: this.parent.element.id + '_formula_list' });\n                var descriptionContent = this.parent.createElement('div', { className: 'e-description-content', innerHTML: l10n.getConstant('Description') });\n                var headerContent = this.parent.createElement('div', { className: 'e-header-content', innerHTML: l10n.getConstant('InsertFunction') });\n                var categoryArgs = {\n                    action: 'getFormulaCategory', categoryCollection: []\n                };\n                this.parent.notify(workbookFormulaOperation, categoryArgs);\n                this.categoryCollection = categoryArgs.categoryCollection;\n                this.categoryList = new DropDownList({\n                    dataSource: this.categoryCollection, index: 0, width: '285px', popupHeight: '210px',\n                    select: this.dropDownSelect.bind(this)\n                });\n                var listArgs = {\n                    action: 'getLibraryFormulas', formulaCollection: []\n                };\n                this.parent.notify(workbookFormulaOperation, listArgs);\n                this.formulaCollection = listArgs.formulaCollection;\n                this.formulaList = new ListView({\n                    dataSource: this.formulaCollection.sort(),\n                    actionComplete: this.updateFormulaList.bind(this),\n                    select: this.listSelected.bind(this), width: '285px', height: '200px'\n                });\n                this.dialog = this.parent.serviceLocator.getService('dialog');\n                this.dialog.show({\n                    header: headerContent.outerHTML,\n                    content: categoryContent.outerHTML + dropDownElement.outerHTML + listViewElement.outerHTML +\n                        descriptionContent.outerHTML + formulaDescription.outerHTML,\n                    width: '320px', height: '485px', cssClass: 'e-spreadsheet-function-dlg',\n                    showCloseIcon: true, isModal: true,\n                    beforeOpen: function (args) {\n                        var dlgArgs = {\n                            dialogName: 'InsertFunctionDialog', element: args.element, target: args.target, cancel: args.cancel\n                        };\n                        _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                        if (dlgArgs.cancel) {\n                            args.cancel = true;\n                        }\n                        focus(_this.parent.element);\n                    },\n                    open: this.dialogOpen.bind(this), beforeClose: this.dialogBeforeClose.bind(this), close: this.dialogClose.bind(this),\n                    buttons: [\n                        {\n                            click: (this.selectFormula.bind(this, this.dialog, this)),\n                            buttonModel: { content: l10n.getConstant('Ok'), isPrimary: true }\n                        }\n                    ]\n                });\n                this.categoryList.appendTo('#' + this.parent.element.id + '_formula_category');\n                this.formulaList.appendTo('#' + this.parent.element.id + '_formula_list');\n                EventHandler.add(this.formulaList.element, 'dblclick', this.formulaClickHandler, this);\n            }\n        }\n    };\n    FormulaBar.prototype.toggleFormulaBar = function (target) {\n        var parent = target.parentElement;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (parent.classList.contains('e-expanded')) {\n            parent.classList.remove('e-expanded');\n            document.getElementById(this.parent.element.id + '_formula_input').rows = 1;\n            target.title = l10n.getConstant('ExpandFormulaBar');\n        }\n        else {\n            parent.classList.add('e-expanded');\n            document.getElementById(this.parent.element.id + '_formula_input').rows = 3;\n            target.title = l10n.getConstant('CollapseFormulaBar');\n        }\n        this.parent.setPanelSize();\n    };\n    FormulaBar.prototype.dialogOpen = function () {\n        this.focusOkButton();\n    };\n    FormulaBar.prototype.dialogClose = function () {\n        var args = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, args);\n        if (args.editedValue.toString().trim() === '=') {\n            this.parent.notify(editOperation, { action: 'refreshEditor', value: '' });\n        }\n    };\n    FormulaBar.prototype.dialogBeforeClose = function () {\n        EventHandler.remove(this.formulaList.element, 'dblclick', this.formulaClickHandler);\n        var dialogContentEle = document.getElementById('_dialog-content');\n        dialogContentEle.parentNode.removeChild(dialogContentEle);\n        /* tslint:disable-next-line:no-any */\n        this.dialog.dialogInstance.storeActiveElement = document.getElementById(this.parent.element.id + '_edit');\n    };\n    FormulaBar.prototype.selectFormula = function (dialog, formulaBarObj) {\n        var formulaText = formulaBarObj.formulaList.getSelectedItems().text;\n        var sheet = getSheet(this.parent, this.parent.activeSheetIndex);\n        if (this.parent.isEdit) {\n            this.parent.notify(editOperation, {\n                action: 'refreshEditor', value: formulaText + '(', refreshFormulaBar: true,\n                refreshEditorElem: true, isAppend: true\n            });\n        }\n        else {\n            this.parent.notify(editOperation, { action: 'startEdit', value: '=' + formulaText + '(', address: sheet.activeCell });\n            this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: '=' + formulaText + '(' });\n        }\n        dialog.hide();\n    };\n    FormulaBar.prototype.listSelected = function () {\n        this.updateFormulaDescription();\n    };\n    FormulaBar.prototype.updateFormulaList = function () {\n        this.activeListFormula();\n        this.updateFormulaDescription();\n    };\n    FormulaBar.prototype.dropDownSelect = function (args) {\n        this.formulaCollection = [];\n        var listArgs = {\n            action: 'getLibraryFormulas',\n            formulaCollection: []\n        };\n        if (args.item.textContent === 'All') {\n            this.parent.notify(workbookFormulaOperation, listArgs);\n            this.formulaCollection = listArgs.formulaCollection;\n        }\n        else {\n            var category = args.item.textContent;\n            var selectArgs = {\n                action: 'dropDownSelectFormulas',\n                formulaCollection: [],\n                selectCategory: category,\n            };\n            this.parent.notify(workbookFormulaOperation, selectArgs);\n            this.formulaCollection = selectArgs.formulaCollection;\n        }\n        this.formulaList.dataSource = this.formulaCollection.sort();\n    };\n    FormulaBar.prototype.focusOkButton = function () {\n        var focusEle = document.getElementById('_dialog-content');\n        (focusEle.nextElementSibling.firstElementChild).focus();\n    };\n    FormulaBar.prototype.activeListFormula = function () {\n        var acListEle = document.getElementById(this.parent.element.id + '_formula_list');\n        var firstElement = acListEle.children[0].children[0].firstElementChild;\n        this.formulaList.selectItem(firstElement);\n    };\n    FormulaBar.prototype.updateFormulaDescription = function () {\n        var descriptionArea;\n        var selectedFormula = this.formulaList.getSelectedItems().text;\n        var descriptionArgs = {\n            action: 'getFormulaDescription',\n            description: '',\n            selectedList: selectedFormula,\n        };\n        this.parent.notify(workbookFormulaOperation, descriptionArgs);\n        this.focusOkButton();\n        descriptionArea = document.getElementById(this.parent.element.id + '_description_content');\n        selectedFormula = (selectedFormula === 'AND') ? 'CalculateAND' : (selectedFormula === 'OR') ? 'CalculateOR' : selectedFormula;\n        descriptionArea.innerHTML = this.parent.serviceLocator.getService(locale).getConstant(selectedFormula);\n    };\n    FormulaBar.prototype.formulaClickHandler = function (args) {\n        var trgtElem = args.target;\n        var sheet = getSheet(this.parent, this.parent.activeSheetIndex);\n        if (trgtElem.offsetParent.classList.contains('e-text-content') || trgtElem.classList.contains('e-list-item')) {\n            if (this.parent.isEdit) {\n                this.parent.notify(editOperation, {\n                    action: 'refreshEditor', value: trgtElem.innerText + '(', refreshFormulaBar: true,\n                    refreshEditorElem: true, isAppend: true\n                });\n            }\n            else {\n                this.parent.notify(editOperation, { action: 'startEdit', value: '=' + trgtElem.innerText + '(', address: sheet.activeCell });\n                this.parent.notify(formulaBarOperation, { action: 'refreshFormulabar', value: '=' + trgtElem.innerText + '(' });\n            }\n            this.dialog.hide();\n        }\n    };\n    FormulaBar.prototype.addEventListener = function () {\n        this.parent.on(formulaBar, this.createFormulaBar, this);\n        this.parent.on(click, this.formulaBarClickHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(selectionComplete, this.formulaBarUpdateHandler, this);\n        this.parent.on(mouseUpAfterSelection, this.UpdateValueAfterMouseUp, this);\n        this.parent.on(formulaBarOperation, this.editOperationHandler, this);\n        this.parent.on(enableFormulaInput, this.disabletextarea, this);\n        this.parent.on(isFormulaBarEdit, this.isFormulaBarEdit, this);\n    };\n    FormulaBar.prototype.destroy = function () {\n        this.removeEventListener();\n        this.comboBoxInstance.destroy();\n        this.comboBoxInstance = null;\n        this.insertFnRipple();\n        this.insertFnRipple = null;\n        var formulaPanel = this.parent.element.querySelector('.e-formula-bar-panel');\n        if (formulaPanel) {\n            detach(formulaPanel);\n        }\n    };\n    FormulaBar.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(formulaBar, this.createFormulaBar);\n            this.parent.off(click, this.formulaBarClickHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(selectionComplete, this.formulaBarUpdateHandler);\n            this.parent.off(mouseUpAfterSelection, this.UpdateValueAfterMouseUp);\n            this.parent.off(formulaBarOperation, this.editOperationHandler);\n            this.parent.off(enableFormulaInput, this.disabletextarea);\n            this.parent.off(isFormulaBarEdit, this.isFormulaBarEdit);\n        }\n    };\n    FormulaBar.prototype.editOperationHandler = function (args) {\n        var action = args.action;\n        switch (action) {\n            case 'refreshFormulabar':\n                this.getFormulaBar().value = isUndefined(args.value) ? '' : args.value;\n                break;\n            case 'getPosition':\n                args.position = this.getFormulaBar().getBoundingClientRect();\n                break;\n        }\n    };\n    FormulaBar.prototype.isFormulaBarEdit = function (args) {\n        var edit = this.parent.isEdit;\n        if (edit && this.isGoto) {\n            args.isEdit = true;\n        }\n        else {\n            args.isEdit = false;\n        }\n    };\n    FormulaBar.prototype.getFormulaBar = function () {\n        return select('#' + this.parent.element.id + '_formula_input', this.parent.element);\n    };\n    return FormulaBar;\n}());\nexport { FormulaBar };\n","import { formulaOperation, keyUp, keyDown, click, refreshFormulaDatasource } from '../common/event';\nimport { editOperation, formulaBarOperation } from '../common/event';\nimport { workbookFormulaOperation } from '../../workbook/common/event';\nimport { AutoComplete } from '@syncfusion/ej2-dropdowns';\nimport { detach, isNullOrUndefined, select } from '@syncfusion/ej2-base';\nimport { checkIsFormula, getSheet, getSheetName, getCellIndexes } from '../../workbook/index';\nimport { dialog, locale, focus } from '../common/index';\n/**\n * @hidden\n * The `Formula` module is used to handle the formulas and its functionalities in Spreadsheet.\n */\nvar Formula = /** @class */ (function () {\n    /**\n     * Constructor for formula module in Spreadsheet.\n     * @private\n     */\n    function Formula(parent) {\n        this.isFormulaBar = false;\n        this.isFormula = false;\n        this.isPopupOpened = false;\n        this.isPreventClose = false;\n        this.isSubFormula = false;\n        this.keyCodes = {\n            UP: 38,\n            DOWN: 40,\n            LEFT: 37,\n            RIGHT: 39,\n            FIRSTALPHABET: 65,\n            LASTALPHABET: 90,\n            SPACE: 32,\n            BACKSPACE: 8,\n            TAB: 9,\n            DELETE: 46,\n            ENTER: 13,\n            ESC: 27\n        };\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookFormula);\n    }\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    Formula.prototype.getModuleName = function () {\n        return 'formula';\n    };\n    /**\n     * To destroy the formula module.\n     * @return {void}\n     * @hidden\n     */\n    Formula.prototype.destroy = function () {\n        this.removeEventListener();\n        if (this.autocompleteInstance) {\n            this.autocompleteInstance.destroy();\n            if (this.autocompleteInstance.element) {\n                this.autocompleteInstance.element.remove();\n            }\n        }\n        this.autocompleteInstance = null;\n        this.parent = null;\n    };\n    Formula.prototype.addEventListener = function () {\n        this.parent.on(formulaOperation, this.performFormulaOperation, this);\n        this.parent.on(keyUp, this.keyUpHandler, this);\n        this.parent.on(keyDown, this.keyDownHandler, this);\n        this.parent.on(click, this.formulaClick, this);\n        this.parent.on(refreshFormulaDatasource, this.refreshFormulaDatasource, this);\n    };\n    Formula.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(formulaOperation, this.performFormulaOperation);\n            this.parent.off(keyUp, this.keyUpHandler);\n            this.parent.off(keyDown, this.keyDownHandler);\n            this.parent.off(click, this.formulaClick);\n            this.parent.off(refreshFormulaDatasource, this.refreshFormulaDatasource);\n        }\n    };\n    Formula.prototype.performFormulaOperation = function (args) {\n        var _this = this;\n        var action = args.action;\n        switch (action) {\n            case 'renderAutoComplete':\n                this.renderAutoComplete();\n                break;\n            case 'endEdit':\n                this.endEdit();\n                break;\n            case 'addDefinedName':\n                args.isAdded = this.addDefinedName(args.definedName);\n                break;\n            case 'getNames':\n                if (!args.sheetName) {\n                    args.sheetName = getSheetName(this.parent);\n                }\n                args.names = this.getNames(args.sheetName);\n                break;\n            case 'getNameFromRange':\n                args.definedName = this.getNameFromRange(args.range);\n                break;\n            case 'isFormulaEditing':\n                args.isFormulaEdit = this.isFormula;\n                break;\n            case 'isCircularReference':\n                var l10n = this.parent.serviceLocator.getService(locale);\n                var dialogInst = this.parent.serviceLocator.getService(dialog);\n                dialogInst.show({\n                    height: 180, width: 400, isModal: true, showCloseIcon: true,\n                    content: l10n.getConstant('CircularReference'),\n                    beforeOpen: function (args) {\n                        var dlgArgs = {\n                            dialogName: 'CircularReferenceDialog',\n                            element: args.element, target: args.target, cancel: args.cancel\n                        };\n                        _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                        if (dlgArgs.cancel) {\n                            args.cancel = true;\n                        }\n                    },\n                });\n                args.argValue = '0';\n                break;\n        }\n    };\n    Formula.prototype.renderAutoComplete = function () {\n        if (!select('#' + this.parent.element.id + '_ac', this.parent.element)) {\n            var acElem = this.parent.createElement('input', { id: this.parent.element.id + '_ac', className: 'e-ss-ac' });\n            this.parent.element.appendChild(acElem);\n            var eventArgs = {\n                action: 'getLibraryFormulas',\n                formulaCollection: []\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            var autoCompleteOptions = {\n                dataSource: eventArgs.formulaCollection,\n                cssClass: 'e-ss-atc',\n                popupWidth: '130px',\n                allowFiltering: true,\n                filterType: 'StartsWith',\n                sortOrder: 'Ascending',\n                open: this.onSuggestionOpen.bind(this),\n                close: this.onSuggestionClose.bind(this),\n                select: this.onSelect.bind(this),\n                actionComplete: this.onSuggestionComplete.bind(this)\n            };\n            this.autocompleteInstance = new AutoComplete(autoCompleteOptions, acElem);\n            this.autocompleteInstance.createElement = this.parent.createElement;\n        }\n    };\n    Formula.prototype.onSuggestionOpen = function (e) {\n        var _this = this;\n        this.isPopupOpened = true;\n        var position = this.getPopupPosition();\n        e.popup.offsetX = position.left;\n        e.popup.offsetY = (position.top + position.height);\n        e.popup.refreshPosition();\n        e.popup.element.firstChild.style.maxHeight = '180px';\n        new Promise(function (resolve, reject) {\n            setTimeout(function () { resolve(); }, 100);\n        }).then(function () {\n            _this.triggerKeyDownEvent(_this.keyCodes.DOWN);\n        });\n    };\n    Formula.prototype.onSuggestionClose = function (e) {\n        if (this.isPreventClose) {\n            e.cancel = true;\n        }\n        else {\n            this.isPopupOpened = false;\n        }\n    };\n    Formula.prototype.onSelect = function (e) {\n        var updatedFormulaValue = '=' + e.itemData.value + '(';\n        if (this.isSubFormula) {\n            var editValue = this.getEditingValue();\n            var parseIndex = editValue.lastIndexOf(this.getArgumentSeparator());\n            if (parseIndex > -1) {\n                updatedFormulaValue = editValue.slice(0, parseIndex + 1);\n            }\n            else {\n                parseIndex = editValue.lastIndexOf('(');\n                if (parseIndex > -1) {\n                    updatedFormulaValue = editValue.slice(0, parseIndex + 1);\n                }\n            }\n            updatedFormulaValue += e.itemData.value + '(';\n        }\n        this.parent.notify(editOperation, {\n            action: 'refreshEditor', value: updatedFormulaValue,\n            refreshFormulaBar: true, refreshEditorElem: true, refreshCurPos: !this.isFormulaBar\n        });\n    };\n    Formula.prototype.onSuggestionComplete = function (args) {\n        this.isPreventClose = args.result.length > 0;\n        if (!this.isPreventClose) {\n            args.cancel = true;\n            this.hidePopUp();\n        }\n    };\n    Formula.prototype.refreshFormulaDatasource = function () {\n        var eventArgs = {\n            action: 'getLibraryFormulas',\n            formulaCollection: []\n        };\n        this.parent.notify(workbookFormulaOperation, eventArgs);\n        this.autocompleteInstance.dataSource = eventArgs.formulaCollection;\n    };\n    Formula.prototype.keyUpHandler = function (e) {\n        if (this.parent.isEdit) {\n            var editValue = this.getEditingValue();\n            this.isFormula = checkIsFormula(editValue);\n            if (this.isFormula || this.isPopupOpened) {\n                if (e.keyCode !== this.keyCodes.TAB && this.isFormula) {\n                    editValue = this.getSuggestionKeyFromFormula(editValue);\n                }\n                this.refreshFormulaSuggestion(e, editValue);\n            }\n        }\n        else if (this.isPopupOpened) {\n            this.hidePopUp();\n        }\n    };\n    Formula.prototype.keyDownHandler = function (e) {\n        var keyCode = e.keyCode;\n        if (this.isFormula) {\n            if (this.isPopupOpened) {\n                switch (keyCode) {\n                    case this.keyCodes.UP:\n                    case this.keyCodes.DOWN:\n                        e.preventDefault();\n                        this.triggerKeyDownEvent(keyCode);\n                        break;\n                    case this.keyCodes.TAB:\n                        e.preventDefault();\n                        this.triggerKeyDownEvent(this.keyCodes.ENTER);\n                        break;\n                }\n            }\n        }\n        else {\n            var trgtElem = e.target;\n            if (trgtElem.id === this.parent.element.id + '_name_box') {\n                switch (keyCode) {\n                    case this.keyCodes.ENTER:\n                        this.addDefinedName({ name: trgtElem.value });\n                        focus(this.parent.element);\n                        break;\n                    case this.keyCodes.ESC:\n                        focus(this.parent.element);\n                        break;\n                }\n            }\n        }\n    };\n    Formula.prototype.formulaClick = function (e) {\n        if (this.parent.isEdit) {\n            var trgtElem = e.target;\n            this.isFormulaBar = trgtElem.classList.contains('e-formula-bar');\n        }\n    };\n    Formula.prototype.refreshFormulaSuggestion = function (e, formula) {\n        if (formula.length > 0) {\n            var autoCompleteElem = this.autocompleteInstance.element;\n            var keyCode = e.keyCode;\n            var isSuggestionAlreadyOpened = this.isPopupOpened;\n            if (!this.isNavigationKey(keyCode)) {\n                autoCompleteElem.value = formula;\n                autoCompleteElem.dispatchEvent(new Event('input'));\n                autoCompleteElem.dispatchEvent(new Event('keyup'));\n                if (isSuggestionAlreadyOpened) {\n                    this.triggerKeyDownEvent(this.keyCodes.DOWN);\n                }\n            }\n        }\n        else {\n            if (this.isPopupOpened) {\n                this.isPreventClose = false;\n                this.hidePopUp();\n            }\n        }\n    };\n    Formula.prototype.endEdit = function () {\n        this.isSubFormula = false;\n        this.isPreventClose = false;\n        this.isFormula = false;\n        this.isFormulaBar = false;\n        if (this.isPopupOpened) {\n            this.hidePopUp();\n            var suggPopupElem = select('#' + this.parent.element.id + '_ac_popup');\n            if (suggPopupElem) {\n                detach(suggPopupElem);\n            }\n            this.isPopupOpened = false;\n        }\n    };\n    Formula.prototype.hidePopUp = function () {\n        this.autocompleteInstance.hidePopup();\n    };\n    Formula.prototype.getSuggestionKeyFromFormula = function (formula) {\n        var suggestValue = '';\n        formula = formula.substr(1); //remove = char.\n        if (formula) {\n            var bracketIndex = formula.lastIndexOf('(');\n            formula = formula.substr(bracketIndex + 1);\n            var fSplit = formula.split(this.getArgumentSeparator());\n            if (fSplit.length === 1) {\n                suggestValue = fSplit[0];\n                this.isSubFormula = bracketIndex > -1;\n            }\n            else {\n                suggestValue = fSplit[fSplit.length - 1];\n                this.isSubFormula = true;\n            }\n            var isAlphaNumeric = suggestValue.match(/\\w/);\n            if (!isAlphaNumeric || (isAlphaNumeric && isAlphaNumeric.index !== 0)) {\n                suggestValue = '';\n            }\n        }\n        return suggestValue;\n    };\n    Formula.prototype.getPopupPosition = function () {\n        var eventArgs = { position: null };\n        if (this.isFormulaBar) {\n            eventArgs.action = 'getPosition';\n            this.parent.notify(formulaBarOperation, eventArgs);\n        }\n        else {\n            eventArgs.action = 'getPosition';\n            this.parent.notify(editOperation, eventArgs);\n        }\n        return eventArgs.position;\n    };\n    Formula.prototype.getEditingValue = function () {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        return eventArgs.editedValue;\n    };\n    Formula.prototype.isNavigationKey = function (keyCode) {\n        return (keyCode === this.keyCodes.UP) || (keyCode === this.keyCodes.DOWN) || (keyCode === this.keyCodes.LEFT)\n            || (keyCode === this.keyCodes.RIGHT);\n    };\n    Formula.prototype.triggerKeyDownEvent = function (keyCode) {\n        var autoCompleteElem = this.autocompleteInstance.element;\n        autoCompleteElem.dispatchEvent(new Event('input'));\n        var eventArg = new Event('keydown');\n        // tslint:disable:no-string-literal\n        eventArg['keyCode'] = keyCode;\n        eventArg['which'] = keyCode;\n        eventArg['altKey'] = false;\n        eventArg['shiftKey'] = false;\n        eventArg['ctrlKey'] = false;\n        // tslint:enable:no-string-literal\n        autoCompleteElem.dispatchEvent(eventArg);\n    };\n    Formula.prototype.getArgumentSeparator = function () {\n        if (this.argumentSeparator) {\n            return this.argumentSeparator;\n        }\n        else {\n            var eventArgs = {\n                action: 'getArgumentSeparator', argumentSeparator: ''\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            this.argumentSeparator = eventArgs.argumentSeparator;\n            return eventArgs.argumentSeparator;\n        }\n    };\n    Formula.prototype.getNames = function (sheetName) {\n        var names = this.parent.definedNames.filter(function (name) { return name.scope === 'Workbook' || name.scope === '' || name.scope === sheetName; });\n        return names;\n    };\n    Formula.prototype.getNameFromRange = function (range) {\n        var singleRange = range.slice(0, range.indexOf(':'));\n        var sRange = range.slice(range.indexOf('!') + 1).split(':');\n        var isSingleCell = sRange.length > 1 && sRange[0] === sRange[1];\n        var name = this.parent.definedNames.filter(function (name, index) {\n            if (isSingleCell && name.refersTo === '=' + singleRange) {\n                return true;\n            }\n            return name.refersTo === '=' + range;\n        });\n        return name && name[0];\n    };\n    Formula.prototype.addDefinedName = function (definedName) {\n        var _this = this;\n        var name = definedName.name;\n        var isAdded = false;\n        if (!definedName.refersTo) {\n            var sheet = getSheet(this.parent, this.parent.activeSheetIndex);\n            var sheetName = getSheetName(this.parent);\n            sheetName = sheetName.indexOf(' ') !== -1 ? '\\'' + sheetName + '\\'' : sheetName;\n            var selectRange = sheet.selectedRange;\n            if (!isNullOrUndefined(selectRange)) {\n                var colIndex = selectRange.indexOf(':');\n                var left = selectRange.substr(0, colIndex);\n                var right = selectRange.substr(colIndex + 1, selectRange.length);\n                if (parseInt(right.replace(/\\D/g, ''), 10) === sheet.rowCount && parseInt(left.replace(/\\D/g, ''), 10) === 1) {\n                    right = right.replace(/[0-9]/g, '');\n                    left = left.replace(/[0-9]/g, '');\n                    selectRange = '$' + left + ':$' + right;\n                }\n                else if (getCellIndexes(right)[1] === sheet.colCount - 1 && getCellIndexes(left)[1] === 0) {\n                    right = right.replace(/\\D/g, '');\n                    left = left.replace(/\\D/g, '');\n                    selectRange = '$' + left + ':$' + right;\n                }\n                else {\n                    selectRange = left === right ? left : selectRange;\n                }\n            }\n            definedName.refersTo = sheetName + '!' + selectRange;\n            definedName.scope = 'Workbook';\n        }\n        if (name.length > 0 && (/^([a-zA-Z_0-9.]){0,255}$/.test(name))) {\n            var eventArgs = {\n                action: 'addDefinedName', definedName: definedName, isAdded: false\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            isAdded = eventArgs.isAdded;\n            if (!eventArgs.isAdded) {\n                this.parent.serviceLocator.getService(dialog).show({\n                    content: this.parent.serviceLocator.getService(locale).getConstant('DefineNameExists'),\n                    width: '300',\n                    beforeOpen: function (args) {\n                        var dlgArgs = {\n                            dialogName: 'DefineNameExistsDialog',\n                            element: args.element, target: args.target, cancel: args.cancel\n                        };\n                        _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                        if (dlgArgs.cancel) {\n                            args.cancel = true;\n                        }\n                    },\n                });\n            }\n        }\n        else {\n            this.parent.serviceLocator.getService(dialog).show({\n                content: this.parent.serviceLocator.getService(locale).getConstant('DefineNameInValid'),\n                width: '300',\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'DefineNameInValidDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                },\n            });\n        }\n        return isAdded;\n    };\n    return Formula;\n}());\nexport { Formula };\n","import { Tab } from '@syncfusion/ej2-navigations';\nimport { refreshSheetTabs, locale, insertSheetTab, cMenuBeforeOpen, dialog, renameSheet, hideSheet, beginAction } from '../common/index';\nimport { sheetNameUpdate, clearUndoRedoCollection, completeAction, showAggregate, focus } from '../common/index';\nimport { sheetTabs, renameSheetTab, removeSheetTab, activeSheetChanged, onVerticalScroll, onHorizontalScroll } from '../common/index';\nimport { protectSheet, editOperation } from '../common/index';\nimport { getSheetName, aggregateComputation } from '../../workbook/index';\nimport { isSingleCell, getRangeIndexes, getSheet, getSheetIndex } from '../../workbook/index';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\nimport { isCollide, calculatePosition } from '@syncfusion/ej2-popups';\nimport { rippleEffect, closest, EventHandler, remove, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { sheetsDestroyed, activeCellChanged, workbookFormulaOperation } from '../../workbook/common/index';\nimport { insertModel, checkIsFormula } from './../../workbook/common/index';\n/**\n * Represents SheetTabs for Spreadsheet.\n */\nvar SheetTabs = /** @class */ (function () {\n    function SheetTabs(parent) {\n        this.aggregateContent = '';\n        this.isSelectCancel = false;\n        this.selaggregateCnt = 'Sum';\n        this.parent = parent;\n        this.addEventListener();\n    }\n    SheetTabs.prototype.getModuleName = function () {\n        return 'sheetTabs';\n    };\n    SheetTabs.prototype.createSheetTabs = function () {\n        var _this = this;\n        if (!this.parent.showSheetTabs && this.tabInstance) {\n            this.destroy();\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var panel = this.parent.createElement('div', {\n            className: 'e-sheet-tab-panel', id: this.parent.element.id + '_sheet_tab_panel'\n        });\n        var addBtn = this.parent.createElement('button', {\n            className: 'e-add-sheet-tab e-btn e-css e-flat e-icon-btn' + (this.parent.allowInsert ? '' : ' e-disabled'),\n            attrs: { 'title': l10n.getConstant('AddSheet') }\n        });\n        addBtn.appendChild(this.parent.createElement('span', { className: 'e-btn-icon e-icons e-add-icon' }));\n        addBtn.addEventListener('click', this.addSheetTab.bind(this));\n        addBtn.disabled = !this.parent.allowInsert;\n        panel.appendChild(addBtn);\n        this.addBtnRipple = rippleEffect(panel, { selector: '.e-add-sheet-tab' });\n        var ddb = this.parent.createElement('button', { attrs: { 'title': l10n.getConstant('ListAllSheets') } });\n        panel.appendChild(ddb);\n        this.parent.element.appendChild(panel);\n        var items = this.getSheetTabItems();\n        this.dropDownInstance = new DropDownButton({\n            iconCss: 'e-icons',\n            items: items.ddbItems,\n            beforeItemRender: function (args) {\n                var sheet = _this.parent.sheets[_this.dropDownInstance.items.indexOf(args.item)];\n                if (sheet.state === 'Hidden') {\n                    args.element.classList.add('e-hide');\n                }\n                else if (sheet.state === 'VeryHidden') {\n                    args.element.style.display = 'none';\n                }\n            },\n            select: function (args) { return _this.updateSheetTab({ idx: _this.dropDownInstance.items.indexOf(args.item) }); },\n            beforeOpen: function (args) { return _this.beforeOpenHandler(_this.dropDownInstance, args.element); },\n            open: function (args) { return _this.openHandler(_this.dropDownInstance, args.element, 'left'); },\n            cssClass: 'e-sheets-list e-flat e-caret-hide',\n            close: function () { return focus(_this.parent.element); }\n        });\n        this.dropDownInstance.createElement = this.parent.createElement;\n        this.dropDownInstance.appendTo(ddb);\n        var sheetTab = this.parent.createElement('div', { className: 'e-sheet-tab' });\n        this.tabInstance = new Tab({\n            selectedItem: this.parent.activeSheetIndex,\n            overflowMode: 'Scrollable',\n            items: items.tabItems,\n            scrollStep: 250,\n            selecting: function (args) {\n                var beginEventArgs = {\n                    currentSheetIndex: args.selectingIndex, previousSheetIndex: args.selectedIndex, cancel: false\n                };\n                if (!_this.isSelectCancel) {\n                    _this.parent.notify(beginAction, { eventArgs: beginEventArgs, action: 'gotoSheet' });\n                }\n                _this.isSelectCancel = beginEventArgs.cancel;\n            },\n            selected: function (args) {\n                if (args.selectedIndex === args.previousIndex) {\n                    return;\n                }\n                if (_this.parent.isEdit) {\n                    _this.parent.endEdit();\n                }\n                if (_this.isSelectCancel) {\n                    _this.tabInstance.selectedItem = args.previousIndex;\n                    _this.tabInstance.dataBind();\n                    focus(_this.parent.element);\n                }\n                else {\n                    _this.parent.activeSheetIndex = args.selectedIndex;\n                    _this.parent.dataBind();\n                    _this.updateDropDownItems(args.selectedIndex, args.previousIndex);\n                    focus(_this.parent.element);\n                    var completeEventArgs = {\n                        previousSheetIndex: args.previousIndex, currentSheetIndex: args.selectedIndex\n                    };\n                    _this.parent.notify(completeAction, { eventArgs: completeEventArgs, action: 'gotoSheet' });\n                    var eventArgs = {\n                        action: 'registerGridInCalc',\n                        sheetID: (args.selectedIndex + 1).toString()\n                    };\n                    _this.parent.notify(workbookFormulaOperation, eventArgs);\n                }\n            },\n            created: function () {\n                var tBarItems = _this.tabInstance.element.querySelector('.e-toolbar-items');\n                tBarItems.classList.add('e-sheet-tabs-items');\n                EventHandler.add(tBarItems, 'dblclick', _this.renameSheetTab, _this);\n            },\n        });\n        panel.appendChild(sheetTab);\n        this.tabInstance.createElement = this.parent.createElement;\n        this.tabInstance.appendTo(sheetTab);\n        // tslint:disable-next-line:no-any\n        EventHandler.remove(this.tabInstance.element, 'keydown', this.tabInstance.spaceKeyDown);\n        var sheetCount = items.tabItems.length;\n        for (var i = 0; i < sheetCount; i++) {\n            var sheetName = getSheetName(this.parent, i);\n            var arg = { action: 'addSheet', sheetName: 'Sheet' + (i + 1), index: i + 1, visibleName: sheetName };\n            this.parent.notify(workbookFormulaOperation, arg);\n        }\n        this.parent.notify(workbookFormulaOperation, { action: 'initiateDefinedNames' });\n        this.parent.notify(protectSheet, null);\n    };\n    SheetTabs.prototype.updateDropDownItems = function (curIdx, prevIdx) {\n        if (prevIdx > -1) {\n            this.dropDownInstance.items[prevIdx].iconCss = '';\n        }\n        this.dropDownInstance.items[curIdx].iconCss = 'e-selected-icon e-icons';\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n    };\n    SheetTabs.prototype.beforeOpenHandler = function (instance, element) {\n        var viewportHeight = this.parent.viewport.height;\n        var actualHeight = (parseInt(getComputedStyle(element.firstElementChild).height, 10) *\n            instance.items.length) + (parseInt(getComputedStyle(element).paddingTop, 10) * 2);\n        if (actualHeight > viewportHeight) {\n            element.style.height = viewportHeight + \"px\";\n            element.style.overflowY = 'auto';\n        }\n        element.parentElement.style.visibility = 'hidden';\n    };\n    SheetTabs.prototype.openHandler = function (instance, element, positionX) {\n        var wrapper = element.parentElement;\n        var height;\n        var collide = isCollide(wrapper);\n        if (collide.indexOf('bottom') === -1) {\n            height = element.style.overflowY === 'auto' ? this.parent.viewport.height : wrapper.getBoundingClientRect().height;\n            var offset = calculatePosition(instance.element, positionX, 'top');\n            if (positionX === 'right') {\n                offset.left -= wrapper.getBoundingClientRect().width;\n            }\n            wrapper.style.left = offset.left + \"px\";\n            wrapper.style.top = offset.top - height + \"px\";\n        }\n        wrapper.style.visibility = '';\n    };\n    SheetTabs.prototype.getSheetTabItems = function () {\n        var _this = this;\n        var tabItems = [];\n        var ddbItems = [];\n        var sheetName;\n        this.parent.sheets.forEach(function (sheet, index) {\n            sheetName = getSheetName(_this.parent, index);\n            tabItems.push({ header: { 'text': sheetName }, cssClass: sheet.state === 'Visible' ? '' : 'e-hide' });\n            ddbItems.push({ text: sheetName, iconCss: index === _this.parent.activeSheetIndex ? 'e-selected-icon e-icons' : '' });\n        });\n        return { tabItems: tabItems, ddbItems: ddbItems };\n    };\n    SheetTabs.prototype.refreshSheetTab = function () {\n        var items = this.getSheetTabItems();\n        this.dropDownInstance.items = items.ddbItems;\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        this.tabInstance.items = items.tabItems;\n        this.tabInstance.selectedItem = this.parent.activeSheetIndex;\n        this.tabInstance.dataBind();\n    };\n    SheetTabs.prototype.addSheetTab = function () {\n        var eventArgs = { action: 'getCurrentEditValue', editedValue: '' };\n        this.parent.notify(editOperation, eventArgs);\n        var val = eventArgs.editedValue;\n        var isFormulaEdit = checkIsFormula(val) || val && val !== '' ? val.indexOf('=') === 0 : false;\n        this.parent.notify(insertModel, { model: this.parent, start: this.parent.activeSheetIndex + 1, end: this.parent.activeSheetIndex + 1, modelType: 'Sheet', isAction: true, activeSheetIndex: this.parent.activeSheetIndex + 1 });\n        focus(this.parent.element);\n    };\n    SheetTabs.prototype.insertSheetTab = function (args) {\n        if (!args.preventUpdate || args.startIdx === this.tabInstance.selectedItem) {\n            this.dropDownInstance.items[this.tabInstance.selectedItem].iconCss = '';\n        }\n        for (var i = args.startIdx; i <= args.endIdx; i++) {\n            var sheetName = this.parent.sheets[i].name;\n            this.dropDownInstance.items.splice(i, 0, { text: sheetName });\n            this.tabInstance.addTab([{ header: { text: sheetName }, content: '' }], i);\n        }\n        if (!args.preventUpdate || args.startIdx === this.tabInstance.selectedItem) {\n            this.dropDownInstance.items[args.startIdx].iconCss = 'e-selected-icon e-icons';\n        }\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        if (args.preventUpdate) {\n            if (args.startIdx !== this.tabInstance.selectedItem) {\n                this.refreshSheetTab();\n            }\n        }\n        else {\n            this.updateSheetTab({ idx: args.startIdx });\n        }\n    };\n    SheetTabs.prototype.updateSheetTab = function (args) {\n        if (args.name === 'activeSheetChanged') {\n            args.idx = this.parent.skipHiddenSheets(args.idx);\n        }\n        else {\n            if (this.parent.sheets[args.idx].state === 'Hidden') {\n                this.parent.setSheetPropertyOnMute(this.parent.sheets[args.idx], 'state', 'Visible');\n                this.tabInstance.items[args.idx].cssClass = '';\n                this.tabInstance.items = this.tabInstance.items;\n                this.tabInstance.dataBind();\n            }\n        }\n        this.tabInstance.selectedItem = args.idx;\n        this.tabInstance.dataBind();\n        this.parent.notify(protectSheet, null);\n    };\n    SheetTabs.prototype.switchSheetTab = function (args) {\n        var target = closest(args.event.target, '.e-toolbar-item');\n        if (!target) {\n            return;\n        }\n        var text = target.querySelector('.e-tab-text').textContent;\n        for (var i = 0, len = this.tabInstance.items.length; i < len; i++) {\n            if (this.tabInstance.items[i].header.text === text) {\n                if (this.parent.activeSheetIndex !== i) {\n                    this.updateSheetTab({ idx: i });\n                }\n                break;\n            }\n        }\n        if (args.element.classList.contains('e-contextmenu') && args.items[0] &&\n            args.items[0].id === this.parent.element.id + \"_cmenu_insert_sheet\") {\n            if (this.skipHiddenSheets() === 1) {\n                //let id: string = `${this.parent.element.id}_cmenu`;\n                //this.parent.enableFileMenuItems([`${id}_hide_sheet`, `${id}_delete_sheet`], false, true);\n                args.element.children[1].classList.add('e-disabled');\n                args.element.children[3].classList.add('e-disabled');\n            }\n            if (!this.parent.allowInsert) {\n                args.element.children[0].classList.add('e-disabled');\n            }\n            if (!this.parent.allowDelete) {\n                args.element.children[1].classList.add('e-disabled');\n            }\n        }\n    };\n    SheetTabs.prototype.skipHiddenSheets = function () {\n        var count = this.parent.sheets.length;\n        this.parent.sheets.forEach(function (sheet) {\n            if (sheet.state !== 'Visible') {\n                --count;\n            }\n        });\n        return count;\n    };\n    SheetTabs.prototype.renameSheetTab = function () {\n        var target = this.tabInstance.element.querySelector('.e-toolbar-item.e-active');\n        if (target) {\n            target = target.querySelector('.e-text-wrap');\n            var value = target.querySelector('.e-tab-text').textContent;\n            var args = {\n                eventArgs: {\n                    name: value, index: this.parent.getActiveSheet().id\n                },\n                action: 'renameSheet', cancel: false\n            };\n            this.parent.trigger('actionBegin', args);\n            var input = this.parent.createElement('input', {\n                id: this.parent.element.id + '_rename_input',\n                className: 'e-input e-sheet-rename', styles: \"width: \" + target.getBoundingClientRect().width + \"px\", attrs: {\n                    'type': 'text', 'name': 'Rename', 'required': '', 'value': value, 'spellcheck': 'false', 'maxlength': '31'\n                }\n            });\n            target.firstElementChild.style.display = 'none';\n            target.appendChild(input);\n            EventHandler.add(document, 'mousedown touchstart', this.renameInputFocusOut, this);\n            EventHandler.add(input, 'input', this.updateWidth, this);\n            input.focus();\n            input.setSelectionRange(0, value.length);\n            EventHandler.remove(closest(target, '.e-toolbar-items'), 'dblclick', this.renameSheetTab);\n        }\n    };\n    SheetTabs.prototype.updateWidth = function (e) {\n        var target = e.target;\n        var len = target.value.length;\n        var value = target.value.split(' ');\n        if (value.length) {\n            var spaceLen = value.length - 1;\n            len -= spaceLen;\n            len += (spaceLen * 0.5);\n        }\n        target.style.width = len + \"ch\";\n    };\n    SheetTabs.prototype.renameInputFocusOut = function (e) {\n        var target = e.target;\n        if ((e.type === 'mousedown' || e.type === 'touchstart') && (target.classList.contains('e-sheet-rename') ||\n            closest(target, '.e-dlg-container'))) {\n            return;\n        }\n        target = document.getElementById(this.parent.element.id + '_rename_input');\n        if (e.type === 'keydown' && e.keyCode === 27) {\n            this.removeRenameInput(target);\n            focus(this.parent.element);\n            return;\n        }\n        var value = target.value;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (value) {\n            var idx = this.tabInstance.selectedItem;\n            if (!value.match(new RegExp('.*[\\\\[\\\\]\\\\*\\\\\\\\\\/\\\\?].*'))) {\n                if (this.tabInstance.items[idx].header.text !== value) {\n                    for (var i = 0, len = this.parent.sheets.length; i < len; i++) {\n                        if (i !== this.parent.activeSheetIndex && this.parent.sheets[i].name.toLowerCase() === value.toLowerCase()) {\n                            this.showRenameDialog(target, l10n.getConstant('SheetRenameAlreadyExistsAlert'));\n                            return;\n                        }\n                    }\n                }\n                var items = this.removeRenameInput(target);\n                if (this.tabInstance.items[idx].header.text !== value) {\n                    this.parent.setSheetPropertyOnMute(this.parent.sheets[idx], 'name', value);\n                    this.updateSheetName({ value: value, idx: idx, items: items });\n                }\n                if (e.type === 'keydown' || (closest(e.target, '.e-spreadsheet'))) {\n                    focus(this.parent.element);\n                }\n            }\n            else {\n                this.showRenameDialog(target, l10n.getConstant('SheetRenameInvalidAlert'));\n            }\n        }\n        else {\n            this.showRenameDialog(target, l10n.getConstant('SheetRenameEmptyAlert'));\n        }\n        var sheetIndex = this.parent.getActiveSheet().id;\n        var args = { action: 'renameUpdation', value: value, sheetId: sheetIndex };\n        this.parent.notify(workbookFormulaOperation, args);\n        var eventArgs = {\n            index: sheetIndex,\n            value: value\n        };\n        this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'renameSheet' });\n    };\n    SheetTabs.prototype.updateSheetName = function (args) {\n        this.tabInstance.items[args.idx].header.text = args.value;\n        this.dropDownInstance.items[args.idx].text = args.value;\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        if (args.value.indexOf('  ') > -1) {\n            this.tabInstance.setProperties({ 'items': this.tabInstance.items }, true);\n            args.items.querySelector('.e-toolbar-item.e-active .e-tab-text').textContent = args.value;\n        }\n        else {\n            this.tabInstance.items = this.tabInstance.items;\n            this.tabInstance.dataBind();\n        }\n    };\n    SheetTabs.prototype.hideSheet = function () {\n        this.parent.setSheetPropertyOnMute(this.parent.getActiveSheet(), 'state', 'Hidden');\n        this.tabInstance.items[this.parent.activeSheetIndex].cssClass = 'e-hide';\n        this.tabInstance.items = this.tabInstance.items;\n        this.tabInstance.dataBind();\n        this.tabInstance.selectedItem = this.parent.skipHiddenSheets(this.parent.activeSheetIndex === this.parent.sheets.length - 1 ? this.parent.activeSheetIndex - 1 :\n            this.parent.activeSheetIndex + 1);\n        this.tabInstance.dataBind();\n    };\n    SheetTabs.prototype.removeRenameInput = function (target) {\n        var textEle = target.parentElement.querySelector('.e-tab-text');\n        var sheetItems = closest(target, '.e-toolbar-items');\n        EventHandler.add(sheetItems, 'dblclick', this.renameSheetTab, this);\n        EventHandler.remove(document, 'mousedown touchstart', this.renameInputFocusOut);\n        EventHandler.remove(target, 'input', this.updateWidth);\n        remove(target);\n        textEle.style.display = '';\n        return sheetItems;\n    };\n    SheetTabs.prototype.showRenameDialog = function (target, content) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            target: document.getElementById(this.parent.element.id + '_sheet_panel'),\n            height: 180, width: 400, isModal: true, showCloseIcon: true,\n            content: content,\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'SheetRenameDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                target.focus();\n            },\n            close: function () { return target.setSelectionRange(0, target.value.length); }\n        });\n    };\n    SheetTabs.prototype.focusRenameInput = function () {\n        var input = document.getElementById(this.parent.element.id + '_rename_input');\n        if (input) {\n            input.focus();\n        }\n    };\n    SheetTabs.prototype.removeSheetTab = function (args) {\n        var _this = this;\n        if (args.count && (args.count === this.parent.sheets.length)) {\n            return;\n        }\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (this.skipHiddenSheets() > 1) {\n            var sheet = args.sheetName ? getSheet(this.parent, getSheetIndex(this.parent, args.sheetName)) :\n                this.parent.getActiveSheet();\n            var sheetIndex_1 = args.index || getSheetIndex(this.parent, sheet.name);\n            var eventArgs_1 = {\n                index: sheetIndex_1,\n                sheetCount: this.parent.sheets.length,\n                sheetName: sheet.name\n            };\n            var isDataAvail = sheet.rows && sheet.rows.length ?\n                (sheet.rows.length === 1 ? (sheet.rows[0].cells && sheet.rows[0].cells.length ? true : false) : true) : false;\n            if (isDataAvail) {\n                var dialogInst_1 = this.parent.serviceLocator.getService(dialog);\n                if (args.clicked) {\n                    this.forceDelete(sheetIndex_1);\n                }\n                else {\n                    dialogInst_1.show({\n                        height: 200, width: 400, isModal: true, showCloseIcon: true,\n                        content: l10n.getConstant('DeleteSheetAlert'),\n                        beforeOpen: function (args) {\n                            var dlgArgs = {\n                                dialogName: 'DeleteSheetDialog',\n                                element: args.element, target: args.target, cancel: args.cancel\n                            };\n                            _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                            if (dlgArgs.cancel) {\n                                args.cancel = true;\n                            }\n                            focus(_this.parent.element);\n                        },\n                        buttons: [{\n                                buttonModel: {\n                                    content: l10n.getConstant('Ok'), isPrimary: true\n                                },\n                                click: function () {\n                                    dialogInst_1.hide();\n                                    _this.forceDelete(sheetIndex_1);\n                                    _this.parent.notify(clearUndoRedoCollection, null);\n                                    if (args && !args.isAction) {\n                                        eventArgs_1.sheetCount = _this.parent.sheets.length;\n                                        _this.parent.notify(completeAction, { eventArgs: eventArgs_1, action: 'removeSheet' });\n                                    }\n                                }\n                            }]\n                    });\n                }\n            }\n            else {\n                var sheetArgs = {\n                    action: 'deleteSheetTab', sheetName: '', index: sheetIndex_1 + 1\n                };\n                this.parent.notify(workbookFormulaOperation, sheetArgs);\n                this.destroySheet(sheetIndex_1);\n                this.parent.notify(clearUndoRedoCollection, null);\n                if (args && !args.isAction) {\n                    eventArgs_1.sheetCount = this.parent.sheets.length;\n                    this.parent.notify(completeAction, { eventArgs: eventArgs_1, action: 'removeSheet' });\n                }\n            }\n        }\n        else {\n            this.parent.serviceLocator.getService(dialog).show({\n                target: document.getElementById(this.parent.element.id + '_sheet_panel'),\n                height: 180, width: 400, isModal: true, showCloseIcon: true,\n                content: l10n.getConstant('DeleteSingleLastSheetAlert'),\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'DeleteSingleSheetDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                    focus(_this.parent.element);\n                },\n            });\n        }\n    };\n    SheetTabs.prototype.forceDelete = function (sheetIndex) {\n        var sheetArgs = {\n            action: 'deleteSheetTab', sheetName: '', index: sheetIndex + 1\n        };\n        this.parent.notify(workbookFormulaOperation, sheetArgs);\n        this.destroySheet(sheetIndex);\n    };\n    SheetTabs.prototype.destroySheet = function (sheetIndex) {\n        var activeSheetIdx = sheetIndex || this.parent.activeSheetIndex;\n        this.parent.removeSheet(activeSheetIdx);\n        this.parent.notify(sheetsDestroyed, { sheetIndex: activeSheetIdx });\n        this.dropDownInstance.items.splice(activeSheetIdx, 1);\n        this.dropDownInstance.setProperties({ 'items': this.dropDownInstance.items }, true);\n        this.tabInstance.removeTab(activeSheetIdx);\n        var activeIndex = this.parent.skipHiddenSheets(this.tabInstance.selectedItem);\n        this.parent.activeSheetIndex = activeIndex;\n        this.parent.setProperties({ activeSheetIndex: activeIndex }, true);\n        this.parent.renderModule.refreshSheet();\n        this.tabInstance.selectedItem = activeIndex;\n        this.tabInstance.dataBind();\n        this.updateDropDownItems(activeIndex);\n        this.parent.notify(protectSheet, null);\n        focus(this.parent.element);\n    };\n    SheetTabs.prototype.showAggregate = function () {\n        var _this = this;\n        if (isSingleCell(getRangeIndexes(this.parent.getActiveSheet().selectedRange))) {\n            return;\n        }\n        var eventArgs = { Count: 0, Sum: '0', Avg: '0', Min: '0', Max: '0', countOnly: true };\n        this.parent.notify(aggregateComputation, eventArgs);\n        if (eventArgs.Count > 1) {\n            this.aggregateContent = eventArgs.countOnly ? 'Count' : this.selaggregateCnt;\n            if (eventArgs.countOnly) {\n                this.aggregateContent = 'Count';\n                delete eventArgs.Sum;\n                delete eventArgs.Avg;\n                delete eventArgs.Min;\n                delete eventArgs.Max;\n            }\n            var btnClass = eventArgs.countOnly ? 'e-aggregate-list e-flat e-aggregate-list-countonly e-caret-hide'\n                : 'e-aggregate-list e-flat';\n            delete eventArgs.countOnly;\n            var key = this.aggregateContent;\n            var content = key + \": \" + eventArgs[key];\n            if (!this.aggregateDropDown) {\n                var aggregateEle = this.parent.createElement('button');\n                document.getElementById(this.parent.element.id + \"_sheet_tab_panel\").appendChild(aggregateEle);\n                this.aggregateDropDown = new DropDownButton({\n                    content: content,\n                    items: this.getAggregateItems(eventArgs),\n                    select: function (args) { return _this.updateAggregateContent(args.item.text, eventArgs, true); },\n                    beforeOpen: function (args) {\n                        return _this.beforeOpenHandler(_this.aggregateDropDown, args.element);\n                    },\n                    open: function (args) { return _this.openHandler(_this.aggregateDropDown, args.element, 'right'); },\n                    close: function () { return focus(_this.parent.element); },\n                    cssClass: btnClass\n                });\n                this.aggregateDropDown.createElement = this.parent.createElement;\n                this.aggregateDropDown.appendTo(aggregateEle);\n            }\n            else {\n                this.updateAggregateContent(content, eventArgs);\n            }\n        }\n        else {\n            this.removeAggregate();\n        }\n    };\n    SheetTabs.prototype.getAggregateItems = function (args) {\n        var _this = this;\n        var items = [];\n        var text;\n        var iconCss;\n        Object.keys(args).forEach(function (key) {\n            if (args[key] !== aggregateComputation) {\n                text = key + \": \" + args[key];\n                iconCss = key === _this.aggregateContent ? 'e-selected-icon e-icons' : '';\n                items.push({ text: text, iconCss: iconCss });\n            }\n        });\n        return items;\n    };\n    SheetTabs.prototype.updateAggregateContent = function (text, eventArgs, isSelect) {\n        this.aggregateContent = text.split(': ')[0];\n        if (isSelect) {\n            this.selaggregateCnt = text.split(': ')[0];\n        }\n        this.aggregateDropDown.content = text;\n        this.aggregateDropDown.dataBind();\n        this.aggregateDropDown.setProperties({ 'items': this.getAggregateItems(eventArgs) }, true);\n    };\n    SheetTabs.prototype.removeAggregate = function () {\n        if (!isNullOrUndefined(this.aggregateDropDown)) {\n            this.aggregateDropDown.destroy();\n            remove(this.aggregateDropDown.element);\n            this.aggregateDropDown = null;\n        }\n    };\n    SheetTabs.prototype.addEventListener = function () {\n        this.parent.on(sheetTabs, this.createSheetTabs, this);\n        this.parent.on(refreshSheetTabs, this.refreshSheetTab, this);\n        this.parent.on(insertSheetTab, this.insertSheetTab, this);\n        this.parent.on(removeSheetTab, this.removeSheetTab, this);\n        this.parent.on(renameSheetTab, this.renameSheetTab, this);\n        this.parent.on(cMenuBeforeOpen, this.switchSheetTab, this);\n        this.parent.on(activeSheetChanged, this.updateSheetTab, this);\n        this.parent.on(renameSheet, this.renameInputFocusOut, this);\n        this.parent.on(activeCellChanged, this.removeAggregate, this);\n        this.parent.on(onVerticalScroll, this.focusRenameInput, this);\n        this.parent.on(onHorizontalScroll, this.focusRenameInput, this);\n        this.parent.on(sheetNameUpdate, this.updateSheetName, this);\n        this.parent.on(hideSheet, this.hideSheet, this);\n        this.parent.on(showAggregate, this.showAggregate, this);\n    };\n    SheetTabs.prototype.destroy = function () {\n        this.removeEventListener();\n        this.dropDownInstance.destroy();\n        this.dropDownInstance = null;\n        this.tabInstance.destroy();\n        this.tabInstance = null;\n        this.aggregateDropDown = null;\n        this.aggregateContent = null;\n        this.addBtnRipple();\n        this.addBtnRipple = null;\n        EventHandler.remove(document, 'mousedown touchstart', this.renameInputFocusOut);\n        var ele = document.getElementById(this.parent.element.id + '_sheet_tab_panel');\n        if (ele) {\n            remove(ele);\n        }\n        this.parent = null;\n    };\n    SheetTabs.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(sheetTabs, this.createSheetTabs);\n            this.parent.off(refreshSheetTabs, this.refreshSheetTab);\n            this.parent.off(insertSheetTab, this.insertSheetTab);\n            this.parent.off(removeSheetTab, this.removeSheetTab);\n            this.parent.off(renameSheetTab, this.renameSheetTab);\n            this.parent.off(cMenuBeforeOpen, this.switchSheetTab);\n            this.parent.off(activeSheetChanged, this.updateSheetTab);\n            this.parent.off(renameSheet, this.renameInputFocusOut);\n            this.parent.off(activeCellChanged, this.removeAggregate);\n            this.parent.off(onVerticalScroll, this.focusRenameInput);\n            this.parent.off(onHorizontalScroll, this.focusRenameInput);\n            this.parent.off(sheetNameUpdate, this.updateSheetName);\n            this.parent.off(hideSheet, this.hideSheet);\n            this.parent.off(showAggregate, this.showAggregate);\n        }\n    };\n    return SheetTabs;\n}());\nexport { SheetTabs };\n","import { refreshSheetTabs, completeAction } from '../common/event';\nimport { dialog } from '../common/index';\nimport { openSuccess, openFailure } from '../../workbook/index';\nvar Open = /** @class */ (function () {\n    function Open(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        this.renderFileUpload();\n        //Spreadsheet.Inject(WorkbookOpen);\n    }\n    /**\n     * Adding event listener for success and failure\n     */\n    Open.prototype.addEventListener = function () {\n        this.parent.on(openSuccess, this.openSuccess, this);\n        this.parent.on(openFailure, this.openFailed, this);\n    };\n    /**\n     * Removing event listener for success and failure\n     */\n    Open.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(openSuccess, this.openSuccess);\n            this.parent.off(openFailure, this.openFailed);\n        }\n    };\n    /**\n     * Rendering upload component for importing files.\n     */\n    Open.prototype.renderFileUpload = function () {\n        var uploadID = this.parent.element.id + '_fileUpload';\n        this.parent.element.appendChild(this.parent.createElement('input', {\n            id: uploadID,\n            attrs: { type: 'file', accept: '.xls, .xlsx, .csv, .xlsm', name: 'fileUpload' }\n        }));\n        var uploadBox = document.getElementById(uploadID);\n        uploadBox.onchange = this.fileSelect.bind(this);\n        uploadBox.onerror = this.openFailed.bind(this);\n        uploadBox.style.display = 'none';\n    };\n    /**\n     * Process after select the excel and image file.\n     * @param {Event} args - File select native event.\n     */\n    Open.prototype.fileSelect = function (args) {\n        /* tslint:disable-next-line:no-any */\n        var filesData = args.target.files[0];\n        if (filesData && filesData.length < 1) {\n            return;\n        }\n        var impArgs = {\n            file: filesData\n        };\n        this.parent.open(impArgs);\n        document.getElementById(this.parent.element.id + '_fileUpload').value = '';\n    };\n    /**\n     * File open success event declaration.\n     * @param {string} response - File open success response text.\n     */\n    Open.prototype.openSuccess = function (response) {\n        var _this = this;\n        var openError = ['UnsupportedFile', 'InvalidUrl'];\n        if (openError.indexOf(response.data) > -1) {\n            this.parent.serviceLocator.getService(dialog).show({\n                content: this.parent.serviceLocator.getService('spreadsheetLocale')\n                    .getConstant(response.data),\n                width: '300',\n                beforeOpen: function (args) {\n                    var dlgArgs = {\n                        dialogName: 'OpenDialog',\n                        element: args.element, target: args.target, cancel: args.cancel\n                    };\n                    _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                    if (dlgArgs.cancel) {\n                        args.cancel = true;\n                    }\n                },\n            });\n            this.parent.hideSpinner();\n            return;\n        }\n        if (!this.parent.element) {\n            return;\n        }\n        this.parent.trigger('openComplete', { response: response });\n        this.parent.notify(completeAction, { response: response, action: 'import' });\n        this.parent.renderModule.refreshSheet();\n        this.parent.notify(refreshSheetTabs, this);\n        this.parent.hideSpinner();\n    };\n    /**\n     * File open failure event declaration.\n     * @param {object} args - Open failure arguments.\n     */\n    Open.prototype.openFailed = function (args) {\n        this.parent.trigger('openFailure', args);\n        this.parent.hideSpinner();\n        /* Need to Implement */\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    Open.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the sheet open module name.\n     */\n    Open.prototype.getModuleName = function () {\n        return 'open';\n    };\n    return Open;\n}());\nexport { Open };\n","import { dialog, focus } from '../index';\nimport { beginSave, saveCompleted, saveError } from '../../workbook/common/event';\n/**\n * `Save` module is used to handle the save action in Spreadsheet.\n */\nvar Save = /** @class */ (function () {\n    /**\n     * Constructor for Save module in Spreadsheet.\n     * @private\n     */\n    function Save(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookSave);\n    }\n    /**\n     * To destroy the Save module.\n     * @return {void}\n     * @hidden\n     */\n    Save.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Save.prototype.addEventListener = function () {\n        this.parent.on(beginSave, this.initiateSave, this);\n        this.parent.on(saveCompleted, this.saveCompleted, this);\n        this.parent.on(saveError, this.showErrorDialog, this);\n    };\n    Save.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(beginSave, this.initiateSave);\n            this.parent.off(saveCompleted, this.saveCompleted);\n            this.parent.off(saveError, this.showErrorDialog);\n        }\n    };\n    /**\n     * Get the module name.\n     * @returns string\n     * @private\n     */\n    Save.prototype.getModuleName = function () {\n        return 'save';\n    };\n    /**\n     * Initiate save process.\n     * @hidden\n     */\n    Save.prototype.initiateSave = function (args) {\n        this.parent.showSpinner();\n    };\n    /**\n     * Save action completed.\n     * @hidden\n     */\n    Save.prototype.saveCompleted = function (args) {\n        this.parent.hideSpinner();\n    };\n    Save.prototype.showErrorDialog = function (args) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            target: this.parent.element, isModal: true, showCloseIcon: true, height: 180, width: 400, content: args.content,\n            beforeOpen: function () { return focus(_this.parent.element); }\n        });\n    };\n    return Save;\n}());\nexport { Save };\n","import { ContextMenu as ContextMenuComponent } from '@syncfusion/ej2-navigations';\nimport { closest, extend, detach } from '@syncfusion/ej2-base';\nimport { removeSheetTab, cMenuBeforeOpen, renameSheetTab, cut, copy, paste, focus } from '../common/index';\nimport { addContextMenuItems, removeContextMenuItems, enableContextMenuItems, initiateCustomSort, hideSheet } from '../common/index';\nimport { openHyperlink, initiateHyperlink, editHyperlink, hideShow, applyProtect } from '../common/index';\nimport { filterByCellValue, reapplyFilter, clearFilter, getFilteredColumn, applySort, locale } from '../common/index';\nimport { getRangeIndexes, getColumnHeaderText, getCellIndexes, insertModel } from '../../workbook/common/index';\nimport { getSwapRange } from '../../workbook/index';\n/**\n * Represents context menu for Spreadsheet.\n */\nvar ContextMenu = /** @class */ (function () {\n    /**\n     * Constructor for ContextMenu module.\n     */\n    function ContextMenu(parent) {\n        this.parent = parent;\n        this.init();\n    }\n    ContextMenu.prototype.init = function () {\n        this.initContextMenu();\n        this.addEventListener();\n    };\n    ContextMenu.prototype.initContextMenu = function () {\n        var ul = document.createElement('ul');\n        ul.id = this.parent.element.id + '_contextmenu';\n        this.parent.element.appendChild(ul);\n        this.contextMenuInstance = new ContextMenuComponent({\n            cssClass: 'e-spreadsheet-contextmenu',\n            target: '#' + this.parent.element.id,\n            filter: 'e-numericcontainer e-active-cell e-selection e-row e-header-row e-select-all-cell e-sheet-tabs-items',\n            select: this.selectHandler.bind(this),\n            beforeOpen: this.beforeOpenHandler.bind(this),\n            beforeClose: this.beforeCloseHandler.bind(this)\n        }, ul);\n    };\n    /**\n     * Before close event handler.\n     */\n    ContextMenu.prototype.beforeCloseHandler = function (args) {\n        this.parent.trigger('contextMenuBeforeClose', args);\n    };\n    /**\n     * Select event handler.\n     */\n    // tslint:disable-next-line\n    ContextMenu.prototype.selectHandler = function (args) {\n        var selectArgs = extend({ cancel: false }, args);\n        this.parent.trigger('contextMenuItemSelect', selectArgs);\n        var id = this.parent.element.id + '_cmenu';\n        if (!selectArgs.cancel) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            var indexes = void 0;\n            switch (args.item.id) {\n                case id + '_cut':\n                    this.parent.notify(cut, { isAction: true, promise: Promise });\n                    break;\n                case id + '_copy':\n                    this.parent.notify(copy, { isAction: true, promise: Promise });\n                    break;\n                case id + '_paste':\n                    this.parent.notify(paste, { isAction: true, isInternal: true });\n                    break;\n                case id + '_pastevalues':\n                    this.parent.notify(paste, { type: 'Values', isAction: true, isInternal: true });\n                    break;\n                case id + '_pasteformats':\n                    this.parent.notify(paste, { type: 'Formats', isAction: true, isInternal: true });\n                    break;\n                case id + '_rename':\n                    this.parent.notify(renameSheetTab, {});\n                    break;\n                case id + '_delete_sheet':\n                    this.parent.notify(removeSheetTab, {});\n                    break;\n                case id + '_insert_sheet':\n                    this.parent.notify(insertModel, { model: this.parent, start: this.parent.activeSheetIndex,\n                        end: this.parent.activeSheetIndex, modelType: 'Sheet', isAction: true });\n                    break;\n                case id + '_hide_sheet':\n                    this.parent.notify(hideSheet, null);\n                    break;\n                case id + '_ascending':\n                    this.parent.notify(applySort, null);\n                    break;\n                case id + '_descending':\n                    this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: 'Descending' } } });\n                    break;\n                case id + '_customsort':\n                    this.parent.notify(initiateCustomSort, null);\n                    break;\n                case id + '_filtercellvalue':\n                    this.parent.notify(filterByCellValue, null);\n                    break;\n                case id + '_clearfilter':\n                    var field = getColumnHeaderText(getCellIndexes(this.parent.getActiveSheet().activeCell)[1] + 1);\n                    this.parent.notify(clearFilter, { field: field });\n                    break;\n                case id + '_reapplyfilter':\n                    this.parent.notify(reapplyFilter, null);\n                    break;\n                case id + '_hide_row':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[0], endIndex: indexes[2], hide: true, isCol: false, actionUpdate: true\n                    });\n                    focus(this.parent.element);\n                    break;\n                case id + '_unhide_row':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[0], endIndex: indexes[2], hide: false, isCol: false, actionUpdate: true\n                    });\n                    focus(this.parent.element);\n                    break;\n                case id + '_hide_column':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[1], endIndex: indexes[3], hide: true, isCol: true, actionUpdate: true\n                    });\n                    focus(this.parent.element);\n                    break;\n                case id + '_unhide_column':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(hideShow, {\n                        startIndex: indexes[1], endIndex: indexes[3], hide: false, isCol: true, actionUpdate: true\n                    });\n                    focus(this.parent.element);\n                    break;\n                case id + '_insert_row_above':\n                case id + '_delete_row':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(args.item.id.substr(id.length + 1, 6) + \"Model\", { model: this.parent.getActiveSheet(), start: indexes[0], end: indexes[2], modelType: 'Row', isAction: true,\n                        insertType: 'above' });\n                    focus(this.parent.element);\n                    break;\n                case id + '_insert_row_below':\n                    indexes = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n                    this.parent.notify(insertModel, { model: this.parent.getActiveSheet(), start: indexes[2] + 1, end: indexes[2] + 1 + (indexes[2] - indexes[0]), modelType: 'Row', isAction: true,\n                        insertType: 'below' });\n                    focus(this.parent.element);\n                    break;\n                case id + '_insert_column_before':\n                case id + '_delete_column':\n                    indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n                    this.parent.notify(args.item.id.substr(id.length + 1, 6) + \"Model\", { model: this.parent.getActiveSheet(), start: indexes[1], end: indexes[3], modelType: 'Column', isAction: true });\n                    focus(this.parent.element);\n                    break;\n                case id + '_insert_column_after':\n                    indexes = getSwapRange(getRangeIndexes(this.parent.getActiveSheet().selectedRange));\n                    this.parent.notify(insertModel, { model: this.parent.getActiveSheet(), start: indexes[3] + 1, end: indexes[3] + 1 + (indexes[3] - indexes[1]), modelType: 'Column', isAction: true });\n                    focus(this.parent.element);\n                    break;\n                case id + '_hyperlink':\n                    this.parent.notify(initiateHyperlink, null);\n                    break;\n                case id + '_editHyperlink':\n                    this.parent.notify(editHyperlink, null);\n                    break;\n                case id + '_openHyperlink':\n                    this.parent.notify(openHyperlink, null);\n                    break;\n                case id + '_removeHyperlink':\n                    this.parent.removeHyperlink(this.parent.getActiveSheet().selectedRange);\n                    break;\n                case id + '_protect':\n                    var sheet = this.parent.getActiveSheet();\n                    this.parent.setSheetPropertyOnMute(sheet, 'isProtected', !sheet.isProtected);\n                    var isActive = void 0;\n                    sheet.isProtected ? isActive = false : isActive = true;\n                    this.parent.notify(applyProtect, { isActive: isActive });\n                    break;\n            }\n        }\n    };\n    ContextMenu.prototype.getInsertModel = function (startIndex, endIndex) {\n        var model = [];\n        for (var i = startIndex; i <= endIndex; i++) {\n            if (i === startIndex) {\n                model.push({ index: i });\n            }\n            else {\n                model.push({});\n            }\n        }\n        return model;\n    };\n    /**\n     * Before open event handler.\n     */\n    ContextMenu.prototype.beforeOpenHandler = function (args) {\n        var target = this.getTarget(args.event.target);\n        var items;\n        if (args.element.classList.contains('e-contextmenu')) {\n            items = this.getDataSource(target);\n            this.contextMenuInstance.items = items;\n            this.contextMenuInstance.dataBind();\n        }\n        else {\n            items = args.items;\n        }\n        if (target === 'ColumnHeader' || target === 'RowHeader') {\n            if (args.element && args.element.childElementCount > 0) {\n                var insertEle = target === 'ColumnHeader' ? args.element.querySelector('#' + this.parent.element.id + '_cmenu_insert_column') :\n                    args.element.querySelector('#' + this.parent.element.id + '_cmenu_insert_row');\n                var deleteEle = target ===\n                    'ColumnHeader' ? args.element.querySelector('#' + this.parent.element.id + '_cmenu_delete_column') :\n                    args.element.querySelector('#' + this.parent.element.id + '_cmenu_delete_row');\n                if (this.parent.allowInsert && insertEle.classList.contains('e-disabled')) {\n                    insertEle.classList.remove('e-disabled');\n                }\n                else if (!this.parent.allowInsert && !insertEle.classList.contains('e-disabled')) {\n                    insertEle.classList.add('e-disabled');\n                }\n                if (this.parent.allowDelete && deleteEle.classList.contains('e-disabled')) {\n                    deleteEle.classList.remove('e-disabled');\n                }\n                else if (!this.parent.allowDelete && !deleteEle.classList.contains('e-disabled')) {\n                    deleteEle.classList.add('e-disabled');\n                }\n            }\n        }\n        this.parent.trigger('contextMenuBeforeOpen', args);\n        this.parent.notify(cMenuBeforeOpen, extend(args, { target: target, items: items }));\n    };\n    /**\n     * To get target area based on right click.\n     */\n    ContextMenu.prototype.getTarget = function (target) {\n        if (closest(target, '.e-sheet-content')) {\n            return 'Content';\n        }\n        else if (closest(target, '.e-column-header')) {\n            return 'ColumnHeader';\n        }\n        else if (closest(target, '.e-row-header')) {\n            return 'RowHeader';\n        }\n        else if (closest(target, '.e-sheet-tabs-items')) {\n            return 'Footer';\n        }\n        else if (closest(target, '.e-selectall-container')) {\n            return 'SelectAll';\n        }\n        else {\n            return '';\n        }\n    };\n    /**\n     * To populate context menu items based on target area.\n     */\n    ContextMenu.prototype.getDataSource = function (target) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var items = [];\n        var id = this.parent.element.id + '_cmenu';\n        if (target === 'Content') {\n            this.setClipboardData(items, l10n, id);\n            items.push({ separator: true });\n            //push filter and sort items here\n            this.setFilterItems(items, id);\n            this.setSortItems(items, id);\n            items.push({ separator: true });\n            this.setHyperLink(items, id);\n        }\n        else if (target === 'RowHeader') {\n            this.setClipboardData(items, l10n, id);\n            var indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n            this.setInsertDeleteItems(items, l10n, 'Row', id, [indexes[0], indexes[2]], ['Above', 'Below']);\n            this.setHideShowItems(items, l10n, 'Row', id, [indexes[0], indexes[2]]);\n        }\n        else if (target === 'ColumnHeader') {\n            this.setClipboardData(items, l10n, id);\n            var indexes = getRangeIndexes(this.parent.getActiveSheet().selectedRange);\n            this.setInsertDeleteItems(items, l10n, 'Column', id, [indexes[1], indexes[3]], ['Before', 'After']);\n            this.setHideShowItems(items, l10n, 'Column', id, [indexes[1], indexes[3]]);\n        }\n        else if (target === 'SelectAll') {\n            this.setClipboardData(items, l10n, id);\n            this.setFilterItems(items, id);\n            this.setSortItems(items, id);\n        }\n        else if (target === 'Footer') {\n            items.push({\n                text: l10n.getConstant('Insert'), id: id + '_insert_sheet'\n            });\n            items.push({\n                text: l10n.getConstant('Delete'), iconCss: 'e-icons e-delete', id: id + '_delete_sheet'\n            });\n            items.push({\n                text: l10n.getConstant('Rename'), id: id + '_rename'\n            });\n            items.push({\n                text: l10n.getConstant('Hide'), id: id + '_hide_sheet'\n            });\n            this.setProtectSheetItems(items, id);\n        }\n        return items;\n    };\n    ContextMenu.prototype.setProtectSheetItems = function (items, id) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (this.parent.getActiveSheet().isProtected) {\n            items.push({\n                text: l10n.getConstant('UnprotectSheet'), id: id + '_protect', iconCss: 'e-icons e-protect-icon',\n            });\n        }\n        else {\n            items.push({\n                text: l10n.getConstant('ProtectSheet'), id: id + '_protect', iconCss: 'e-icons e-protect-icon',\n            });\n        }\n    };\n    /**\n     * Sets sorting related items to the context menu.\n     */\n    ContextMenu.prototype.setFilterItems = function (items, id) {\n        if (this.parent.allowFiltering) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            var args = { clearFilterText: null, isFiltered: false };\n            this.parent.notify(getFilteredColumn, args);\n            items.push({\n                text: l10n.getConstant('Filter'), id: id + '_filter',\n                iconCss: '',\n                items: [\n                    { text: args.clearFilterText, iconCss: 'e-icons e-filter-clear', id: id + '_clearfilter' },\n                    { text: l10n.getConstant('ReapplyFilter'), iconCss: 'e-icons e-filter-reapply', id: id + '_reapplyfilter' },\n                    { separator: true },\n                    { text: l10n.getConstant('FilterCellValue'), iconCss: '', id: id + '_filtercellvalue' }\n                ]\n            });\n        }\n    };\n    /**\n     * Sets sorting related items to the context menu.\n     */\n    ContextMenu.prototype.setSortItems = function (items, id) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (this.parent.allowSorting) {\n            items.push({\n                text: l10n.getConstant('Sort'), id: id + '_sort',\n                iconCss: 'e-icons e-sort-icon',\n                items: [\n                    { text: l10n.getConstant('SortAscending'), iconCss: 'e-icons e-sort-asc', id: id + '_ascending' },\n                    { text: l10n.getConstant('SortDescending'), iconCss: 'e-icons e-sort-desc', id: id + '_descending' },\n                    { text: l10n.getConstant('CustomSort') + '...', iconCss: 'e-icons e-sort-custom', id: id + '_customsort' }\n                ]\n            });\n        }\n    };\n    ContextMenu.prototype.setHyperLink = function (items, id) {\n        var sheet = this.parent.getActiveSheet();\n        if (this.parent.allowHyperlink) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            if ((!document.activeElement.getElementsByClassName('e-hyperlink')[0] &&\n                !document.activeElement.classList.contains('e-hyperlink')) || (sheet.isProtected && !sheet.protectSettings.insertLink)) {\n                items.push({\n                    text: l10n.getConstant('Hyperlink'), iconCss: 'e-icons e-hyperlink-icon', id: id + '_hyperlink'\n                });\n            }\n            else {\n                items.push({ text: l10n.getConstant('EditHyperlink'), iconCss: 'e-icons e-edithyperlink-icon', id: id + '_editHyperlink' }, { text: l10n.getConstant('OpenHyperlink'), iconCss: 'e-icons e-openhyperlink-icon', id: id + '_openHyperlink' }, { text: l10n.getConstant('RemoveHyperlink'), iconCss: 'e-icons e-removehyperlink-icon', id: id + '_removeHyperlink' });\n            }\n        }\n    };\n    ContextMenu.prototype.setClipboardData = function (items, l10n, id) {\n        if (this.parent.enableClipboard) {\n            items.push({\n                text: l10n.getConstant('Cut'),\n                iconCss: 'e-icons e-cut-icon', id: id + '_cut'\n            });\n            items.push({\n                text: l10n.getConstant('Copy'),\n                iconCss: 'e-icons e-copy-icon', id: id + '_copy'\n            });\n            items.push({\n                text: l10n.getConstant('Paste'),\n                iconCss: 'e-icons e-paste-icon', id: id + '_paste'\n            });\n            items.push({\n                text: l10n.getConstant('PasteSpecial'), id: id + '_pastespecial',\n                items: [\n                    { text: l10n.getConstant('Values'), id: id + '_pastevalues' },\n                    { text: l10n.getConstant('Formats'), id: id + '_pasteformats' }\n                ]\n            });\n        }\n    };\n    ContextMenu.prototype.setInsertDeleteItems = function (items, l10n, layout, id, indexes, subItems) {\n        items.push({ separator: true });\n        ['Insert', 'Delete'].forEach(function (action) {\n            if (indexes[0] === indexes[1]) {\n                items.push({ text: l10n.getConstant(\"\" + action + layout), id: id + (\"_\" + action.toLowerCase() + \"_\" + layout.toLowerCase()) });\n            }\n            else {\n                items.push({ text: l10n.getConstant(\"\" + action + layout + \"s\"), id: id + (\"_\" + action.toLowerCase() + \"_\" + layout.toLowerCase()) });\n            }\n            if (action === 'Insert') {\n                items[items.length - 1].items = [];\n                subItems.forEach(function (item) {\n                    items[items.length - 1].items.push({\n                        text: l10n.getConstant(item), id: items[items.length - 1].id + \"_\" + item.toLowerCase()\n                    });\n                });\n            }\n        });\n    };\n    ContextMenu.prototype.setHideShowItems = function (items, l10n, layout, id, indexes) {\n        if (indexes[0] === indexes[1]) {\n            items.push({ text: l10n.getConstant(\"Hide\" + layout), id: id + (\"_hide_\" + layout.toLowerCase()) });\n        }\n        else {\n            items.push({ text: l10n.getConstant(\"Hide\" + layout + \"s\"), id: id + (\"_hide_\" + layout.toLowerCase()) });\n        }\n        if (this.parent.hiddenCount(indexes[0], indexes[1], layout.toLowerCase() + \"s\")) {\n            items.push({ text: l10n.getConstant(\"UnHide\" + layout + \"s\"), id: id + (\"_unhide_\" + layout.toLowerCase()) });\n        }\n    };\n    /**\n     * To add event listener.\n     */\n    ContextMenu.prototype.addEventListener = function () {\n        this.parent.on(addContextMenuItems, this.addItemsHandler, this);\n        this.parent.on(removeContextMenuItems, this.removeItemsHandler, this);\n        this.parent.on(enableContextMenuItems, this.enableItemsHandler, this);\n    };\n    /**\n     * To add context menu items before / after particular item.\n     */\n    ContextMenu.prototype.addItemsHandler = function (args) {\n        if (args.insertAfter) {\n            this.contextMenuInstance.insertAfter(args.items, args.text, args.isUniqueId);\n        }\n        else {\n            this.contextMenuInstance.insertBefore(args.items, args.text, args.isUniqueId);\n        }\n    };\n    /**\n     * To remove context menu items.\n     */\n    ContextMenu.prototype.removeItemsHandler = function (args) {\n        this.contextMenuInstance.removeItems(args.items, args.isUniqueId);\n    };\n    /**\n     * To enable / disable context menu items.\n     */\n    ContextMenu.prototype.enableItemsHandler = function (args) {\n        this.contextMenuInstance.enableItems(args.items, args.enable, args.isUniqueId);\n    };\n    /**\n     * To remove event listener.\n     */\n    ContextMenu.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(addContextMenuItems, this.addItemsHandler);\n            this.parent.off(removeContextMenuItems, this.removeItemsHandler);\n            this.parent.off(enableContextMenuItems, this.enableItemsHandler);\n        }\n    };\n    /**\n     * To get module name.\n     */\n    ContextMenu.prototype.getModuleName = function () {\n        return 'contextMenu';\n    };\n    /**\n     * Destroy method.\n     */\n    ContextMenu.prototype.destroy = function () {\n        this.removeEventListener();\n        this.contextMenuInstance.destroy();\n        var ele = document.getElementById(this.parent.element.id + '_contextmenu');\n        if (ele) {\n            detach(ele);\n        }\n        this.parent = null;\n    };\n    return ContextMenu;\n}());\nexport { ContextMenu };\n","import { refreshCellElement } from '../../workbook/common/event';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * Specifies number format.\n */\nvar NumberFormat = /** @class */ (function () {\n    function NumberFormat(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //Spreadsheet.Inject(WorkbookNumberFormat);\n    }\n    NumberFormat.prototype.refreshCellElement = function (args) {\n        var cell = this.parent.getCell(args.rowIndex, args.colIndex);\n        if (!isNullOrUndefined(cell)) {\n            this.parent.refreshNode(cell, args);\n        }\n    };\n    /**\n     * Adding event listener for number format.\n     * @hidden\n     */\n    NumberFormat.prototype.addEventListener = function () {\n        this.parent.on(refreshCellElement, this.refreshCellElement, this);\n    };\n    /**\n     * Removing event listener for number format.\n     * @hidden\n     */\n    NumberFormat.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(refreshCellElement, this.refreshCellElement);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    NumberFormat.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the workbook import module name.\n     */\n    NumberFormat.prototype.getModuleName = function () {\n        return 'numberFormat';\n    };\n    return NumberFormat;\n}());\nexport { NumberFormat };\n","import { initiateCustomSort, locale, dialog, getFilterRange } from '../index';\nimport { applySort, completeAction, beginAction, focus } from '../index';\nimport { sortComplete, beforeSort, getFormattedCellObject } from '../../workbook/common/event';\nimport { getIndexesFromAddress, getSwapRange, getCell, inRange } from '../../workbook/index';\nimport { getColumnHeaderText, getRangeAddress } from '../../workbook/index';\nimport { getUniqueID, getComponent, enableRipple } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { RadioButton, CheckBox } from '@syncfusion/ej2-buttons';\nimport { ListView } from '@syncfusion/ej2-lists';\n/**\n * `Sort` module is used to handle the sort action in Spreadsheet.\n */\nvar Sort = /** @class */ (function () {\n    /**\n     * Constructor for sort module.\n     */\n    function Sort(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * To destroy the sort module.\n     * @return {void}\n     */\n    Sort.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Sort.prototype.addEventListener = function () {\n        this.parent.on(applySort, this.applySortHandler, this);\n        this.parent.on(sortComplete, this.sortCompleteHandler, this);\n        this.parent.on(initiateCustomSort, this.initiateCustomSortHandler, this);\n    };\n    Sort.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(applySort, this.applySortHandler);\n            this.parent.off(sortComplete, this.sortCompleteHandler);\n            this.parent.off(initiateCustomSort, this.initiateCustomSortHandler);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    Sort.prototype.getModuleName = function () {\n        return 'sort';\n    };\n    /**\n     * Validates the range and returns false when invalid.\n     */\n    Sort.prototype.isValidSortRange = function () {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSwapRange(getIndexesFromAddress(sheet.selectedRange));\n        if (range[0] > sheet.usedRange.rowIndex || range[1] > sheet.usedRange.colIndex) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * Shows the range error alert dialog.\n     * @param error - range error string.\n     */\n    Sort.prototype.sortRangeAlertHandler = function (args) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            height: 180, width: 400, isModal: true, showCloseIcon: true,\n            content: args.error,\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'SortRangeDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n            },\n        });\n        this.parent.hideSpinner();\n    };\n    /**\n     * Initiates the custom sort dialog.\n     */\n    Sort.prototype.initiateCustomSortHandler = function () {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        if (!this.isValidSortRange()) {\n            this.sortRangeAlertHandler({ error: l10n.getConstant('SortOutOfRangeError') });\n            return;\n        }\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            height: 400, width: 560, isModal: true, showCloseIcon: true, cssClass: 'e-customsort-dlg',\n            header: l10n.getConstant('CustomSort'),\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'CustomSortDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n                dialogInst.dialogInstance.content = _this.customSortContent();\n                dialogInst.dialogInstance.dataBind();\n                focus(_this.parent.element);\n            },\n            buttons: [{\n                    buttonModel: {\n                        content: l10n.getConstant('Ok'), isPrimary: true\n                    },\n                    click: function () {\n                        var element = dialogInst.dialogInstance.content;\n                        var list = element.getElementsByClassName('e-list-sort e-listview e-lib')[0];\n                        var listview = getComponent(list, 'listview');\n                        var data = listview.dataSource;\n                        _this.clearError();\n                        var errorElem = element.getElementsByClassName('e-sort-error')[0];\n                        errorElem.style.display = 'block';\n                        if (!_this.validateError(data, element, errorElem)) {\n                            dialogInst.hide();\n                            var headercheck = element.getElementsByClassName('e-sort-checkheader')[0];\n                            var headerCheckbox = getComponent(headercheck, 'checkbox');\n                            var caseCheckbox = getComponent(element.getElementsByClassName('e-sort-checkcase')[0], 'checkbox');\n                            var hasHeader = headerCheckbox.checked;\n                            _this.applySortHandler({ sortOptions: { sortDescriptors: data, containsHeader: hasHeader, caseSensitive: caseCheckbox.checked } });\n                        }\n                    }\n                }]\n        });\n    };\n    /**\n     * Validates the errors of the sort criteria and displays the error.\n     * @param json - listview datasource.\n     * @param dialogElem - dialog content element.\n     * @param errorElem - element to display error.\n     */\n    Sort.prototype.validateError = function (json, dialogElem, errorElem) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var hasEmpty = json.some(function (element) { return element.field.toString() === ''; });\n        if (hasEmpty) {\n            Array.prototype.some.call(dialogElem.getElementsByClassName('e-sort-field'), function (dropDown) {\n                var hasError = !getComponent(dropDown, 'dropdownlist').value;\n                if (hasError) {\n                    dropDown.parentElement.classList.add('e-error');\n                }\n                return hasError; //breaks the loop if only one error added.\n            });\n            errorElem.innerText = l10n.getConstant('SortEmptyFieldError');\n            return true;\n        }\n        var temp = new Set();\n        var duplicateField = '';\n        var hasDuplicate = json.some(function (element) {\n            duplicateField = element.field.toString();\n            return temp.size === temp.add(element.field).size;\n        });\n        var errorField = '';\n        if (hasDuplicate) {\n            var count_1 = 0;\n            Array.prototype.some.call(dialogElem.getElementsByClassName('e-sort-field'), function (dropDown) {\n                var dropDownList = getComponent(dropDown, 'dropdownlist');\n                if (dropDownList.value === duplicateField) {\n                    dropDown.parentElement.classList.add('e-error');\n                    errorField = dropDownList.text;\n                    count_1++;\n                }\n                return count_1 === 2; //breaks the loop when 2 errors added.\n            });\n            errorElem.innerHTML = '<strong>' + errorField + '</strong>' + l10n.getConstant('SortDuplicateFieldError');\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Creates all the elements and generates the dialog content element.\n     */\n    Sort.prototype.customSortContent = function () {\n        var dialogElem = this.parent.createElement('div', { className: 'e-sort-dialog' });\n        var fields = this.getFields();\n        var listId = getUniqueID('customSort');\n        var listviewObj = this.getCustomListview(listId);\n        this.setHeaderTab(dialogElem, listviewObj, fields);\n        var contentElem = this.parent.createElement('div', {\n            className: 'e-sort-listsection',\n            styles: ''\n        });\n        dialogElem.appendChild(contentElem);\n        var listview = this.parent.createElement('div', { className: 'e-list-sort', styles: '' });\n        contentElem.appendChild(listview);\n        listviewObj.createElement = this.parent.createElement;\n        listviewObj.appendTo(listview);\n        this.renderListItem(listId, listviewObj, true, fields);\n        var errorElem = this.parent.createElement('div', { className: 'e-sort-error' });\n        dialogElem.appendChild(errorElem);\n        return dialogElem;\n    };\n    /**\n     * Gets the fields data from the selected range.\n     */\n    Sort.prototype.getFields = function () {\n        var sheet = this.parent.getActiveSheet();\n        var range = getSwapRange(getIndexesFromAddress(sheet.selectedRange));\n        if (range[0] === range[2] && (range[2] - range[0]) === 0) { //for entire range\n            range[0] = 0;\n            range[1] = 0;\n            range[3] = sheet.usedRange.colIndex;\n            var args = { filterRange: [], hasFilter: false };\n            this.parent.notify(getFilterRange, args);\n            if (args.hasFilter && args.filterRange) {\n                range[0] = args.filterRange[0];\n            }\n        }\n        var fields = [];\n        var fieldName;\n        for (range[1]; range[1] <= range[3]; range[1]++) {\n            var cell = getCell(range[0], range[1], sheet);\n            if (cell && cell.value) {\n                var eventArgs = {\n                    formattedText: cell.value,\n                    value: cell.value,\n                    format: cell.format,\n                    onLoad: true\n                };\n                if (cell.format) {\n                    this.parent.notify(getFormattedCellObject, eventArgs);\n                }\n                fieldName = eventArgs.formattedText;\n            }\n            else {\n                fieldName = 'Column ' + getColumnHeaderText(range[1] + 1);\n            }\n            fields.push({ text: fieldName, value: 'Column ' + getColumnHeaderText(range[1] + 1) });\n        }\n        return fields;\n    };\n    /**\n     * Creates the header tab for the custom sort dialog.\n     * @param dialogElem - dialog content element.\n     * @param listviewObj - listview instance.\n     * @param fields - fields data.\n     */\n    Sort.prototype.setHeaderTab = function (dialogElem, listviewObj, fields) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var headerTabElement = this.parent.createElement('div', {\n            className: 'e-sort-header',\n            styles: '',\n            innerHTML: ''\n        });\n        dialogElem.appendChild(headerTabElement);\n        var addButton = this.parent.createElement('button', {\n            className: 'e-btn e-sort-addbtn e-flat',\n            innerHTML: l10n.getConstant('AddColumn')\n        });\n        var footer = this.parent.element.querySelector('.e-customsort-dlg .e-footer-content');\n        footer.insertBefore(addButton, footer.firstElementChild);\n        addButton.addEventListener('click', function () {\n            if (listviewObj) {\n                var listId = getUniqueID('customSort');\n                listviewObj.addItem([{ id: listId, text: l10n.getConstant('ThenBy'), field: '', order: 'ascending' }]);\n                _this.renderListItem(listId, listviewObj, checkHeaderObj.checked, fields, true);\n            }\n        });\n        var checkHeaderObj = new CheckBox({\n            label: l10n.getConstant('ContainsHeader'),\n            checked: true,\n            change: function (args) {\n                var fieldsMap = args.checked ? { text: 'text', value: 'value' } : { text: 'value' };\n                Array.prototype.forEach.call(dialogElem.getElementsByClassName('e-sort-field e-dropdownlist e-lib'), function (dropDown) {\n                    var dropDownListObj = getComponent(dropDown, 'dropdownlist');\n                    dropDownListObj.dataSource = null; //reset datasource.\n                    dropDownListObj.dataSource = fields;\n                    dropDownListObj.fields = fieldsMap;\n                    dropDownListObj.dataBind();\n                });\n            },\n            cssClass: 'e-sort-headercheckbox'\n        });\n        var headerCheckbox = this.parent.createElement('input', {\n            className: 'e-sort-checkheader', attrs: { type: 'checkbox' }\n        });\n        headerTabElement.appendChild(headerCheckbox);\n        checkHeaderObj.createElement = this.parent.createElement;\n        checkHeaderObj.appendTo(headerCheckbox);\n        var checkCaseObj = new CheckBox({\n            label: l10n.getConstant('CaseSensitive'),\n            checked: false,\n            cssClass: 'e-sort-casecheckbox'\n        });\n        var caseCheckbox = this.parent.createElement('input', {\n            className: 'e-sort-checkcase', attrs: { type: 'checkbox' }\n        });\n        headerTabElement.appendChild(caseCheckbox);\n        checkCaseObj.createElement = this.parent.createElement;\n        checkCaseObj.appendTo(caseCheckbox);\n    };\n    /**\n     * Creates a listview instance.\n     * @param listId - unique id of the list item.\n     */\n    Sort.prototype.getCustomListview = function (listId) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var data = [{ id: listId, text: l10n.getConstant('SortBy'), field: '', order: 'ascending' }];\n        enableRipple(false);\n        var listviewObj = new ListView({\n            dataSource: data,\n            fields: { id: 'id' },\n            height: '100%',\n            template: '<div class=\"e-sort-listwrapper\">' +\n                '<span class=\"text\">${text}</span>' +\n                '<div class=\"e-sort-row\"><div class=\"e-sort-field\"></div>' +\n                '<div class=\"e-sort-order\">' +\n                '<span class=\"e-sort-ordertxt\" style=\"display:none;\">${order}</span></div>' +\n                '<span class=\"e-icons e-sort-delete\"></span></div>',\n            cssClass: 'e-sort-template',\n        });\n        return listviewObj;\n    };\n    /**\n     * Triggers the click event for delete icon.\n     * @param element - current list item element.\n     * @param listviewObj - listview instance.\n     */\n    Sort.prototype.deleteHandler = function (element, listviewObj) {\n        var iconEle = element.getElementsByClassName('e-sort-delete')[0];\n        //Event handler to bind the click event for delete icon\n        iconEle.addEventListener('click', function () {\n            if (element) {\n                listviewObj.removeItem(element);\n            }\n        });\n    };\n    /**\n     * Renders the dropdown and radio button components inside list item.\n     * @param id - unique id of the list item.\n     * @param listviewObj - listview instance.\n     * @param containsHeader - data contains header.\n     * @param fields - fields data.\n     */\n    Sort.prototype.renderListItem = function (id, lvObj, containsHeader, fields, btn) {\n        var _this = this;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var element = lvObj.element.querySelector('li[data-uid=' + id + ']');\n        var fieldsMap = containsHeader ? { text: 'text', value: 'value' } : { text: 'value' };\n        var dropDown = element.getElementsByClassName('e-sort-field')[0];\n        var dropDownListObj = new DropDownList({\n            dataSource: fields,\n            width: 'auto',\n            cssClass: 'e-sort-field-ddl',\n            fields: fieldsMap,\n            placeholder: l10n.getConstant('SelectAColumn'),\n            change: function (args) {\n                if (!args.value) {\n                    return;\n                }\n                Array.prototype.some.call(lvObj.dataSource, function (item) {\n                    if (item.id === id) {\n                        item.field = args.value.toString().replace('Column ', '');\n                    }\n                    return item.id === id; //breaks the loop when proper id found\n                });\n                _this.clearError();\n            }\n        });\n        dropDownListObj.createElement = this.parent.createElement;\n        dropDownListObj.appendTo(dropDown);\n        if (!btn) {\n            dropDownListObj.index = 0;\n        }\n        /* sort ascending radio button */\n        var orderRadio = element.getElementsByClassName('e-sort-order')[0];\n        var ordertxtElem = orderRadio.getElementsByClassName('e-sort-ordertxt')[0];\n        var isAscending = ordertxtElem.innerText.toLocaleLowerCase() === 'ascending';\n        var radiobutton = new RadioButton({\n            label: l10n.getConstant('SortAscending'),\n            name: 'sortAZ_' + id, value: 'ascending', checked: isAscending, cssClass: 'e-sort-radiobutton',\n            change: function (args) { _this.setRadioBtnValue(lvObj, id, args.value); }\n        });\n        var radio = this.parent.createElement('input', {\n            id: 'orderAsc_' + id, className: 'e-sort-radioasc', styles: '', attrs: { type: 'radio' }\n        });\n        orderRadio.appendChild(radio);\n        radiobutton.createElement = this.parent.createElement;\n        radiobutton.appendTo(radio);\n        /* sort descending radio button */\n        var radiobutton2 = new RadioButton({\n            label: l10n.getConstant('SortDescending'),\n            name: 'sortAZ_' + id, value: 'descending', checked: !isAscending, cssClass: 'e-sort-radiobutton',\n            change: function (args) { _this.setRadioBtnValue(lvObj, id, args.value); }\n        });\n        var radio2 = this.parent.createElement('input', {\n            id: 'orderDesc_' + id, className: 'e-sort-radiodesc', styles: '', attrs: { type: 'radio' }\n        });\n        orderRadio.appendChild(radio2);\n        radiobutton2.createElement = this.parent.createElement;\n        radiobutton2.appendTo(radio2);\n        this.deleteHandler(element, lvObj);\n    };\n    /**\n     * Sets the new value of the radio button.\n     * @param listviewObj - listview instance.\n     * @param id - unique id of the list item.\n     * @param value - new value.\n     */\n    Sort.prototype.setRadioBtnValue = function (listviewObj, id, value) {\n        if (!value) {\n            return;\n        }\n        Array.prototype.some.call(listviewObj.dataSource, function (item) {\n            if (item.id === id) {\n                item.order = value;\n            }\n            return item.id === id; //breaks the loop when proper id found\n        });\n    };\n    /**\n     * Clears the error from the dialog.\n     * @param dialogElem - dialog content element.\n     */\n    Sort.prototype.clearError = function () {\n        var dialogElem = document.getElementsByClassName('e-sort-dialog')[0];\n        var errorElem = dialogElem.getElementsByClassName('e-sort-error')[0];\n        if (errorElem.style.display !== 'none' && errorElem.innerHTML !== '') {\n            errorElem.style.display = 'none';\n            Array.prototype.forEach.call(dialogElem.getElementsByClassName('e-error'), function (element) {\n                element.classList.remove('e-error');\n            });\n        }\n    };\n    /**\n     * Triggers sort events and applies sorting.\n     */\n    Sort.prototype.applySortHandler = function (args) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        var address = args && args.range || sheet.selectedRange;\n        var sortOptions = args && args.sortOptions || { sortDescriptors: {} };\n        var beforeArgs = { range: address, sortOptions: sortOptions, cancel: false };\n        this.parent.trigger(beforeSort, beforeArgs);\n        if (beforeArgs.cancel) {\n            return;\n        }\n        this.parent.notify(beginAction, { eventArgs: beforeArgs, action: 'beforeSort' });\n        this.parent.showSpinner();\n        var range = getSwapRange(getIndexesFromAddress(beforeArgs.range));\n        var eventArgs = { filterRange: [], hasFilter: false };\n        if (range[0] === range[2] && (range[2] - range[0]) === 0) { //check for filter range\n            this.parent.notify(getFilterRange, eventArgs);\n            if (eventArgs.hasFilter && inRange(eventArgs.filterRange, range[0], range[1])) {\n                range[0] = eventArgs.filterRange[0];\n                range[1] = 0;\n                range[2] = sheet.usedRange.rowIndex;\n                range[3] = sheet.usedRange.colIndex;\n                beforeArgs.sortOptions.containsHeader = true;\n            }\n        }\n        this.parent.sort(beforeArgs.sortOptions, getRangeAddress(range)).then(function (sortArgs) {\n            _this.parent.trigger(sortComplete, sortArgs);\n            _this.parent.notify(completeAction, { eventArgs: sortArgs, action: 'sorting' });\n            return Promise.resolve(sortArgs);\n        }).catch(function (error) {\n            _this.sortRangeAlertHandler({ error: error });\n            return Promise.reject(error);\n        });\n    };\n    /**\n     * Invoked when the sort action is completed.\n     */\n    Sort.prototype.sortCompleteHandler = function (args) {\n        var range = getIndexesFromAddress(args.range);\n        this.parent.serviceLocator.getService('cell').refreshRange(range);\n        this.parent.hideSpinner();\n    };\n    return Sort;\n}());\nexport { Sort };\n","import { locale, dialog, mouseDown, renderFilterCell, initiateFilterUI } from '../index';\nimport { reapplyFilter, filterCellKeyDown } from '../index';\nimport { getFilteredColumn, cMenuBeforeOpen, filterByCellValue, clearFilter, getFilterRange, applySort, getCellPosition } from '../index';\nimport { filterRangeAlert, filterComplete, beforeFilter, clearAllFilter, getFilteredCollection } from '../../workbook/common/event';\nimport { getRangeIndexes } from '../../workbook/index';\nimport { getIndexesFromAddress, getSwapRange, getColumnHeaderText } from '../../workbook/index';\nimport { getData, getTypeFromFormat, getCell, getCellIndexes, getRangeAddress, getSheet } from '../../workbook/index';\nimport { getComponent } from '@syncfusion/ej2-base';\nimport { ExcelFilterBase, beforeFltrcMenuOpen, CheckBoxFilterBase } from '@syncfusion/ej2-grids';\nimport { beforeCustomFilterOpen, parentsUntil, filterCboxValue } from '@syncfusion/ej2-grids';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { Query, DataManager } from '@syncfusion/ej2-data';\nimport { beginAction, completeAction } from '../../spreadsheet/index';\n/**\n * `Filter` module is used to handle the filter action in Spreadsheet.\n */\nvar Filter = /** @class */ (function () {\n    /**\n     * Constructor for filter module.\n     */\n    function Filter(parent) {\n        this.parent = parent;\n        this.filterCollection = new Map();\n        this.filterClassList = new Map();\n        this.filterRange = new Map();\n        this.addEventListener();\n    }\n    /**\n     * To destroy the filter module.\n     * @return {void}\n     */\n    Filter.prototype.destroy = function () {\n        this.removeEventListener();\n        this.filterRange = null;\n        this.filterCollection = null;\n        this.filterClassList = null;\n        this.parent = null;\n    };\n    Filter.prototype.addEventListener = function () {\n        this.parent.on(filterRangeAlert, this.filterRangeAlertHandler, this);\n        this.parent.on(initiateFilterUI, this.initiateFilterUIHandler, this);\n        this.parent.on(mouseDown, this.filterMouseDownHandler, this);\n        this.parent.on(renderFilterCell, this.renderFilterCellHandler, this);\n        this.parent.on(clearAllFilter, this.clearAllFilterHandler, this);\n        this.parent.on(beforeFltrcMenuOpen, this.beforeFilterMenuOpenHandler, this);\n        this.parent.on(beforeCustomFilterOpen, this.beforeCustomFilterOpenHandler, this);\n        this.parent.on(reapplyFilter, this.reapplyFilterHandler, this);\n        this.parent.on(filterByCellValue, this.filterByCellValueHandler, this);\n        this.parent.on(clearFilter, this.clearFilterHandler, this);\n        this.parent.on(getFilteredColumn, this.getFilteredColumnHandler, this);\n        this.parent.on(cMenuBeforeOpen, this.cMenuBeforeOpenHandler, this);\n        this.parent.on(filterCboxValue, this.filterCboxValueHandler, this);\n        this.parent.on(getFilterRange, this.getFilterRangeHandler, this);\n        this.parent.on(filterCellKeyDown, this.filterCellKeyDownHandler, this);\n        this.parent.on(getFilteredCollection, this.getFilteredCollection, this);\n    };\n    Filter.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(filterRangeAlert, this.filterRangeAlertHandler);\n            this.parent.off(initiateFilterUI, this.initiateFilterUIHandler);\n            this.parent.off(mouseDown, this.filterMouseDownHandler);\n            this.parent.off(renderFilterCell, this.renderFilterCellHandler);\n            this.parent.off(clearAllFilter, this.clearAllFilterHandler);\n            this.parent.off(beforeFltrcMenuOpen, this.beforeFilterMenuOpenHandler);\n            this.parent.off(beforeCustomFilterOpen, this.beforeCustomFilterOpenHandler);\n            this.parent.off(reapplyFilter, this.reapplyFilterHandler);\n            this.parent.off(filterByCellValue, this.filterByCellValueHandler);\n            this.parent.off(clearFilter, this.clearFilterHandler);\n            this.parent.off(getFilteredColumn, this.getFilteredColumnHandler);\n            this.parent.off(cMenuBeforeOpen, this.cMenuBeforeOpenHandler);\n            this.parent.on(filterCboxValue, this.filterCboxValueHandler);\n            this.parent.off(getFilterRange, this.getFilterRangeHandler);\n            this.parent.off(filterCellKeyDown, this.filterCellKeyDownHandler);\n            this.parent.off(getFilteredCollection, this.getFilteredCollection);\n        }\n    };\n    /**\n     * Gets the module name.\n     * @returns string\n     */\n    Filter.prototype.getModuleName = function () {\n        return 'filter';\n    };\n    /**\n     * Validates the range and returns false when invalid.\n     */\n    Filter.prototype.isInValidFilterRange = function (sheet, range) {\n        var selectedRange = range ? getSwapRange(getIndexesFromAddress(range)) :\n            getSwapRange(getIndexesFromAddress(sheet.selectedRange));\n        return selectedRange[0] > sheet.usedRange.rowIndex || selectedRange[1] > sheet.usedRange.colIndex;\n    };\n    /**\n     * Shows the range error alert dialog.\n     * @param error - range error string.\n     */\n    Filter.prototype.filterRangeAlertHandler = function (args) {\n        var _this = this;\n        var dialogInst = this.parent.serviceLocator.getService(dialog);\n        dialogInst.show({\n            content: args.error, isModal: true,\n            height: 180, width: 400, showCloseIcon: true,\n            beforeOpen: function (args) {\n                var dlgArgs = {\n                    dialogName: 'FilterRangeDialog',\n                    element: args.element, target: args.target, cancel: args.cancel\n                };\n                _this.parent.trigger('dialogBeforeOpen', dlgArgs);\n                if (dlgArgs.cancel) {\n                    args.cancel = true;\n                }\n            },\n        });\n        this.parent.hideSpinner();\n    };\n    /**\n     * Triggers before filter context menu opened and used to add sorting items.\n     */\n    Filter.prototype.beforeFilterMenuOpenHandler = function (args) {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        args.element.classList.add('e-spreadsheet-contextmenu'); // to show sort icons\n        var ul = args.element.querySelector('ul');\n        this.addMenuItem(ul, l10n.getConstant('SortDescending'), 'e-filter-sortdesc', 'e-sort-desc');\n        this.addMenuItem(ul, l10n.getConstant('SortAscending'), 'e-filter-sortasc', 'e-sort-asc');\n        args.element.appendChild(ul);\n    };\n    /**\n     * Creates new menu item element\n     */\n    Filter.prototype.addMenuItem = function (ul, text, className, iconCss) {\n        var li = this.parent.createElement('li', { className: className + ' e-menu-item' });\n        li.innerHTML = text;\n        li.insertBefore(this.parent.createElement('span', { className: 'e-menu-icon e-icons ' + iconCss }), li.firstChild);\n        ul.insertBefore(li, ul.firstChild);\n    };\n    /**\n     * Initiates the filter UI for the selected range.\n     */\n    Filter.prototype.initiateFilterUIHandler = function (args) {\n        var _this = this;\n        var predicates = args ? args.predicates : null;\n        var sheetIdx = args.sIdx;\n        if (!sheetIdx && sheetIdx !== 0) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        if (this.filterRange.size > 0 && this.filterRange.has(sheetIdx)) { //disable filter\n            this.removeFilter(sheetIdx);\n            if (!predicates) {\n                return;\n            }\n        }\n        var sheet = getSheet(this.parent, sheetIdx);\n        if (this.isInValidFilterRange(sheet, args.range)) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            this.filterRangeAlertHandler({ error: l10n.getConstant('FilterOutOfRangeError') });\n            return;\n        }\n        var selectedRange = sheet.selectedRange;\n        var rangeIdx = getRangeIndexes(selectedRange);\n        if (rangeIdx[0] === rangeIdx[2] && rangeIdx[1] === rangeIdx[3]) {\n            rangeIdx[0] = 0;\n            rangeIdx[1] = 1;\n            rangeIdx[2] = sheet.usedRange.rowIndex;\n            rangeIdx[3] = sheet.usedRange.colIndex;\n            selectedRange = getRangeAddress(rangeIdx);\n        }\n        var eventArgs = {\n            range: args.range ? args.range : selectedRange,\n            filterOptions: { predicates: args.predicates }, cancel: false\n        };\n        if (!args.isCut) {\n            this.parent.notify(beginAction, { action: 'filter', eventArgs: eventArgs });\n        }\n        this.processRange(sheet, sheetIdx, args ? args.range : null);\n        if (predicates) {\n            var range = this.filterRange.get(sheetIdx).slice();\n            range[0] = range[0] + 1; // to skip first row.\n            range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n            getData(this.parent, sheet.name + \"!\" + getRangeAddress(range), true, true).then(function (jsonData) {\n                _this.filterSuccessHandler(new DataManager(jsonData), {\n                    action: 'filtering',\n                    filterCollection: predicates, field: predicates[0].field, sIdx: args.sIdx\n                });\n                predicates.forEach(function (predicate) {\n                    if (_this.filterClassList.get(sheetIdx)[predicate.field] &&\n                        _this.filterClassList.get(sheetIdx)[predicate.field].indexOf(' e-filtered') < 0) {\n                        _this.filterClassList.get(sheetIdx)[predicate.field] += ' e-filtered';\n                    }\n                });\n                _this.refreshFilterRange(null, false, args.sIdx);\n            });\n        }\n        if (!args.isCut) {\n            this.parent.notify(completeAction, { action: 'filter', eventArgs: eventArgs });\n        }\n    };\n    /**\n     * Processes the range if no filter applied.\n     */\n    Filter.prototype.processRange = function (sheet, sheetIdx, filterRange) {\n        var range = getSwapRange(getIndexesFromAddress(filterRange || sheet.selectedRange));\n        if (range[0] === range[2] && range[1] === range[3]) { //if selected range is a single cell \n            range[0] = 0;\n            range[1] = 0;\n            range[2] = sheet.usedRange.rowIndex;\n            range[3] = sheet.usedRange.colIndex;\n        }\n        this.filterRange.set(sheetIdx, range);\n        this.filterCollection.set(sheetIdx, []);\n        this.filterClassList.set(sheetIdx, {});\n        this.refreshFilterRange(range, false, sheetIdx);\n    };\n    /**\n     * Removes all the filter related collections for the active sheet.\n     */\n    Filter.prototype.removeFilter = function (sheetIdx) {\n        if (this.filterCollection.get(sheetIdx).length) {\n            this.parent.clearFilter();\n        }\n        var range = this.filterRange.get(sheetIdx).slice();\n        this.filterRange.delete(sheetIdx);\n        this.filterCollection.delete(sheetIdx);\n        this.filterClassList.delete(sheetIdx);\n        this.refreshFilterRange(range, true, sheetIdx);\n    };\n    /**\n     * Handles filtering cell value based on context menu.\n     */\n    Filter.prototype.filterByCellValueHandler = function () {\n        var _this = this;\n        var sheetIdx = this.parent.activeSheetIndex;\n        var sheet = this.parent.getActiveSheet();\n        if (this.isInValidFilterRange(sheet)) {\n            var l10n = this.parent.serviceLocator.getService(locale);\n            this.filterRangeAlertHandler({ error: l10n.getConstant('FilterOutOfRangeError') });\n            return;\n        }\n        var cell = getCellIndexes(sheet.activeCell);\n        if (!this.isFilterRange(sheetIdx, cell[0], cell[1])) {\n            this.processRange(sheet, sheetIdx);\n        }\n        var range = this.filterRange.get(sheetIdx).slice();\n        range[0] = range[0] + 1; // to skip first row.\n        range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n        var field = getColumnHeaderText(cell[1] + 1);\n        var type = this.getColumnType(sheet, cell[1] + 1, range);\n        var predicates = [{\n                field: field,\n                operator: type === 'date' || type === 'datetime' || type === 'boolean' ? 'equal' : 'contains',\n                value: getCell(cell[0], cell[1], sheet).value, matchCase: false, type: type\n            }];\n        getData(this.parent, sheet.name + \"!\" + getRangeAddress(range), true, true).then(function (jsonData) {\n            _this.filterSuccessHandler(new DataManager(jsonData), { action: 'filtering', filterCollection: predicates, field: field });\n        });\n    };\n    /**\n     * Creates filter buttons and renders the filter applied cells.\n     */\n    Filter.prototype.renderFilterCellHandler = function (args) {\n        var sheetIdx = args.sIdx | this.parent.activeSheetIndex;\n        if (this.filterRange.has(sheetIdx) && this.isFilterCell(sheetIdx, args.rowIndex, args.colIndex)) {\n            if (!args.td) {\n                return;\n            }\n            var field = getColumnHeaderText(args.colIndex + 1);\n            if (this.filterClassList.has(sheetIdx) && !this.filterClassList.get(sheetIdx)[field]) {\n                this.filterClassList.get(sheetIdx)[field] = '';\n            }\n            if (args.td.querySelector('.e-filter-btn')) {\n                var element = args.td.querySelector('.e-filter-iconbtn');\n                var filterBtnObj = getComponent(element, 'btn');\n                filterBtnObj.iconCss = 'e-icons e-filter-icon' + this.filterClassList.get(sheetIdx)[field];\n            }\n            else {\n                var filterButton = this.parent.createElement('div', { className: 'e-filter-btn' });\n                var filterBtnObj = new Button({ iconCss: 'e-icons e-filter-icon' + this.filterClassList.get(sheetIdx)[field], cssClass: 'e-filter-iconbtn' });\n                args.td.insertBefore(filterButton, args.td.firstChild);\n                filterBtnObj.createElement = this.parent.createElement;\n                filterBtnObj.appendTo(filterButton);\n            }\n        }\n    };\n    /**\n     * Refreshes the filter header range.\n     */\n    Filter.prototype.refreshFilterRange = function (filterRange, remove, sIdx) {\n        var sheetIdx = sIdx;\n        if (!sheetIdx && sheetIdx !== 0) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var range = filterRange || this.filterRange.get(sheetIdx).slice();\n        for (var index = range[1]; index <= range[3]; index++) {\n            var cell = this.parent.getCell(range[0], index);\n            if (remove) {\n                if (cell && cell.hasChildNodes()) {\n                    var element = cell.querySelector('.e-filter-btn');\n                    if (element) {\n                        cell.removeChild(element);\n                    }\n                }\n            }\n            else {\n                this.renderFilterCellHandler({ td: cell, rowIndex: range[0], colIndex: index, sIdx: sheetIdx });\n            }\n        }\n    };\n    /**\n     * Checks whether the provided cell is a filter cell.\n     */\n    Filter.prototype.isFilterCell = function (sheetIdx, rowIndex, colIndex) {\n        var range = this.filterRange.get(sheetIdx);\n        return (range && range[0] === rowIndex && range[1] <= colIndex && range[3] >= colIndex);\n    };\n    /**\n     * Checks whether the provided cell is in a filter range\n     */\n    Filter.prototype.isFilterRange = function (sheetIdx, rowIndex, colIndex) {\n        var range = this.filterRange.get(sheetIdx);\n        return (range && range[0] <= rowIndex && range[2] >= rowIndex && range[1] <= colIndex && range[3] >= colIndex);\n    };\n    /**\n     * Gets the filter information from active cell\n     */\n    Filter.prototype.getFilteredColumnHandler = function (args) {\n        var sheetIdx = this.parent.activeSheetIndex;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        args.clearFilterText = l10n.getConstant('ClearFilter');\n        if (this.filterRange.has(sheetIdx)) {\n            var filterCollection = this.filterCollection.get(sheetIdx);\n            if (args.isClearAll) {\n                args.isFiltered = filterCollection && filterCollection.length > 0;\n                return;\n            }\n            var range = this.filterRange.get(sheetIdx).slice();\n            var sheet = this.parent.getActiveSheet();\n            var cell = getCellIndexes(sheet.activeCell);\n            if (this.isFilterRange(sheetIdx, cell[0], cell[1])) {\n                args.field = getColumnHeaderText(cell[1] + 1);\n                var headerCell = getCell(range[0], cell[1], sheet);\n                var cellValue = this.parent.getDisplayText(headerCell);\n                args.clearFilterText = l10n.getConstant('ClearFilterFrom') + '\\\"'\n                    + (cellValue ? cellValue.toString() : 'Column ' + args.field) + '\\\"';\n                filterCollection.some(function (value) {\n                    args.isFiltered = value.field === args.field;\n                    return args.isFiltered;\n                });\n            }\n        }\n    };\n    /**\n     * Triggers before context menu created to enable or disable items.\n     */\n    Filter.prototype.cMenuBeforeOpenHandler = function (e) {\n        var id = this.parent.element.id + '_cmenu';\n        if (e.parentItem && e.parentItem.id === id + '_filter' && e.target === '') {\n            var args = { isFiltered: false };\n            this.getFilteredColumnHandler(args);\n            this.parent.enableContextMenuItems([id + '_clearfilter', id + '_reapplyfilter'], !!args.isFiltered, true);\n        }\n    };\n    /**\n     * Closes the filter popup.\n     */\n    Filter.prototype.closeDialog = function () {\n        var filterPopup = this.parent.element.querySelector('.e-filter-popup');\n        var excelFilter = getComponent(filterPopup, 'dialog');\n        if (excelFilter) {\n            excelFilter.hide();\n        }\n    };\n    /**\n     * Returns true if the filter popup is opened.\n     */\n    Filter.prototype.isPopupOpened = function () {\n        var filterPopup = this.parent.element.querySelector('.e-filter-popup');\n        return filterPopup && filterPopup.style.display !== 'none';\n    };\n    Filter.prototype.filterCellKeyDownHandler = function (args) {\n        var sheetIdx = this.parent.activeSheetIndex;\n        var sheet = this.parent.getActiveSheet();\n        var indexes = getCellIndexes(sheet.activeCell);\n        if (this.isFilterCell(sheetIdx, indexes[0], indexes[1])) {\n            args.isFilterCell = true;\n            var pos = getCellPosition(sheet, indexes);\n            var target = this.parent.getCell(indexes[0], indexes[1]);\n            if (this.isPopupOpened()) {\n                this.closeDialog();\n            }\n            this.openDialog(target, pos.left, pos.top);\n        }\n        else {\n            args.isFilterCell = false;\n        }\n    };\n    /**\n     * Opens the filter popup dialog on filter button click.\n     */\n    Filter.prototype.filterMouseDownHandler = function (e) {\n        var target = e.target;\n        if (target.classList.contains('e-filter-icon')) {\n            if (this.isPopupOpened()) {\n                this.closeDialog();\n                return;\n            }\n            this.openDialog(target, e.x, e.y);\n        }\n        else if (this.isPopupOpened()) {\n            if (!target.classList.contains('e-searchinput') && !target.classList.contains('e-searchclear')\n                && (target.offsetParent && !target.offsetParent.classList.contains('e-filter-popup'))) {\n                this.closeDialog();\n            }\n            else {\n                this.selectSortItemHandler(target);\n            }\n        }\n    };\n    /**\n     * Opens the excel filter dialog based on target.\n     */\n    Filter.prototype.openDialog = function (target, xPos, yPos) {\n        var _this = this;\n        var cell = parentsUntil(target, 'e-cell');\n        var colIndex = parseInt(cell.getAttribute('aria-colindex'), 10);\n        var field = getColumnHeaderText(colIndex);\n        //Update datasource dynamically\n        this.parent.showSpinner();\n        var sheetIdx = this.parent.activeSheetIndex;\n        var range = this.filterRange.get(sheetIdx).slice();\n        var sheet = this.parent.getActiveSheet();\n        var filterCell = getCell(range[0], colIndex - 1, sheet);\n        var displayName = this.parent.getDisplayText(filterCell);\n        range[0] = range[0] + 1; // to skip first row.\n        range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n        getData(this.parent, sheet.name + \"!\" + getRangeAddress(range), true, true).then(function (jsonData) {\n            //to avoid undefined array data\n            var checkBoxData;\n            jsonData.some(function (value, index) {\n                if (value) {\n                    checkBoxData = new DataManager(jsonData.slice(index));\n                }\n                return !!value;\n            });\n            var options = {\n                type: _this.getColumnType(sheet, colIndex, range), field: field, displayName: displayName || 'Column ' + field,\n                dataSource: checkBoxData, height: _this.parent.element.classList.contains('e-bigger') ? 800 : 500, columns: [],\n                hideSearchbox: false, filteredColumns: _this.filterCollection.get(sheetIdx), column: { 'field': field, 'filter': {} },\n                handler: _this.filterSuccessHandler.bind(_this, new DataManager(jsonData)), target: target,\n                position: { X: xPos, Y: yPos }, localeObj: _this.parent.serviceLocator.getService(locale)\n            };\n            var excelFilter = new ExcelFilterBase(_this.parent, _this.getLocalizedCustomOperators());\n            excelFilter.openDialog(options);\n            _this.parent.hideSpinner();\n        });\n    };\n    /**\n     * Formats cell value for listing it in filter popup.\n     */\n    Filter.prototype.filterCboxValueHandler = function (args) {\n        if (args.column && args.data) {\n            var fieldKey = 'field';\n            var field = args.column[fieldKey];\n            var dataKey = 'dataObj';\n            var rowKey = '__rowIndex';\n            if (args.value) {\n                var indexes = getCellIndexes(field + args.data[dataKey][rowKey]);\n                var cell = getCell(indexes[0], indexes[1], this.parent.getActiveSheet());\n                if (cell && cell.format) {\n                    args.value = this.parent.getDisplayText(cell);\n                }\n            }\n        }\n    };\n    /**\n     * Triggers when sorting items are chosen on context menu of filter popup.\n     */\n    Filter.prototype.selectSortItemHandler = function (target) {\n        var sortOrder = target.classList.contains('e-filter-sortasc') ? 'Ascending'\n            : target.classList.contains('e-filter-sortdesc') ? 'Descending' : null;\n        if (!sortOrder) {\n            return;\n        }\n        var sheet = this.parent.getActiveSheet();\n        var sheetIdx = this.parent.activeSheetIndex;\n        var range = this.filterRange.get(sheetIdx).slice();\n        range[0] = range[0] + 1; // to skip first row.\n        range[2] = sheet.usedRange.rowIndex; //filter range should be till used range.\n        this.parent.notify(applySort, { sortOptions: { sortDescriptors: { order: sortOrder } }, range: getRangeAddress(range) });\n        var cell = getIndexesFromAddress(sheet.activeCell);\n        var field = getColumnHeaderText(cell[1] + 1);\n        for (var _i = 0, _a = Object.keys(this.filterClassList.get(sheetIdx)); _i < _a.length; _i++) {\n            var key = _a[_i];\n            var className = this.filterClassList.get(sheetIdx)[key].replace(/\\se-sortasc-filter|\\se-sortdesc-filter/gi, '');\n            if (key === field) {\n                className += sortOrder === 'Ascending' ? ' e-sortasc-filter' : ' e-sortdesc-filter';\n            }\n            this.filterClassList.get(sheetIdx)[key] = className;\n        }\n        this.refreshFilterRange();\n        this.closeDialog();\n    };\n    /**\n     * Triggers when OK button or clear filter item is selected\n     */\n    Filter.prototype.filterSuccessHandler = function (dataSource, args) {\n        var sheetIdx = args.sIdx;\n        if (!sheetIdx && sheetIdx !== 0) {\n            sheetIdx = this.parent.activeSheetIndex;\n        }\n        var predicates = this.filterCollection.get(sheetIdx);\n        var dataManager = new DataManager(predicates);\n        var query = new Query();\n        var fields = dataManager.executeLocal(query.where('field', 'equal', args.field));\n        for (var index = 0; index < fields.length; index++) {\n            var sameIndex = -1;\n            for (var filterIndex = 0; filterIndex < predicates.length; filterIndex++) {\n                if (predicates[filterIndex].field === fields[index].field) {\n                    sameIndex = filterIndex;\n                    break;\n                }\n            }\n            if (sameIndex !== -1) {\n                predicates.splice(sameIndex, 1);\n            }\n        }\n        if (args.action === 'filtering') {\n            predicates = predicates.concat(args.filterCollection);\n            if (predicates.length && this.filterClassList.get(sheetIdx)[args.field].indexOf(' e-filtered') < 0) {\n                this.filterClassList.get(sheetIdx)[args.field] += ' e-filtered';\n            }\n        }\n        else {\n            this.filterClassList.get(sheetIdx)[args.field] = this.filterClassList.get(sheetIdx)[args.field].replace(' e-filtered', '');\n        }\n        this.filterCollection.set(sheetIdx, predicates);\n        var filterOptions = {\n            datasource: dataSource,\n            predicates: this.getPredicates(sheetIdx),\n        };\n        this.filterRange.get(sheetIdx)[2] = getSheet(this.parent, sheetIdx).usedRange.rowIndex; //extend the range if filtered\n        this.applyFilter(filterOptions, getRangeAddress(this.filterRange.get(sheetIdx)));\n    };\n    /**\n     * Triggers events for filtering and applies filter.\n     */\n    Filter.prototype.applyFilter = function (filterOptions, range) {\n        var _this = this;\n        var args = { range: range, filterOptions: filterOptions, cancel: false };\n        this.parent.trigger(beforeFilter, args);\n        if (args.cancel) {\n            return;\n        }\n        this.parent.showSpinner();\n        this.parent.filter(filterOptions, range).then(function (args) {\n            _this.refreshFilterRange();\n            _this.parent.hideSpinner();\n            _this.parent.trigger(filterComplete, args);\n            return Promise.resolve(args);\n        }).catch(function (error) {\n            _this.filterRangeAlertHandler({ error: error });\n            return Promise.reject(error);\n        });\n    };\n    /**\n     * Gets the predicates for the sheet\n     */\n    Filter.prototype.getPredicates = function (sheetIdx) {\n        var predicateList = [];\n        var excelPredicate = CheckBoxFilterBase.getPredicate(this.filterCollection.get(sheetIdx));\n        for (var _i = 0, _a = Object.keys(excelPredicate); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            predicateList.push(excelPredicate[prop]);\n        }\n        return predicateList;\n    };\n    /**\n     * Gets the column type to pass it into the excel filter options.\n     */\n    Filter.prototype.getColumnType = function (sheet, colIndex, range) {\n        var num = 0;\n        var str = 0;\n        var date = 0;\n        var time = 0;\n        for (var i = range[0]; i <= sheet.usedRange.rowIndex; i++) {\n            var cell = getCell(i, colIndex - 1, sheet);\n            if (cell) {\n                if (cell.format) {\n                    var type = getTypeFromFormat(cell.format).toLowerCase();\n                    switch (type) {\n                        case 'number':\n                        case 'currency':\n                        case 'accounting':\n                        case 'percentage':\n                            num++;\n                            break;\n                        case 'shortdate':\n                        case 'longdate':\n                            date++;\n                            break;\n                        case 'time':\n                            num++;\n                            break;\n                        default:\n                            str++;\n                            break;\n                    }\n                }\n                else {\n                    if (typeof cell.value === 'string') {\n                        str++;\n                    }\n                    else {\n                        num++;\n                    }\n                }\n            }\n            else {\n                str++;\n            }\n        }\n        return (num > str && num > date && num > time) ? 'number' : (str > num && str > date && str > time) ? 'string'\n            : (date > num && date > str && date > time) ? 'date' : 'datetime';\n    };\n    /**\n     * Triggers before the custom filter dialog opened.\n     */\n    Filter.prototype.beforeCustomFilterOpenHandler = function () {\n        this.closeDialog();\n    };\n    /**\n     * Clears all the filtered columns in the active sheet.\n     */\n    Filter.prototype.clearAllFilterHandler = function () {\n        if (this.filterRange.has(this.parent.activeSheetIndex)) {\n            this.filterCollection.set(this.parent.activeSheetIndex, []);\n            for (var _i = 0, _a = Object.keys(this.filterClassList.get(this.parent.activeSheetIndex)); _i < _a.length; _i++) {\n                var key = _a[_i];\n                this.filterClassList.get(this.parent.activeSheetIndex)[key] = '';\n            }\n            this.refreshFilterRange();\n        }\n    };\n    /**\n     * Clear filter from the field.\n     */\n    Filter.prototype.clearFilterHandler = function (args) {\n        this.filterSuccessHandler(null, { action: 'clear-filter', filterCollection: [], field: args.field });\n    };\n    /**\n     * Reapplies the filter.\n     */\n    Filter.prototype.reapplyFilterHandler = function () {\n        var sheetIdx = this.parent.activeSheetIndex;\n        if (this.filterRange.has(sheetIdx)) {\n            this.applyFilter({ predicates: this.getPredicates(sheetIdx) }, getRangeAddress(this.filterRange.get(sheetIdx)));\n        }\n    };\n    /**\n     * Gets the filter information of the sheet.\n     */\n    Filter.prototype.getFilterRangeHandler = function (args) {\n        var sheetIdx = args.sheetIdx;\n        if (this.filterRange && this.filterRange.has(sheetIdx)) {\n            args.hasFilter = true;\n            args.filterRange = this.filterRange.get(sheetIdx);\n        }\n        else {\n            args.hasFilter = false;\n            args.filterRange = null;\n        }\n    };\n    /**\n     * Returns the custom operators for filter items.\n     */\n    Filter.prototype.getLocalizedCustomOperators = function () {\n        var l10n = this.parent.serviceLocator.getService(locale);\n        var numOptr = [\n            { value: 'equal', text: l10n.getConstant('Equal') },\n            { value: 'greaterthan', text: l10n.getConstant('GreaterThan') },\n            { value: 'greaterthanorequal', text: l10n.getConstant('GreaterThanOrEqual') },\n            { value: 'lessthan', text: l10n.getConstant('LessThan') },\n            { value: 'lessthanorequal', text: l10n.getConstant('LessThanOrEqual') },\n            { value: 'notequal', text: l10n.getConstant('NotEqual') }\n        ];\n        var customOperators = {\n            stringOperator: [\n                { value: 'startswith', text: l10n.getConstant('StartsWith') },\n                { value: 'endswith', text: l10n.getConstant('EndsWith') },\n                { value: 'contains', text: l10n.getConstant('Contains') },\n                { value: 'equal', text: l10n.getConstant('Equal') },\n                { value: 'notequal', text: l10n.getConstant('NotEqual') }\n            ],\n            numberOperator: numOptr,\n            dateOperator: numOptr,\n            datetimeOperator: numOptr,\n            booleanOperator: [\n                { value: 'equal', text: l10n.getConstant('Equal') },\n                { value: 'notequal', text: l10n.getConstant('NotEqual') }\n            ]\n        };\n        return customOperators;\n    };\n    /**\n     * To get filtered range and predicates collections\n     */\n    Filter.prototype.getFilteredCollection = function () {\n        var sheetLen = this.parent.sheets.length;\n        var col = [];\n        var fil;\n        for (var i = 0; i < sheetLen; i++) {\n            var range = void 0;\n            var hasFilter = void 0;\n            var args = { sheetIdx: i, filterRange: range, hasFilter: hasFilter };\n            this.getFilterRangeHandler(args);\n            if (args.hasFilter) {\n                var colCollection = [];\n                var condition = [];\n                var value = [];\n                var type = [];\n                var predicate = this.filterCollection.get(args.sheetIdx);\n                for (var i_1 = 0; i_1 < predicate.length; i_1++) {\n                    if (predicate[i_1].field && predicate[i_1].operator) {\n                        var colIdx = getCellIndexes(predicate[i_1].field + '1')[1];\n                        colCollection.push(colIdx);\n                        condition.push(predicate[i_1].operator);\n                        value.push(predicate[i_1].value);\n                        type.push(predicate[i_1].type);\n                    }\n                }\n                var address = getRangeAddress(args.filterRange);\n                fil = {\n                    sheetIdx: args.sheetIdx, filterRange: address, hasFilter: args.hasFilter, column: colCollection,\n                    criteria: condition, value: value, dataType: type\n                };\n                col.push(fil);\n            }\n        }\n        if (fil) {\n            this.parent.filterCollection = col;\n        }\n    };\n    return Filter;\n}());\nexport { Filter };\n","import { getColIdxFromClientX, createImageElement, deleteImage, refreshImagePosition } from '../common/event';\nimport { insertImage, refreshImgElem, refreshImgCellObj, getRowIdxFromClientY, } from '../common/event';\nimport { overlay, dialog } from '../common/index';\nimport { removeClass } from '@syncfusion/ej2-base';\nimport { getCell, setCell, getSheetIndex } from '../../workbook/index';\nimport { getRangeIndexes, setImage } from '../../workbook/index';\nvar SpreadsheetImage = /** @class */ (function () {\n    function SpreadsheetImage(parent) {\n        this.pictureCount = 1;\n        this.parent = parent;\n        this.addEventListener();\n        this.renderImageUpload();\n    }\n    /**\n     * Adding event listener for success and failure\n     */\n    SpreadsheetImage.prototype.addEventListener = function () {\n        this.parent.on(insertImage, this.insertImage, this);\n        this.parent.on(refreshImgElem, this.refreshImgElem, this);\n        this.parent.on(refreshImgCellObj, this.refreshImgCellObj, this);\n        this.parent.on(createImageElement, this.createImageElement, this);\n        this.parent.on(deleteImage, this.deleteImage, this);\n        this.parent.on(refreshImagePosition, this.refreshInsDelImagePosition, this);\n    };\n    /**\n     * Rendering upload component for importing images.\n     */\n    SpreadsheetImage.prototype.renderImageUpload = function () {\n        var uploadID = this.parent.element.id + '_imageUpload';\n        this.parent.element.appendChild(this.parent.createElement('input', {\n            id: uploadID,\n            attrs: { type: 'file', accept: '.image, .jpg, .png, .gif ,jpeg', name: 'fileUpload' }\n        }));\n        var uploadBox = document.getElementById(uploadID);\n        uploadBox.onchange = this.imageSelect.bind(this);\n        uploadBox.style.display = 'none';\n    };\n    /**\n     * Process after select the excel and image file.\n     * @param {Event} args - File select native event.\n     */\n    SpreadsheetImage.prototype.imageSelect = function (args) {\n        /* tslint:disable-next-line:no-any */\n        var filesData = args.target.files[0];\n        if (filesData && filesData.length < 1) {\n            return;\n        }\n        var impArgs = {\n            file: filesData\n        };\n        /* tslint:disable-next-line:no-any */\n        if (impArgs.file.type.indexOf('image') === 0) {\n            this.insertImage(impArgs);\n        }\n        else {\n            this.parent.serviceLocator.getService(dialog).show({\n                content: this.parent.serviceLocator.getService('spreadsheetLocale')\n                    .getConstant('UnsupportedFile'),\n                width: '300'\n            });\n        }\n        document.getElementById(this.parent.element.id + '_imageUpload').value = '';\n    };\n    /**\n     * Removing event listener for success and failure\n     */\n    SpreadsheetImage.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(insertImage, this.insertImage);\n            this.parent.off(refreshImgCellObj, this.refreshImgCellObj);\n            this.parent.off(createImageElement, this.createImageElement);\n            this.parent.off(deleteImage, this.deleteImage);\n            this.parent.off(refreshImagePosition, this.refreshInsDelImagePosition);\n        }\n    };\n    // tslint:disable\n    SpreadsheetImage.prototype.insertImage = function (args, range) {\n        var _this = this;\n        this.binaryStringVal(args).then(function (src) { return _this.createImageElement({ options: { src: src }, range: range, isPublic: true }); });\n    };\n    SpreadsheetImage.prototype.binaryStringVal = function (args) {\n        return new Promise(function (resolve, reject) {\n            var reader = new FileReader();\n            reader.readAsDataURL(args.file);\n            reader.onload = function () { return resolve(reader.result); };\n            reader.onerror = function (error) { return reject(error); };\n        });\n    };\n    // tslint:enable\n    SpreadsheetImage.prototype.createImageElement = function (args) {\n        var range = args.range ? (args.range.indexOf('!') > 0) ? args.range.split('!')[1] : args.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var sheetIndex = (args.range && args.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, args.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var overlayObj = this.parent.serviceLocator.getService(overlay);\n        var id = args.options.imageId ? args.options.imageId : this.parent.element.id + '_overlay_picture_' + this.pictureCount;\n        var indexes = getRangeIndexes(range);\n        var sheet = sheetIndex ? this.parent.sheets[sheetIndex] : this.parent.getActiveSheet();\n        if (document.getElementById(id)) {\n            return;\n        }\n        var eventArgs = {\n            requestType: 'beforeInsertImage', range: sheet.name + '!' + range,\n            imageData: args.options.src, sheetIndex: sheetIndex\n        };\n        if (args.isPublic) {\n            this.parent.notify('actionBegin', { eventArgs: eventArgs, action: 'beforeInsertImage' });\n        }\n        if (eventArgs.cancel) {\n            return;\n        }\n        var element = overlayObj.insertOverlayElement(id, range, sheetIndex);\n        element.style.backgroundImage = 'url(\\'' + args.options.src + '\\')';\n        if (args.options.height || args.options.left) {\n            element.style.height = args.options.height + 'px';\n            element.style.width = args.options.width + 'px';\n            element.style.top = args.options.top + 'px';\n            element.style.left = args.options.left + 'px';\n        }\n        if (!args.options.imageId) {\n            this.pictureCount++;\n        }\n        var imgData = {\n            src: args.options.src, id: id, height: parseFloat(element.style.height.replace('px', '')),\n            width: parseFloat(element.style.width.replace('px', '')), top: parseFloat(element.style.top.replace('px', '')),\n            left: parseFloat(element.style.left.replace('px', ''))\n        };\n        this.parent.setUsedRange(indexes[0], indexes[1]);\n        if (args.isPublic || args.isUndoRedo) {\n            this.parent.notify(setImage, { options: [imgData], range: sheet.name + '!' + range });\n        }\n        var currCell = getCell(indexes[0], indexes[1], sheet);\n        if (!currCell.image[currCell.image.length - 1].id) {\n            currCell.image[currCell.image.length - 1].id = imgData.id;\n        }\n        eventArgs = {\n            requestType: 'insertImage', range: sheet.name + '!' + range, imageHeight: args.options.height ? args.options.height : 300,\n            imageWidth: args.options.width ? args.options.width : 400, imageData: args.options.src, id: id, sheetIndex: sheetIndex\n        };\n        if (!args.isUndoRedo && args.isPublic) {\n            this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'insertImage' });\n        }\n    };\n    SpreadsheetImage.prototype.refreshImgElem = function () {\n        var overlayElem = document.getElementsByClassName('e-ss-overlay-active')[0];\n        if (overlayElem) {\n            removeClass([overlayElem], 'e-ss-overlay-active');\n        }\n    };\n    SpreadsheetImage.prototype.refreshInsDelImagePosition = function (args) {\n        var count = args.count;\n        var sheetIdx = args.sheetIdx;\n        var sheet = this.parent.sheets[sheetIdx];\n        var pictureElements;\n        var currCellObj = getCell(args.rowIdx, args.colIdx, sheet);\n        var imageLen = currCellObj.image.length;\n        var top;\n        var left;\n        for (var i = 0; i < imageLen; i++) {\n            pictureElements = document.getElementById(currCellObj.image[i].id);\n            top = (args.type === 'Row') ? (args.status === 'insert') ? currCellObj.image[i].top + (count * 20) :\n                currCellObj.image[i].top - (count * 20) : currCellObj.image[i].top;\n            left = (args.type === 'Column') ? (args.status === 'insert') ? currCellObj.image[i].left + (count * 64) :\n                currCellObj.image[i].left - (count * 64) : currCellObj.image[i].left;\n            currCellObj.image[i].top = top;\n            currCellObj.image[i].left = left;\n            pictureElements.style.top = top + 'px';\n            pictureElements.style.left = left + 'px';\n        }\n    };\n    SpreadsheetImage.prototype.refreshImgCellObj = function (args) {\n        var prevRowIdx = { clientY: args.prevTop, isImage: true };\n        this.parent.notify(getRowIdxFromClientY, prevRowIdx);\n        var currRowIdx = { clientY: args.currentTop, isImage: true };\n        this.parent.notify(getRowIdxFromClientY, currRowIdx);\n        var prevColIdx = { clientX: args.prevLeft, isImage: true };\n        this.parent.notify(getColIdxFromClientX, prevColIdx);\n        var currColIdx = { clientX: args.currentLeft, isImage: true };\n        this.parent.notify(getColIdxFromClientX, currColIdx);\n        var sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        var prevCellObj = getCell(prevRowIdx.clientY, prevColIdx.clientX, sheet);\n        var currCellObj = getCell(currRowIdx.clientY, currColIdx.clientX, sheet);\n        var prevCellImg = prevCellObj ? prevCellObj.image : [];\n        var prevImgObj;\n        var currImgObj;\n        var prevCellImgLen = (prevCellImg && prevCellImg.length) ? prevCellImg.length : 0;\n        if (prevCellObj && prevCellObj.image && prevCellImg.length > 0) {\n            for (var i = 0; i < prevCellImgLen; i++) {\n                if (prevCellImg[i].id === args.id) {\n                    prevImgObj = prevCellImg[i];\n                    prevImgObj.height = args.currentHeight;\n                    prevImgObj.width = args.currentWidth;\n                    prevImgObj.top = args.currentTop;\n                    prevImgObj.left = args.currentLeft;\n                    prevCellImg.splice(i, 1);\n                }\n            }\n            if (currCellObj && currCellObj.image) {\n                currImgObj = currCellObj.image;\n                if (prevImgObj) {\n                    currImgObj.push(prevImgObj);\n                }\n            }\n            (currImgObj) ? setCell(currRowIdx.clientY, currColIdx.clientX, sheet, { image: currImgObj }, true) :\n                setCell(currRowIdx.clientY, currColIdx.clientX, sheet, { image: [prevImgObj] }, true);\n            if (args.requestType === 'imageRefresh' && !args.isUndoRedo) {\n                var eventArgs = {\n                    requestType: 'imageRefresh', currentRowIdx: currRowIdx.clientY, currentColIdx: currColIdx.clientX,\n                    prevRowIdx: prevRowIdx.clientY, prevColIdx: prevColIdx.clientX, prevTop: args.prevTop, prevLeft: args.prevLeft,\n                    currentTop: args.currentTop, currentLeft: args.currentLeft, currentHeight: args.currentHeight,\n                    currentWidth: args.currentWidth, prevHeight: args.prevHeight, prevWidth: args.prevWidth,\n                    id: args.id, sheetIdx: this.parent.activeSheetIndex\n                };\n                this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'imageRefresh' });\n            }\n        }\n    };\n    SpreadsheetImage.prototype.deleteImage = function (args) {\n        var sheet;\n        var pictureElements = document.getElementById(args.id);\n        var rowIdx;\n        var colIdx;\n        var cellObj;\n        var prevCellImg;\n        var imgLength;\n        if (pictureElements) {\n            var imgTop = { clientY: pictureElements.offsetTop, isImage: true };\n            this.parent.notify(getRowIdxFromClientY, imgTop);\n            var imgleft = { clientX: pictureElements.offsetLeft, isImage: true };\n            this.parent.notify(getColIdxFromClientX, imgleft);\n            document.getElementById(args.id).remove();\n            rowIdx = imgTop.clientY;\n            colIdx = imgleft.clientX;\n            sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        }\n        else {\n            var rangeVal = args.range ? args.range.indexOf('!') > 0 ? args.range.split('!')[1] : args.range.split('!')[0] :\n                this.parent.getActiveSheet().selectedRange;\n            var sheetIndex = args.range && args.range.indexOf('!') > 0 ? getSheetIndex(this.parent, args.range.split('!')[0]) :\n                this.parent.activeSheetIndex;\n            var index = getRangeIndexes(rangeVal);\n            rowIdx = index[0];\n            colIdx = index[1];\n            sheet = this.parent.sheets[sheetIndex];\n        }\n        cellObj = getCell(rowIdx, colIdx, sheet);\n        prevCellImg = cellObj.image;\n        imgLength = prevCellImg.length;\n        for (var i = 0; i < imgLength; i++) {\n            if (prevCellImg[i].id === args.id) {\n                prevCellImg.splice(i, 1);\n            }\n        }\n        setCell(rowIdx, colIdx, sheet, { image: prevCellImg }, true);\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    SpreadsheetImage.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    /**\n     * Get the sheet picture module name.\n     */\n    SpreadsheetImage.prototype.getModuleName = function () {\n        return 'spreadsheetImage';\n    };\n    return SpreadsheetImage;\n}());\nexport { SpreadsheetImage };\n","import { getSheetIndex, isHiddenRow, getCell, setCell } from '../../workbook/base/index';\nimport { initiateChart, getRangeIndexes, isNumber, isDateTime, dateToInt } from '../../workbook/common/index';\nimport { overlay, locale, refreshChartCellObj, getRowIdxFromClientY, getColIdxFromClientX, deleteChart } from '../common/index';\nimport { beginAction, completeAction, clearChartBorder, focusBorder } from '../common/index';\nimport { Chart, ColumnSeries, Category, StackingColumnSeries, BarSeries } from '@syncfusion/ej2-charts';\nimport { AreaSeries, StackingAreaSeries, AccumulationChart } from '@syncfusion/ej2-charts';\nimport { Legend, StackingBarSeries, LineSeries, StackingLineSeries, ScatterSeries } from '@syncfusion/ej2-charts';\nimport { AccumulationLegend, PieSeries, AccumulationTooltip, AccumulationDataLabel } from '@syncfusion/ej2-charts';\nimport { isNullOrUndefined, getComponent, closest, detach } from '@syncfusion/ej2-base';\nimport { Tooltip } from '@syncfusion/ej2-popups';\nimport { getTypeFromFormat } from '../../workbook/integrations/index';\nimport { updateChart, deleteChartColl, getFormattedCellObject, setChart, getCellAddress } from '../../workbook/common/index';\nimport { insertChart, chartRangeSelection } from '../common/index';\nChart.Inject(ColumnSeries, LineSeries, BarSeries, AreaSeries, StackingColumnSeries, StackingLineSeries, StackingBarSeries, ScatterSeries);\nChart.Inject(StackingAreaSeries, Category, Legend, Tooltip);\nAccumulationChart.Inject(PieSeries, AccumulationTooltip, AccumulationDataLabel, AccumulationLegend);\n/**\n * Represents Chart support for Spreadsheet.\n */\nvar SpreadsheetChart = /** @class */ (function () {\n    /**\n     * Constructor for the Spreadsheet Chart module.\n     */\n    function SpreadsheetChart(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * Adding event listener for success and failure\n     */\n    SpreadsheetChart.prototype.addEventListener = function () {\n        this.parent.on(initiateChart, this.initiateChartHandler, this);\n        this.parent.on(refreshChartCellObj, this.refreshChartCellObj, this);\n        this.parent.on(updateChart, this.updateChartHandler, this);\n        this.parent.on(deleteChart, this.deleteChart, this);\n        this.parent.on(clearChartBorder, this.clearBorder, this);\n        this.parent.on(insertChart, this.insertChartHandler, this);\n        this.parent.on(chartRangeSelection, this.chartRangeHandler, this);\n    };\n    SpreadsheetChart.prototype.insertChartHandler = function (args) {\n        var chartType = 'Column';\n        switch (args.id) {\n            case 'clusteredColumn':\n                chartType = 'Column';\n                break;\n            case 'stackedColumn':\n                chartType = 'StackingColumn';\n                break;\n            case 'stackedColumn100':\n                chartType = 'StackingColumn100';\n                break;\n            case 'clusteredBar':\n                chartType = 'Bar';\n                break;\n            case 'stackedBar':\n                chartType = 'StackingBar';\n                break;\n            case 'stackedBar100':\n                chartType = 'StackingBar100';\n                break;\n            case 'area':\n                chartType = 'Area';\n                break;\n            case 'stackedArea':\n                chartType = 'StackingArea';\n                break;\n            case 'stackedArea100':\n                chartType = 'StackingArea100';\n                break;\n            case 'line':\n                chartType = 'Line';\n                break;\n            case 'stackedLine':\n                chartType = 'StackingLine';\n                break;\n            case 'stackedLine100':\n                chartType = 'StackingLine100';\n                break;\n            case 'pie':\n                chartType = 'Pie';\n                break;\n            case 'doughnut':\n                chartType = 'Doughnut';\n                break;\n            //  case 'radar':\n            //     chartType = ;\n            //     break;\n            //  case 'radar_markers':\n            //     chartType = 'Column';\n            //     break;\n            case 'scatter':\n                chartType = 'Scatter';\n                break;\n        }\n        var chart = [{ type: chartType }];\n        this.parent.notify(setChart, { chart: chart });\n    };\n    SpreadsheetChart.prototype.chartRangeHandler = function () {\n        var overlayEle = document.querySelector('.e-datavisualization-chart.e-ss-overlay-active');\n        if (overlayEle) {\n            var chartId = overlayEle.getElementsByClassName('e-control')[0].id;\n            var chartColl = this.parent.chartColl;\n            var chartCollLen = chartColl.length;\n            for (var idx = 0; idx < chartCollLen; idx++) {\n                var chartEle = document.getElementById(chartColl[idx].id);\n                if (overlayEle && chartEle && chartColl[idx].id === chartId) {\n                    this.parent.notify(initiateChart, {\n                        option: chartColl[idx], chartCount: this.parent.chartCount, isRefresh: true\n                    });\n                }\n            }\n        }\n    };\n    SpreadsheetChart.prototype.getPropertyValue = function (rIdx, cIdx, sheetIndex) {\n        var sheets = this.parent.sheets;\n        if (sheets[sheetIndex] && sheets[sheetIndex].rows[rIdx] && sheets[sheetIndex].rows[rIdx].cells[cIdx]) {\n            var cell = getCell(rIdx, cIdx, this.parent.sheets[sheetIndex]);\n            var value = '';\n            if (cell.format) {\n                var formatObj = {\n                    type: getTypeFromFormat(cell.format),\n                    value: cell && cell.value, format: cell && cell.format ?\n                        cell.format : 'General', formattedText: cell && cell.value,\n                    onLoad: true, isRightAlign: false, cell: cell,\n                    rowIdx: rIdx.toString(), colIdx: cIdx.toString()\n                };\n                if (cell) {\n                    this.parent.notify(getFormattedCellObject, formatObj);\n                    if (typeof (formatObj.value) === 'number') {\n                        var escapeRegx = new RegExp('[!@#$%^&()+=\\';,{}|\\\":<>~_-]', 'g');\n                        formatObj.formattedText = (formatObj.formattedText.toString()).replace(escapeRegx, '');\n                        value = parseInt(formatObj.formattedText.toString(), 10);\n                    }\n                    else {\n                        value = formatObj.formattedText.toString();\n                        parseFloat('');\n                    }\n                }\n            }\n            else {\n                value = this.parent.sheets[sheetIndex].rows[rIdx].cells[cIdx].value;\n            }\n            value = isNullOrUndefined(value) ? '' : value;\n            return value;\n        }\n        else {\n            return '';\n        }\n    };\n    SpreadsheetChart.prototype.updateChartHandler = function (args) {\n        var series = this.initiateChartHandler({ option: args.chart, isRefresh: true });\n        var chartObj = this.parent.element.querySelector('.' + args.chart.id);\n        if (chartObj) {\n            var chartComp = getComponent(chartObj, 'chart');\n            chartComp.series = series;\n        }\n    };\n    SpreadsheetChart.prototype.refreshChartCellObj = function (args) {\n        var currRowIdx = { clientY: args.currentTop, isImage: true };\n        this.parent.notify(getRowIdxFromClientY, currRowIdx);\n        var prevRowIdx = { clientY: args.prevTop, isImage: true };\n        this.parent.notify(getRowIdxFromClientY, prevRowIdx);\n        var currColIdx = { clientX: args.currentLeft, isImage: true };\n        this.parent.notify(getColIdxFromClientX, currColIdx);\n        var prevColIdx = { clientX: args.prevLeft, isImage: true };\n        this.parent.notify(getColIdxFromClientX, prevColIdx);\n        var sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        var prevCellObj = getCell(prevRowIdx.clientY, prevColIdx.clientX, sheet);\n        var currCellObj = getCell(currRowIdx.clientY, currColIdx.clientX, sheet);\n        var prevCellChart = prevCellObj ? prevCellObj.chart : [];\n        var prevChartObj;\n        var currChartObj;\n        var prevCellImgLen = (prevCellChart && prevCellChart.length) ? prevCellChart.length : 0;\n        if (prevCellObj && prevCellObj.chart) {\n            for (var i = 0; i < prevCellImgLen; i++) {\n                var overlayEle = document.getElementsByClassName('e-datavisualization-chart e-ss-overlay-active')[0];\n                var chartEleClassName = document.getElementById(prevCellChart[i].id);\n                if (closest(chartEleClassName, '.' + overlayEle.classList[1]) === overlayEle) {\n                    prevChartObj = prevCellChart[i];\n                    prevChartObj.height = args.currentHeight;\n                    prevChartObj.width = args.currentWidth;\n                    prevChartObj.top = args.currentTop;\n                    prevChartObj.left = args.currentLeft;\n                    prevCellChart.splice(i, 1);\n                }\n            }\n            if (currCellObj && currCellObj.chart) {\n                currChartObj = currCellObj.chart;\n                if (prevChartObj) {\n                    currChartObj.push(prevChartObj);\n                }\n            }\n            (currChartObj) ? setCell(currRowIdx.clientY, currColIdx.clientX, sheet, { chart: currChartObj }, true) :\n                setCell(currRowIdx.clientY, currColIdx.clientX, sheet, { chart: [prevChartObj] }, true);\n            if (args.requestType === 'chartRefresh' && !args.isUndoRedo) {\n                var eventArgs = {\n                    requestType: 'chartRefresh', currentRowIdx: currRowIdx.clientY, currentColIdx: currColIdx.clientX,\n                    currentWidth: args.currentWidth, prevHeight: args.prevHeight, prevWidth: args.prevWidth,\n                    prevRowIdx: prevRowIdx.clientY, prevColIdx: prevColIdx.clientX, prevTop: args.prevTop, prevLeft: args.prevLeft,\n                    currentTop: args.currentTop, currentLeft: args.currentLeft, currentHeight: args.currentHeight,\n                    id: args.id, sheetIdx: this.parent.activeSheetIndex\n                };\n                this.parent.notify('actionComplete', { eventArgs: eventArgs, action: 'chartRefresh' });\n            }\n        }\n    };\n    SpreadsheetChart.prototype.processChartRange = function (range, dataSheetIdx, opt) {\n        var xRange;\n        var yRange;\n        var lRange;\n        var trVal;\n        var blVal;\n        var tlVal;\n        var minr = range[0];\n        var minc = range[1];\n        var isStringSeries = false;\n        var maxr = range[2];\n        var maxc = range[3];\n        var isSingleRow = minr === maxr;\n        var isSingleCol = minc === maxc;\n        trVal = this.getPropertyValue(minr, maxc, dataSheetIdx);\n        // trVal = this.getParseValue(trVal);\n        blVal = this.getPropertyValue(maxr, minc, dataSheetIdx);\n        // blVal = this.getParseValue(blVal);\n        tlVal = this.getPropertyValue(minr, minc, dataSheetIdx);\n        // tlVal = this.getParseValue(tlVal);\n        if (!isNumber(blVal) || !tlVal) {\n            isStringSeries = true;\n        }\n        if (isNullOrUndefined(tlVal) && !isSingleRow && !isSingleCol || (opt.type === 'Scatter' && range[3] - range[1] === 1)) {\n            xRange = [minr + 1, minc, maxr, minc];\n            yRange = [minr + 1, minc + 1, maxr, maxc];\n            lRange = [minr, minc + 1, minr, maxc];\n        }\n        else if ((!isNullOrUndefined(blVal) && isStringSeries && !isSingleRow && !isSingleCol)) {\n            if (!isNullOrUndefined(trVal) && (!isNumber(trVal) || !tlVal)) {\n                xRange = [minr + 1, minc, maxr, minc];\n                yRange = [minr + 1, minc + 1, maxr, maxc];\n                lRange = [minr, minc + 1, minr, maxc];\n            }\n            else {\n                xRange = [minr, minc, maxr, minc];\n                yRange = [minr, minc + 1, maxr, maxc];\n            }\n        }\n        else {\n            yRange = [minr, minc, maxr, maxc];\n            if ((!isNullOrUndefined(trVal) && !isNumber(trVal) && !isDateTime(trVal))) {\n                lRange = [minr, minc, minr, maxc];\n                yRange[0] = yRange[0] + 1;\n            }\n            else if (isNullOrUndefined(tlVal) && (isSingleRow || isSingleCol)) {\n                lRange = [minr, minc, minr, maxc];\n                if (isSingleRow) {\n                    yRange[1] = yRange[1] + 1;\n                    lRange[3] = lRange[1];\n                }\n                else {\n                    yRange[0] = yRange[0] + 1;\n                }\n            }\n        }\n        return { xRange: xRange, yRange: yRange, lRange: lRange };\n    };\n    SpreadsheetChart.prototype.toIntrnlRange = function (range, sheetIdx) {\n        if (!range) {\n            range = getRangeIndexes[this.parent.sheets[sheetIdx].selectedRange];\n        }\n        else if (typeof (range) === 'string') {\n            range = getRangeIndexes[range];\n        }\n        return range;\n    };\n    SpreadsheetChart.prototype.getRangeData = function (options) {\n        options.sheetIdx = isNullOrUndefined(options.sheetIdx) ? this.parent.getActiveSheet().index : options.sheetIdx;\n        var sheet = this.parent.sheets[options.sheetIdx];\n        options.range = this.toIntrnlRange(options.range, options.sheetIdx);\n        var minc;\n        var minr;\n        var maxr;\n        var maxc;\n        var skipVirtualHiddenRow;\n        var isRowHidden;\n        var rowIdx = [];\n        var arr = [];\n        skipVirtualHiddenRow = false;\n        minr = options.range[0];\n        maxr = options.range[2];\n        maxc = options.range[3];\n        isRowHidden = isHiddenRow(sheet, minr);\n        if (skipVirtualHiddenRow && isRowHidden) {\n            maxr++;\n        }\n        else if (!isRowHidden) {\n            minc = skipVirtualHiddenRow ? 0 : options.range[1];\n            this.pushRowData(options, minr, minc, maxr, maxc, arr, rowIdx, true, options.isYvalue);\n        }\n        return arr;\n    };\n    SpreadsheetChart.prototype.pushRowData = function (options, minr, minc, maxr, maxc, arr, rowIdx, isDataSrcEnsured, isYvalue) {\n        var minCol = minc;\n        while (minr <= maxr) {\n            minc = minCol;\n            while (minc <= maxc) {\n                var value = '';\n                var cell = getCell(minr, minc, this.parent.getActiveSheet());\n                if (cell && cell.format && !isYvalue) {\n                    var forArgs = {\n                        value: cell && cell.value, format: cell && cell.format ? cell.format : 'General',\n                        formattedText: cell && cell.value, onLoad: true,\n                        type: cell && getTypeFromFormat(cell.format),\n                        rowIdx: minr.toString(), colIdx: minc.toString(),\n                        isRightAlign: false, cell: cell,\n                    };\n                    this.parent.notify(getFormattedCellObject, forArgs);\n                    value = forArgs.formattedText.toString();\n                }\n                else {\n                    value = this.parent.getValueRowCol(options.sheetIdx, minr + 1, minc + 1);\n                }\n                // = this.parent.getValueRowCol(options.sheetIdx, minr + 1, minc + 1);\n                arr.push({ value: value });\n                minc++;\n            }\n            minr++;\n        }\n        rowIdx.push(minr);\n    };\n    SpreadsheetChart.prototype.toArrayData = function (args) {\n        var prop = 'value';\n        var obj;\n        var i = 0;\n        var temp = [];\n        var len = args.length;\n        while (i < len) {\n            obj = args[i];\n            if (Object.keys(obj).length) {\n                if (prop in obj) {\n                    temp.push(obj[prop]);\n                }\n            }\n            else {\n                temp.push('');\n            }\n            i++;\n        }\n        return temp;\n    };\n    SpreadsheetChart.prototype.getVirtualXValues = function (limit) {\n        var i = 1;\n        var arr = [];\n        while (i < limit) {\n            arr.push(i.toString());\n            i++;\n        }\n        return arr;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    SpreadsheetChart.prototype.processChartSeries = function (options, sheetIndex, xRange, yRange, lRange) {\n        options = options || {};\n        var seriesName = '';\n        var val;\n        var len;\n        var xValue;\n        var yValue;\n        var lValue;\n        var diff;\n        var pArr;\n        var pObj = {};\n        var j;\n        var inc;\n        var i = 0;\n        var yInc = 0;\n        var sArr = [];\n        var tArr = ['value2'];\n        var dtVal;\n        yValue = this.getRangeData({ range: yRange, sheetIdx: sheetIndex, skipFormula: true, isYvalue: true });\n        var rDiff = (yRange[2] - yRange[0]) + 1;\n        var cDiff = (yRange[3] - yRange[1]) + 1;\n        if (options.isSeriesInRows) {\n            xValue = lRange ? this.toArrayData(this.getRangeData({ range: lRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false })) :\n                this.getVirtualXValues(cDiff + 1);\n            if (xRange) {\n                lValue = this.toArrayData(this.getRangeData({ range: xRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false }));\n            }\n            diff = rDiff;\n        }\n        else {\n            xValue = xRange ? this.toArrayData(this.getRangeData({ range: xRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false })) :\n                this.getVirtualXValues(rDiff + 1);\n            if (lRange) {\n                lValue = this.toArrayData(this.getRangeData({ range: lRange, sheetIdx: sheetIndex, skipFormula: false, isYvalue: false }));\n            }\n            diff = cDiff;\n        }\n        len = xValue.length;\n        inc = options.isSeriesInRows ? 1 : diff;\n        while (i < diff) {\n            j = 0;\n            pArr = [];\n            yInc = options.isSeriesInRows ? yInc : i;\n            while (j < len) {\n                if (yValue[yInc]) {\n                    val = yValue[yInc].value;\n                    if (isNumber(val)) {\n                        val = Number(val);\n                    }\n                    else {\n                        dtVal = dateToInt(val);\n                        val = isNaN(dtVal) ? 0 : dtVal;\n                    }\n                    pArr.push({ x: xValue[j], y: val });\n                }\n                yInc += inc;\n                j++;\n            }\n            if (lValue && lValue.length > 0) {\n                seriesName = lValue[i];\n            }\n            else {\n                seriesName = 'series' + i;\n            }\n            if (options.type) {\n                var type = options.type;\n                if (type === 'Line' || type === 'StackingLine' || type === 'StackingLine100') {\n                    pObj = {\n                        dataSource: pArr, type: options.type, xName: 'x', yName: 'y', name: seriesName.toString(), marker: {\n                            visible: true,\n                            width: 10,\n                            height: 10\n                        }\n                    };\n                }\n                else if (type === 'Scatter') {\n                    pObj = {\n                        dataSource: pArr, type: options.type, xName: 'x', yName: 'y', name: seriesName.toString(), marker: {\n                            visible: false,\n                            width: 12,\n                            height: 12,\n                            shape: 'Circle'\n                        }\n                    };\n                }\n                else if (type === 'Pie' || type === 'Doughnut') {\n                    var innerRadius = options.type === 'Pie' ? '0%' : '40%';\n                    pObj = {\n                        dataSource: pArr,\n                        dataLabel: {\n                            visible: true, position: 'Inside', name: 'text', font: { fontWeight: '600' }\n                        },\n                        radius: '100%', xName: 'x', yName: 'y', startAngle: 0, endAngle: 360, innerRadius: innerRadius, explode: true,\n                        explodeOffset: '10%', explodeIndex: 0, name: 'Browser'\n                    };\n                }\n                else {\n                    pObj = { dataSource: pArr, type: options.type, xName: 'x', yName: 'y', name: seriesName.toString() };\n                }\n            }\n            sArr.push(pObj);\n            i++;\n        }\n        var retVal;\n        if (options.type) {\n            var type = options.type;\n            retVal = {\n                series: sArr, xRange: options.isSeriesInRows ? lRange : xRange,\n                yRange: yRange, lRange: options.isSeriesInRows ? xRange : lRange\n            };\n        }\n        return retVal;\n    };\n    SpreadsheetChart.prototype.primaryYAxisFormat = function (yRange) {\n        if (isNullOrUndefined(yRange)) {\n            return '{value}';\n        }\n        var type;\n        var cell = getCell(yRange[0], yRange[1], this.parent.getActiveSheet());\n        if (cell && cell.format) {\n            type = getTypeFromFormat(cell.format);\n            if (type === 'Accounting') {\n                return '${value}';\n            }\n            else if (type === 'Currency') {\n                return '${value}';\n            }\n            else if (type === 'Percentage') {\n                return '{value}%';\n            }\n        }\n        return '{value}';\n    };\n    SpreadsheetChart.prototype.focusChartRange = function (xRange, yRange, lRange) {\n        var border = ['e-rcborderright', 'e-rcborderbottom', 'e-vcborderright', 'e-vcborderbottom', 'e-bcborderright', 'e-bcborderbottom'];\n        this.clearBorder();\n        if (lRange) {\n            this.parent.notify(focusBorder, {\n                startcell: { rowIndex: lRange[0], colIndex: lRange[1] },\n                endcell: { rowIndex: lRange[2], colIndex: lRange[3] }, classes: [border[0], border[1]]\n            });\n        }\n        if (xRange) {\n            this.parent.notify(focusBorder, {\n                startcell: { rowIndex: xRange[0], colIndex: xRange[1] },\n                endcell: { rowIndex: xRange[2], colIndex: xRange[3] }, classes: [border[2], border[3]]\n            });\n        }\n        this.parent.notify(focusBorder, {\n            startcell: { rowIndex: yRange[0], colIndex: yRange[1] },\n            endcell: { rowIndex: yRange[2], colIndex: yRange[3] }, classes: [border[4], border[5]]\n        });\n    };\n    SpreadsheetChart.prototype.clearBorder = function () {\n        var mainCont = this.parent.getMainContent();\n        var border = ['e-rcborderright', 'e-rcborderbottom', 'e-vcborderright', 'e-vcborderbottom', 'e-bcborderright', 'e-bcborderbottom'];\n        for (var borderIdx = 0; borderIdx < border.length; borderIdx++) {\n            var eleColl = mainCont.querySelectorAll('.' + border[borderIdx]);\n            for (var tdIdx = 0; tdIdx < eleColl.length; tdIdx++) {\n                var td = eleColl[tdIdx];\n                td.classList.remove(border[borderIdx]);\n            }\n        }\n    };\n    // tslint:disable-next-line:max-func-body-length\n    SpreadsheetChart.prototype.initiateChartHandler = function (argsOpt) {\n        var isRangeSelect = true;\n        isRangeSelect = isNullOrUndefined(argsOpt.isInitCell) ? true : !argsOpt.isInitCell;\n        var l10n = this.parent.serviceLocator.getService(locale);\n        argsOpt.isUndoRedo = isNullOrUndefined(argsOpt.isUndoRedo) ? true : argsOpt.isUndoRedo;\n        var seriesModel;\n        argsOpt.isRefresh = isNullOrUndefined(argsOpt.isRefresh) ? false : argsOpt.isRefresh;\n        var sheet = this.parent.getActiveSheet();\n        var range = argsOpt.option.range ? (argsOpt.option.range.indexOf('!') > 0) ?\n            argsOpt.option.range.split('!')[1] : argsOpt.option.range.split('!')[0]\n            : this.parent.getActiveSheet().selectedRange;\n        var rangeIdx = getRangeIndexes(range);\n        var top;\n        var left;\n        var position;\n        var options = {};\n        var isRowLesser;\n        var xRange;\n        var yRange;\n        var lRange;\n        var eventArgs;\n        if (!this.parent.allowChart && sheet.isProtected) {\n            return seriesModel;\n        }\n        var sheetIdx = (argsOpt.option.range && argsOpt.option.range.indexOf('!') > 0) ?\n            getSheetIndex(this.parent, argsOpt.option.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var args = {\n            sheetIndex: sheetIdx, reqType: 'shape', type: 'actionBegin', shapeType: 'chart',\n            action: 'create', options: argsOpt.option, range: range, operation: 'create',\n        };\n        options = args.options;\n        range = args.range;\n        options = options || {};\n        var chartOptions;\n        var chartRange;\n        var type = 'chart';\n        if (rangeIdx.length > 0) {\n            var rDiff = rangeIdx[2] - rangeIdx[0];\n            var cDiff = rangeIdx[3] - rangeIdx[1];\n            if (rDiff < cDiff) {\n                isRowLesser = true;\n            }\n        }\n        options.isSeriesInRows = isRowLesser ? true : options.isSeriesInRows ? options.isSeriesInRows : false;\n        argsOpt.dataSheetIdx = isNullOrUndefined(argsOpt.dataSheetIdx) ? sheetIdx : argsOpt.dataSheetIdx;\n        chartRange = this.processChartRange(rangeIdx, argsOpt.dataSheetIdx, options);\n        xRange = chartRange.xRange;\n        yRange = chartRange.yRange;\n        lRange = chartRange.lRange;\n        if (sheetIdx === this.parent.activeSheetIndex && isRangeSelect) {\n            this.focusChartRange(xRange, yRange, lRange);\n        }\n        chartOptions = this.processChartSeries(options, argsOpt.dataSheetIdx, xRange, yRange, lRange);\n        var primaryXAxis = {\n            majorGridLines: { width: 0 },\n            minorGridLines: { width: 0 },\n            majorTickLines: { width: 0 },\n            minorTickLines: { width: 0 },\n            lineStyle: { width: 0 },\n            valueType: 'Category'\n        };\n        var primaryYAxis = {\n            lineStyle: { width: 0 },\n            majorTickLines: { width: 0 },\n            majorGridLines: { width: 1 },\n            minorGridLines: { width: 1 },\n            minorTickLines: { width: 0 },\n            labelFormat: this.primaryYAxisFormat(yRange)\n        };\n        if (argsOpt.isRefresh) {\n            return chartOptions.series;\n        }\n        if (argsOpt.isUndoRedo) {\n            eventArgs = {\n                type: argsOpt.option.type, theme: argsOpt.option.theme, isSeriesInRows: argsOpt.option.isSeriesInRows,\n                range: argsOpt.option.range, height: argsOpt.option.height, width: argsOpt.option.width, id: argsOpt.option.id,\n                posRange: argsOpt.range, isInitCell: argsOpt.isInitCell, cancel: false\n            };\n            this.parent.notify(beginAction, { eventArgs: eventArgs, action: 'beforeInsertChart' });\n            if (eventArgs.cancel) {\n                return [];\n            }\n            argsOpt.option.type = eventArgs.type;\n            argsOpt.option.theme = eventArgs.theme;\n            argsOpt.option.isSeriesInRows = eventArgs.isSeriesInRows;\n            argsOpt.option.range = eventArgs.range;\n            argsOpt.option.id = eventArgs.id;\n            argsOpt.option.height = eventArgs.height;\n            argsOpt.option.width = eventArgs.width;\n        }\n        var id = argsOpt.option.id + '_overlay';\n        var sheetIndex = argsOpt.isPaste ? this.parent.getActiveSheet().index :\n            (argsOpt.option.range && argsOpt.option.range.indexOf('!') > 0) ?\n                getSheetIndex(this.parent, argsOpt.option.range.split('!')[0]) : this.parent.activeSheetIndex;\n        var overlayObj = this.parent.serviceLocator.getService(overlay);\n        var eleRange = !isNullOrUndefined(argsOpt.isInitCell) && argsOpt.isInitCell ? argsOpt.range : range;\n        var element = overlayObj.insertOverlayElement(id, eleRange, sheetIndex);\n        element.classList.add('e-datavisualization-chart');\n        element.style.width = argsOpt.option.width + 'px';\n        element.style.height = argsOpt.option.height + 'px';\n        element.style.top = isNullOrUndefined(argsOpt.option.top) ? element.style.top : (argsOpt.option.top + 'px');\n        element.style.left = isNullOrUndefined(argsOpt.option.left) ? element.style.left : (argsOpt.option.left + 'px');\n        argsOpt.option.top = parseInt(element.style.top.replace('px', ''), 10);\n        argsOpt.option.left = parseInt(element.style.left.replace('px', ''), 10);\n        var chartContent = this.parent.createElement('div', {\n            id: argsOpt.option.id, className: argsOpt.option.id\n        });\n        if (argsOpt.option.type !== 'Pie' && argsOpt.option.type !== 'Doughnut') {\n            this.chart = new Chart({\n                primaryXAxis: primaryXAxis,\n                primaryYAxis: primaryYAxis,\n                chartArea: {\n                    border: {\n                        width: 0\n                    }\n                },\n                series: chartOptions.series,\n                tooltip: {\n                    enable: true\n                },\n                width: element.style.width,\n                height: element.style.height,\n                load: function (args) {\n                    var selectedTheme = argsOpt.option.theme;\n                    selectedTheme = selectedTheme ? selectedTheme : 'Material';\n                    args.chart.theme = (selectedTheme.charAt(0).toUpperCase() +\n                        selectedTheme.slice(1)).replace(/-dark/i, 'Dark').replace(/contrast/i, 'Contrast');\n                },\n                beforeResize: function (args) {\n                    args.cancelResizedEvent = true; // This is for cancel the resized event.\n                }\n            });\n            this.chart.appendTo(chartContent);\n        }\n        else {\n            this.chart = new AccumulationChart({\n                series: chartOptions.series,\n                width: element.style.width,\n                height: element.style.height,\n                center: { x: '50%', y: '50%' },\n                enableSmartLabels: true,\n                enableAnimation: true,\n                legendSettings: { visible: true, position: 'Bottom' },\n                load: function (args) {\n                    var selectedTheme = location.hash.split('/')[1];\n                    selectedTheme = selectedTheme ? selectedTheme : 'Material';\n                    args.accumulation.theme = (selectedTheme.charAt(0).toUpperCase() +\n                        selectedTheme.slice(1)).replace(/-dark/i, 'Dark').replace(/contrast/i, 'Contrast');\n                },\n                beforeResize: function (args) {\n                    args.cancelResizedEvent = true; // This is for cancel the resized event.\n                }\n            });\n            this.chart.appendTo(chartContent);\n        }\n        element.appendChild(chartContent);\n        if (argsOpt.isUndoRedo) {\n            this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'insertChart' });\n        }\n        return seriesModel;\n    };\n    SpreadsheetChart.prototype.deleteChart = function (args) {\n        this.clearBorder();\n        var chartElements = null;\n        var sheet;\n        if (isNullOrUndefined(args.id)) {\n            chartElements = document.querySelector('.e-datavisualization-chart.e-ss-overlay-active');\n            args.id = chartElements ? chartElements.getElementsByClassName('e-control')[0].id : null;\n        }\n        else {\n            args.id = args.id.includes('overlay') ? args.id : args.id + '_overlay';\n            chartElements = document.getElementById(args.id);\n        }\n        if (isNullOrUndefined(args.id) || isNullOrUndefined(chartElements)) {\n            return;\n        }\n        else {\n            args.id = args.id.includes('overlay') ? args.id : args.id + '_overlay';\n        }\n        var rowIdx;\n        var colIdx;\n        var cellObj;\n        var prevCellChart;\n        var chartLength;\n        var isRemoveEle = false;\n        var chartObj;\n        for (var i = 0; i < this.parent.chartColl.length; i++) {\n            if (this.parent.chartColl[i].id === args.id.split('_overlay')[0]) {\n                chartObj = this.parent.chartColl[i];\n                break;\n            }\n        }\n        var eventArgs = {\n            id: chartObj.id, range: chartObj.range, type: chartObj.type, theme: chartObj.theme, height: chartObj.height,\n            width: chartObj.width, isSeriesInRows: chartObj.isSeriesInRows, isInitCell: true, posRange: null, cancel: false\n        };\n        if (chartElements) {\n            this.parent.notify(deleteChartColl, { id: args.id });\n            var imgTop = { clientY: chartElements.offsetTop, isImage: true };\n            this.parent.notify(getRowIdxFromClientY, imgTop);\n            var imgleft = { clientX: chartElements.offsetLeft, isImage: true };\n            this.parent.notify(getColIdxFromClientX, imgleft);\n            isRemoveEle = true;\n            rowIdx = imgTop.clientY;\n            colIdx = imgleft.clientX;\n            sheet = this.parent.sheets[this.parent.activeSheetIndex];\n        }\n        else {\n            this.parent.notify(deleteChartColl, { id: args.id });\n            var sheetIndex = args.range && args.range.indexOf('!') > 0 ? getSheetIndex(this.parent, args.range.split('!')[0]) :\n                this.parent.activeSheetIndex;\n            var rangeVal = args.range ? args.range.indexOf('!') > 0 ? args.range.split('!')[1] : args.range.split('!')[0] :\n                this.parent.getActiveSheet().selectedRange;\n            var index = getRangeIndexes(rangeVal);\n            rowIdx = index[0];\n            colIdx = index[1];\n            sheet = this.parent.sheets[sheetIndex];\n        }\n        cellObj = getCell(rowIdx, colIdx, sheet);\n        if (cellObj) {\n            prevCellChart = cellObj.chart;\n        }\n        chartLength = prevCellChart ? prevCellChart.length : chartLength;\n        for (var i = 0; i < chartLength; i++) {\n            var overlayEle = document.getElementById(args.id);\n            var chartEleClassName = document.getElementById(prevCellChart[i].id);\n            if (closest(chartEleClassName, '.' + overlayEle.classList[1]) === overlayEle) {\n                prevCellChart.splice(i, 1);\n            }\n        }\n        if (isRemoveEle) {\n            document.getElementById(args.id).remove();\n        }\n        setCell(rowIdx, colIdx, sheet, { chart: prevCellChart }, true);\n        eventArgs.posRange = getCellAddress(rowIdx, colIdx);\n        this.parent.notify(completeAction, { eventArgs: eventArgs, action: 'deleteChart' });\n    };\n    /**\n     * Removing event listener for success and failure\n     */\n    SpreadsheetChart.prototype.removeEventListener = function () {\n        if (!this.parent.isDestroyed) {\n            this.parent.off(initiateChart, this.initiateChartHandler);\n            this.parent.off(refreshChartCellObj, this.refreshChartCellObj);\n            this.parent.off(updateChart, this.updateChartHandler);\n            this.parent.off(deleteChart, this.deleteChart);\n            this.parent.off(clearChartBorder, this.clearBorder);\n            this.parent.off(insertChart, this.insertChartHandler);\n            this.parent.off(chartRangeSelection, this.chartRangeHandler);\n        }\n    };\n    /**\n     * To Remove the event listeners.\n     */\n    SpreadsheetChart.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n        var chartEle = null;\n        if (this.chart) {\n            chartEle = this.chart.element;\n            this.chart.destroy();\n        }\n        if (chartEle) {\n            detach(chartEle);\n        }\n        this.chart = null;\n    };\n    /**\n     * Get the sheet chart module name.\n     */\n    SpreadsheetChart.prototype.getModuleName = function () {\n        return 'spreadsheetChart';\n    };\n    return SpreadsheetChart;\n}());\nexport { SpreadsheetChart };\n","import { Spreadsheet } from '../index';\nimport { Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, WrapText, Insert, Delete, ProtectSheet } from '../actions/index';\nimport { CellFormat, CollaborativeEditing, UndoRedo, Resize, SpreadsheetHyperlink, FindAndReplace, Merge } from '../actions/index';\nimport { Formula, Sort, Filter, SpreadsheetImage, SpreadsheetChart } from '../integrations/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, ContextMenu, Save, NumberFormat } from '../integrations/index';\nimport { DataBind } from '../../workbook/index';\nimport { DataValidation } from '../actions/data-validation';\nimport { ConditionalFormatting } from '../actions/conditional-formatting';\n/**\n * Spreadsheet basic module.\n * @private\n */\nvar BasicModule = /** @class */ (function () {\n    /**\n     * Constructor for Spreadsheet basic module.\n     * @private\n     */\n    function BasicModule() {\n        Spreadsheet.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, ContextMenu, Save, NumberFormat, CellFormat, Formula, Sort, CollaborativeEditing, UndoRedo, Resize, Filter, SpreadsheetHyperlink, WrapText, Insert, Delete, ProtectSheet, DataValidation, FindAndReplace, Merge, ConditionalFormatting, SpreadsheetImage, SpreadsheetChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    BasicModule.prototype.getModuleName = function () {\n        return 'basic';\n    };\n    /**\n     * Destroys the Spreadsheet basic module.\n     * @return {void}\n     */\n    BasicModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return BasicModule;\n}());\nexport { BasicModule };\n","import { Spreadsheet } from '../index';\nimport { Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, CellFormat, WrapText, ProtectSheet } from '../actions/index';\nimport { CollaborativeEditing, UndoRedo, Resize, SpreadsheetHyperlink, Insert, Delete, FindAndReplace, Merge } from '../actions/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, Save, NumberFormat, Formula, Sort, Filter, SpreadsheetImage } from '../integrations/index';\nimport { SpreadsheetChart } from '../integrations/index';\nimport { DataBind } from '../../workbook/integrations/index';\nimport { DataValidation } from '../actions/data-validation';\nimport { ConditionalFormatting } from '../actions/conditional-formatting';\n/**\n * Spreadsheet all module.\n * @private\n */\nvar AllModule = /** @class */ (function () {\n    /**\n     * Constructor for Spreadsheet all module.\n     * @private\n     */\n    function AllModule() {\n        Spreadsheet.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, Save, NumberFormat, CellFormat, Formula, Sort, Resize, CollaborativeEditing, UndoRedo, Filter, SpreadsheetHyperlink, WrapText, Insert, Delete, DataValidation, ProtectSheet, FindAndReplace, Merge, SpreadsheetImage, ConditionalFormatting, SpreadsheetChart);\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    AllModule.prototype.getModuleName = function () {\n        return 'all';\n    };\n    /**\n     * Destroys the Spreadsheet all module.\n     * @return {void}\n     */\n    AllModule.prototype.destroy = function () {\n        /* code snippet */\n    };\n    return AllModule;\n}());\nexport { AllModule };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Property, ChildProperty } from '@syncfusion/ej2-base';\n/**\n * Represents the scroll settings.\n */\nvar ScrollSettings = /** @class */ (function (_super) {\n    __extends(ScrollSettings, _super);\n    function ScrollSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(false)\n    ], ScrollSettings.prototype, \"isFinite\", void 0);\n    __decorate([\n        Property(true)\n    ], ScrollSettings.prototype, \"enableVirtualization\", void 0);\n    return ScrollSettings;\n}(ChildProperty));\nexport { ScrollSettings };\n/**\n * Represents the selection settings.\n */\nvar SelectionSettings = /** @class */ (function (_super) {\n    __extends(SelectionSettings, _super);\n    function SelectionSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Multiple')\n    ], SelectionSettings.prototype, \"mode\", void 0);\n    return SelectionSettings;\n}(ChildProperty));\nexport { SelectionSettings };\n","/** @hidden */\nexport var DISABLED = 'e-disabled';\n/** @hidden */\nexport var WRAPTEXT = 'e-wraptext';\n/** @hidden */\nexport var locale = 'spreadsheetLocale';\n/** @hidden */\nexport var dialog = 'dialog';\n/** @hidden */\nexport var actionEvents = 'actionEvents';\n/** @hidden */\nexport var overlay = 'shape';\n/** @hidden */\nexport var fontColor = {\n    'Custom': [\n        '#ffffff', '#000000', '#e7e6e6', '#44546a', '#4472c4', '#ed7d31', '#a5a5a5', '#ffc000', '#70ad47', '#ff0000',\n        '#f2f2f2', '#808080', '#cfcdcd', '#d5dce4', '#d9e2f3', '#fbe4d5', '#ededed', '#fff2cc', '#e2efd9', '#ffcccc',\n        '#d9d9d9', '#595959', '#aeaaaa', '#acb9ca', '#b4c6e7', '#f7caac', '#dbdbdb', '#ffe599', '#c5e0b3', '#ff8080',\n        '#bfbfbf', '#404040', '#747070', '#8496b0', '#8eaadb', '#f4b083', '#c9c9c9', '#ffd966', '#a8d08d', '#ff3333',\n        '#a6a6a6', '#262626', '#3b3838', '#323e4f', '#2f5496', '#c45911', '#7b7b7b', '#bf8f00', '#538135', '#b30000',\n        '#7f7f7f', '#0d0d0d', '#161616', '#212934', '#1f3763', '#823b0b', '#525252', '#7f5f00', '#375623', '#660000'\n    ]\n};\n/** @hidden */\nexport var fillColor = {\n    'Custom': [\n        '#ffffff', '#000000', '#ffff00', '#00ff00', '#00ffff', '#0000ff', '#ff0000', '#000080', '#800080', '#996633',\n        '#f2f2f2', '#808080', '#ffffcc', '#b3ffb3', '#ccffff', '#ccccff', '#ffcccc', '#ccccff', '#ff80ff', '#f2e6d9',\n        '#d9d9d9', '#595959', '#ffff80', '#80ff80', '#b3ffff', '#8080ff', '#ff8080', '#8080ff', '#ff00ff', '#dfbf9f',\n        '#bfbfbf', '#404040', '#ffff33', '#33ff33', '#33ffff', '#3333ff', '#ff3333', '#0000b3', '#b300b3', '#c68c53',\n        '#a6a6a6', '#262626', '#e6e600', '#00b300', '#009999', '#000099', '#b30000', '#000066', '#660066', '#86592d',\n        '#7f7f7f', '#0d0d0d', '#999900', '#006600', '#006666', '#000066', '#660000', '#00004d', '#4d004d', '#734d26',\n    ]\n};\n/**\n * Default locale text\n * @hidden\n */\nexport var defaultLocale = {\n    FindValue: 'Find value',\n    ReplaceValue: 'Replace value',\n    FindReplaceTooltip: 'Find & Replace',\n    InsertingEmptyValue: 'Reference value is not valid.',\n    ReplaceAllEnd: ' matches replaced with ',\n    ByRow: 'By Rows',\n    ByColumn: 'By Columns',\n    MatchCase: 'Match case   ',\n    MatchExactCellElements: 'Match exact cell contents',\n    Replace: 'Replace...',\n    Find: 'Find and Replace...',\n    Goto: 'Goto...',\n    EntercellAddress: 'Enter cell address',\n    GotoSpecial: 'GotoSpecial...',\n    FindAndReplace: 'Find and Replace',\n    FindNextBtn: 'Find Next',\n    FindPreviousBtn: 'Find Previous',\n    ReplaceBtn: 'Replace',\n    ReplaceAllBtn: 'Replace All',\n    GotoHeader: 'Go To',\n    GotoSpecialHeader: 'Go To Special',\n    Sheet: 'Sheet',\n    Workbook: 'Workbook',\n    NoElements: 'We couldn\\'t find what you were looking for.',\n    FindWhat: 'Find what',\n    ReplaceWith: 'Replace with',\n    Cut: 'Cut',\n    Copy: 'Copy',\n    Paste: 'Paste',\n    PasteSpecial: 'Paste Special',\n    Link: 'Link',\n    SpreadsheetHyperlink: 'SpreadsheetHyperlink',\n    Hyperlink: 'Hyperlink',\n    EditHyperlink: 'Edit Hyperlink',\n    OpenHyperlink: 'Open Hyperlink',\n    RemoveHyperlink: 'Remove Hyperlink',\n    InsertLink: 'Insert Link',\n    EditLink: 'Edit Link',\n    All: 'All',\n    Values: 'Values',\n    Formats: 'Formats',\n    Bold: 'Bold',\n    Font: 'Font',\n    FontSize: 'Font Size',\n    Italic: 'Italic',\n    Underline: 'Underline',\n    Strikethrough: 'Strikethrough',\n    TextColor: 'Text Color',\n    FillColor: 'Fill Color',\n    HorizontalAlignment: 'Horizontal Alignment',\n    AlignLeft: 'Align Left',\n    AlignCenter: 'Center',\n    AlignRight: 'Align Right',\n    VerticalAlignment: 'Vertical Alignment',\n    AlignTop: 'Align Top',\n    AlignMiddle: 'Align Middle',\n    AlignBottom: 'Align Bottom',\n    WrapText: 'Wrap Text',\n    MergeCells: 'Merge Cells',\n    MergeAll: 'Merge All',\n    MergeHorizontally: 'Merge Horizontally',\n    MergeVertically: 'Merge Vertically',\n    Unmerge: 'Unmerge',\n    UnmergeCells: 'Unmerge Cells',\n    SelectMergeType: 'Select Merge Type',\n    MergeCellsAlert: 'Merging cells will only preserve the top-leftmost(Uppermost) value. Merge anyway?',\n    PasteMergeAlert: 'We can\"t do that to a merge cell.',\n    Borders: 'Borders',\n    TopBorders: 'Top Borders',\n    LeftBorders: 'Left Borders',\n    RightBorders: 'Right Borders',\n    BottomBorders: 'Bottom Borders',\n    AllBorders: 'All Borders',\n    HorizontalBorders: 'Horizontal Borders',\n    VerticalBorders: 'Vertical Borders',\n    OutsideBorders: 'Outside Borders',\n    InsideBorders: 'Inside Borders',\n    NoBorders: 'No Borders',\n    BorderColor: 'Border Color',\n    BorderStyle: 'Border Style',\n    InsertFunction: 'Insert Function',\n    Insert: 'Insert',\n    Delete: 'Delete',\n    Rename: 'Rename',\n    Hide: 'Hide',\n    Unhide: 'Unhide',\n    NameBox: 'Name Box',\n    ShowHeaders: 'Show Headers',\n    HideHeaders: 'Hide Headers',\n    ShowGridLines: 'Show Gridlines',\n    HideGridLines: 'Hide Gridlines',\n    AddSheet: 'Add Sheet',\n    ListAllSheets: 'List All Sheets',\n    FullScreen: 'Full Screen',\n    CollapseToolbar: 'Collapse Toolbar',\n    ExpandToolbar: 'Expand Toolbar',\n    CollapseFormulaBar: 'Collapse Formula Bar',\n    ExpandFormulaBar: 'Expand Formula Bar',\n    File: 'File',\n    Home: 'Home',\n    Formulas: 'Formulas',\n    View: 'View',\n    New: 'New',\n    Open: 'Open',\n    SaveAs: 'Save As',\n    Update: 'Update',\n    ExcelXlsx: 'Microsoft Excel',\n    ExcelXls: 'Microsoft Excel 97-2003',\n    CSV: 'Comma-separated values',\n    FormulaBar: 'Formula Bar',\n    Sort: 'Sort',\n    SortAscending: 'Ascending',\n    SortDescending: 'Descending',\n    CustomSort: 'Custom Sort',\n    AddColumn: 'Add Column',\n    ContainsHeader: 'Data contains header',\n    CaseSensitive: 'Case sensitive',\n    SortBy: 'Sort by',\n    ThenBy: 'Then by',\n    SelectAColumn: 'Select a column',\n    SortEmptyFieldError: 'Sort criteria column should not be empty.',\n    SortDuplicateFieldError: ' is mentioned more than once. Duplicate columns must be removed.',\n    SortOutOfRangeError: 'Select a cell or range inside the used range and try again.',\n    SortAndFilter: 'Sort & Filter',\n    Filter: 'Filter',\n    ClearAllFilter: 'Clear',\n    ClearFilterFrom: 'Clear Filter From ',\n    ReapplyFilter: 'Reapply',\n    FilterCellValue: 'Filter by Value of Selected Cell',\n    FilterOutOfRangeError: 'Select a cell or range inside the used range and try again.',\n    HideRow: 'Hide Row',\n    HideRows: 'Hide Rows',\n    UnHideRows: 'UnHide Rows',\n    HideColumn: 'Hide Column',\n    HideColumns: 'Hide Columns',\n    UnHideColumns: 'UnHide Columns',\n    InsertRow: 'Insert Row',\n    InsertRows: 'Insert Rows',\n    Above: 'Above',\n    Below: 'Below',\n    InsertColumn: 'Insert Column',\n    InsertColumns: 'Insert Columns',\n    Before: 'Before',\n    After: 'After',\n    DeleteRow: 'Delete Row',\n    DeleteRows: 'Delete Rows',\n    DeleteColumn: 'Delete Column',\n    DeleteColumns: 'Delete Columns',\n    Ok: 'Ok',\n    Close: 'Close',\n    Cancel: 'Cancel',\n    Apply: 'Apply',\n    MoreColors: 'More Colors',\n    StandardColors: 'Standard Colors',\n    General: 'General',\n    Number: 'Number',\n    Currency: 'Currency',\n    Accounting: 'Accounting',\n    ShortDate: 'Short Date',\n    LongDate: 'Long Date',\n    Time: 'Time',\n    Percentage: 'Percentage',\n    Fraction: 'Fraction',\n    Scientific: 'Scientific',\n    Text: 'Text',\n    MobileFormulaBarPlaceHolder: 'Enter value or Formula',\n    NumberFormat: 'Number Format',\n    PasteAlert: 'You can\\'t paste this here, because the copy area and paste area aren\\'t in the same size. ' +\n        'Please try pasting in a different range.',\n    DestroyAlert: 'Are you sure you want to destroy the current workbook without saving and create a new workbook?',\n    SheetRenameInvalidAlert: 'Sheet name contains invalid character.',\n    SheetRenameEmptyAlert: 'Sheet name cannot be empty.',\n    SheetRenameAlreadyExistsAlert: 'Sheet name already exists. Please enter another name.',\n    DeleteSheetAlert: 'You can\\'t undo deleting sheets, and you might be removing some data. If you don\\'t need it, click OK to delete.',\n    DeleteSingleLastSheetAlert: 'A Workbook must contain at least one visible worksheet.',\n    PickACategory: 'Pick a category',\n    Description: 'Description',\n    UnsupportedFile: 'Unsupported File',\n    InvalidUrl: 'Invalid URL',\n    SUM: 'Adds a series of numbers and/or cells.',\n    SUMIF: 'Adds the cells based on specified condition.',\n    SUMIFS: 'Adds the cells based on specified conditions.',\n    ABS: 'Returns the value of a number without its sign.',\n    RAND: 'Returns a random number between 0 and 1.',\n    RANDBETWEEN: 'Returns a random integer based on specified values.',\n    FLOOR: 'Rounds a number down to the nearest multiple of a given factor.',\n    CEILING: 'Rounds a number up to the nearest multiple of a given factor.',\n    PRODUCT: 'Multiplies a series of numbers and/or cells.',\n    INT: 'Returns a number to the nearest integer.',\n    ROUNDUP: 'Rounds a number away from zero.',\n    SUMPRODUCT: 'Returns sum of the product of given ranges of arrays.',\n    TODAY: 'Returns the current date as date value.',\n    AVERAGE: 'Calculates average for the series of numbers and/or cells excluding text.',\n    AVERAGEIF: 'Calculates average for the cells based on specified criterion.',\n    AVERAGEIFS: 'Calculates average for the cells based on specified conditions.',\n    AVERAGEA: 'Calculates the average for the cells evaluating TRUE as 1, text and FALSE as 0.',\n    COUNT: 'Counts the cells that contain numeric values in a range.',\n    COUNTIF: 'Counts the cells based on specified condition.',\n    COUNTIFS: 'Counts the cells based on specified conditions.',\n    COUNTA: 'Counts the cells that contains values in a range.',\n    MIN: 'Returns the smallest number of the given arguments.',\n    MAX: 'Returns the largest number of the given arguments.',\n    DATE: 'Returns the date based on given year, month, and day.',\n    DAY: 'Returns the day from the given date.',\n    DAYS: 'Returns the number of days between two dates.',\n    IF: 'Returns value based on the given expression.',\n    IFS: 'Returns value based on the given multiple expressions.',\n    CalculateAND: 'Returns TRUE if all the arguments are TRUE, otherwise returns FALSE.',\n    CalculateOR: 'Returns TRUE if any of the arguments are TRUE, otherwise returns FALSE.',\n    IFERROR: 'Returns value if no error found else it will return specified value.',\n    CHOOSE: 'Returns a value from list of values, based on index number.',\n    INDEX: 'Returns a value of the cell in a given range based on row and column number.',\n    FIND: 'Returns the position of a string within another string, which is case sensitive',\n    CONCATENATE: 'Combines two or more strings together.',\n    CONCAT: 'Concatenates a list or a range of text strings.',\n    SUBTOTAL: 'Returns subtotal for a range using the given function number.',\n    RADIANS: 'Converts degrees into radians.',\n    MATCH: 'Returns the relative position of a specified value in given range.',\n    LN: 'Returns the natural logarithm of a number.',\n    INTERCEPT: 'Calculates the point of the Y-intercept line via linear regression.',\n    SLOPE: 'Returns the slope of the line from linear regression of the data points.',\n    DefineNameExists: 'This name already exists, try different name.',\n    DefineNameInValid: 'The name that you entered is not valid.',\n    CircularReference: 'When a formula refers to one or more circular references, this may result in an incorrect calculation.',\n    ShowRowsWhere: 'Show rows where:',\n    OR: 'OR',\n    AND: 'AND',\n    CustomFilterDatePlaceHolder: 'Choose a date',\n    CustomFilterPlaceHolder: 'Enter the value',\n    CustomFilter: 'Custom Filter',\n    Between: 'Between',\n    DateTimeFilter: 'DateTime Filters',\n    Undo: 'Undo',\n    Redo: 'Redo',\n    DateFilter: 'Date Filters',\n    TextFilter: 'Text Filters',\n    NumberFilter: 'Number Filters',\n    ClearFilter: 'Clear Filter',\n    NoResult: 'No Matches Found',\n    FilterFalse: 'False',\n    FilterTrue: 'True',\n    Blanks: 'Blanks',\n    SelectAll: 'Select All',\n    GreaterThanOrEqual: 'Greater Than Or Equal',\n    GreaterThan: 'Greater Than',\n    LessThanOrEqual: 'Less Than Or Equal',\n    LessThan: 'Less Than',\n    NotEqual: 'Not Equal',\n    Equal: 'Equal',\n    Contains: 'Contains',\n    EndsWith: 'Ends With',\n    StartsWith: 'Starts With',\n    ClearButton: 'Clear',\n    FilterButton: 'Filter',\n    CancelButton: 'Cancel',\n    OKButton: 'OK',\n    Search: 'Search',\n    ProtectSheet: 'Protect Sheet',\n    UnprotectSheet: 'Unprotect Sheet',\n    LockCells: 'Lock Cells',\n    SelectCells: 'Select cells',\n    FormatCells: 'Format cells',\n    FormatRows: 'Format rows',\n    FormatColumns: 'Format columns',\n    InsertLinks: 'Insert links',\n    ProtectContent: 'Protect the contents of locked cells',\n    ProtectAllowUser: ' Allow all users of this worksheet to:',\n    EditAlert: 'The cell you\\'re trying to change is protected. To make change, unprotect the sheet.',\n    SearchWithin: 'Search within',\n    SearchBy: 'Search by',\n    Reference: 'Reference',\n    DataValidation: 'Data Validation',\n    CLEARALL: 'CLEAR ALL',\n    APPLY: 'APPLY',\n    CellRange: 'Cell Range',\n    Allow: 'Allow',\n    Data: 'Data',\n    Minimum: 'Minimum',\n    Maximum: 'Maximum',\n    IgnoreBlank: 'Ignore blank',\n    WholeNumber: 'Whole Number',\n    Decimal: 'Decimal',\n    Date: 'Date',\n    TextLength: 'Text Length',\n    List: 'List',\n    NotBetween: 'Not between',\n    EqualTo: 'Equal to',\n    NotEqualTo: 'Not equal to',\n    Greaterthan: 'Greater than',\n    Lessthan: 'Less than',\n    GreaterThanOrEqualTo: 'Greater than or equal to',\n    LessThanOrEqualTo: 'Less than or equal to',\n    InCellDropDown: 'In-cell-dropdown',\n    Sources: 'Sources',\n    Value: 'Value',\n    Retry: 'Retry',\n    EnterValue: 'Enter value',\n    DialogError: 'The list source must be a reference to single row or column.',\n    ListLengthError: 'The list values allows only upto 256 charcters',\n    ValidationError: 'This value doesn' + '\\'' + 't match the data validation restrictions defined for the cell.',\n    EmptyError: 'You must enter a value',\n    ClearHighlight: 'Clear Highlight',\n    HighlightInvalidData: 'Highlight Invalid Data',\n    ClearValidation: 'Clear Validation',\n    HighlightCellsRules: 'Highlight Cells Rules',\n    CFEqualTo: 'Equal To',\n    TextThatContains: 'Text that Contains',\n    ADateOccuring: 'A Date Occuring',\n    DuplicateValues: 'Duplicate Values',\n    TopBottomRules: 'Top/Bottom Rules',\n    Top10Items: 'Top 10 Items',\n    Top10: 'Top 10',\n    Bottom10Items: 'Bottom 10 Items',\n    Bottom10: 'Bottom 10',\n    AboveAverage: 'Above Average',\n    BelowAverage: 'Below Average',\n    FormatCellsGreaterThan: 'Format cells that are GREATER THAN:',\n    FormatCellsLessThan: 'Format cells that are LESS THAN:',\n    FormatCellsBetween: 'Format cells that are BETWEEN:',\n    FormatCellsEqualTo: 'Format cells that are EQUAL TO:',\n    FormatCellsThatContainTheText: 'Format cells that contain the text:',\n    FormatCellsThatContainADateOccurring: 'Format cells that contain a date occurring:',\n    FormatCellsDuplicate: 'Format cells that contain:',\n    FormatCellsTop: 'Format cells that rank in the TOP:',\n    FormatCellsBottom: 'Format cells that rank in the BOTTOM:',\n    FormatCellsAbove: 'Format cells that are ABOVE AVERAGE:',\n    FormatCellsBelow: 'Format cells that are BELOW AVERAGE:',\n    With: 'with',\n    DataBars: 'Data Bars',\n    ColorScales: 'Color Scales',\n    IconSets: 'Icon Sets',\n    ClearRules: 'Clear Rules',\n    SelectedCells: 'Clear Rules from Selected Cells',\n    EntireSheet: 'Clear Rules from Entire Sheet',\n    ISNUMBER: 'Returns true when the value parses as a numeric value.',\n    ROUND: 'Rounds a number to a specified number of digits.',\n    GEOMEAN: 'Returns the geometric mean of an array or range of positive data.',\n    POWER: 'Returns the result of a number raised to power',\n    LOG: 'Returns the logarithm of a number to the base that you specify.',\n    TRUNC: 'Returns the truncated value of a number to a specified number of decimal places.',\n    EXP: 'Returns e raised to the power of the given number.',\n    Clear: 'Clear',\n    ClearContents: 'Clear Contents',\n    ClearAll: 'Clear All',\n    ClearFormats: 'Clear Formats',\n    ClearHyperlinks: 'Clear Hyperlinks',\n    LightRedFillWithDarkRedText: 'Light Red Fill with Dark Red Text',\n    YellowFillWithDarkYellowText: 'Yellow Fill with Dark Yellow Text',\n    GreenFillWithDarkGreenText: 'Green Fill with Dark Green Text',\n    RedFill: 'Red Fill',\n    RedText: 'Red Text',\n    Duplicate: 'Duplicate',\n    Unique: 'Unique',\n    And: 'and',\n    WebPage: 'WEB PAGE',\n    ThisDocument: 'THIS DOCUMENT',\n    DisplayText: 'Display Text',\n    Url: 'URL',\n    CellReference: 'Cell Reference',\n    DefinedNames: 'Defined Names',\n    EnterTheTextToDisplay: 'Enter the text to display',\n    EnterTheUrl: 'Enter the URL',\n    Image: 'Image',\n    ConditionalFormatting: 'Conditional Formatting',\n    BlueDataBar: 'Blue Data Bar',\n    GreenDataBar: 'Green Data Bar',\n    RedDataBar: 'Red Data Bar',\n    OrangeDataBar: 'Orange Data Bar',\n    LightblueDataBar: 'Light blue Data Bar',\n    PurpleDataBar: 'Purple Data Bar',\n    GYRColorScale: 'Green - Yellow - Red Color Scale',\n    RYGColorScale: 'Red - Yellow - Green Color Scale',\n    GWRColorScale: 'Green - White - Red Color Scale',\n    RWGColorScale: 'Red - White - Green Color Scale',\n    BWRColorScale: 'Blue - White - Red Color Scale',\n    RWBColorScale: 'Red - White - Blue Color Scale',\n    WRColorScale: 'White - Red Color Scale',\n    RWColorScale: 'Red - White Color Scale',\n    GWColorScale: 'Green - White Color Scale',\n    WGColorScale: 'White - Green Color Scale',\n    GYColorScale: 'Green - Yellow Color Scale',\n    YGColorScale: 'Yellow - Green Color Scale',\n    ThreeArrowsColor: '3 Arrows (Colored)',\n    ThreeArrowsGray: '3 Arrows (Gray)',\n    ThreeTriangles: '3 Triangles',\n    FourArrowsColor: '4 Arrows (Gray)',\n    FourArrowsGray: '4 Arrows (Colored)',\n    FiveArrowsColor: '5 Arrows (Gray)',\n    FiveArrowsGray: '5 Arrows (Colored)',\n    ThreeTrafficLights1: '3 Traffic Lights (Unrimmed)',\n    ThreeTrafficLights2: '3 Traffic Lights (Rimmed)',\n    ThreeSigns: '3 Signs',\n    FourTrafficLights: '4 Traffic Lights',\n    RedToBlack: 'Red To Black',\n    ThreeSymbols1: '3 Symbols (Circled)',\n    ThreeSymbols2: '3 Symbols (Uncircled)',\n    ThreeFlags: '3 Flags',\n    ThreeStars: '3 Stars',\n    FourRatings: '4 Ratings',\n    FiveQuarters: '5 Quarters',\n    FiveRatings: '5 Ratings',\n    FiveBoxes: '5 Boxes',\n    Chart: 'Chart',\n    Column: 'Column',\n    Bar: 'Bar',\n    Area: 'Area',\n    Pie: 'Pie',\n    Doughnut: 'Doughnut',\n    PieAndDoughnut: 'Pie/Doughnut',\n    Line: 'Line',\n    Radar: 'Radar',\n    Scatter: 'Scatter',\n    ChartDesign: 'Chart Design',\n    ClusteredColumn: 'Clustered Column',\n    StackedColumn: 'Stacked Column',\n    StackedColumn100: '100% Stacked Column',\n    ClusteredBar: 'Clustered Bar',\n    StackedBar: 'Stacked Bar',\n    StackedBar100: '100% Stacked Bar',\n    StackedArea: 'Stacked Area',\n    StackedArea100: '100% Stacked Area',\n    StackedLine: 'Stacked Line',\n    StackedLine100: '100% Stacked Line',\n};\n","import { formatUnit, detach, attributes, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getRangeIndexes } from './../../workbook/common/address';\nimport { getColumnWidth, isHiddenCol } from '../../workbook/base/column';\nimport { contentLoaded, editOperation, getUpdateUsingRaf, removeAllChildren } from '../common/index';\nimport { beforeContentLoaded, getColGroupWidth, virtualContentLoaded, setAriaOptions, dataBound } from '../common/index';\nimport { beforeHeaderLoaded, created, spreadsheetDestroyed, skipHiddenIdx, isReact } from '../common/index';\nimport { checkMerge, forRefSelRender, initiateEdit, chartRangeSelection, renderReactTemplates } from '../common/index';\nimport { getCell, isHiddenRow } from '../../workbook/index';\n/**\n * Sheet module is used to render Sheet\n * @hidden\n */\nvar SheetRender = /** @class */ (function () {\n    function SheetRender(parent) {\n        this.freezePane = false;\n        this.colGroupWidth = 30; //Row header and selectall table colgroup width\n        this.parent = parent;\n        this.col = parent.createElement('col');\n        this.rowRenderer = parent.serviceLocator.getService('row');\n        this.cellRenderer = parent.serviceLocator.getService('cell');\n        this.addEventListener();\n    }\n    SheetRender.prototype.refreshSelectALLContent = function () {\n        var cell;\n        if (this.freezePane) {\n            var tHead = this.getSelectAllTable().querySelector('thead');\n            var row = this.rowRenderer.render();\n            tHead.appendChild(row);\n            cell = this.parent.createElement('th', { className: 'e-select-all-cell' });\n            row.appendChild(cell);\n        }\n        else {\n            cell = this.headerPanel.firstElementChild;\n            cell.classList.add('e-select-all-cell');\n        }\n        cell.appendChild(this.parent.createElement('button', { className: 'e-selectall e-icons',\n            id: this.parent.element.id + \"_select_all\" }));\n    };\n    SheetRender.prototype.updateLeftColGroup = function (width, rowHdr) {\n        if (width) {\n            this.colGroupWidth = width;\n        }\n        if (!rowHdr) {\n            rowHdr = this.getRowHeaderPanel();\n        }\n        var table = rowHdr.querySelector('table');\n        this.detachColGroup(table);\n        var colGrp = this.parent.createElement('colgroup');\n        var colGrpWidth = this.colGroupWidth + \"px\";\n        var col = this.col.cloneNode();\n        col.style.width = colGrpWidth;\n        colGrp.appendChild(col);\n        table.insertBefore(colGrp, table.querySelector('tbody'));\n        rowHdr.style.width = colGrpWidth;\n        if (this.freezePane) {\n            table = this.getSelectAllTable();\n            this.detachColGroup(table);\n            table.insertBefore(colGrp.cloneNode(true), table.querySelector('thead'));\n        }\n        else {\n            this.getSelectAllContent().style.width = colGrpWidth;\n        }\n        if (this.parent.getActiveSheet().showHeaders) {\n            this.getColHeaderPanel().style.width = \"calc(100% - \" + colGrpWidth + \")\";\n            this.getContentPanel().style.width = \"calc(100% - \" + colGrpWidth + \")\";\n        }\n    };\n    SheetRender.prototype.detachColGroup = function (table) {\n        var colGrp = table.querySelector('colgroup');\n        if (colGrp) {\n            detach(colGrp);\n        }\n    };\n    SheetRender.prototype.renderPanel = function () {\n        this.contentPanel = this.parent.createElement('div', { className: 'e-main-panel' });\n        var sheet = this.parent.getActiveSheet();\n        var id = this.parent.element.id;\n        if (sheet.showHeaders) {\n            this.contentPanel.appendChild(this.parent.createElement('div', { className: 'e-row-header', id: id + \"_row_header\" }));\n            this.initHeaderPanel();\n            if (this.parent.allowScrolling) {\n                this.parent.scrollModule.setPadding();\n            }\n        }\n        else {\n            this.updateHideHeaders();\n        }\n        var content = this.contentPanel.appendChild(this.parent.createElement('div', { className: 'e-sheet-content', id: id + \"_main_content\" }));\n        if (!sheet.showGridLines) {\n            content.classList.add('e-hide-gridlines');\n        }\n        if (!this.parent.allowScrolling) {\n            content.style.overflow = 'hidden';\n        }\n    };\n    SheetRender.prototype.initHeaderPanel = function () {\n        var id = this.parent.element.id;\n        this.headerPanel = this.parent.createElement('div', { className: 'e-header-panel' });\n        this.headerPanel.appendChild(this.parent.createElement('div', { className: 'e-selectall-container', id: id + \"_selectall\" }));\n        this.headerPanel.appendChild(this.parent.createElement('div', { className: 'e-column-header', id: id + \"_col_header\" }));\n    };\n    SheetRender.prototype.createTable = function () {\n        if (this.parent.getActiveSheet().showHeaders) {\n            this.createHeaderTable();\n        }\n        this.updateTable('tbody', 'content', this.contentPanel.lastElementChild);\n    };\n    SheetRender.prototype.createHeaderTable = function (rowHdrEle) {\n        if (rowHdrEle === void 0) { rowHdrEle = this.contentPanel.querySelector('.e-row-header'); }\n        if (this.freezePane) {\n            this.updateTable('thead', 'selectall', this.headerPanel.querySelector('.e-selectall-container'));\n        }\n        this.updateTable('thead', 'colhdr', this.headerPanel.querySelector('.e-column-header'));\n        this.updateTable('tbody', 'rowhdr', rowHdrEle);\n        this.updateLeftColGroup(null, rowHdrEle);\n    };\n    SheetRender.prototype.updateTable = function (tagName, name, appendTo) {\n        var table = this.parent.createElement('table', { className: 'e-table', attrs: { 'role': 'grid' } });\n        table.classList.add(\"e-\" + name + \"-table\");\n        appendTo.appendChild(table);\n        table.appendChild(this.parent.createElement(tagName));\n    };\n    /**\n     * It is used to refresh the select all, row header, column header and content of the spreadsheet.\n     */\n    SheetRender.prototype.renderTable = function (args) {\n        var _this = this;\n        var indexes;\n        var row;\n        var hRow;\n        var sheet = this.parent.getActiveSheet();\n        var frag = document.createDocumentFragment();\n        this.createTable();\n        var colGrp = this.parent.createElement('colgroup');\n        var cTBody = this.contentPanel.querySelector('.e-sheet-content tbody');\n        var rHdrTBody;\n        var cHdrTHead;\n        var cHdrRow;\n        if (sheet.showHeaders) {\n            frag.appendChild(this.headerPanel);\n            this.refreshSelectALLContent();\n            rHdrTBody = this.contentPanel.querySelector('.e-row-header tbody');\n            cHdrTHead = this.headerPanel.querySelector('.e-column-header thead');\n            this.getColHeaderTable().insertBefore(colGrp, cHdrTHead);\n            cHdrRow = this.rowRenderer.render();\n            cHdrTHead.appendChild(cHdrRow);\n        }\n        frag.appendChild(this.contentPanel);\n        this.parent.notify(beforeContentLoaded, { startColIdx: args.indexes[1] });\n        var colCount = sheet.colCount.toString();\n        var rowCount = sheet.colCount.toString();\n        var layout = args.top && args.left ? 'RowColumn' : (args.top ? 'Row' : (args.left ? 'Column' : ''));\n        if (sheet.showHeaders) {\n            this.parent.getColHeaderTable().setAttribute('aria-colcount', colCount);\n            this.parent.getRowHeaderTable().setAttribute('aria-rowcount', rowCount);\n        }\n        attributes(this.parent.getContentTable(), { 'aria-rowcount': rowCount, 'aria-colcount': colCount });\n        args.cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[1] === args.indexes[1]) {\n                if (sheet.showHeaders) {\n                    hRow = _this.rowRenderer.render(indexes[0], true);\n                    rHdrTBody.appendChild(hRow);\n                    hRow.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                }\n                row = _this.rowRenderer.render(indexes[0]);\n                cTBody.appendChild(row);\n            }\n            row.appendChild(_this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[0], cell: value,\n                address: key, lastCell: indexes[1] === args.indexes[3], isHeightCheckNeeded: true, row: row, hRow: hRow,\n                pRow: row.previousSibling, pHRow: sheet.showHeaders ? hRow.previousSibling : null,\n                first: layout ? (layout.includes('Row') ? (indexes[0] === args.indexes[0] ? 'Row' : (layout.includes('Column') ? (indexes[1] === args.indexes[1] ? 'Column' : '') : '')) : (indexes[1] === args.indexes[1] ? 'Column' : '')) : '' }));\n            if (indexes[0] === args.indexes[0]) {\n                _this.updateCol(sheet, indexes[1], colGrp);\n                if (sheet.showHeaders) {\n                    cHdrRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                }\n            }\n        });\n        if (this.parent[isReact]) {\n            this.parent[renderReactTemplates]();\n        }\n        cTBody.parentElement.insertBefore(colGrp.cloneNode(true), cTBody);\n        getUpdateUsingRaf(function () {\n            var content = _this.parent.getMainContent();\n            var sheetContent = document.getElementById(_this.parent.element.id + '_sheet');\n            sheetContent.appendChild(frag);\n            if (args.top) {\n                content.scrollTop = args.top;\n                if (sheet.showHeaders) {\n                    _this.parent.getRowHeaderContent().scrollTop = args.top;\n                }\n            }\n            if (args.left) {\n                content.scrollLeft = args.left;\n                if (sheet.showHeaders) {\n                    _this.parent.getColumnHeaderContent().scrollLeft = args.left;\n                }\n            }\n            _this.parent.notify(contentLoaded, null);\n            _this.parent.notify(editOperation, { action: 'renderEditor' });\n            if (!args.initLoad && !_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n            _this.parent.trigger(dataBound, {});\n            if (_this.parent.isEdit) {\n                _this.parent.notify(initiateEdit, null);\n            }\n            if (args.initLoad) {\n                var triggerEvent = true;\n                if (_this.parent.scrollSettings.enableVirtualization) {\n                    for (var i = 0; i < sheet.ranges.length; i++) {\n                        if (sheet.ranges[i].info.count - 1 > _this.parent.viewport.bottomIndex) {\n                            triggerEvent = false;\n                            break;\n                        }\n                    }\n                }\n                if (triggerEvent) {\n                    _this.triggerCreatedEvent();\n                }\n            }\n        });\n    };\n    SheetRender.prototype.triggerCreatedEvent = function () {\n        if (!this.parent.isOpen) {\n            this.parent.hideSpinner();\n        }\n        if (this.parent.createdHandler) {\n            if (this.parent.createdHandler.observers) {\n                this.parent[created].observers = this.parent.createdHandler.observers;\n            }\n            else {\n                this.parent.setProperties({ created: this.parent.createdHandler }, true);\n            }\n            this.parent.createdHandler = undefined;\n            this.parent.trigger(created, null);\n        }\n    };\n    SheetRender.prototype.refreshColumnContent = function (args) {\n        var _this = this;\n        var indexes;\n        var row;\n        var table;\n        var count = 0;\n        var cell;\n        var sheet = this.parent.getActiveSheet();\n        var frag = document.createDocumentFragment();\n        var hFrag = document.createDocumentFragment();\n        var tBody = this.parent.element.querySelector('.e-sheet-content tbody');\n        tBody = frag.appendChild(tBody.cloneNode(true));\n        var colGrp = this.parent.element.querySelector('.e-sheet-content colgroup');\n        colGrp = colGrp.cloneNode();\n        var hRow;\n        var tHead;\n        if (sheet.showHeaders) {\n            hFrag.appendChild(colGrp);\n            tHead = this.parent.element.querySelector('.e-column-header thead');\n            tHead = hFrag.appendChild(tHead.cloneNode(true));\n            hRow = tHead.querySelector('tr');\n            hRow.innerHTML = '';\n        }\n        args.cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[0] === args.indexes[0]) {\n                _this.updateCol(sheet, indexes[1], colGrp);\n                if (sheet.showHeaders) {\n                    hRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                }\n            }\n            if (indexes[1] === args.indexes[1]) {\n                row = tBody.children[count];\n                if (row) {\n                    row.innerHTML = '';\n                    count++;\n                }\n                else {\n                    return;\n                }\n            }\n            cell = row.appendChild(_this.cellRenderer.render({\n                colIdx: indexes[1], rowIdx: indexes[0], cell: value, address: key, row: row, pRow: row.previousSibling,\n                first: !args.skipUpdateOnFirst && indexes[1] === args.indexes[1] ? 'Column' : (_this.parent.scrollSettings.\n                    enableVirtualization && indexes[0] === args.indexes[0] && _this.parent.viewport.topIndex !== skipHiddenIdx(sheet, 0, true)\n                    ? 'Row' : '')\n            }));\n            _this.checkColMerge(indexes, args.indexes, cell, value);\n        });\n        frag.insertBefore(colGrp.cloneNode(true), tBody);\n        getUpdateUsingRaf(function () {\n            if (sheet.showHeaders) {\n                table = _this.getColHeaderTable();\n                removeAllChildren(table);\n                table.appendChild(hFrag);\n            }\n            table = _this.getContentTable();\n            removeAllChildren(table);\n            table.appendChild(frag);\n            _this.parent.notify(virtualContentLoaded, { refresh: 'Column' });\n            if (_this.parent.isEdit) {\n                _this.parent.notify(forRefSelRender, {});\n            }\n            if (_this.parent.allowChart) {\n                _this.parent.notify(chartRangeSelection, null);\n            }\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n        });\n    };\n    SheetRender.prototype.refreshRowContent = function (args) {\n        var _this = this;\n        var indexes;\n        var row;\n        var hdrRow;\n        var colGroupWidth = this.colGroupWidth;\n        var sheet = this.parent.getActiveSheet();\n        var hFrag;\n        var hTBody;\n        var cell;\n        var frag = document.createDocumentFragment();\n        var tBody = this.parent.createElement('tbody');\n        if (sheet.showHeaders) {\n            hFrag = document.createDocumentFragment();\n            hTBody = tBody.cloneNode();\n            hFrag.appendChild(hTBody);\n        }\n        frag.appendChild(tBody);\n        args.cells.forEach(function (value, key) {\n            indexes = getRangeIndexes(key);\n            if (indexes[1] === args.indexes[1]) {\n                if (sheet.showHeaders) {\n                    hdrRow = _this.rowRenderer.render(indexes[0], true);\n                    hTBody.appendChild(hdrRow);\n                    hdrRow.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                    colGroupWidth = getColGroupWidth(indexes[0] + 1);\n                }\n                row = _this.rowRenderer.render(indexes[0]);\n                tBody.appendChild(row);\n            }\n            cell = row.appendChild(_this.cellRenderer.render({ rowIdx: indexes[0], colIdx: indexes[1], cell: value, address: key, lastCell: indexes[1] === args.indexes[3], row: row, hRow: hdrRow, pRow: row.previousSibling, pHRow: sheet.showHeaders ?\n                    hdrRow.previousSibling : null, isHeightCheckNeeded: true, first: !args.skipUpdateOnFirst && indexes[0] === args.indexes[0] ?\n                    'Row' : (_this.parent.scrollSettings.enableVirtualization && indexes[1] === args.indexes[1] && _this.parent.viewport.leftIndex\n                    !== skipHiddenIdx(sheet, 0, true, 'columns') ? 'Column' : '') }));\n            _this.checkRowMerge(indexes, args.indexes, cell, value);\n        });\n        if (this.colGroupWidth !== colGroupWidth) {\n            this.updateLeftColGroup(colGroupWidth);\n        }\n        if (sheet.showHeaders) {\n            if (this.contentPanel.querySelector('.e-row-header tbody')) {\n                detach(this.contentPanel.querySelector('.e-row-header tbody'));\n                this.getRowHeaderTable().appendChild(hFrag);\n            }\n        }\n        if (this.contentPanel.querySelector('.e-sheet-content tbody')) {\n            detach(this.contentPanel.querySelector('.e-sheet-content tbody'));\n            this.getContentTable().appendChild(frag);\n        }\n        this.parent.notify(virtualContentLoaded, { refresh: 'Row' });\n        if (this.parent.allowChart) {\n            this.parent.notify(chartRangeSelection, {});\n        }\n        if (this.parent.isEdit) {\n            this.parent.notify(forRefSelRender, null);\n        }\n        if (!this.parent.isOpen) {\n            this.parent.hideSpinner();\n        }\n        setAriaOptions(this.parent.getMainContent(), { busy: false });\n    };\n    SheetRender.prototype.updateCol = function (sheet, idx, appendTo) {\n        var col = this.col.cloneNode();\n        col.style.width = formatUnit(getColumnWidth(sheet, idx));\n        return appendTo ? appendTo.appendChild(col) : col;\n    };\n    SheetRender.prototype.updateColContent = function (args) {\n        var _this = this;\n        getUpdateUsingRaf(function () {\n            var indexes;\n            var row;\n            var table;\n            var refChild;\n            var cell;\n            var hRow;\n            var rowCount = 0;\n            var col;\n            var hRefChild;\n            var sheet = _this.parent.getActiveSheet();\n            if (sheet.showHeaders) {\n                hRow = _this.parent.element.querySelector('.e-column-header .e-header-row');\n                hRefChild = hRow.firstElementChild;\n            }\n            var colGrp = _this.parent.element.querySelector('.e-sheet-content colgroup');\n            var colRefChild = colGrp.firstElementChild;\n            var skipRender;\n            var tBody = _this.parent.element.querySelector('.e-sheet-content tbody');\n            args.cells.forEach(function (value, key) {\n                if (skipRender) {\n                    return;\n                }\n                indexes = getRangeIndexes(key);\n                if (args.direction === 'first' && indexes[1] === args.indexes[1]) {\n                    _this.checkColMerge([indexes[0], _this.parent.viewport.leftIndex], args.indexes, (tBody.rows[rowCount] || { cells: [] }).cells[(args.indexes[3] - args.indexes[1]) + 1], getCell(indexes[0], _this.parent.viewport.leftIndex, sheet) || {});\n                }\n                if (indexes[0] === args.indexes[0]) {\n                    if (args.direction === 'last') {\n                        col = _this.col.cloneNode();\n                        col.style.width = formatUnit(getColumnWidth(sheet, indexes[1]));\n                        colGrp.insertBefore(col, colRefChild);\n                        if (sheet.showHeaders) {\n                            hRow.insertBefore(_this.cellRenderer.renderColHeader(indexes[1]), hRefChild);\n                        }\n                    }\n                    else {\n                        _this.updateCol(sheet, indexes[1], colGrp);\n                        if (sheet.showHeaders) {\n                            hRow.appendChild(_this.cellRenderer.renderColHeader(indexes[1]));\n                        }\n                    }\n                    if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                        // tslint:disable\n                        detach(colGrp[args.direction + 'ElementChild']);\n                        if (sheet.showHeaders) {\n                            detach(hRow[args.direction + 'ElementChild']);\n                        }\n                        // tslint:enable\n                    }\n                }\n                if (indexes[1] === args.indexes[1]) {\n                    row = tBody.children[rowCount];\n                    rowCount++;\n                    if (!row) {\n                        skipRender = true;\n                        return;\n                    }\n                    refChild = row.firstElementChild;\n                }\n                cell = _this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[0], cell: value, address: key,\n                    lastCell: indexes[1] === args.indexes[3], isHeightCheckNeeded: args.direction === 'first',\n                    first: args.direction === 'last' && !args.skipUpdateOnFirst && indexes[1] === args.indexes[1] ? 'Column' : '',\n                    checkNextBorder: args.direction === 'last' && indexes[3] === args.indexes[3] ? 'Column' : '', });\n                if (args.direction === 'last') {\n                    _this.checkColMerge(indexes, args.indexes, cell, value, (tBody.rows[rowCount - 1] || { cells: [] }).cells[0]);\n                    row.insertBefore(cell, refChild);\n                }\n                else {\n                    row.appendChild(cell);\n                }\n                if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                    // tslint:disable-next-line:no-any\n                    detach(row[args.direction + 'ElementChild']);\n                }\n            });\n            if (sheet.showHeaders) {\n                table = _this.getColHeaderTable();\n                detach(table.querySelector('colgroup'));\n                table.insertBefore(colGrp.cloneNode(true), table.querySelector('thead'));\n            }\n            if (_this.parent.scrollSettings.enableVirtualization) {\n                _this.parent.notify(virtualContentLoaded, { refresh: 'Column' });\n            }\n            if (_this.parent.allowChart) {\n                _this.parent.notify(chartRangeSelection, null);\n            }\n            if (_this.parent.isEdit) {\n                _this.parent.notify(forRefSelRender, {});\n            }\n            if (!_this.parent.isOpen) {\n                _this.parent.hideSpinner();\n            }\n            setAriaOptions(_this.parent.getMainContent(), { busy: false });\n        });\n    };\n    SheetRender.prototype.updateRowContent = function (args) {\n        var _this = this;\n        var colGroupWidth = this.colGroupWidth;\n        var row;\n        var hRow;\n        var cell;\n        var sheet = this.parent.getActiveSheet();\n        var cellModel;\n        var count = 0;\n        var tBody = this.parent.getMainContent().querySelector('tbody');\n        var rTBody;\n        var rFrag;\n        var index;\n        if (sheet.showHeaders) {\n            rFrag = document.createDocumentFragment();\n            rTBody = this.parent.getRowHeaderContent().querySelector('tbody');\n        }\n        var indexes;\n        var frag = document.createDocumentFragment();\n        this.parent.showSpinner();\n        args.cells.forEach(function (value, cKey) {\n            indexes = getRangeIndexes(cKey);\n            if (args.direction === 'first' && indexes[0] === args.indexes[0]) {\n                _this.checkRowMerge([_this.parent.viewport.topIndex, indexes[1]], args.indexes, (tBody.rows[(args.indexes[2] - args.indexes[0]) + 1] || { cells: [] }).cells[count], getCell(_this.parent.viewport.topIndex, indexes[1], sheet) || {});\n            }\n            if (indexes[1] === args.indexes[1]) {\n                if (sheet.showHeaders) {\n                    hRow = _this.rowRenderer.render(indexes[0], true);\n                    rFrag.appendChild(hRow);\n                    hRow.appendChild(_this.cellRenderer.renderRowHeader(indexes[0]));\n                    colGroupWidth = getColGroupWidth(indexes[0] + 1);\n                    if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                        // tslint:disable-next-line:no-any\n                        detach(rTBody[args.direction + 'ElementChild']);\n                    }\n                }\n                row = _this.rowRenderer.render(indexes[0]);\n                frag.appendChild(row);\n                if (_this.parent.scrollSettings.enableVirtualization && args.direction) {\n                    // tslint:disable-next-line:no-any\n                    detach(tBody[args.direction + 'ElementChild']);\n                }\n            }\n            cell = row.appendChild(_this.cellRenderer.render({ colIdx: indexes[1], rowIdx: indexes[2], cell: value, address: cKey, lastCell: indexes[1] === args.indexes[3], row: row, pHRow: sheet.showHeaders ? hRow.previousSibling : null,\n                checkNextBorder: args.direction === 'last' && indexes[2] === args.indexes[2] ? 'Row' : '', pRow: row.previousSibling,\n                isHeightCheckNeeded: args.direction === 'first' || args.direction === '', hRow: hRow, first: args.direction === 'last' &&\n                    !args.skipUpdateOnFirst && indexes[0] === args.indexes[0] ? 'Row' : '' }));\n            if (args.direction === 'last') {\n                _this.checkRowMerge(indexes, args.indexes, cell, value, tBody.rows[0].cells[count]);\n            }\n            count++;\n        });\n        if (this.colGroupWidth !== colGroupWidth) {\n            this.updateLeftColGroup(colGroupWidth);\n        }\n        if (args.direction === 'last') {\n            if (sheet.showHeaders) {\n                rTBody.insertBefore(rFrag, rTBody.firstElementChild);\n            }\n            tBody.insertBefore(frag, tBody.firstElementChild);\n        }\n        else {\n            if (sheet.showHeaders) {\n                rTBody.appendChild(rFrag);\n            }\n            tBody.appendChild(frag);\n        }\n        if (this.parent.scrollSettings.enableVirtualization) {\n            this.parent.notify(virtualContentLoaded, { refresh: 'Row' });\n        }\n        if (this.parent.isEdit) {\n            this.parent.notify(forRefSelRender, null);\n        }\n        if (this.parent.allowChart) {\n            this.parent.notify(chartRangeSelection, {});\n        }\n        if (!this.parent.isOpen) {\n            this.parent.hideSpinner();\n        }\n        setAriaOptions(this.parent.getMainContent(), { busy: false });\n    };\n    SheetRender.prototype.checkRowMerge = function (indexes, range, cell, model, firstcell) {\n        if (this.parent.scrollSettings.enableVirtualization && cell &&\n            (!isNullOrUndefined(model.rowSpan) || !isNullOrUndefined(model.colSpan))) {\n            if (indexes[0] === this.parent.viewport.topIndex) {\n                if (model.rowSpan < 0) {\n                    this.parent.notify(checkMerge, { td: cell, rowIdx: indexes[0], colIdx: indexes[1], isRow: true });\n                    if (this.parent.viewport.topIndex >= range[0]) {\n                        this.refreshPrevMerge(range[0] + 1, indexes[1]);\n                    }\n                }\n                if (firstcell && (firstcell.colSpan || firstcell.rowSpan)) {\n                    this.cellRenderer.refresh(indexes[0] + (range[2] - range[0]) + 1, indexes[1], null, firstcell);\n                }\n            }\n            else if (model.rowSpan > 1) {\n                var prevTopIdx = range[2] + 1;\n                if (indexes[0] + model.rowSpan - 1 > prevTopIdx && indexes[0] < prevTopIdx) {\n                    this.refreshPrevMerge(prevTopIdx, indexes[1], this.parent.viewport.topIndex);\n                }\n            }\n        }\n    };\n    SheetRender.prototype.refreshPrevMerge = function (prevTopIdx, colIndex, currTopIdx) {\n        var td = this.parent.getCell(prevTopIdx, colIndex, this.parent.getRow(currTopIdx ? currTopIdx : 0));\n        if (td && td.rowSpan > 1) {\n            this.cellRenderer.refresh(prevTopIdx, colIndex, null, td);\n        }\n    };\n    SheetRender.prototype.checkColMerge = function (indexes, range, cell, model, firstcell) {\n        if (this.parent.scrollSettings.enableVirtualization && cell && indexes[1] === this.parent.viewport.leftIndex &&\n            (!isNullOrUndefined(model.rowSpan) || !isNullOrUndefined(model.colSpan))) {\n            if (model.colSpan < 0) {\n                this.parent.notify(checkMerge, { td: cell, colIdx: indexes[1], rowIdx: indexes[0] });\n            }\n            if (firstcell && (firstcell.colSpan || firstcell.rowSpan)) {\n                this.cellRenderer.refresh(indexes[0], indexes[1] + (range[3] - range[1]) + 1, null, firstcell);\n            }\n        }\n    };\n    /**\n     * Used to toggle row and column headers.\n     */\n    SheetRender.prototype.showHideHeaders = function () {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        if (sheet.showHeaders) {\n            if (this.parent.scrollSettings.enableVirtualization) {\n                var indexes = [this.parent.viewport.topIndex, this.parent.viewport.leftIndex,\n                    this.parent.viewport.bottomIndex, this.parent.viewport.rightIndex];\n                this.renderHeaders([indexes[0], indexes[2]], [indexes[1], indexes[3]]);\n            }\n            else {\n                this.renderHeaders([0, sheet.rowCount - 1], [0, sheet.colCount - 1]);\n                if (sheet.topLeftCell !== 'A1') {\n                    this.parent.goTo(sheet.topLeftCell);\n                }\n            }\n        }\n        else {\n            getUpdateUsingRaf(function () {\n                detach(_this.headerPanel);\n                detach(_this.getRowHeaderPanel());\n                _this.getContentPanel().style.width = '';\n                _this.updateHideHeaders();\n            });\n        }\n    };\n    SheetRender.prototype.renderHeaders = function (rowIndexes, colIndexes) {\n        var _this = this;\n        var sheet = this.parent.getActiveSheet();\n        this.initHeaderPanel();\n        var cFrag = document.createDocumentFragment();\n        var rFrag = document.createDocumentFragment();\n        cFrag.appendChild(this.headerPanel);\n        var rowHdrEle = rFrag.appendChild(this.parent.createElement('div', { className: 'e-row-header', id: this.parent.element.id + \"_row_header\" }));\n        this.createHeaderTable(rowHdrEle);\n        this.parent.notify(beforeHeaderLoaded, { element: rowHdrEle });\n        this.refreshSelectALLContent();\n        var rTBody = rowHdrEle.querySelector('tbody');\n        var cTHead = this.headerPanel.querySelector('.e-column-header thead');\n        var cRow = this.rowRenderer.render();\n        cTHead.appendChild(cRow);\n        var row;\n        for (var i = colIndexes[0]; i <= colIndexes[1]; i++) {\n            if (!isHiddenCol(sheet, i)) {\n                cRow.appendChild(this.cellRenderer.renderColHeader(i));\n            }\n        }\n        var colGroupWidth = getColGroupWidth(rowIndexes[1]);\n        if (this.colGroupWidth !== colGroupWidth) {\n            this.updateLeftColGroup(colGroupWidth, rowHdrEle);\n        }\n        for (var i = rowIndexes[0]; i <= rowIndexes[1]; i++) {\n            if (!isHiddenRow(sheet, i)) {\n                row = this.rowRenderer.render(i, true);\n                row.appendChild(this.cellRenderer.renderRowHeader(i));\n                rTBody.appendChild(row);\n            }\n        }\n        getUpdateUsingRaf(function () {\n            _this.getColHeaderTable().insertBefore(_this.getContentTable().querySelector('colgroup').cloneNode(true), cTHead);\n            var sheet = document.getElementById(_this.parent.element.id + '_sheet');\n            sheet.classList.remove('e-hide-headers');\n            sheet.insertBefore(cFrag, _this.contentPanel);\n            var content = _this.getContentPanel();\n            _this.contentPanel.insertBefore(rFrag, content);\n            _this.parent.scrollModule.setPadding();\n            rowHdrEle.scrollTop = content.scrollTop;\n            _this.getColHeaderPanel().scrollLeft = content.scrollLeft;\n        });\n    };\n    SheetRender.prototype.updateHideHeaders = function () {\n        document.getElementById(this.parent.element.id + '_sheet').classList.add('e-hide-headers');\n        this.headerPanel = null;\n    };\n    /**\n     * Get the select all table element of spreadsheet\n     * @return {HTMLElement}\n     */\n    SheetRender.prototype.getSelectAllContent = function () {\n        return this.headerPanel.getElementsByClassName('e-selectall-container')[0];\n    };\n    /**\n     * Get the select all table element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getSelectAllTable = function () {\n        return this.headerPanel.getElementsByClassName('e-selectall-table')[0];\n    };\n    /**\n     * Get the column header element of spreadsheet\n     * @return {HTMLTableElement}\n     */\n    SheetRender.prototype.getColHeaderTable = function () {\n        return this.headerPanel.getElementsByClassName('e-colhdr-table')[0];\n    };\n    /**\n     * Get the row header table element of spreadsheet\n     * @return {HTMLTableElement}\n     */\n    SheetRender.prototype.getRowHeaderTable = function () {\n        return this.contentPanel.getElementsByClassName('e-rowhdr-table')[0];\n    };\n    /**\n     * Get the main content table element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getContentTable = function () {\n        return this.contentPanel.getElementsByClassName('e-content-table')[0];\n    };\n    /**\n     * Get the row header div element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getRowHeaderPanel = function () {\n        return this.contentPanel.getElementsByClassName('e-row-header')[0];\n    };\n    /**\n     * Get the column header div element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getColHeaderPanel = function () {\n        return this.headerPanel.getElementsByClassName('e-column-header')[0];\n    };\n    /**\n     * Get the main content div element of spreadsheet\n     * @return {Element}\n     */\n    SheetRender.prototype.getContentPanel = function () {\n        return this.contentPanel.getElementsByClassName('e-sheet-content')[0];\n    };\n    SheetRender.prototype.addEventListener = function () {\n        this.parent.on(created, this.triggerCreatedEvent, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    SheetRender.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    SheetRender.prototype.removeEventListener = function () {\n        this.parent.off(created, this.triggerCreatedEvent);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return SheetRender;\n}());\nexport { SheetRender };\n","import { skipHiddenIdx } from '../common/index';\nimport { getRowHeight, getCell, isHiddenRow } from '../../workbook/base/index';\nimport { attributes } from '@syncfusion/ej2-base';\nimport { getCellAddress } from '../../workbook/common/index';\n/**\n * Sheet module is used for creating row element\n * @hidden\n */\nvar RowRenderer = /** @class */ (function () {\n    function RowRenderer(parent) {\n        this.parent = parent;\n        this.element = this.parent.createElement('tr', { attrs: { 'role': 'row' } });\n        this.cellRenderer = parent.serviceLocator.getService('cell');\n    }\n    RowRenderer.prototype.render = function (index, isRowHeader, skipHidden) {\n        var row = this.element.cloneNode();\n        if (index === undefined) {\n            row.classList.add('e-header-row');\n            return row;\n        }\n        row.classList.add('e-row');\n        var sheet = this.parent.getActiveSheet();\n        attributes(row, { 'aria-rowindex': (index + 1).toString() });\n        row.style.height = getRowHeight(sheet, index) + \"px\";\n        if (isRowHeader && !skipHidden) {\n            if (isHiddenRow(sheet, index + 1) && !isHiddenRow(sheet, index - 1)) {\n                row.classList.add('e-hide-start');\n            }\n            if (index !== 0 && isHiddenRow(sheet, index - 1) && !isHiddenRow(sheet, index + 1)) {\n                row.classList.add('e-hide-end');\n            }\n        }\n        return row;\n    };\n    RowRenderer.prototype.refresh = function (index, pRow, hRow, header) {\n        var row;\n        var sheet = this.parent.getActiveSheet();\n        if (header) {\n            row = this.render(index, true, true);\n            row.appendChild(this.cellRenderer.renderRowHeader(index));\n        }\n        else {\n            row = this.render(index);\n            var len = this.parent.viewport.leftIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2);\n            for (var i = this.parent.viewport.leftIndex; i <= len; i++) {\n                row.appendChild(this.cellRenderer.render({ colIdx: i, rowIdx: index, cell: getCell(index, i, sheet),\n                    address: getCellAddress(index, i), lastCell: i === len, row: row, hRow: hRow, isHeightCheckNeeded: true, pRow: pRow,\n                    first: index === this.parent.viewport.topIndex && skipHiddenIdx(sheet, index, true) !== skipHiddenIdx(sheet, 0, true) ?\n                        'Row' : '' }));\n            }\n        }\n        return row;\n    };\n    return RowRenderer;\n}());\nexport { RowRenderer };\n","import { inView, renderFilterCell, checkConditionalFormat } from '../common/index';\nimport { hasTemplate, createHyperlinkElement, checkPrevMerge, createImageElement } from '../common/index';\nimport { getColumnHeaderText, getRangeIndexes, getRangeAddress } from '../../workbook/common/index';\nimport { setChart, refreshChart, getCellAddress } from '../../workbook/common/index';\nimport { getCell, skipDefaultValue, isHiddenRow, isHiddenCol } from '../../workbook/base/index';\nimport { getRowHeight, setRowHeight } from '../../workbook/base/index';\nimport { addClass, attributes, getNumberDependable, extend, compile, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getFormattedCellObject, applyCellFormat, workbookFormulaOperation, wrapEvent, cFRender } from '../../workbook/common/event';\nimport { getTypeFromFormat } from '../../workbook/index';\nimport { checkIsFormula } from '../../workbook/common/util';\n/**\n * CellRenderer class which responsible for building cell content.\n * @hidden\n */\nvar CellRenderer = /** @class */ (function () {\n    function CellRenderer(parent) {\n        this.parent = parent;\n        this.element = this.parent.createElement('td');\n        this.th = this.parent.createElement('th', { className: 'e-header-cell' });\n        this.tableRow = parent.createElement('tr', { className: 'e-row' });\n        this.parent.on('updateView', this.updateView, this);\n    }\n    CellRenderer.prototype.renderColHeader = function (index) {\n        var headerCell = this.th.cloneNode();\n        attributes(headerCell, { 'role': 'columnheader', 'aria-colindex': (index + 1).toString(), 'tabindex': '-1' });\n        headerCell.innerHTML = getColumnHeaderText(index + 1);\n        var sheet = this.parent.getActiveSheet();\n        if (isHiddenCol(sheet, index + 1)) {\n            headerCell.classList.add('e-hide-start');\n        }\n        if (index !== 0 && isHiddenCol(sheet, index - 1)) {\n            headerCell.classList.add('e-hide-end');\n        }\n        return headerCell;\n    };\n    CellRenderer.prototype.renderRowHeader = function (index) {\n        var headerCell = this.element.cloneNode();\n        addClass([headerCell], 'e-header-cell');\n        attributes(headerCell, { 'role': 'rowheader', 'tabindex': '-1' });\n        headerCell.innerHTML = (index + 1).toString();\n        return headerCell;\n    };\n    CellRenderer.prototype.render = function (args) {\n        args.td = this.element.cloneNode();\n        args.td.className = 'e-cell';\n        attributes(args.td, { 'role': 'gridcell', 'aria-colindex': (args.colIdx + 1).toString(), 'tabindex': '-1' });\n        var sheet = this.parent.getActiveSheet();\n        if (this.checkMerged(args)) {\n            return args.td;\n        }\n        var compiledTemplate = this.processTemplates(args.cell, args.rowIdx, args.colIdx);\n        if (typeof compiledTemplate === 'string') {\n            args.td.innerHTML = compiledTemplate;\n        }\n        else {\n            args.td.appendChild(compiledTemplate);\n        }\n        args.isRefresh = false;\n        this.update(args);\n        if (args.cell && args.td) {\n            this.parent.notify(cFRender, { rowIdx: args.rowIdx, colIdx: args.colIdx, cell: args.cell, td: args.td, isChecked: false });\n            if (args.td && args.td.children[0] && args.td.children[0].className === 'e-cf-databar') {\n                if (args.cell.style && args.cell.style.fontSize) {\n                    args.td.children[0].querySelector('.e-databar-value').style.fontSize = args.cell.style.fontSize;\n                }\n                args.td.children[0].style.height = '100%';\n                args.td.children[0].firstElementChild.nextElementSibling.style.height = '100%';\n            }\n        }\n        if (!hasTemplate(this.parent, args.rowIdx, args.colIdx, this.parent.activeSheetIndex)) {\n            this.parent.notify(renderFilterCell, { td: args.td, rowIndex: args.rowIdx, colIndex: args.colIdx });\n        }\n        var evtArgs = { cell: args.cell, element: args.td, address: args.address };\n        this.parent.trigger('beforeCellRender', evtArgs);\n        this.updateRowHeight({\n            rowIdx: args.rowIdx,\n            cell: evtArgs.element,\n            lastCell: args.lastCell,\n            rowHgt: 20,\n            row: args.row,\n            hRow: args.hRow\n        });\n        var isWrap = args.td.classList.contains('e-wraptext');\n        var cellValue = args.td.innerHTML;\n        if (cellValue.indexOf('\\n') > -1 && !isWrap) {\n            var splitVal = cellValue.split('\\n');\n            if (splitVal.length > 1) {\n                this.parent.notify(wrapEvent, {\n                    range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx], wrap: true, initial: true, sheet: this.parent.getActiveSheet(), td: args.td, row: args.row, hRow: args.hRow\n                });\n            }\n        }\n        return evtArgs.element;\n    };\n    // tslint:disable-next-line:max-func-body-length\n    CellRenderer.prototype.update = function (args) {\n        if (args.isRefresh) {\n            if (args.td.rowSpan) {\n                args.td.removeAttribute('rowSpan');\n            }\n            if (args.td.colSpan) {\n                args.td.removeAttribute('colSpan');\n            }\n            if (this.checkMerged(args)) {\n                return;\n            }\n        }\n        if (args.cell && args.cell.formula && !args.cell.value) {\n            var isFormula = checkIsFormula(args.cell.formula);\n            var eventArgs = {\n                action: 'refreshCalculate', value: args.cell.formula, rowIndex: args.rowIdx, colIndex: args.colIdx, isFormula: isFormula\n            };\n            this.parent.notify(workbookFormulaOperation, eventArgs);\n            args.cell.value = getCell(args.rowIdx, args.colIdx, this.parent.getActiveSheet()).value;\n        }\n        var formatArgs = {\n            type: args.cell && getTypeFromFormat(args.cell.format),\n            value: args.cell && args.cell.value, format: args.cell && args.cell.format ? args.cell.format : 'General',\n            formattedText: args.cell && args.cell.value, onLoad: true, isRightAlign: false, cell: args.cell,\n            rowIdx: args.rowIdx.toString(), colIdx: args.colIdx.toString()\n        };\n        if (args.cell) {\n            this.parent.notify(getFormattedCellObject, formatArgs);\n        }\n        if (!isNullOrUndefined(args.td)) {\n            this.parent.refreshNode(args.td, { type: formatArgs.type, result: formatArgs.formattedText,\n                curSymbol: getNumberDependable(this.parent.locale, 'USD'), isRightAlign: formatArgs.isRightAlign,\n                value: formatArgs.value || ''\n            });\n        }\n        var style = {};\n        if (args.cell) {\n            if (args.cell.style) {\n                if (args.cell.style.properties) {\n                    style = skipDefaultValue(args.cell.style, true);\n                }\n                else {\n                    style = args.cell.style;\n                }\n            }\n            if (args.cell.chart && args.cell.chart.length > 0) {\n                this.parent.notify(setChart, { chart: args.cell.chart, isInitCell: true, range: getCellAddress(args.rowIdx, args.colIdx) });\n            }\n            if (args.cell.hyperlink) {\n                this.parent.notify(createHyperlinkElement, { cell: args.cell, td: args.td, rowIdx: args.rowIdx, colIdx: args.colIdx });\n            }\n            if (args.cell.wrap) {\n                this.parent.notify(wrapEvent, {\n                    range: [args.rowIdx, args.colIdx, args.rowIdx, args.colIdx], wrap: true, sheet: this.parent.getActiveSheet(), initial: true, td: args.td, row: args.row, hRow: args.hRow\n                });\n            }\n            if (args.cell.rowSpan > 1) {\n                var rowSpan = args.cell.rowSpan - this.parent.hiddenCount(args.rowIdx, args.rowIdx + (args.cell.rowSpan - 1));\n                if (rowSpan > 1) {\n                    args.td.rowSpan = rowSpan;\n                }\n            }\n            if (args.cell.colSpan > 1) {\n                var colSpan = args.cell.colSpan -\n                    this.parent.hiddenCount(args.colIdx, args.colIdx + (args.cell.colSpan - 1), 'columns');\n                if (colSpan > 1) {\n                    args.td.colSpan = colSpan;\n                }\n            }\n            if (args.cell.image) {\n                for (var i = 0; i < args.cell.image.length; i++) {\n                    this.parent.notify(createImageElement, {\n                        options: {\n                            src: args.cell.image[i].src, imageId: args.cell.image[i].id,\n                            height: args.cell.image[i].height, width: args.cell.image[i].width,\n                            top: args.cell.image[i].top, left: args.cell.image[i].left\n                        },\n                        range: getRangeAddress([args.rowIdx, args.colIdx, args.rowIdx, args.colIdx]), isPublic: false\n                    });\n                }\n            }\n        }\n        if (args.isRefresh) {\n            this.removeStyle(args.td, args.rowIdx, args.colIdx);\n        }\n        if (this.parent.allowConditionalFormat && args.lastCell) {\n            this.parent.notify(checkConditionalFormat, { rowIdx: args.rowIdx, colIdx: args.colIdx, cell: args.cell });\n        }\n        if (this.parent.allowChart && args.lastCell) {\n            this.parent.notify(refreshChart, {\n                cell: args.cell, rIdx: args.rowIdx, cIdx: args.colIdx, sheetIdx: this.parent.activeSheetIndex\n            });\n        }\n        if (Object.keys(style).length || Object.keys(this.parent.commonCellStyle).length || args.lastCell) {\n            this.parent.notify(applyCellFormat, {\n                style: extend({}, this.parent.commonCellStyle, style), rowIdx: args.rowIdx, colIdx: args.colIdx, cell: args.td,\n                first: args.first, row: args.row, lastCell: args.lastCell, hRow: args.hRow, pRow: args.pRow, isHeightCheckNeeded: args.isHeightCheckNeeded, manualUpdate: args.manualUpdate\n            });\n        }\n        if (args.checkNextBorder === 'Row') {\n            var borderTop = this.parent.getCellStyleValue(['borderTop'], [Number(this.parent.getContentTable().rows[0].getAttribute('aria-rowindex')) - 1, args.colIdx]).borderTop;\n            if (borderTop !== '' && (!args.cell || !args.cell.style || !args.cell.style.bottomPriority)) {\n                this.parent.notify(applyCellFormat, { style: { borderBottom: borderTop }, rowIdx: args.rowIdx,\n                    colIdx: args.colIdx, cell: args.td });\n            }\n        }\n        if (args.checkNextBorder === 'Column') {\n            var borderLeft = this.parent.getCellStyleValue(['borderLeft'], [args.rowIdx, args.colIdx + 1]).borderLeft;\n            if (borderLeft !== '' && (!args.cell || !args.cell.style || (!args.cell.style.borderRight && !args.cell.style.border))) {\n                this.parent.notify(applyCellFormat, { style: { borderRight: borderLeft }, rowIdx: args.rowIdx, colIdx: args.colIdx,\n                    cell: args.td });\n            }\n        }\n        if (args.cell && args.cell.hyperlink && !hasTemplate(this.parent, args.rowIdx, args.colIdx, this.parent.activeSheetIndex)) {\n            var address = void 0;\n            if (typeof (args.cell.hyperlink) === 'string') {\n                address = args.cell.hyperlink;\n                if (address.indexOf('http://') !== 0 && address.indexOf('https://') !== 0 && address.indexOf('ftp://') !== 0) {\n                    args.cell.hyperlink = address.toLowerCase().indexOf('www.') === 0 ? 'http://' + address : address;\n                }\n            }\n            else {\n                address = args.cell.hyperlink.address;\n                if (address.indexOf('http://') !== 0 && address.indexOf('https://') !== 0 && address.indexOf('ftp://') !== 0) {\n                    args.cell.hyperlink.address = address.toLowerCase().indexOf('www.') === 0 ? 'http://' + address : address;\n                }\n            }\n            this.parent.notify(createHyperlinkElement, { cell: args.cell, td: args.td, rowIdx: args.rowIdx, colIdx: args.colIdx });\n        }\n    };\n    CellRenderer.prototype.checkMerged = function (args) {\n        if (args.cell && (args.cell.colSpan < 0 || args.cell.rowSpan < 0)) {\n            args.td.style.display = 'none';\n            if (args.cell.colSpan < 0) {\n                this.parent.notify(checkPrevMerge, args);\n            }\n            if (args.cell.rowSpan < 0) {\n                args.isRow = true;\n                this.parent.notify(checkPrevMerge, args);\n            }\n            return true;\n        }\n        return false;\n    };\n    CellRenderer.prototype.processTemplates = function (cell, rowIdx, colIdx) {\n        var sheet = this.parent.getActiveSheet();\n        var ranges = sheet.ranges;\n        var range;\n        for (var j = 0, len = ranges.length; j < len; j++) {\n            if (ranges[j].template) {\n                range = getRangeIndexes(ranges[j].address.length ? ranges[j].address : ranges[j].startCell);\n                if (range[0] <= rowIdx && range[1] <= colIdx && range[2] >= rowIdx && range[3] >= colIdx) {\n                    if (cell) {\n                        return this.compileCellTemplate(ranges[j].template);\n                    }\n                    else {\n                        if (!getCell(rowIdx, colIdx, sheet, true)) {\n                            return this.compileCellTemplate(ranges[j].template);\n                        }\n                    }\n                }\n            }\n        }\n        return '';\n    };\n    CellRenderer.prototype.compileCellTemplate = function (template) {\n        var compiledStr;\n        if (typeof template === 'string') {\n            var templateString = void 0;\n            if (template.trim().indexOf('#') === 0) {\n                templateString = document.querySelector(template).innerHTML.trim();\n            }\n            else {\n                templateString = template;\n            }\n            compiledStr = compile(templateString);\n            return compiledStr({}, null, null, '', true)[0].outerHTML;\n        }\n        else {\n            compiledStr = compile(template);\n            return compiledStr({}, this.parent, 'ranges', '')[0];\n        }\n    };\n    CellRenderer.prototype.updateRowHeight = function (args) {\n        if (args.cell && args.cell.children.length) {\n            var clonedCell = args.cell.cloneNode(true);\n            this.tableRow.appendChild(clonedCell);\n        }\n        if (args.lastCell && this.tableRow.childElementCount) {\n            var sheet = this.parent.getActiveSheet();\n            var tableRow = args.row || this.parent.getRow(args.rowIdx);\n            var previouseHeight = getRowHeight(sheet, args.rowIdx);\n            var rowHeight = this.getRowHeightOnInit();\n            if (rowHeight > previouseHeight) {\n                tableRow.style.height = rowHeight + \"px\";\n                if (sheet.showHeaders) {\n                    (args.hRow || this.parent.getRow(args.rowIdx, this.parent.getRowHeaderTable())).style.height =\n                        rowHeight + \"px\";\n                }\n                setRowHeight(sheet, args.rowIdx, rowHeight);\n            }\n            this.tableRow.innerHTML = '';\n        }\n    };\n    CellRenderer.prototype.getRowHeightOnInit = function () {\n        var tTable = this.parent.createElement('table', { className: 'e-table e-test-table' });\n        var tBody = tTable.appendChild(this.parent.createElement('tbody'));\n        tBody.appendChild(this.tableRow);\n        this.parent.element.appendChild(tTable);\n        var height = Math.round(this.tableRow.getBoundingClientRect().height);\n        this.parent.element.removeChild(tTable);\n        return height < 20 ? 20 : height;\n    };\n    CellRenderer.prototype.removeStyle = function (element, rowIdx, colIdx) {\n        var cellStyle;\n        if (element.style.length) {\n            cellStyle = this.parent.getCellStyleValue(['borderLeft', 'border'], [rowIdx, colIdx + 1]);\n            var rightBorder_1 = cellStyle.borderLeft || cellStyle.border;\n            cellStyle = this.parent.getCellStyleValue(['borderTop', 'border'], [rowIdx + 1, colIdx]);\n            var bottomBorder_1 = cellStyle.borderTop || cellStyle.border;\n            if (rightBorder_1 || bottomBorder_1) {\n                [].slice.call(element.style).forEach(function (style) {\n                    if ((rightBorder_1 && !(style.indexOf('border-right') > -1) && !bottomBorder_1) ||\n                        (bottomBorder_1 && !(style.indexOf('border-bottom') > -1) && !rightBorder_1)) {\n                        element.style.removeProperty(style);\n                    }\n                });\n            }\n            else {\n                element.removeAttribute('style');\n            }\n        }\n        var prevRowCell = this.parent.getCell(rowIdx - 1, colIdx);\n        if (prevRowCell && prevRowCell.style.borderBottom) {\n            var prevRowIdx = Number(prevRowCell.parentElement.getAttribute('aria-rowindex')) - 1;\n            cellStyle = this.parent.getCellStyleValue(['borderBottom', 'border'], [prevRowIdx, colIdx]);\n            if (!(cellStyle.borderBottom || cellStyle.border)) {\n                prevRowCell.style.borderBottom = '';\n            }\n        }\n        var prevColCell = element.previousElementSibling;\n        if (prevColCell && prevColCell.style.borderRight) {\n            colIdx = Number(prevColCell.getAttribute('aria-colindex')) - 1;\n            cellStyle = this.parent.getCellStyleValue(['borderRight', 'border'], [rowIdx, colIdx]);\n            if (!(cellStyle.borderRight || cellStyle.border)) {\n                prevColCell.style.borderRight = '';\n            }\n        }\n    };\n    /** @hidden */\n    CellRenderer.prototype.refreshRange = function (range) {\n        var sheet = this.parent.getActiveSheet();\n        var cRange = range.slice();\n        if (inView(this.parent, cRange, true)) {\n            for (var i = cRange[0]; i <= cRange[2]; i++) {\n                if (isHiddenRow(sheet, i)) {\n                    continue;\n                }\n                for (var j = cRange[1]; j <= cRange[3]; j++) {\n                    var cell = this.parent.getCell(i, j);\n                    if (cell) {\n                        this.update({ rowIdx: i, colIdx: j, td: cell, cell: getCell(i, j, sheet), lastCell: j === cRange[3], isRefresh: true, isHeightCheckNeeded: true, manualUpdate: true, first: '' });\n                        this.parent.notify(renderFilterCell, { td: cell, rowIndex: i, colIndex: j });\n                    }\n                }\n            }\n        }\n    };\n    CellRenderer.prototype.refresh = function (rowIdx, colIdx, lastCell, element) {\n        var sheet = this.parent.getActiveSheet();\n        if (!element && (isHiddenRow(sheet, rowIdx) || isHiddenCol(sheet, colIdx))) {\n            return;\n        }\n        if (element || !this.parent.scrollSettings.enableVirtualization || (rowIdx >= this.parent.viewport.topIndex && rowIdx <=\n            this.parent.viewport.bottomIndex && colIdx >= this.parent.viewport.leftIndex && colIdx <=\n            this.parent.viewport.rightIndex)) {\n            var cell = element || this.parent.getCell(rowIdx, colIdx);\n            this.update({ rowIdx: rowIdx, colIdx: colIdx, td: cell, cell: getCell(rowIdx, colIdx, sheet), lastCell: lastCell, isRefresh: true, isHeightCheckNeeded: true,\n                manualUpdate: true, first: '' });\n            this.parent.notify(renderFilterCell, { td: cell, rowIndex: rowIdx, colIndex: colIdx });\n        }\n    };\n    CellRenderer.prototype.updateView = function (args) {\n        this.refreshRange(args.indexes);\n    };\n    return CellRenderer;\n}());\nexport { CellRenderer };\n","import { initialLoad, ribbon, formulaBar, beforeVirtualContentLoaded, setAriaOptions, getSiblingsHeight } from '../common/index';\nimport { SheetRender, RowRenderer, CellRenderer } from './index';\nimport { remove } from '@syncfusion/ej2-base';\nimport { getSheetName, getRowsHeight, getColumnsWidth } from '../../workbook/base/index';\nimport { getCellAddress, getCellIndexes, workbookFormulaOperation } from '../../workbook/common/index';\nimport { dataRefresh, sheetTabs, onContentScroll, deInitProperties, beforeDataBound, isReact } from '../common/index';\nimport { spreadsheetDestroyed, isFormulaBarEdit, editOperation, renderReactTemplates } from '../common/index';\n/**\n * Render module is used to render the spreadsheet\n * @hidden\n */\nvar Render = /** @class */ (function () {\n    function Render(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Render.prototype.render = function () {\n        this.parent.activeSheetIndex = this.parent.skipHiddenSheets(this.parent.activeSheetIndex);\n        if (!this.parent.isMobileView()) {\n            this.parent.notify(ribbon, null);\n            this.parent.notify(formulaBar, null);\n        }\n        var sheetPanel = this.parent.createElement('div', {\n            id: this.parent.element.id + '_sheet_panel', className: 'e-sheet-panel'\n        });\n        if (this.parent.enableRtl) {\n            sheetPanel.classList.add('e-rtl');\n        }\n        this.parent.element.appendChild(sheetPanel);\n        if (this.parent.showSheetTabs) {\n            this.parent.notify(sheetTabs, null);\n        }\n        else { // for formula calculation\n            var sheetName = getSheetName(this.parent, 0);\n            var arg = { action: 'addSheet', sheetName: 'Sheet1', index: 1, visibleName: sheetName };\n            this.parent.notify(workbookFormulaOperation, arg);\n            this.parent.notify(workbookFormulaOperation, { action: 'initiateDefinedNames' });\n        }\n        if (this.parent.isMobileView()) {\n            this.parent.notify(formulaBar, null);\n            this.parent.notify(ribbon, null);\n        }\n        this.setSheetPanelSize();\n        this.renderSheet(sheetPanel);\n        this.checkTopLeftCell(true);\n    };\n    Render.prototype.checkTopLeftCell = function (initLoad) {\n        var sheet = this.parent.getActiveSheet();\n        if (!this.parent.scrollSettings.enableVirtualization || sheet.topLeftCell === 'A1') {\n            this.refreshUI({ rowIndex: 0, colIndex: 0, refresh: 'All' }, null, initLoad);\n        }\n        else {\n            var indexes = getCellIndexes(sheet.topLeftCell);\n            var top_1 = indexes[0] ? getRowsHeight(sheet, 0, indexes[0] - 1) : 0;\n            var left = indexes[1] ? getColumnsWidth(sheet, 0, indexes[1] - 1) : 0;\n            this.parent.notify(onContentScroll, { scrollLeft: left, scrollTop: top_1, preventScroll: true });\n            var threshold = this.parent.getThreshold('row');\n            var rowIndex = indexes[0] > threshold ? indexes[0] - threshold : 0;\n            threshold = this.parent.getThreshold('col');\n            var colIndex = indexes[1] > threshold ? indexes[1] - threshold : 0;\n            this.refreshUI({ rowIndex: rowIndex, colIndex: colIndex, refresh: 'All', top: top_1, left: left });\n        }\n    };\n    Render.prototype.renderSheet = function (panel) {\n        if (panel === void 0) { panel = document.getElementById(this.parent.element.id + '_sheet_panel'); }\n        panel.appendChild(this.parent.createElement('div', { className: 'e-sheet', id: this.parent.element.id + '_sheet' }));\n        this.parent.serviceLocator.getService('sheet').renderPanel();\n    };\n    Render.prototype.refreshUI = function (args, address, initLoad) {\n        var _this = this;\n        var sheetModule = this.parent.serviceLocator.getService('sheet');\n        var sheet = this.parent.getActiveSheet();\n        var sheetName = getSheetName(this.parent);\n        this.parent.showSpinner();\n        if (!address) {\n            if (this.parent.scrollSettings.enableVirtualization) {\n                var lastRow = args.rowIndex + this.parent.viewport.rowCount + (this.parent.getThreshold('row') * 2);\n                var count = sheet.rowCount - 1;\n                if (this.parent.scrollSettings.isFinite && lastRow > count) {\n                    lastRow = count;\n                }\n                var lastCol = args.colIndex + this.parent.viewport.colCount + (this.parent.getThreshold('col') * 2);\n                count = sheet.colCount - 1;\n                if (this.parent.scrollSettings.isFinite && lastCol > count) {\n                    lastCol = count;\n                }\n                var indexes = this.parent.skipHidden(args.rowIndex, lastRow);\n                var startRow = args.rowIndex;\n                if (args.rowIndex !== indexes[0]) {\n                    var topLeftCell = getCellIndexes(sheet.topLeftCell);\n                    if (topLeftCell[0] === args.rowIndex) {\n                        this.parent.setSheetPropertyOnMute(sheet, 'topLeftCell', getCellAddress(indexes[0], topLeftCell[1]));\n                    }\n                    args.rowIndex = indexes[0];\n                }\n                lastRow = indexes[1];\n                indexes = this.parent.skipHidden(args.colIndex, lastCol, 'columns');\n                var startCol = args.colIndex;\n                if (args.colIndex !== indexes[0]) {\n                    var topLeftCell = getCellIndexes(sheet.topLeftCell);\n                    if (topLeftCell[1] === args.colIndex) {\n                        this.parent.setSheetPropertyOnMute(sheet, 'topLeftCell', getCellAddress(topLeftCell[0], indexes[0]));\n                    }\n                    args.colIndex = indexes[0];\n                }\n                lastCol = indexes[1];\n                this.parent.viewport.topIndex = args.rowIndex;\n                this.parent.viewport.bottomIndex = lastRow;\n                this.parent.viewport.leftIndex = args.colIndex;\n                this.parent.viewport.rightIndex = lastCol;\n                address = getCellAddress(startRow, startCol) + \":\" + getCellAddress(lastRow, lastCol);\n            }\n            else {\n                address = \"A1:\" + getCellAddress(sheet.rowCount - 1, sheet.colCount - 1);\n            }\n        }\n        if (args.refresh === 'All') {\n            this.parent.trigger(beforeDataBound, {});\n        }\n        setAriaOptions(this.parent.getMainContent(), { busy: true });\n        var sheetsLen = this.parent.sheets.length;\n        this.parent.getData(sheetName + \"!\" + address).then(function (values) {\n            if (sheetsLen < _this.parent.sheets.length) {\n                return;\n            }\n            var sheetIdx = _this.parent.sheets.indexOf(sheet);\n            if (sheetIdx === -1 || sheetIdx !== _this.parent.activeSheetIndex) {\n                if (sheetIdx > -1) {\n                    _this.checkTopLeftCell();\n                }\n                return;\n            }\n            var indexes = [args.rowIndex, args.colIndex].concat(getCellIndexes(address.split(':')[1]));\n            switch (args.refresh) {\n                case 'All':\n                    sheetModule.renderTable({ cells: values, indexes: indexes, top: args.top, left: args.left, initLoad: initLoad });\n                    break;\n                case 'Row':\n                    sheetModule.refreshRowContent({ cells: values, indexes: indexes, skipUpdateOnFirst: args.skipUpdateOnFirst });\n                    var isEdit = false;\n                    var arg = { isEdit: isEdit };\n                    _this.parent.notify(isFormulaBarEdit, arg);\n                    if (arg.isEdit) {\n                        _this.parent.notify(editOperation, { action: 'startEdit', refreshCurPos: false });\n                    }\n                    break;\n                case 'Column':\n                    sheetModule.refreshColumnContent({ cells: values, indexes: indexes, skipUpdateOnFirst: args.skipUpdateOnFirst });\n                    break;\n                case 'RowPart':\n                    sheetModule.updateRowContent({\n                        cells: values, indexes: indexes, direction: args.direction, skipUpdateOnFirst: args.skipUpdateOnFirst\n                    });\n                    break;\n                case 'ColumnPart':\n                    sheetModule.updateColContent({\n                        cells: values, indexes: indexes, direction: args.direction, skipUpdateOnFirst: args.skipUpdateOnFirst\n                    });\n                    break;\n            }\n            if (_this.parent[isReact]) {\n                _this.parent[renderReactTemplates]();\n            }\n        });\n        this.parent.notify(beforeVirtualContentLoaded, { refresh: args.refresh });\n    };\n    Render.prototype.removeSheet = function () {\n        remove(document.getElementById(this.parent.element.id + '_sheet'));\n    };\n    /**\n     * Refresh the active sheet\n     */\n    Render.prototype.refreshSheet = function () {\n        this.removeSheet();\n        this.renderSheet();\n        this.parent.notify(deInitProperties, {});\n        this.checkTopLeftCell();\n    };\n    /**\n     * Used to set sheet panel size.\n     */\n    Render.prototype.setSheetPanelSize = function () {\n        var panel = document.getElementById(this.parent.element.id + '_sheet_panel');\n        var offset = this.parent.element.getBoundingClientRect();\n        var height;\n        if (this.parent.height === 'auto') {\n            panel.style.height = '260px';\n            height = 230;\n        }\n        else {\n            height = offset.height - getSiblingsHeight(panel);\n            panel.style.height = height + \"px\";\n            height -= 32;\n        }\n        this.parent.viewport.height = height;\n        this.parent.viewport.width = offset.width - 32;\n        this.parent.viewport.rowCount = this.roundValue(height, 20);\n        this.parent.viewport.colCount = this.roundValue(offset.width, 64);\n    };\n    Render.prototype.roundValue = function (size, threshold) {\n        var value = size / threshold;\n        var roundedValue = Math.round(value);\n        return Math.abs(value - roundedValue) < 0.5 ? roundedValue : roundedValue - 1;\n    };\n    /**\n     * Registing the renderer related services.\n     */\n    Render.prototype.instantiateRenderer = function () {\n        this.parent.serviceLocator.register('cell', new CellRenderer(this.parent));\n        this.parent.serviceLocator.register('row', new RowRenderer(this.parent));\n        this.parent.serviceLocator.register('sheet', new SheetRender(this.parent));\n    };\n    /**\n     * Destroy the Render module.\n     * @return {void}\n     */\n    Render.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    Render.prototype.addEventListener = function () {\n        this.parent.on(initialLoad, this.instantiateRenderer, this);\n        this.parent.on(dataRefresh, this.refreshSheet, this);\n        this.parent.on(spreadsheetDestroyed, this.destroy, this);\n    };\n    Render.prototype.removeEventListener = function () {\n        this.parent.off(initialLoad, this.instantiateRenderer);\n        this.parent.off(dataRefresh, this.refreshSheet);\n        this.parent.off(spreadsheetDestroyed, this.destroy);\n    };\n    return Render;\n}());\nexport { Render };\n","import { Dialog as DialogComponent } from '@syncfusion/ej2-popups';\nimport { extend, remove, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { locale } from '../common/index';\n/**\n * Dialog Service.\n * @hidden\n */\nvar Dialog = /** @class */ (function () {\n    /**\n     * Constructor for initializing dialog service.\n     */\n    function Dialog(parent) {\n        this.parent = parent;\n    }\n    /**\n     * To show dialog.\n     */\n    Dialog.prototype.show = function (dialogModel, cancelBtn) {\n        var _this = this;\n        var btnContent;\n        cancelBtn = isNullOrUndefined(cancelBtn) ? true : false;\n        var closeHandler = dialogModel.close || null;\n        var model = {\n            header: 'Spreadsheet',\n            cssClass: this.parent.cssClass,\n            target: this.parent.element,\n            buttons: []\n        };\n        dialogModel.close = function () {\n            _this.dialogInstance.destroy();\n            remove(_this.dialogInstance.element);\n            _this.dialogInstance = null;\n            if (closeHandler) {\n                closeHandler();\n            }\n        };\n        extend(model, dialogModel);\n        if (cancelBtn) {\n            btnContent = this.parent.serviceLocator.getService(locale).getConstant(model.buttons.length ? 'Cancel' : 'Ok');\n            model.buttons.push({\n                buttonModel: { content: btnContent, isPrimary: model.buttons.length === 0 },\n                click: this.hide.bind(this),\n            });\n        }\n        var div = this.parent.createElement('div');\n        document.body.appendChild(div);\n        this.dialogInstance = new DialogComponent(model);\n        this.dialogInstance.createElement = this.parent.createElement;\n        this.dialogInstance.appendTo(div);\n        this.dialogInstance.refreshPosition();\n    };\n    /**\n     * To hide dialog.\n     */\n    Dialog.prototype.hide = function () {\n        if (this.dialogInstance) {\n            this.dialogInstance.hide();\n        }\n    };\n    /**\n     * To clear private variables.\n     */\n    Dialog.prototype.destroy = function () {\n        this.parent = null;\n    };\n    return Dialog;\n}());\nexport { Dialog };\n","import { completeAction, beginAction } from '../common/index';\nimport { setActionData, updateUndoRedoCollection } from '../common/index';\n/**\n *  Begin and complete events.\n * @hidden\n */\nvar ActionEvents = /** @class */ (function () {\n    /**\n     * Constructor for initializing action begin and action complete services.\n     */\n    function ActionEvents(parent) {\n        this.parent = parent;\n        this.addEventListener();\n        //this.initializeActionBegin();\n        //this.initializeActionComplete();\n    }\n    ActionEvents.prototype.initializeActionBegin = function () {\n        var _this = this;\n        var cellFormat = this.parent.beforeCellFormat;\n        this.parent.beforeCellFormat = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: cellFormat, actionType: 'begin', eventType: 'format' });\n        };\n        var beforeOpen = this.parent.beforeOpen;\n        this.parent.beforeOpen = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: beforeOpen, actionType: 'begin', eventType: 'beforeOpen' });\n        };\n        var beforeSave = this.parent.beforeSave;\n        this.parent.beforeSave = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: beforeSave, actionType: 'begin', eventType: 'beforeSave' });\n        };\n        var beforeSort = this.parent.beforeSort;\n        this.parent.beforeSort = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: beforeSort, actionType: 'begin', eventType: 'beforeSort' });\n        };\n    };\n    ActionEvents.prototype.initializeActionComplete = function () {\n        var _this = this;\n        var sortComplete = this.parent.sortComplete;\n        this.parent.sortComplete = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: sortComplete, actionType: 'complete', eventType: 'sorting' });\n        };\n        var cellSave = this.parent.cellSave;\n        this.parent.cellSave = function (args) {\n            _this.actionEventHandler({ evtArgs: args, evtFunc: cellSave, actionType: 'complete', eventType: 'cellSave' });\n        };\n    };\n    ActionEvents.prototype.actionEventHandler = function (args) {\n        if (args.evtFunc) {\n            args.evtFunc.apply(this, [args]);\n        }\n        if (args.actionType === 'begin') {\n            this.actionBeginHandler({ eventArgs: args.evtArgs, action: args.eventType });\n        }\n        else {\n            this.actionCompleteHandler({ eventArgs: args.evtArgs, action: args.eventType });\n        }\n    };\n    ActionEvents.prototype.actionBeginHandler = function (args) {\n        this.parent.trigger('actionBegin', { action: args.action, args: args });\n        if (args.action === 'clipboard' || args.action === 'beforeSort' || args.action === 'format' || args.action === 'cellSave'\n            || args.action === 'beforeWrap' || args.action === 'beforeReplace'\n            || args.action === 'beforeClear' || args.action === 'beforeInsertImage' || args.action === 'beforeInsertChart'\n            || args.action === 'filter' || args.action === 'cellDelete') {\n            this.parent.notify(setActionData, { args: args });\n        }\n    };\n    ActionEvents.prototype.actionCompleteHandler = function (args) {\n        this.parent.trigger('actionComplete', args);\n        if (args.action !== 'undoRedo' && args.action !== 'gotoSheet') {\n            this.parent.notify(updateUndoRedoCollection, { args: args });\n        }\n    };\n    ActionEvents.prototype.addEventListener = function () {\n        this.parent.on(completeAction, this.actionCompleteHandler, this);\n        this.parent.on(beginAction, this.actionBeginHandler, this);\n    };\n    ActionEvents.prototype.removeEventListener = function () {\n        this.parent.off(completeAction, this.actionCompleteHandler);\n        this.parent.off(beginAction, this.actionBeginHandler);\n    };\n    return ActionEvents;\n}());\nexport { ActionEvents };\n","import { getCellPosition, refreshImgCellObj, refreshChartCellObj } from '../common/index';\nimport { getRangeIndexes, refreshChartSize, focusChartBorder } from '../../workbook/index';\nimport { EventHandler, removeClass, closest } from '@syncfusion/ej2-base';\n/**\n * Specifes to create or modify overlay.\n * @hidden\n */\nvar Overlay = /** @class */ (function () {\n    /**\n     * Constructor for initializing Overlay service.\n     */\n    function Overlay(parent) {\n        this.minHeight = '300px';\n        this.minWidth = '400px';\n        this.isOverlayClicked = false;\n        this.isResizerClicked = false;\n        this.currentWidth = 400;\n        this.currenHeight = 300;\n        this.parent = parent;\n    }\n    /**\n     * To insert a shape.\n     * @hidden\n     */\n    Overlay.prototype.insertOverlayElement = function (id, range, sheetIndex) {\n        var div = this.parent.createElement('div', {\n            id: id,\n            attrs: { 'class': 'e-ss-overlay' },\n            styles: 'width: ' + this.minWidth + ';  height: ' + this.minHeight\n        });\n        var indexes = getRangeIndexes(range);\n        var sheet = this.parent.sheets[sheetIndex];\n        var pos = getCellPosition(sheet, indexes);\n        div.style.top = pos.top + 'px';\n        div.style.left = pos.left + 'px';\n        this.parent.getMainContent().appendChild(div);\n        this.renderResizeHandles(div);\n        this.addEventListener(div);\n        this.originalWidth = parseFloat(getComputedStyle(div, null).getPropertyValue('width').replace('px', ''));\n        this.originalHeight = parseFloat(getComputedStyle(div, null).getPropertyValue('height').replace('px', ''));\n        return div;\n    };\n    Overlay.prototype.addEventListener = function (div) {\n        var overlayElem = div;\n        EventHandler.add(overlayElem, 'mousedown', this.overlayClickHandler, this);\n        EventHandler.add(overlayElem, 'mousemove', this.overlayMouseMoveHandler, this);\n        EventHandler.add(this.parent.getMainContent(), 'mousemove', this.overlayMouseMoveHandler, this);\n        EventHandler.add(document, 'mouseup', this.overlayMouseUpHandler, this);\n    };\n    Overlay.prototype.overlayMouseMoveHandler = function (e) {\n        var target = e.target;\n        var overlayElem = document.getElementsByClassName('e-ss-overlay-active')[0];\n        if (this.isOverlayClicked && this.isResizerClicked) {\n            switch (this.resizer) {\n                case 'e-ss-overlay-t':\n                    var height1 = Math.max(this.originalMouseY - e.clientY + this.originalHeight, 20);\n                    var top_1 = e.clientY - (this.originalMouseY - this.originalResizeTop);\n                    if (height1 > 180 && top_1 > -1) {\n                        overlayElem.style.height = height1 + 'px';\n                        overlayElem.style.top = top_1 + 'px';\n                        this.resizedReorderTop = top_1; // resized divTop\n                        this.currenHeight = height1;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n                case 'e-ss-overlay-r':\n                    var width1 = this.originalWidth + (e.pageX - this.originalMouseX);\n                    if (width1 > 180) {\n                        overlayElem.style.width = width1 + 'px';\n                        this.currentWidth = width1;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n                case 'e-ss-overlay-b':\n                    var height2 = this.originalHeight + (e.pageY - this.originalMouseY);\n                    if (height2 > 180) {\n                        overlayElem.style.height = height2 + 'px';\n                        this.currenHeight = height2;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n                case 'e-ss-overlay-l':\n                    var width2 = Math.max(this.originalMouseX - e.clientX + this.originalWidth, 20);\n                    var left = e.clientX - (this.originalMouseX - this.originalResizeLeft);\n                    if (width2 > 180 && left > -1) {\n                        overlayElem.style.width = width2 + 'px';\n                        overlayElem.style.left = left + 'px';\n                        this.resizedReorderLeft = left; //resized divLeft\n                        this.currentWidth = width2;\n                        this.parent.notify(refreshChartSize, {\n                            height: overlayElem.style.height, width: overlayElem.style.width, overlayEle: overlayElem\n                        });\n                    }\n                    break;\n            }\n        }\n        else if (this.isOverlayClicked) {\n            if ((closest(target, '.e-sheet-content') && !target.classList.contains('e-sheet-content')) ||\n                target.classList.contains('e-cell')) {\n                var posX = e.clientX;\n                var posY = e.clientY;\n                var aX = posX - this.diffX;\n                var aY = posY - this.diffY;\n                if (aX > -1) {\n                    overlayElem.style.left = aX + 'px';\n                }\n                if (aY > -1) {\n                    overlayElem.style.top = aY + 'px';\n                }\n                this.resizedReorderLeft = aX; //resized divLeft\n                this.resizedReorderTop = aY; // resized divTop\n            }\n            else {\n                this.overlayMouseUpHandler(e, true);\n            }\n        }\n    };\n    Overlay.prototype.overlayMouseUpHandler = function (e, isMouseUp) {\n        if (this.parent.getActiveSheet().isProtected) {\n            return;\n        }\n        this.isResizerClicked = false;\n        var elem = e.target;\n        var overlaElems = document.getElementsByClassName('e-datavisualization-chart e-ss-overlay-active');\n        if (!elem.classList.contains('e-ss-overlay')) {\n            elem = closest(e.target, '.e-datavisualization-chart') ?\n                closest(e.target, '.e-datavisualization-chart') : elem;\n        }\n        var eventArgs = {\n            prevTop: this.originalReorderTop, prevLeft: this.originalReorderLeft,\n            currentTop: this.resizedReorderTop ? this.resizedReorderTop : this.originalReorderTop,\n            currentLeft: this.resizedReorderLeft ? this.resizedReorderLeft : this.originalReorderLeft,\n            id: elem.id, currentHeight: this.currenHeight, currentWidth: this.currentWidth,\n            requestType: 'imageRefresh', prevHeight: this.originalHeight, prevWidth: this.originalWidth\n        };\n        if (this.isOverlayClicked || isMouseUp) {\n            if (this.originalReorderTop !== this.resizedReorderTop || this.originalReorderLeft !== this.resizedReorderLeft) {\n                eventArgs.id = elem.id;\n                if (overlaElems && overlaElems[0]) {\n                    eventArgs.requestType = 'chartRefresh';\n                    this.parent.notify(refreshChartCellObj, eventArgs);\n                }\n                else {\n                    this.parent.notify(refreshImgCellObj, eventArgs);\n                }\n                this.resizedReorderTop = this.originalReorderTop;\n                this.resizedReorderLeft = this.originalReorderLeft;\n            }\n            else if (this.currenHeight !== this.originalHeight || this.originalWidth !== this.currentWidth) {\n                eventArgs.id = elem.id.indexOf('overlay') > 0 ? elem.id : elem.parentElement ? elem.parentElement.id : '';\n                if (overlaElems && overlaElems[0]) {\n                    eventArgs.requestType = 'chartRefresh';\n                    this.parent.notify(refreshChartCellObj, eventArgs);\n                }\n                else {\n                    this.parent.notify(refreshImgCellObj, eventArgs);\n                }\n                this.originalHeight = this.currenHeight;\n                this.originalWidth = this.currentWidth;\n            }\n        }\n        this.isOverlayClicked = false;\n    };\n    Overlay.prototype.overlayClickHandler = function (e) {\n        if (this.parent.getActiveSheet().isProtected) {\n            return;\n        }\n        this.isOverlayClicked = true;\n        var target = e.target;\n        var overlayElem = e.target;\n        if (!target.classList.contains('e-ss-overlay')) {\n            overlayElem = target.parentElement;\n            if (closest(e.target, '.e-datavisualization-chart')) {\n                overlayElem = closest(e.target, '.e-datavisualization-chart');\n                this.currentWidth = parseFloat(getComputedStyle(overlayElem, null).getPropertyValue('width').replace('px', ''));\n                this.currenHeight = parseFloat(getComputedStyle(overlayElem, null).getPropertyValue('height').replace('px', ''));\n            }\n        }\n        this.originalReorderLeft = parseInt(overlayElem.style.left, 10); //divLeft\n        this.originalReorderTop = parseInt(overlayElem.style.top, 10); // divTop\n        this.resizedReorderLeft = parseInt(overlayElem.style.left, 10); //resized divLeft\n        this.resizedReorderTop = parseInt(overlayElem.style.top, 10); // resized divTop\n        this.originalResizeTop = this.originalReorderTop;\n        this.originalResizeLeft = this.originalReorderLeft;\n        this.originalMouseX = e.clientX; // posX\n        this.originalMouseY = e.clientY; // posY\n        this.diffX = this.originalMouseX - this.originalReorderLeft;\n        this.diffY = this.originalMouseY - this.originalReorderTop;\n        var actOverlayElem = document.getElementsByClassName('e-ss-overlay-active')[0];\n        if (actOverlayElem) {\n            removeClass([actOverlayElem], 'e-ss-overlay-active');\n        }\n        document.getElementById(overlayElem.id).classList.add('e-ss-overlay-active');\n        if (target.classList.contains('e-ss-resizer')) {\n            this.resizer = target.classList[0];\n            this.originalWidth = parseFloat(getComputedStyle(overlayElem, null).getPropertyValue('width').replace('px', ''));\n            this.originalHeight = parseFloat(getComputedStyle(overlayElem, null).getPropertyValue('height').replace('px', ''));\n            this.isResizerClicked = true;\n        }\n        if (overlayElem.classList.contains('e-datavisualization-chart')) {\n            this.parent.notify(focusChartBorder, { id: overlayElem.id });\n        }\n    };\n    Overlay.prototype.renderResizeHandles = function (div) {\n        var handles = ['e-ss-overlay-t', 'e-ss-overlay-r', 'e-ss-overlay-b', 'e-ss-overlay-l'];\n        var i = 0;\n        var handleElem;\n        var overlay = div;\n        while (handles.length > i) {\n            handleElem = this.parent.createElement('div', {\n                attrs: { 'class': handles[i] + ' ' + 'e-ss-resizer' },\n                styles: 'width: 8px; height: 8px; border-radius: 4px;'\n            });\n            overlay.appendChild(handleElem);\n            i++;\n        }\n    };\n    Overlay.prototype.removeEventListener = function () {\n        var overlayElem = document.getElementById(this.parent.element.id + '_overlay');\n        EventHandler.remove(overlayElem, 'mousedown', this.overlayClickHandler);\n        EventHandler.remove(overlayElem, 'mousemove', this.overlayMouseMoveHandler);\n        EventHandler.remove(this.parent.getMainContent(), 'mousemove', this.overlayMouseMoveHandler);\n        EventHandler.remove(document, 'mouseup', this.overlayMouseUpHandler);\n    };\n    /**\n     * To clear private variables.\n     */\n    Overlay.prototype.destroy = function () {\n        this.removeEventListener();\n        this.parent = null;\n    };\n    return Overlay;\n}());\nexport { Overlay };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/// <reference path='../../workbook/base/workbook-model.d.ts'/>\nimport { Property, NotifyPropertyChanges, Event, isUndefined } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, Complex, formatUnit, L10n, isNullOrUndefined, Browser } from '@syncfusion/ej2-base';\nimport { detach, select, closest, setStyleAttribute, EventHandler } from '@syncfusion/ej2-base';\nimport { initialLoad, mouseDown, spreadsheetDestroyed, keyUp, clearViewer, blankWorkbook } from '../common/index';\nimport { hideShow, performUndoRedo, overlay, createImageElement, deleteImage } from '../common/index';\nimport { sheetNameUpdate, updateUndoRedoCollection, getUpdateUsingRaf, setAutoFit, created } from '../common/index';\nimport { actionEvents, keyDown, enableFileMenuItems, hideToolbarItems, updateAction } from '../common/index';\nimport { colWidthChanged, rowHeightChanged, hideRibbonTabs, addFileMenuItems, getSiblingsHeight } from '../common/index';\nimport { defaultLocale, locale, setAriaOptions, setResize, initiateFilterUI, clearFilter, clearTemplate, isReact } from '../common/index';\nimport { ribbon, formulaBar, sheetTabs, formulaOperation, addRibbonTabs } from '../common/index';\nimport { addContextMenuItems, removeContextMenuItems, enableContextMenuItems, selectRange, addToolbarItems } from '../common/index';\nimport { cut, copy, paste, dialog, editOperation, activeSheetChanged, refreshFormulaDatasource } from '../common/index';\nimport { Render } from '../renderer/render';\nimport { Scroll, VirtualScroll, Edit, CellFormat, Selection, KeyboardNavigation, KeyboardShortcut, WrapText } from '../actions/index';\nimport { Clipboard, ShowHide, UndoRedo, SpreadsheetHyperlink, Resize, Insert, Delete, FindAndReplace, Merge } from '../actions/index';\nimport { ProtectSheet } from '../actions/index';\nimport { click, hideFileMenuItems } from '../common/index';\nimport { Dialog, ActionEvents, Overlay } from '../services/index';\nimport { ServiceLocator } from '../../workbook/services/index';\nimport { getColumnsWidth, getSheetIndex, WorkbookHyperlink } from './../../workbook/index';\nimport { getCellAddress } from './../../workbook/common/index';\nimport { activeCellChanged, afterHyperlinkCreate, getColIndex } from './../../workbook/index';\nimport { WorkbookInsert, WorkbookDelete, WorkbookMerge } from './../../workbook/index';\nimport { getSheetNameFromAddress, DataBind, beforeHyperlinkCreate } from './../../workbook/index';\nimport { sortComplete, dataSourceChanged } from './../../workbook/index';\nimport { getSheetIndexFromId, WorkbookEdit, WorkbookOpen, WorkbookSave, WorkbookCellFormat, WorkbookSort } from './../../workbook/index';\nimport { findKeyUp } from './../../workbook/index';\nimport { Workbook } from '../../workbook/base/workbook';\nimport { getRequiredModules, ScrollSettings, enableToolbarItems } from '../common/index';\nimport { SelectionSettings, getStartEvent, enableRibbonTabs } from '../common/index';\nimport { createSpinner, showSpinner, hideSpinner } from '@syncfusion/ej2-popups';\nimport { setRowHeight, getRowsHeight, getColumnWidth, getRowHeight } from './../../workbook/base/index';\nimport { getRangeIndexes, getIndexesFromAddress, getCellIndexes, WorkbookNumberFormat, WorkbookFormula } from '../../workbook/index';\nimport { Ribbon, FormulaBar, SheetTabs, Open, ContextMenu, Save, NumberFormat, Formula } from '../integrations/index';\nimport { Sort, Filter, SpreadsheetImage, SpreadsheetChart } from '../integrations/index';\nimport { isNumber, getColumn, WorkbookFilter } from '../../workbook/index';\nimport { DataValidation } from '../actions/index';\nimport { WorkbookDataValidation, WorkbookConditionalFormat, WorkbookFindAndReplace } from '../../workbook/actions/index';\nimport { findAllValues } from './../../workbook/common/index';\nimport { ConditionalFormatting } from '../actions/conditional-formatting';\nimport { WorkbookImage, WorkbookChart } from '../../workbook/integrations/index';\nimport { WorkbookProtectSheet } from '../../workbook/actions/index';\n/**\n * Represents the Spreadsheet component.\n * ```html\n * <div id='spreadsheet'></div>\n * <script>\n *  var spreadsheetObj = new Spreadsheet();\n *  spreadsheetObj.appendTo('#spreadsheet');\n * </script>\n * ```\n */\nvar Spreadsheet = /** @class */ (function (_super) {\n    __extends(Spreadsheet, _super);\n    /**\n     * Constructor for creating the widget.\n     * @param  {SpreadsheetModel} options? - Configures Spreadsheet options.\n     * @param  {string|HTMLElement} element? - Element to render Spreadsheet.\n     */\n    function Spreadsheet(options, element) {\n        var _this = _super.call(this, options) || this;\n        /** @hidden */\n        _this.viewport = {\n            rowCount: 0, colCount: 0, height: 0, topIndex: 0, leftIndex: 0, width: 0,\n            bottomIndex: 0, rightIndex: 0\n        };\n        _this.needsID = true;\n        Spreadsheet_1.Inject(Ribbon, FormulaBar, SheetTabs, Selection, Edit, KeyboardNavigation, KeyboardShortcut, Clipboard, DataBind, Open, ContextMenu, Save, NumberFormat, CellFormat, Formula, WrapText, WorkbookEdit, WorkbookOpen, WorkbookSave, WorkbookCellFormat, WorkbookNumberFormat, WorkbookFormula, Sort, WorkbookSort, Resize, UndoRedo, WorkbookFilter, Filter, SpreadsheetHyperlink, WorkbookHyperlink, Insert, Delete, WorkbookInsert, WorkbookDelete, DataValidation, WorkbookDataValidation, ProtectSheet, WorkbookProtectSheet, FindAndReplace, WorkbookFindAndReplace, Merge, WorkbookMerge, SpreadsheetImage, ConditionalFormatting, WorkbookImage, WorkbookConditionalFormat, SpreadsheetChart, WorkbookChart);\n        if (element) {\n            _this.appendTo(element);\n        }\n        return _this;\n    }\n    Spreadsheet_1 = Spreadsheet;\n    /**\n     * To get cell element.\n     * @returns HTMLElement\n     * @hidden\n     */\n    Spreadsheet.prototype.getCell = function (rowIndex, colIndex, row) {\n        colIndex = this.getViewportIndex(colIndex, true);\n        if (!row) {\n            row = this.getRow(rowIndex);\n        }\n        return row ? row.cells[colIndex] : row;\n    };\n    /**\n     * Get cell element.\n     * @returns HTMLTableRowElement\n     * @hidden\n     */\n    Spreadsheet.prototype.getRow = function (index, table) {\n        index = this.getViewportIndex(index);\n        table = table || this.getContentTable();\n        return table ? table.rows[index] : null;\n    };\n    /**\n     * To get hidden row/column count between two specified index.\n     * Set `layout` as `columns` if you want to get column hidden count.\n     * @hidden\n     */\n    Spreadsheet.prototype.hiddenCount = function (startIndex, endIndex, layout) {\n        if (layout === void 0) { layout = 'rows'; }\n        var sheet = this.getActiveSheet();\n        var count = 0;\n        for (var i = startIndex; i <= endIndex; i++) {\n            if ((sheet[layout])[i] && (sheet[layout])[i].hidden) {\n                count++;\n            }\n        }\n        return count;\n    };\n    /**\n     * To get row/column viewport index.\n     * @hidden\n     */\n    Spreadsheet.prototype.getViewportIndex = function (index, isCol) {\n        if (this.scrollSettings.enableVirtualization) {\n            if (isCol) {\n                index -= this.hiddenCount(this.viewport.leftIndex, index, 'columns');\n                index -= this.viewport.leftIndex;\n            }\n            else {\n                index -= this.hiddenCount(this.viewport.topIndex, index);\n                index -= this.viewport.topIndex;\n            }\n        }\n        return index;\n    };\n    /**\n     * To initialize the services;\n     * @returns void\n     * @hidden\n     */\n    Spreadsheet.prototype.preRender = function () {\n        _super.prototype.preRender.call(this);\n        this.serviceLocator = new ServiceLocator;\n        this.initServices();\n    };\n    Spreadsheet.prototype.initServices = function () {\n        this.serviceLocator.register(locale, new L10n(this.getModuleName(), defaultLocale, this.locale));\n        this.serviceLocator.register(dialog, new Dialog(this));\n        this.serviceLocator.register(actionEvents, new ActionEvents(this));\n        this.serviceLocator.register(overlay, new Overlay(this));\n    };\n    /**\n     * To Initialize the component rendering.\n     * @returns void\n     * @hidden\n     */\n    Spreadsheet.prototype.render = function () {\n        _super.prototype.render.call(this);\n        this.element.setAttribute('tabindex', '0');\n        setAriaOptions(this.element, { role: 'grid' });\n        this.renderModule = new Render(this);\n        this.notify(initialLoad, null);\n        this.renderSpreadsheet();\n        this.wireEvents();\n        if (this.created) {\n            if (this[created].observers) {\n                if (this[created].observers.length > 0) {\n                    this.createdHandler = { observers: this[created].observers };\n                    this[created].observers = [];\n                }\n            }\n            else {\n                this.createdHandler = this.created;\n                this.setProperties({ created: undefined }, true);\n            }\n        }\n    };\n    Spreadsheet.prototype.renderSpreadsheet = function () {\n        if (this.cssClass) {\n            addClass([this.element], this.cssClass.split(' '));\n        }\n        this.setHeight();\n        this.setWidth();\n        createSpinner({ target: this.element }, this.createElement);\n        if (this.isMobileView() && this.cssClass.indexOf('e-mobile-view') === -1) {\n            this.element.classList.add('e-mobile-view');\n        }\n        this.sheetModule = this.serviceLocator.getService('sheet');\n        if (this.allowScrolling) {\n            this.scrollModule = new Scroll(this);\n        }\n        if (this.scrollSettings.enableVirtualization) {\n            new VirtualScroll(this);\n        }\n        this.renderModule.render();\n        new ShowHide(this);\n    };\n    /**\n     * By default, Spreadsheet shows the spinner for all its actions. To manually show spinner you this method at your needed time.\n     * {% codeBlock src='spreadsheet/showSpinner/index.md' %}{% endcodeBlock %}\n     * @return {void}\n     */\n    Spreadsheet.prototype.showSpinner = function () {\n        showSpinner(this.element);\n    };\n    /**\n     * To hide showed spinner manually.\n     * {% codeBlock src='spreadsheet/hideSpinner/index.md' %}{% endcodeBlock %}\n     * @return {void}\n     */\n    Spreadsheet.prototype.hideSpinner = function () {\n        hideSpinner(this.element);\n    };\n    /**\n     * To protect the particular sheet.\n     * {% codeBlock src='spreadsheet/protectSheet/index.md' %}{% endcodeBlock %}\n     * @param {number | string} sheet - Specifies the sheet to protect.\n     * @param {ProtectSettingsModel} protectSettings - Specifies the protect sheet options.\n     * @default { selectCells: 'false', formatCells: 'false', formatRows: 'false', formatColumns:'false', insertLink:'false' }\n     * @return {void}\n     */\n    Spreadsheet.prototype.protectSheet = function (sheet, protectSettings) {\n        if (typeof (sheet) === 'string') {\n            sheet = getSheetIndex(this, sheet);\n        }\n        if (sheet) {\n            this.setSheetPropertyOnMute(this.sheets[sheet], 'isProtected', true);\n            this.setSheetPropertyOnMute(this.sheets[sheet], 'protectSettings', protectSettings);\n        }\n        sheet = this.getActiveSheet().index;\n        this.setSheetPropertyOnMute(this.getActiveSheet(), 'isProtected', true);\n        _super.prototype.protectSheet.call(this, sheet, protectSettings);\n    };\n    /**\n     * To unprotect the particular sheet.\n     * {% codeBlock src='spreadsheet/unprotectSheet/index.md' %}{% endcodeBlock %}\n     * @param {number | string} sheet - Specifies the sheet to Unprotect.\n     * @return {void}\n     */\n    Spreadsheet.prototype.unprotectSheet = function (sheet) {\n        if (typeof (sheet) === 'string') {\n            sheet = getSheetIndex(this, sheet);\n        }\n        if (sheet) {\n            this.sheets[sheet].isProtected = false;\n        }\n        else {\n            this.getActiveSheet().isProtected = false;\n        }\n        _super.prototype.unprotectSheet.call(this, sheet);\n    };\n    /**\n     * To find the specified cell value.\n     * {% codeBlock src='spreadsheet/find/index.md' %}{% endcodeBlock %}\n     * @param {FindOptions} args - Specifies the replace value with find args to replace specified cell value.\n     * @param {string} args.value - Specifies the value to be find.\n     * @param {FindModeType} args.mode - Specifies the value to be find within sheet or workbook.\n     * @param {string} args.searchBy - Specifies the value to be find by row or column.\n     * @param {boolean} args.isCSen - Specifies the find match with case sensitive or not.\n     * @param {boolean} args.isEMatch - Specifies the find match with entire match or not.\n     * @param {string} args.findOpt - Specifies the next or previous find match.\n     * @param {number} args.sheetIndex - Specifies the current sheet to find.\n     * @default { mode: 'Sheet', searchBy: 'By Row', isCSen: 'false', isEMatch:'false' }\n     * @return {void}\n     */\n    Spreadsheet.prototype.find = function (args) {\n        _super.prototype.findHandler.call(this, args);\n    };\n    /**\n     * To replace the specified cell value.\n     * {% codeBlock src='spreadsheet/replace/index.md' %}{% endcodeBlock %}\n     * @param {FindOptions} args - Specifies the replace value with find args to replace specified cell value.\n     * @param {string} args.replaceValue - Specifies the replacing value.\n     * @param {string} args.replaceBy - Specifies the value to be replaced for one or all.\n     * @param {string} args.value - Specifies the value to be replaced\n     * @return {void}\n     */\n    Spreadsheet.prototype.replace = function (args) {\n        args = {\n            value: args.value, mode: args.mode ? args.mode : 'Sheet', isCSen: args.isCSen ? args.isCSen : false,\n            isEMatch: args.isEMatch ? args.isEMatch : false, searchBy: args.searchBy ? args.searchBy : 'By Row',\n            replaceValue: args.replaceValue, replaceBy: args.replaceBy,\n            sheetIndex: args.sheetIndex ? args.sheetIndex : this.activeSheetIndex, findOpt: args.findOpt ? args.findOpt : ''\n        };\n        _super.prototype.replaceHandler.call(this, args);\n    };\n    /**\n     * To Find All the Match values Address within Sheet or Workbook.\n     * {% codeBlock src='spreadsheet/findAll/index.md' %}{% endcodeBlock %}\n     * @param {string} value - Specifies the value to find.\n     * @param {FindModeType} mode - Specifies the value to be find within Sheet/Workbook.\n     * @param {boolean} isCSen - Specifies the find match with case sensitive or not.\n     * @param {boolean} isEMatch - Specifies the find match with entire match or not.\n     * @param {number} sheetIndex - Specifies the sheetIndex. If not specified, it will consider the active sheet.\n     * @return {string[]}\n     */\n    Spreadsheet.prototype.findAll = function (value, mode, isCSen, isEMatch, sheetIndex) {\n        mode = mode ? mode : 'Sheet';\n        sheetIndex = sheetIndex ? sheetIndex : this.activeSheetIndex;\n        isCSen = isCSen ? isCSen : false;\n        isEMatch = isEMatch ? isEMatch : false;\n        var findCollection = [];\n        var findAllArguments = {\n            value: value, mode: mode, sheetIndex: sheetIndex, isCSen: isCSen,\n            isEMatch: isEMatch, findCollection: findCollection\n        };\n        this.notify(findAllValues, findAllArguments);\n        return findCollection;\n    };\n    /**\n     * Used to navigate to cell address within workbook.\n     * {% codeBlock src='spreadsheet/goTo/index.md' %}{% endcodeBlock %}\n     * @param {string} address - Specifies the cell address you need to navigate.\n     * You can specify the address in two formats,\n     * `{sheet name}!{cell address}` - Switch to specified sheet and navigate to specified cell address.\n     * `{cell address}` - Navigate to specified cell address with in the active sheet.\n     * @return {void}\n     */\n    Spreadsheet.prototype.goTo = function (address) {\n        if (address.includes('!')) {\n            var addrArr = address.split('!');\n            var idx = getSheetIndex(this, addrArr[0]);\n            if (idx === undefined) {\n                return;\n            }\n            if (idx !== this.activeSheetIndex) {\n                var activeCell = addrArr[1].split(':')[0];\n                this.setSheetPropertyOnMute(this.sheets[idx], 'activeCell', activeCell);\n                this.setSheetPropertyOnMute(this.sheets[idx], 'selectedRange', addrArr[1]);\n                var cellIndex = getCellIndexes(activeCell);\n                if (cellIndex[0] < this.viewport.rowCount) {\n                    cellIndex[0] = 0;\n                }\n                if (cellIndex[1] < this.viewport.colCount) {\n                    cellIndex[1] = 0;\n                }\n                this.setSheetPropertyOnMute(this.sheets[idx], 'topLeftCell', getCellAddress(cellIndex[0], cellIndex[1]));\n                this.activeSheetIndex = idx;\n                this.dataBind();\n                return;\n            }\n        }\n        var indexes = getRangeIndexes(address);\n        var sheet = this.getActiveSheet();\n        var insideDomCount = indexes[0] >= this.viewport.topIndex && indexes[0] < this.viewport.bottomIndex && indexes[1] >=\n            this.viewport.leftIndex && indexes[1] < this.viewport.rightIndex;\n        if (insideDomCount) {\n            this.selectRange(address);\n            var viewportIndexes = getCellIndexes(sheet.topLeftCell);\n            viewportIndexes[2] = viewportIndexes[0] + this.viewport.rowCount;\n            viewportIndexes[3] = viewportIndexes[1] + this.viewport.colCount;\n            if (indexes[0] >= viewportIndexes[0] && indexes[0] < viewportIndexes[2] && indexes[1] >= viewportIndexes[1] &&\n                indexes[1] < viewportIndexes[3]) {\n                return;\n            }\n        }\n        var content = this.getMainContent();\n        var vTrack;\n        var cVTrack;\n        var rVTrack;\n        var offset;\n        var vWidth;\n        var vHeight;\n        var scrollableSize;\n        if (indexes[0] === 0) {\n            offset = getRowsHeight(sheet, 0);\n        }\n        else {\n            offset = getRowsHeight(sheet, 0, indexes[0] - 1);\n            if (this.scrollSettings.enableVirtualization) {\n                scrollableSize = offset + this.getContentTable().getBoundingClientRect().height;\n                vHeight = parseInt(content.querySelector('.e-virtualtrack').style.height, 10);\n                if (scrollableSize > vHeight) {\n                    scrollableSize += 10;\n                    vTrack = content.querySelector('.e-virtualtrack');\n                    vTrack.style.height = scrollableSize + \"px\";\n                    if (sheet.showHeaders) {\n                        rVTrack = this.getRowHeaderContent().querySelector('.e-virtualtrack');\n                        rVTrack.style.height = scrollableSize + \"px\";\n                    }\n                    getUpdateUsingRaf(function () {\n                        vTrack.style.height = vHeight + \"px\";\n                        if (sheet.showHeaders) {\n                            rVTrack.style.height = vHeight + \"px\";\n                        }\n                    });\n                }\n            }\n        }\n        content.scrollTop = offset;\n        if (indexes[1] === 0) {\n            offset = getColumnsWidth(sheet, 0);\n        }\n        else {\n            offset = getColumnsWidth(sheet, 0, indexes[1] - 1);\n            if (this.scrollSettings.enableVirtualization) {\n                scrollableSize = offset + this.getContentTable().getBoundingClientRect().width;\n                vWidth = parseInt(content.querySelector('.e-virtualtrack').style.width, 10);\n                if (scrollableSize > vWidth) {\n                    scrollableSize += 10;\n                    vTrack = content.querySelector('.e-virtualtrack');\n                    vTrack.style.width = scrollableSize + \"px\";\n                    if (sheet.showHeaders) {\n                        cVTrack = this.getColumnHeaderContent().querySelector('.e-virtualtrack');\n                        cVTrack.style.width = scrollableSize + \"px\";\n                    }\n                    getUpdateUsingRaf(function () {\n                        vTrack.style.width = vWidth + \"px\";\n                        if (sheet.showHeaders) {\n                            cVTrack.style.width = vWidth + \"px\";\n                        }\n                    });\n                }\n            }\n        }\n        content.scrollLeft = offset;\n        if (!insideDomCount) {\n            this.selectRange(address);\n        }\n    };\n    /**\n     * Used to resize the Spreadsheet.\n     * {% codeBlock src='spreadsheet/resize/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.resize = function () {\n        this.renderModule.setSheetPanelSize();\n        if (this.scrollSettings.enableVirtualization) {\n            this.renderModule.refreshSheet();\n        }\n    };\n    /**\n     * To cut the specified cell or cells properties such as value, format, style etc...\n     * {% codeBlock src='spreadsheet/cut/index.md' %}{% endcodeBlock %}\n     * @param {string} address - Specifies the range address to cut.\n     */\n    Spreadsheet.prototype.cut = function (address) {\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        this.notify(cut, address ? {\n            range: getIndexesFromAddress(address),\n            sId: this.sheets[getSheetIndex(this, getSheetNameFromAddress(address))].id,\n            promise: promise\n        } : { promise: promise });\n        return promise;\n    };\n    /**\n     * To copy the specified cell or cells properties such as value, format, style etc...\n     * {% codeBlock src='spreadsheet/copy/index.md' %}{% endcodeBlock %}\n     * @param {string} address - Specifies the range address.\n     */\n    Spreadsheet.prototype.copy = function (address) {\n        var promise = new Promise(function (resolve, reject) { resolve((function () { })()); });\n        this.notify(copy, address ? {\n            range: getIndexesFromAddress(address),\n            sId: this.sheets[getSheetIndex(this, getSheetNameFromAddress(address))].id,\n            promise: promise\n        } : { promise: promise });\n        return promise;\n    };\n    /**\n     * This method is used to paste the cut or copied cells in to specified address.\n     * {% codeBlock src='spreadsheet/paste/index.md' %}{% endcodeBlock %}\n     * @param {string} address - Specifies the cell or range address.\n     * @param {PasteSpecialType} type - Specifies the type of paste.\n     */\n    Spreadsheet.prototype.paste = function (address, type) {\n        this.notify(paste, {\n            range: getIndexesFromAddress(address), sIdx: getSheetIndex(this, getSheetNameFromAddress(address)),\n            type: type, isAction: false, isInternal: true\n        });\n    };\n    /**\n     * To update the action which need to perform.\n     * {% codeBlock src='spreadsheet/updateAction/index.md' %}{% endcodeBlock %}\n     * @param {string} options - It describes an action and event args to perform.\n     * @param {string} options.action - specifies an action.\n     * @param {string} options.eventArgs - specifies an args to perform an action.\n     */\n    Spreadsheet.prototype.updateAction = function (options) {\n        updateAction(options, this);\n    };\n    Spreadsheet.prototype.setHeight = function () {\n        if (this.height.toString().indexOf('%') > -1) {\n            this.element.style.minHeight = '400px';\n        }\n        this.element.style.height = formatUnit(this.height);\n    };\n    Spreadsheet.prototype.setWidth = function () {\n        if (this.width.toString().indexOf('%') > -1 || this.width === 'auto') {\n            this.element.style.minWidth = '300px';\n        }\n        this.element.style.width = formatUnit(this.width);\n    };\n    /**\n     * Set the width of column.\n     * {% codeBlock src='spreadsheet/setColWidth/index.md' %}{% endcodeBlock %}\n     * @param {number} width\n     * @param {number} colIndex\n     * @param {number} sheetIndex\n     */\n    Spreadsheet.prototype.setColWidth = function (width, colIndex, sheetIndex) {\n        if (width === void 0) { width = 64; }\n        if (colIndex === void 0) { colIndex = 0; }\n        var colThreshold = this.getThreshold('col');\n        var lastIdx = this.viewport.leftIndex + this.viewport.colCount + (colThreshold * 2);\n        var sheet = isNullOrUndefined(sheetIndex) ? this.getActiveSheet() : this.sheets[sheetIndex];\n        if (sheet) {\n            var mIndex = colIndex;\n            var colWidth = (typeof width === 'number') ? width + 'px' : width;\n            colIndex = isNullOrUndefined(colIndex) ? getCellIndexes(sheet.activeCell)[1] : colIndex;\n            if (sheet === this.getActiveSheet()) {\n                if (colIndex >= this.viewport.leftIndex && colIndex <= lastIdx) {\n                    if (this.scrollSettings.enableVirtualization) {\n                        colIndex = colIndex - this.viewport.leftIndex;\n                    }\n                    var trgt = void 0;\n                    if (sheet.showHeaders) {\n                        trgt = this.getColumnHeaderContent().getElementsByClassName('e-header-cell')[colIndex];\n                    }\n                    else {\n                        trgt = this.getContentTable().getElementsByClassName('e-row')[0]\n                            .getElementsByClassName('e-cell')[colIndex];\n                    }\n                    var eleWidth = parseInt(this.getMainContent().getElementsByTagName('col')[colIndex].style.width, 10);\n                    var threshold = parseInt(colWidth, 10) - eleWidth;\n                    if (threshold < 0 && eleWidth < -(threshold)) {\n                        getCellIndexes(sheet.activeCell);\n                        threshold = -eleWidth;\n                    }\n                    var oldIdx = parseInt(trgt.getAttribute('aria-colindex'), 10) - 1;\n                    if (this.getActiveSheet() === sheet) {\n                        this.notify(colWidthChanged, { threshold: threshold, colIdx: oldIdx });\n                        setResize(colIndex, colWidth, true, this);\n                    }\n                }\n                else {\n                    var oldWidth = getColumnWidth(sheet, colIndex);\n                    var threshold = void 0;\n                    if (parseInt(colWidth, 10) > 0) {\n                        threshold = -(oldWidth - parseInt(colWidth, 10));\n                    }\n                    else {\n                        threshold = -oldWidth;\n                    }\n                    this.notify(colWidthChanged, { threshold: threshold, colIdx: colIndex });\n                }\n            }\n            getColumn(sheet, mIndex).width = parseInt(colWidth, 10) > 0 ? parseInt(colWidth, 10) : 0;\n            sheet.columns[mIndex].customWidth = true;\n        }\n    };\n    /**\n     * Set the height of row.\n     * {% codeBlock src='spreadsheet/setRowHeight/index.md' %}{% endcodeBlock %}\n     * @param {number} height? - Specifies height needs to be updated. If not specified, it will set the default height 20.\n     * @param {number} rowIndex? - Specifies the row index. If not specified, it will consider the first row.\n     * @param {number} sheetIndex? - Specifies the sheetIndex. If not specified, it will consider the active sheet.\n     */\n    Spreadsheet.prototype.setRowHeight = function (height, rowIndex, sheetIndex, edited) {\n        if (height === void 0) { height = 20; }\n        if (rowIndex === void 0) { rowIndex = 0; }\n        var sheet = isNullOrUndefined(sheetIndex) ? this.getActiveSheet() : this.sheets[sheetIndex - 1];\n        if (sheet) {\n            var mIndex = rowIndex;\n            var rowHeight = (typeof height === 'number') ? height + 'px' : height;\n            rowIndex = isNullOrUndefined(rowIndex) ? getCellIndexes(sheet.activeCell)[0] : rowIndex;\n            if (sheet === this.getActiveSheet()) {\n                if (rowIndex <= this.viewport.bottomIndex && rowIndex >= this.viewport.topIndex) {\n                    if (this.scrollSettings.enableVirtualization) {\n                        rowIndex = rowIndex - this.viewport.topIndex;\n                    }\n                    var trgt = void 0;\n                    if (sheet.showHeaders) {\n                        trgt = this.getRowHeaderContent().getElementsByClassName('e-header-cell')[rowIndex].parentElement;\n                    }\n                    else {\n                        trgt = this.getContentTable().getElementsByClassName('e-row')[rowIndex];\n                    }\n                    var eleHeight = parseInt(this.getMainContent().getElementsByTagName('tr')[rowIndex].style.height, 10);\n                    var threshold = parseInt(rowHeight, 10) - eleHeight;\n                    if (threshold < 0 && eleHeight < -(threshold)) {\n                        threshold = -eleHeight;\n                    }\n                    var oldIdx = parseInt(trgt.getAttribute('aria-rowindex'), 10) - 1;\n                    if (this.getActiveSheet() === sheet) {\n                        this.notify(rowHeightChanged, { threshold: threshold, rowIdx: oldIdx });\n                        if (isNullOrUndefined(edited)) {\n                            edited = false;\n                        }\n                        if (!edited) {\n                            setResize(rowIndex, rowHeight, false, this);\n                            edited = false;\n                        }\n                    }\n                }\n                else {\n                    var oldHeight = getRowHeight(sheet, rowIndex);\n                    var threshold = void 0;\n                    if (parseInt(rowHeight, 10) > 0) {\n                        threshold = -(oldHeight - parseInt(rowHeight, 10));\n                    }\n                    else {\n                        threshold = -oldHeight;\n                    }\n                    this.notify(rowHeightChanged, { threshold: threshold, rowIdx: rowIndex });\n                }\n            }\n            setRowHeight(sheet, mIndex, parseInt(rowHeight, 10) > 0 ? parseInt(rowHeight, 10) : 0);\n            sheet.rows[mIndex].customHeight = true;\n        }\n    };\n    /**\n     * This method is used to autofit the range of rows or columns\n     * {% codeBlock src='spreadsheet/autoFit/index.md' %}{% endcodeBlock %}\n     * @param {string} range - range that needs to be autofit.\n     *\n     * ```html\n     * <div id='Spreadsheet'></div>\n     * ```\n     * ```typescript\n     * let spreadsheet = new Spreadsheet({\n     *      allowResizing: true\n     * ...\n     * }, '#Spreadsheet');\n     * spreadsheet.autoFit('A:D'); // Auto fit from A to D columns\n     * Spreadsheet.autoFit('1:4'); // Auto fit from 1 to 4 rows\n     *\n     * ```\n     */\n    Spreadsheet.prototype.autoFit = function (range) {\n        var values = this.getIndexes(range);\n        var startIdx = values.startIdx;\n        var endIdx = values.endIdx;\n        var isCol = values.isCol;\n        var maximumColInx = isCol ? getColIndex('XFD') : 1048576;\n        if (startIdx <= maximumColInx) {\n            if (endIdx > maximumColInx) {\n                endIdx = maximumColInx;\n            }\n        }\n        else {\n            return;\n        }\n        for (startIdx; startIdx <= endIdx; startIdx++) {\n            this.notify(setAutoFit, { idx: startIdx, isCol: isCol });\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.getIndexes = function (range) {\n        var startIsCol;\n        var endIsCol;\n        var start;\n        var end;\n        var isCol;\n        if (range.indexOf(':') !== -1) {\n            var starttoend = range.split(':');\n            start = starttoend[0];\n            end = starttoend[1];\n        }\n        else {\n            start = range;\n            end = range;\n        }\n        if (!isNullOrUndefined(start)) {\n            var startValues = this.getAddress(start);\n            start = startValues.address;\n            startIsCol = startValues.isCol;\n        }\n        if (!isNullOrUndefined(end)) {\n            var endValues = this.getAddress(end);\n            end = endValues.address;\n            endIsCol = endValues.isCol;\n        }\n        isCol = startIsCol === true && endIsCol === true ? true : false;\n        var startIdx = isCol ? getColIndex(start.toUpperCase()) : parseInt(start, 10);\n        var endIdx = isCol ? getColIndex(end.toUpperCase()) : parseInt(end, 10);\n        return { startIdx: startIdx, endIdx: endIdx, isCol: isCol };\n    };\n    Spreadsheet.prototype.getAddress = function (address) {\n        var isCol;\n        if (address.substring(0, 1).match(/\\D/g)) {\n            isCol = true;\n            address = address.replace(/[0-9]/g, '');\n            return { address: address, isCol: isCol };\n        }\n        else if (address.substring(0, 1).match(/[0-9]/g) && address.match(/\\D/g)) {\n            return { address: '', isCol: false };\n        }\n        else {\n            address = (parseInt(address, 10) - 1).toString();\n            return { address: address, isCol: isCol };\n        }\n    };\n    /**\n     * To add the hyperlink in the cell\n     * {% codeBlock src='spreadsheet/addHyperlink/index.md' %}{% endcodeBlock %}\n     * @param {string | HyperlinkModel} hyperlink\n     * @param {string} address\n     */\n    Spreadsheet.prototype.addHyperlink = function (hyperlink, address) {\n        this.insertHyperlink(hyperlink, address, '', true);\n    };\n    /**\n     * To remove the hyperlink in the cell\n     * {% codeBlock src='spreadsheet/removeHyperlink/index.md' %}{% endcodeBlock %}\n     * @param {string} range\n     */\n    Spreadsheet.prototype.removeHyperlink = function (range) {\n        var rangeArr;\n        var sheet = this.getActiveSheet();\n        var sheetIdx;\n        if (range && range.indexOf('!') !== -1) {\n            rangeArr = range.split('!');\n            var sheets = this.sheets;\n            for (var idx = 0; idx < sheets.length; idx++) {\n                if (sheets[idx].name === rangeArr[0]) {\n                    sheetIdx = idx;\n                }\n            }\n            sheet = this.sheets[sheetIdx];\n            range = rangeArr[1];\n        }\n        var rangeIndexes = range ? getRangeIndexes(range) : getRangeIndexes(this.getActiveSheet().activeCell);\n        var cellMod;\n        for (var rowIdx = rangeIndexes[0]; rowIdx <= rangeIndexes[2]; rowIdx++) {\n            for (var colIdx = rangeIndexes[1]; colIdx <= rangeIndexes[3]; colIdx++) {\n                if (sheet && sheet.rows[rowIdx] && sheet.rows[rowIdx].cells[colIdx]) {\n                    cellMod = sheet.rows[rowIdx].cells[colIdx];\n                    if (cellMod) {\n                        if (typeof (cellMod.hyperlink) === 'string') {\n                            cellMod.value = cellMod.value ? cellMod.value : cellMod.hyperlink;\n                        }\n                        else {\n                            cellMod.value = cellMod.value ? cellMod.value : cellMod.hyperlink.address;\n                        }\n                        delete (cellMod.hyperlink);\n                        if (sheet === this.getActiveSheet()) {\n                            var eleRowIdx = void 0;\n                            var eleColIdx = void 0;\n                            if (this.scrollSettings.enableVirtualization) {\n                                eleRowIdx = rowIdx - this.viewport.topIndex;\n                                eleColIdx = colIdx - this.viewport.leftIndex;\n                            }\n                            var cell = this.element.getElementsByClassName('e-sheet-content')[0].\n                                getElementsByClassName('e-row')[eleRowIdx].getElementsByClassName('e-cell')[eleColIdx];\n                            if (cell.getElementsByClassName('e-hyperlink')[0]) {\n                                cell.innerText = cell.getElementsByClassName('e-hyperlink')[0].innerHTML;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.insertHyperlink = function (hyperlink, address, displayText, isMethod) {\n        if (this.allowHyperlink) {\n            var value = void 0;\n            var addrRange = void 0;\n            var sheetIdx = void 0;\n            var cellIdx = void 0;\n            var sheet = this.getActiveSheet();\n            var isEmpty = void 0;\n            address = address ? address : this.getActiveSheet().activeCell;\n            var befArgs = { hyperlink: hyperlink, cell: address, cancel: false };\n            var aftArgs = { hyperlink: hyperlink, cell: address };\n            if (!isMethod) {\n                this.trigger(beforeHyperlinkCreate, befArgs);\n            }\n            if (!befArgs.cancel) {\n                hyperlink = befArgs.hyperlink;\n                address = befArgs.cell;\n                _super.prototype.addHyperlink.call(this, hyperlink, address);\n                if (address && address.indexOf('!') !== -1) {\n                    addrRange = address.split('!');\n                    var sheets = this.sheets;\n                    for (var idx = 0; idx < sheets.length; idx++) {\n                        if (sheets[idx].name === addrRange[0]) {\n                            sheetIdx = idx;\n                        }\n                    }\n                    sheet = this.sheets[sheetIdx];\n                    address = addrRange[1];\n                }\n                if (!sheet) {\n                    return;\n                }\n                address = address ? address : this.getActiveSheet().activeCell;\n                cellIdx = getRangeIndexes(address);\n                if (typeof (hyperlink) === 'string') {\n                    value = hyperlink;\n                }\n                else {\n                    value = hyperlink.address;\n                }\n                var mCell = sheet.rows[cellIdx[0]].cells[cellIdx[1]];\n                if (isNullOrUndefined(mCell.value) || mCell.value === '') {\n                    isEmpty = true;\n                }\n                if (!isMethod) {\n                    this.trigger(afterHyperlinkCreate, aftArgs);\n                }\n                if (sheet === this.getActiveSheet()) {\n                    this.serviceLocator.getService('cell').refreshRange(cellIdx);\n                }\n            }\n        }\n    };\n    /**\n     * This method is used to add data validation.\n     * {% codeBlock src='spreadsheet/addDataValidation/index.md' %}{% endcodeBlock %}\n     * @param {ValidationModel} rules - specifies the validation rules.\n     * @param {string} range - range that needs to be add validation.\n     */\n    Spreadsheet.prototype.addDataValidation = function (rules, range) {\n        _super.prototype.addDataValidation.call(this, rules, range);\n    };\n    /**\n     * This method is used for remove validation.\n     * {% codeBlock src='spreadsheet/removeDataValidation/index.md' %}{% endcodeBlock %}\n     * @param {string} range - range that needs to be remove validation.\n     */\n    Spreadsheet.prototype.removeDataValidation = function (range) {\n        _super.prototype.removeDataValidation.call(this, range);\n    };\n    /**\n     * This method is used to highlight the invalid data.\n     * {% codeBlock src='spreadsheet/addInvalidHighlight/index.md' %}{% endcodeBlock %}\n     * @param {string} range - range that needs to be highlight the invalid data.\n     */\n    Spreadsheet.prototype.addInvalidHighlight = function (range) {\n        _super.prototype.addInvalidHighlight.call(this, range);\n    };\n    /**\n     * This method is used for remove highlight from invalid data.\n     * {% codeBlock src='spreadsheet/removeInvalidHighlight/index.md' %}{% endcodeBlock %}\n     * @param {string} range - range that needs to be remove invalid highlight.\n     */\n    Spreadsheet.prototype.removeInvalidHighlight = function (range) {\n        _super.prototype.removeInvalidHighlight.call(this, range);\n    };\n    /**\n     * This method is used to add conditional formatting.\n     * {% codeBlock src='spreadsheet/conditionalFormat/index.md' %}{% endcodeBlock %}\n     * @param  {string} type - Conditional formatting HighlightCell, TopBottom, DataBar, ColorScale, IconSet Type.\n     * HighlightCell- 'GreaterThan' | 'LessThan' | 'Between' | 'EqualTo' | 'ContainsText' | 'DateOccur' | 'Duplicate' | 'Unique',\n     * TopBottom - 'Top10Items' | 'Bottom10Items' | 'Top10Percentage' | 'Bottom10Percentage' | 'BelowAverage' | 'AboveAverage',\n     * DataBar - 'BlueDataBar' | 'GreenDataBar' | 'RedDataBar' | 'OrangeDataBar' | 'LightBlueDataBar' | 'PurpleDataBar',\n     * ColorScale - 'GYRColorScale' | 'RYGColorScale' | 'GWRColorScale' | 'RWGColorScale' | 'BWRColorScale' | 'RWBColorScale' |\n     * 'WRColorScale' | 'RWColorScale' | 'GWColorScale' | 'WGColorScale' | 'GYColorScale' | 'YGColorScale',\n     * IconSet - 'ThreeArrows' | 'ThreeArrowsGray' | 'FourArrowsGray' | 'FourArrows' | 'FiveArrowsGray' | 'FiveArrows' |\n     * 'ThreeTrafficLights1' | 'ThreeTrafficLights2' | 'ThreeSigns' | 'FourTrafficLights' | 'FourRedToBlack' | 'ThreeSymbols' |\n     * 'ThreeSymbols2' | 'ThreeFlags' | 'FourRating' | 'FiveQuarters' | 'FiveRating' | 'ThreeTriangles' | 'ThreeStars' | 'FiveBoxes';\n     * @param  {string} cFColor - Pass the cFcolor to set the conditional formatting.\n     * CFColor - 'RedFT' | 'YellowFT' | 'GreenFT' | 'RedF' | 'RedT'.\n     * @param  {string} value - Pass the value to set the conditional formatting.\n     * @param  {string} range - Pass the range to set the conditional formatting.\n     */\n    Spreadsheet.prototype.conditionalFormat = function (conditionalFormat) {\n        _super.prototype.conditionalFormat.call(this, conditionalFormat);\n    };\n    /**\n     * This method is used for remove conditional formatting.\n     * {% codeBlock src='spreadsheet/clearConditionalFormat/index.md' %}{% endcodeBlock %}\n     * @param {string} range - range that needs to be remove conditional formatting.\n     */\n    Spreadsheet.prototype.clearConditionalFormat = function (range) {\n        range = range || this.getActiveSheet().selectedRange;\n        _super.prototype.clearConditionalFormat.call(this, range);\n    };\n    /** @hidden */\n    Spreadsheet.prototype.setPanelSize = function () {\n        if (this.height !== 'auto') {\n            var panel = document.getElementById(this.element.id + '_sheet_panel');\n            panel.style.height = this.element.getBoundingClientRect().height - getSiblingsHeight(panel) + \"px\";\n        }\n    };\n    /**\n     * Opens the Excel file.\n     * {% codeBlock src='spreadsheet/open/index.md' %}{% endcodeBlock %}\n     * @param {OpenOptions} options - Options for opening the excel file.\n     */\n    Spreadsheet.prototype.open = function (options) {\n        this.isOpen = true;\n        _super.prototype.open.call(this, options);\n        if (this.isOpen) {\n            this.showSpinner();\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.hideRow = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        if (this.renderModule) {\n            this.notify(hideShow, { startIndex: startIndex, endIndex: endIndex, hide: hide });\n        }\n        else {\n            _super.prototype.hideRow.call(this, startIndex, endIndex, hide);\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.hideColumn = function (startIndex, endIndex, hide) {\n        if (endIndex === void 0) { endIndex = startIndex; }\n        if (hide === void 0) { hide = true; }\n        if (this.renderModule) {\n            this.notify(hideShow, { startIndex: startIndex, endIndex: endIndex, hide: hide, isCol: true });\n        }\n        else {\n            _super.prototype.hideColumn.call(this, startIndex, endIndex, hide);\n        }\n    };\n    /**\n     * This method is used to Clear contents, formats and hyperlinks in spreadsheet.\n     * {% codeBlock src='spreadsheet/clear/index.md' %}{% endcodeBlock %}\n     *    * @param {ClearOptions} options - Options for clearing the content, formats and hyperlinks in spreadsheet.\n     */\n    Spreadsheet.prototype.clear = function (options) {\n        this.notify(clearViewer, { options: options, isPublic: true });\n    };\n    /**\n     * Used to refresh the spreadsheet.\n     * {% codeBlock src='spreadsheet/refresh/index.md' %}{% endcodeBlock %}\n     * @param {boolean} isNew - Specifies `true` / `false` to create new workbook in spreadsheet.\n     * @returns void\n     */\n    Spreadsheet.prototype.refresh = function (isNew) {\n        if (this[isReact]) {\n            this[clearTemplate]();\n        }\n        (isNew) ? this.notify(blankWorkbook, {}) : _super.prototype.refresh.call(this);\n    };\n    /**\n     * Used to set the image in spreadsheet.\n     * {% codeBlock src='spreadsheet/insertImage/index.md' %}{% endcodeBlock %}\n     * @param {ImageModel} images - Specifies the options to insert image in spreadsheet.\n     * @param {string} range - Specifies the range in spreadsheet.\n     * @returns void\n     */\n    Spreadsheet.prototype.insertImage = function (images, range) {\n        var i;\n        for (i = 0; i < images.length; i++) {\n            this.notify(createImageElement, {\n                options: images[i],\n                range: range ? range : this.getActiveSheet().selectedRange, isPublic: true\n            });\n        }\n    };\n    /**\n     * Used to delete the image in spreadsheet.\n     * {% codeBlock src='spreadsheet/deleteImage/index.md' %}{% endcodeBlock %}\n     * @param {string} id - Specifies the id of the image element to be deleted.\n     * @param {string} range - Specifies the range in spreadsheet.\n     * @returns void\n     */\n    Spreadsheet.prototype.deleteImage = function (id, range) {\n        this.notify(deleteImage, { id: id, range: range ? range : this.getActiveSheet().selectedRange });\n    };\n    /**\n     * Gets the row header div of the Spreadsheet.\n     * @return {Element}\n     * @hidden\n     */\n    Spreadsheet.prototype.getRowHeaderContent = function () {\n        return this.sheetModule.getRowHeaderPanel();\n    };\n    /**\n     * Gets the column header div of the Spreadsheet.\n     * @return {Element}\n     * @hidden\n     */\n    Spreadsheet.prototype.getColumnHeaderContent = function () {\n        return this.sheetModule.getColHeaderPanel();\n    };\n    /**\n     * Gets the main content div of the Spreadsheet.\n     * @return {Element}\n     * @hidden\n     */\n    Spreadsheet.prototype.getMainContent = function () {\n        return this.sheetModule.getContentPanel();\n    };\n    /**\n     * Get the main content table element of spreadsheet.\n     * @return {HTMLTableElement}\n     * @hidden\n     */\n    Spreadsheet.prototype.getContentTable = function () {\n        return this.sheetModule.getContentTable();\n    };\n    /**\n     * Get the row header table element of spreadsheet.\n     * @return {HTMLTableElement}\n     * @hidden\n     */\n    Spreadsheet.prototype.getRowHeaderTable = function () {\n        return this.sheetModule.getRowHeaderTable();\n    };\n    /**\n     * Get the column header table element of spreadsheet.\n     * @return {HTMLTableElement}\n     * @hidden\n     */\n    Spreadsheet.prototype.getColHeaderTable = function () {\n        return this.sheetModule.getColHeaderTable();\n    };\n    /**\n     * To get the backup element count for row and column virtualization.\n     * @hidden\n     */\n    Spreadsheet.prototype.getThreshold = function (layout) {\n        var threshold = Math.round((this.viewport[layout + 'Count'] + 1) / 2);\n        return threshold < 15 ? 15 : threshold;\n    };\n    /** @hidden */\n    Spreadsheet.prototype.isMobileView = function () {\n        return ((this.cssClass.indexOf('e-mobile-view') > -1 || Browser.isDevice) && this.cssClass.indexOf('e-desktop-view') === -1)\n            && false;\n    };\n    /** @hidden */\n    Spreadsheet.prototype.getValueRowCol = function (sheetIndex, rowIndex, colIndex) {\n        var val = _super.prototype.getValueRowCol.call(this, sheetIndex, rowIndex, colIndex);\n        return val;\n    };\n    /**\n     * To update a cell properties.\n     * {% codeBlock src='spreadsheet/updateCell/index.md' %}{% endcodeBlock %}\n     * @param {CellModel} cell - Cell properties.\n     * @param {string} address - Address to update.\n     */\n    Spreadsheet.prototype.updateCell = function (cell, address) {\n        address = address || this.getActiveSheet().activeCell;\n        _super.prototype.updateCell.call(this, cell, address);\n        this.serviceLocator.getService('cell').refreshRange(getIndexesFromAddress(address));\n        this.notify(activeCellChanged, null);\n    };\n    /**\n     * Sorts the range of cells in the active sheet.\n     * {% codeBlock src='spreadsheet/sort/index.md' %}{% endcodeBlock %}\n     * @param sortOptions - options for sorting.\n     * @param range - address of the data range.\n     */\n    Spreadsheet.prototype.sort = function (sortOptions, range) {\n        var _this = this;\n        if (!this.allowSorting) {\n            return Promise.reject();\n        }\n        return _super.prototype.sort.call(this, sortOptions, range).then(function (args) {\n            _this.notify(sortComplete, args);\n            return Promise.resolve(args);\n        });\n    };\n    /** @hidden */\n    Spreadsheet.prototype.setValueRowCol = function (sheetIndex, value, rowIndex, colIndex) {\n        if (value === 'circular reference: ') {\n            var circularArgs = {\n                action: 'isCircularReference', argValue: value\n            };\n            this.notify(formulaOperation, circularArgs);\n            value = circularArgs.argValue;\n        }\n        _super.prototype.setValueRowCol.call(this, sheetIndex, value, rowIndex, colIndex);\n        sheetIndex = getSheetIndexFromId(this, sheetIndex);\n        this.notify(editOperation, {\n            action: 'refreshDependentCellValue', rowIdx: rowIndex, colIdx: colIndex,\n            sheetIdx: sheetIndex\n        });\n    };\n    /**\n     * Get component name.\n     * @returns string\n     * @hidden\n     */\n    Spreadsheet.prototype.getModuleName = function () {\n        return 'spreadsheet';\n    };\n    /** @hidden */\n    Spreadsheet.prototype.refreshNode = function (td, args) {\n        var value;\n        if (td) {\n            var spanElem = select('#' + this.element.id + '_currency', td);\n            var alignClass = 'e-right-align';\n            if (args) {\n                args.result = isNullOrUndefined(args.result) ? '' : args.result.toString();\n                if (spanElem) {\n                    detach(spanElem);\n                }\n                if (args.type === 'Accounting' && isNumber(args.value)) {\n                    if (td.querySelector('a')) {\n                        td.querySelector('a').textContent = args.result.split(args.curSymbol).join('');\n                    }\n                    else {\n                        td.innerHTML = '';\n                    }\n                    td.appendChild(this.createElement('span', {\n                        id: this.element.id + '_currency',\n                        innerHTML: \"\" + args.curSymbol,\n                        styles: 'float: left'\n                    }));\n                    if (!td.querySelector('a')) {\n                        td.innerHTML += args.result.split(args.curSymbol).join('');\n                    }\n                    td.classList.add(alignClass);\n                    return;\n                }\n                else {\n                    if (args.result && (args.result.toLowerCase() === 'true' || args.result.toLowerCase() === 'false')) {\n                        args.result = args.result.toUpperCase();\n                        alignClass = 'e-center-align';\n                        args.isRightAlign = true; // Re-use this to center align the cell.\n                    }\n                    value = args.result;\n                }\n                args.isRightAlign ? td.classList.add(alignClass) : td.classList.remove(alignClass);\n            }\n            value = !isNullOrUndefined(value) ? value : '';\n            if (!isNullOrUndefined(td)) {\n                var node = td.lastChild;\n                if (td.querySelector('.e-hyperlink')) {\n                    node = td.querySelector('.e-hyperlink').lastChild;\n                }\n                if (td.querySelector('.e-wrap-content')) {\n                    node = td.querySelector('.e-wrap-content').lastChild;\n                }\n                if (node && (node.nodeType === 3 || node.nodeType === 1)) {\n                    node.nodeValue = value;\n                }\n                else {\n                    td.appendChild(document.createTextNode(value));\n                }\n            }\n        }\n    };\n    /** @hidden */\n    Spreadsheet.prototype.calculateHeight = function (style, lines, borderWidth) {\n        if (lines === void 0) { lines = 1; }\n        if (borderWidth === void 0) { borderWidth = 1; }\n        var fontSize = (style && style.fontSize) || this.cellStyle.fontSize;\n        var threshold = style.fontFamily === 'Arial Black' ? 1.44 : 1.24;\n        return ((fontSize.indexOf('pt') > -1 ? parseInt(fontSize, 10) * 1.33 : parseInt(fontSize, 10)) * threshold * lines) +\n            (borderWidth * threshold);\n    };\n    /** @hidden */\n    Spreadsheet.prototype.skipHidden = function (startIdx, endIdx, layout) {\n        if (layout === void 0) { layout = 'rows'; }\n        var sheet = this.getActiveSheet();\n        var totalCount;\n        if (this.scrollSettings.isFinite) {\n            totalCount = (layout === 'rows' ? sheet.rowCount : sheet.colCount) - 1;\n        }\n        for (var i = startIdx; i <= endIdx; i++) {\n            if ((sheet[layout])[i] && (sheet[layout])[i].hidden) {\n                if (startIdx === i) {\n                    startIdx++;\n                }\n                endIdx++;\n                if (totalCount && endIdx > totalCount) {\n                    endIdx = totalCount;\n                    break;\n                }\n            }\n        }\n        return [startIdx, endIdx];\n    };\n    /** @hidden */\n    Spreadsheet.prototype.updateActiveBorder = function (nextTab, selector) {\n        if (selector === void 0) { selector = '.e-ribbon'; }\n        var indicator = select(selector + \" .e-tab-header .e-indicator\", this.element);\n        indicator.style.display = 'none';\n        setStyleAttribute(indicator, { 'left': '', 'right': '' });\n        setStyleAttribute(indicator, {\n            'left': nextTab.offsetLeft + 'px', 'right': nextTab.parentElement.offsetWidth - (nextTab.offsetLeft + nextTab.offsetWidth) + 'px'\n        });\n        indicator.style.display = '';\n    };\n    /**\n     * To perform the undo operation in spreadsheet.\n     * {% codeBlock src='spreadsheet/undo/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.undo = function () {\n        this.notify(performUndoRedo, { isUndo: true, isPublic: true });\n    };\n    /**\n     * To perform the redo operation in spreadsheet.\n     * {% codeBlock src='spreadsheet/redo/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.redo = function () {\n        this.notify(performUndoRedo, { isUndo: false, isPublic: true });\n    };\n    /**\n     * To update the undo redo collection in spreadsheet.\n     * {% codeBlock src='spreadsheet/updateUndoRedoCollection/index.md' %}{% endcodeBlock %}\n     * @param {object} args - options for undo redo.\n     */\n    Spreadsheet.prototype.updateUndoRedoCollection = function (args) {\n        this.notify(updateUndoRedoCollection, { args: args, isPublic: true });\n    };\n    /**\n     * Adds the defined name to the Spreadsheet.\n     * {% codeBlock src='spreadsheet/addDefinedName/index.md' %}{% endcodeBlock %}\n     * @param {DefineNameModel} definedName - Specifies the name.\n     * @return {boolean} - Return the added status of the defined name.\n     */\n    Spreadsheet.prototype.addDefinedName = function (definedName) {\n        var eventArgs = {\n            action: 'addDefinedName',\n            isAdded: false,\n            definedName: definedName\n        };\n        this.notify(formulaOperation, eventArgs);\n        return eventArgs.isAdded;\n    };\n    /**\n     * Removes the defined name from the Spreadsheet.\n     * {% codeBlock src='spreadsheet/removeDefinedName/index.md' %}{% endcodeBlock %}\n     * @param {string} definedName - Specifies the name.\n     * @param {string} scope - Specifies the scope of the defined name.\n     * @return {boolean} - Return the removed status of the defined name.\n     */\n    Spreadsheet.prototype.removeDefinedName = function (definedName, scope) {\n        return _super.prototype.removeDefinedName.call(this, definedName, scope);\n    };\n    Spreadsheet.prototype.mouseClickHandler = function (e) {\n        this.notify(click, e);\n    };\n    Spreadsheet.prototype.mouseDownHandler = function (e) {\n        this.notify(mouseDown, e);\n    };\n    Spreadsheet.prototype.keyUpHandler = function (e) {\n        if (closest(e.target, '.e-find-dlg')) {\n            this.notify(findKeyUp, e);\n        }\n        else {\n            this.notify(keyUp, e);\n        }\n    };\n    Spreadsheet.prototype.keyDownHandler = function (e) {\n        if (!closest(e.target, '.e-findtool-dlg')) {\n            this.notify(keyDown, e);\n        }\n    };\n    /**\n     * Binding events to the element while component creation.\n     */\n    Spreadsheet.prototype.wireEvents = function () {\n        EventHandler.add(this.element, 'click', this.mouseClickHandler, this);\n        EventHandler.add(this.element, getStartEvent(), this.mouseDownHandler, this);\n        EventHandler.add(this.element, 'keyup', this.keyUpHandler, this);\n        EventHandler.add(this.element, 'keydown', this.keyDownHandler, this);\n        EventHandler.add(this.element, 'noderefresh', this.refreshNode, this);\n    };\n    /**\n     * Destroys the component (detaches/removes all event handlers, attributes, classes, and empties the component element).\n     */\n    Spreadsheet.prototype.destroy = function () {\n        if (this[isReact]) {\n            this[clearTemplate]();\n        }\n        this.unwireEvents();\n        this.notify(spreadsheetDestroyed, null);\n        _super.prototype.destroy.call(this);\n        this.element.innerHTML = '';\n        this.element.removeAttribute('tabindex');\n        this.element.removeAttribute('role');\n        this.element.style.removeProperty('height');\n        this.element.style.removeProperty('width');\n        this.element.style.removeProperty('min-height');\n        this.element.style.removeProperty('min-width');\n    };\n    /**\n     * Unbinding events from the element while component destroy.\n     */\n    Spreadsheet.prototype.unwireEvents = function () {\n        EventHandler.remove(this.element, 'click', this.mouseClickHandler);\n        EventHandler.remove(this.element, getStartEvent(), this.mouseDownHandler);\n        EventHandler.remove(this.element, 'keyup', this.keyUpHandler);\n        EventHandler.remove(this.element, 'keydown', this.keyDownHandler);\n        EventHandler.remove(this.element, 'noderefresh', this.refreshNode);\n    };\n    /**\n     * To add context menu items.\n     * {% codeBlock src='spreadsheet/addContextMenu/index.md' %}{% endcodeBlock %}\n     * @param {MenuItemModel[]} items - Items that needs to be added.\n     * @param {string} text - Item before / after that the element to be inserted.\n     * @param {boolean} insertAfter - Set `false` if the `items` need to be inserted before the `text`.\n     * By default, `items` are added after the `text`.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     */\n    Spreadsheet.prototype.addContextMenuItems = function (items, text, insertAfter, isUniqueId) {\n        if (insertAfter === void 0) { insertAfter = true; }\n        this.notify(addContextMenuItems, { items: items, text: text, insertAfter: insertAfter, isUniqueId: isUniqueId });\n    };\n    /**\n     * To remove existing context menu items.\n     * {% codeBlock src='spreadsheet/removeContextMenuItems/index.md' %}{% endcodeBlock %}\n     * @param {string[]} items - Items that needs to be removed.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     */\n    Spreadsheet.prototype.removeContextMenuItems = function (items, isUniqueId) {\n        this.notify(removeContextMenuItems, { items: items, isUniqueId: isUniqueId });\n    };\n    /**\n     * To enable / disable context menu items.\n     * {% codeBlock src='spreadsheet/enableContextMenuItems/index.md' %}{% endcodeBlock %}\n     * @param {string[]} items - Items that needs to be enabled / disabled.\n     * @param {boolean} enable - Set `true` / `false` to enable / disable the menu items.\n     * @param {boolean} isUniqueId - Set `true` if the given `text` is a unique id.\n     */\n    Spreadsheet.prototype.enableContextMenuItems = function (items, enable, isUniqueId) {\n        if (enable === void 0) { enable = true; }\n        this.notify(enableContextMenuItems, { items: items, enable: enable, isUniqueId: isUniqueId });\n    };\n    /**\n     * To enable / disable file menu items.\n     * {% codeBlock src='spreadsheet/enableFileMenuItems/index.md' %}{% endcodeBlock %}\n     * @param {string[]} items - Items that needs to be enabled / disabled.\n     * @param {boolean} enable? - Set `true` / `false` to enable / disable the menu items.\n     * @param {boolean} isUniqueId? - Set `true` if the given file menu items `text` is a unique id.\n     * @returns void.\n     */\n    Spreadsheet.prototype.enableFileMenuItems = function (items, enable, isUniqueId) {\n        if (enable === void 0) { enable = true; }\n        this.notify(enableFileMenuItems, { items: items, enable: enable, isUniqueId: isUniqueId });\n    };\n    /**\n     * To show/hide the file menu items in Spreadsheet ribbon.\n     * {% codeBlock src='spreadsheet/hideFileMenuItems/index.md' %}{% endcodeBlock %}\n     * @param {string[]} items - Specifies the file menu items text which is to be show/hide.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the file menu items.\n     * @param {boolean} isUniqueId? - Set `true` if the given file menu items `text` is a unique id.\n     * @returns void.\n     */\n    Spreadsheet.prototype.hideFileMenuItems = function (items, hide, isUniqueId) {\n        if (hide === void 0) { hide = true; }\n        this.notify(hideFileMenuItems, { items: items, hide: hide, isUniqueId: isUniqueId });\n    };\n    /**\n     * To add custom file menu items.\n     * {% codeBlock src='spreadsheet/addFileMenuItems/index.md' %}{% endcodeBlock %}\n     * @param {MenuItemModel[]} items - Specifies the ribbon file menu items to be inserted.\n     * @param {string} text - Specifies the existing file menu item text before / after which the new file menu items to be inserted.\n     * @param {boolean} insertAfter? - Set `false` if the `items` need to be inserted before the `text`.\n     * By default, `items` are added after the `text`.\n     * @param {boolean} isUniqueId? - Set `true` if the given file menu items `text` is a unique id.\n     * @returns void.\n     */\n    Spreadsheet.prototype.addFileMenuItems = function (items, text, insertAfter, isUniqueId) {\n        if (insertAfter === void 0) { insertAfter = true; }\n        this.notify(addFileMenuItems, { items: items, text: text, insertAfter: insertAfter, isUniqueId: isUniqueId });\n    };\n    /**\n     * To show/hide the existing ribbon tabs.\n     * {% codeBlock src='spreadsheet/hideRibbonTabs/index.md' %}{% endcodeBlock %}\n     * @param {string[]} tabs - Specifies the tab header text which needs to be shown/hidden.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the ribbon tabs.\n     * @returns void.\n     */\n    Spreadsheet.prototype.hideRibbonTabs = function (tabs, hide) {\n        if (hide === void 0) { hide = true; }\n        this.notify(hideRibbonTabs, { tabs: tabs, hide: hide });\n    };\n    /**\n     * To enable / disable the existing ribbon tabs.\n     * {% codeBlock src='spreadsheet/enableRibbonTabs/index.md' %}{% endcodeBlock %}\n     * @param {string[]} tabs - Specifies the tab header text which needs to be enabled / disabled.\n     * @param {boolean} enable? - Set `true` / `false` to enable / disable the ribbon tabs.\n     * @returns void.\n     */\n    Spreadsheet.prototype.enableRibbonTabs = function (tabs, enable) {\n        if (enable === void 0) { enable = true; }\n        this.notify(enableRibbonTabs, { tabs: tabs, enable: enable });\n    };\n    /**\n     * To add custom ribbon tabs.\n     * {% codeBlock src='spreadsheet/addRibbonTabs/index.md' %}{% endcodeBlock %}\n     * @param {RibbonItemModel[]} items - Specifies the ribbon tab items to be inserted.\n     * @param {string} insertBefore? - Specifies the existing ribbon header text before which the new tabs will be inserted.\n     * If not specified, the new tabs will be inserted at the end.\n     * @returns void.\n     */\n    Spreadsheet.prototype.addRibbonTabs = function (items, insertBefore) {\n        this.notify(addRibbonTabs, { items: items, insertBefore: insertBefore });\n    };\n    /**\n     * Enables or disables the specified ribbon toolbar items or all ribbon items.\n     * {% codeBlock src='spreadsheet/enableToolbarItems/index.md' %}{% endcodeBlock %}\n     * @param {string} tab - Specifies the ribbon tab header text under which the toolbar items need to be enabled / disabled.\n     * @param {string[]} items? - Specifies the toolbar item indexes / unique id's which needs to be enabled / disabled.\n     * If it is not specified the entire toolbar items will be enabled / disabled.\n     * @param  {boolean} enable? - Boolean value that determines whether the toolbar items should be enabled or disabled.\n     * @returns void.\n     */\n    Spreadsheet.prototype.enableToolbarItems = function (tab, items, enable) {\n        this.notify(enableToolbarItems, [{ tab: tab, items: items, enable: enable === undefined ? true : enable }]);\n    };\n    /**\n     * To show/hide the existing Spreadsheet ribbon toolbar items.\n     * {% codeBlock src='spreadsheet/hideToolbarItems/index.md' %}{% endcodeBlock %}\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items needs to be hidden / shown.\n     * @param {string[]} indexes - Specifies the toolbar indexes which needs to be shown/hidden from UI.\n     * @param {boolean} hide? - Set `true` / `false` to hide / show the toolbar items.\n     * @returns void.\n     */\n    Spreadsheet.prototype.hideToolbarItems = function (tab, indexes, hide) {\n        if (hide === void 0) { hide = true; }\n        this.notify(hideToolbarItems, { tab: tab, indexes: indexes, hide: hide });\n    };\n    /**\n     * To add the custom items in Spreadsheet ribbon toolbar.\n     * {% codeBlock src='spreadsheet/addToolbarItems/index.md' %}{% endcodeBlock %}\n     * @param {string} tab - Specifies the ribbon tab header text under which the specified items will be inserted.\n     * @param {ItemModel[]} items - Specifies the ribbon toolbar items that needs to be inserted.\n     * @param {number} index? - Specifies the index text before which the new items will be inserted.\n     * If not specified, the new items will be inserted at the end of the toolbar.\n     * @returns void.\n     */\n    Spreadsheet.prototype.addToolbarItems = function (tab, items, index) {\n        this.notify(addToolbarItems, { tab: tab, items: items, index: index });\n    };\n    /**\n     * Selects the cell / range of cells with specified address.\n     * {% codeBlock src='spreadsheet/selectRange/index.md' %}{% endcodeBlock %}\n     * @param {string} address - Specifies the range address.\n     */\n    Spreadsheet.prototype.selectRange = function (address) {\n        this.notify(selectRange, { indexes: getRangeIndexes(address) });\n    };\n    /**\n     * Start edit the active cell.\n     * {% codeBlock src='spreadsheet/startEdit/index.md' %}{% endcodeBlock %}\n     * @return {void}\n     */\n    Spreadsheet.prototype.startEdit = function () {\n        this.notify(editOperation, { action: 'startEdit', isNewValueEdit: false });\n    };\n    /**\n     * Cancels the edited state, this will not update any value in the cell.\n     * {% codeBlock src='spreadsheet/closeEdit/index.md' %}{% endcodeBlock %}\n     * @return {void}\n     */\n    Spreadsheet.prototype.closeEdit = function () {\n        this.notify(editOperation, { action: 'cancelEdit' });\n    };\n    /**\n     * If Spreadsheet is in editable state, you can save the cell by invoking endEdit.\n     * {% codeBlock src='spreadsheet/endEdit/index.md' %}{% endcodeBlock %}\n     * @return {void}\n     */\n    Spreadsheet.prototype.endEdit = function () {\n        this.notify(editOperation, { action: 'endEdit' });\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @param  {SpreadsheetModel} newProp\n     * @param  {SpreadsheetModel} oldProp\n     * @returns void\n     * @hidden\n     */\n    Spreadsheet.prototype.onPropertyChanged = function (newProp, oldProp) {\n        var _this = this;\n        _super.prototype.onPropertyChanged.call(this, newProp, oldProp);\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'enableRtl':\n                    newProp.enableRtl ? document.getElementById(this.element.id + '_sheet_panel').classList.add('e-rtl') :\n                        document.getElementById(this.element.id + '_sheet_panel').classList.remove('e-rtl');\n                    break;\n                case 'cssClass':\n                    if (oldProp.cssClass) {\n                        removeClass([this.element], oldProp.cssClass.split(' '));\n                    }\n                    if (newProp.cssClass) {\n                        addClass([this.element], newProp.cssClass.split(' '));\n                    }\n                    break;\n                case 'activeSheetIndex':\n                    this.renderModule.refreshSheet();\n                    this.notify(activeSheetChanged, { idx: newProp.activeSheetIndex });\n                    break;\n                case 'width':\n                    this.setWidth();\n                    this.resize();\n                    break;\n                case 'height':\n                    this.setHeight();\n                    this.resize();\n                    break;\n                case 'showRibbon':\n                    this.notify(ribbon, { uiUpdate: true });\n                    break;\n                case 'showFormulaBar':\n                    this.notify(formulaBar, { uiUpdate: true });\n                    break;\n                case 'showSheetTabs':\n                    this.notify(sheetTabs, null);\n                    break;\n                case 'cellStyle':\n                    this.renderModule.refreshSheet();\n                    break;\n                case 'allowEditing':\n                    if (this.allowEditing) {\n                        this.notify(editOperation, { action: 'renderEditor' });\n                    }\n                    break;\n                case 'allowInsert':\n                    var addBtn = this.element.getElementsByClassName('e-add-sheet-tab')[0];\n                    if (addBtn) {\n                        addBtn.disabled = !this.allowInsert;\n                        if (this.allowInsert) {\n                            if (addBtn.classList.contains('e-disabled')) {\n                                addBtn.classList.remove('e-disabled');\n                            }\n                        }\n                        else {\n                            if (!addBtn.classList.contains('e-disabled')) {\n                                addBtn.classList.add('e-disabled');\n                            }\n                        }\n                    }\n                    break;\n                case 'sheets':\n                    Object.keys(newProp.sheets).forEach(function (sheetIdx, index) {\n                        var sheet = newProp.sheets[sheetIdx];\n                        if (sheet.ranges && Object.keys(sheet.ranges).length) {\n                            var ranges_1 = Object.keys(sheet.ranges);\n                            var newRangeIdx_1;\n                            ranges_1.forEach(function (rangeIdx, idx) {\n                                if (!sheet.ranges[rangeIdx].info) {\n                                    newRangeIdx_1 = idx;\n                                }\n                            });\n                            ranges_1.forEach(function (rangeIdx, idx) {\n                                if (sheet.ranges[rangeIdx].dataSource && (isUndefined(newRangeIdx_1)\n                                    || (!isUndefined(newRangeIdx_1) && newRangeIdx_1 === idx))) {\n                                    _this.notify(dataSourceChanged, {\n                                        sheetIdx: sheetIdx, rangeIdx: rangeIdx,\n                                        isLastRange: ranges_1.length - 1 === idx\n                                    });\n                                }\n                            });\n                        }\n                        else {\n                            if (index === 0) {\n                                _this.renderModule.refreshSheet();\n                            }\n                            if (_this.showSheetTabs && sheet.name) {\n                                _this.notify(sheetNameUpdate, {\n                                    items: _this.element.querySelector('.e-sheet-tabs-items').children[sheetIdx],\n                                    value: sheet.name,\n                                    idx: sheetIdx\n                                });\n                            }\n                        }\n                    });\n                    break;\n                case 'locale':\n                    this.refresh();\n                    break;\n            }\n        }\n    };\n    /**\n     * To provide the array of modules needed for component rendering.\n     * @return {ModuleDeclaration[]}\n     * @hidden\n     */\n    Spreadsheet.prototype.requiredModules = function () {\n        return getRequiredModules(this);\n    };\n    /**\n     * Appends the control within the given HTML Div element.\n     * {% codeBlock src='spreadsheet/appendTo/index.md' %}{% endcodeBlock %}\n     * @param {string | HTMLElement} selector - Target element where control needs to be appended.\n     */\n    Spreadsheet.prototype.appendTo = function (selector) {\n        _super.prototype.appendTo.call(this, selector);\n    };\n    /**\n     * Filters the range of cells in the sheet.\n     * @hidden\n     */\n    Spreadsheet.prototype.filter = function (filterOptions, range) {\n        if (!this.allowFiltering) {\n            return Promise.reject();\n        }\n        range = range || this.getActiveSheet().selectedRange;\n        return _super.prototype.filter.call(this, filterOptions, range);\n    };\n    /**\n     * Clears the filter changes of the sheet.\n     * {% codeBlock src='spreadsheet/clearFilter/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.clearFilter = function (field) {\n        if (field) {\n            this.notify(clearFilter, { field: field });\n        }\n        else {\n            _super.prototype.clearFilter.call(this);\n        }\n    };\n    /**\n     * Applies the filter UI in the range of cells in the sheet.\n     * {% codeBlock src='spreadsheet/applyFilter/index.md' %}{% endcodeBlock %}\n     */\n    Spreadsheet.prototype.applyFilter = function (predicates, range) {\n        this.notify(initiateFilterUI, { predicates: predicates, range: range });\n    };\n    /**\n     * To add custom library function.\n     *  {% codeBlock src='spreadsheet/addCustomFunction/index.md' %}{% endcodeBlock %}\n     * @param {string} functionHandler - Custom function handler name\n     * @param {string} functionName - Custom function name\n     */\n    Spreadsheet.prototype.addCustomFunction = function (functionHandler, functionName) {\n        _super.prototype.addCustomFunction.call(this, functionHandler, functionName);\n        this.notify(refreshFormulaDatasource, null);\n    };\n    var Spreadsheet_1;\n    __decorate([\n        Property('')\n    ], Spreadsheet.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowScrolling\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowResizing\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableClipboard\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableContextMenu\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableKeyboardNavigation\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"enableKeyboardShortcut\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowUndoRedo\", void 0);\n    __decorate([\n        Property(true)\n    ], Spreadsheet.prototype, \"allowWrap\", void 0);\n    __decorate([\n        Complex({}, SelectionSettings)\n    ], Spreadsheet.prototype, \"selectionSettings\", void 0);\n    __decorate([\n        Complex({}, ScrollSettings)\n    ], Spreadsheet.prototype, \"scrollSettings\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeCellRender\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"select\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuBeforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileMenuBeforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuBeforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"dialogBeforeOpen\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileMenuBeforeClose\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"contextMenuItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"fileMenuItemSelect\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeDataBound\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"dataBound\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"dataSourceChanged\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellEdit\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellEditing\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"cellSave\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeCellSave\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeSort\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeHyperlinkCreate\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"afterHyperlinkCreate\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"beforeHyperlinkClick\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"afterHyperlinkClick\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"actionBegin\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"actionComplete\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"openComplete\", void 0);\n    __decorate([\n        Event()\n    ], Spreadsheet.prototype, \"sortComplete\", void 0);\n    Spreadsheet = Spreadsheet_1 = __decorate([\n        NotifyPropertyChanges\n    ], Spreadsheet);\n    return Spreadsheet;\n}(Workbook));\nexport { Spreadsheet };\n"],"names":["getRangeIndexes","range","cellindexes","indexes","indexOf","split","forEach","address","getCellIndexes","push","parseInt","match","getColIndex","toUpperCase","text","colIdx","i","reverse","join","length","charCodeAt","Math","pow","getCellAddress","sRow","sCol","getColumnHeaderText","getRangeAddress","isNullOrUndefined","colIndex","floor","String","fromCharCode","getIndexesFromAddress","getRangeFromAddress","getAddressFromSelectedRange","sheet","name","selectedRange","getAddressInfo","context","sIdx","getSheetIndex","getSheetNameFromAddress","activeSheetIndex","sheetIndex","indices","getSwapRange","clonedRange","slice","swap","x","y","tmp","isSingleCell","executeTaskAsync","taskFn","callbackFn","data","preventCallback","WorkerHelper","toFraction","val","strVal","toString","top_1","bottom","replace","abs","getGcd","a","b","Number","intToDate","Date","getTime","dateToInt","isTime","startDate","date","isDateTime","startDateUTC","UTC","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","diffDays","Object","prototype","call","isNaN","valueOf","isNumber","parseFloat","toDate","intl","format","defaultDateFormats","getDefaultDateObject","availabelDateTimeFormat","dateTimeFormats","availableFormats","dObj","dateObj","isCustom","type","parseDate","_i","_a","keys","dateFormats","key","skeleton","_b","_c","time","toLocaleTimeString","_d","_e","timeFormats","parseIntValue","value","test","getFormatFromType","code","getTypeFromFormat","getSkeletonVal","getModules","modules","includeBasicFormulas","member","args","getValue","nameSpace","obj","splits","j","isUndefined","setValue","keyValues","start","fromObj","undefined","getAlphalabel","col","cols","n","aCharNo","chs","getWorkbookRequiredModules","allowSave","allowOpen","allowEditing","allowNumberFormatting","allowCellFormatting","allowSorting","allowHyperlink","allowFiltering","allowFindAndReplace","allowInsert","allowDelete","allowDataValidation","allowMerge","allowImage","allowChart","checkIsFormula","isCellReference","rangeSplit","isValidCellReference","isChar","inRange","rowIdx","isLocked","cell","column","endNum","numArr","cellText","textLength","cellTextLength","substring","cellNumber","getCell","rowIndex","isInitRow","returnEmptyObjIfNull","row","getRow","cells","rows","setCell","isExtend","extend","skipDefaultValue","style","defaultKey","defaultProps","fontFamily","verticalAlign","textIndent","backgroundColor","color","textAlign","fontSize","fontWeight","fontStyle","textDecoration","border","borderLeft","borderTop","borderRight","borderBottom","changedProps","propName","wrap","addressInfo","rng","getSheet","setProperties","sheets","notify","wrapEvent","getData","columnWiseData","valueOnly","Promise","resolve","reject","Map","sheetIdx","index","promise","updateSheetFromDataSource","then","getDisplayText","isDate","checkDateFormat","getValueFromFormat","cellObj","assign","colSpan","rowSpan","cell_1","len","k","len_1","formula","isHiddenRow","isHiddenCol","eventArgs","trigger","queryCellInfo","set","processIdx","model","isSheet","cnt","out_i_1","diff","_loop_1","createSheet","splice","id","getMaxSheetId","properties","setSheetPropertyOnMute","getSheetNameCount","cellCnt_1","max","clearRange","sCIdx","eCIdx","sRIdx","eRIdx","cFDelete","idx","toLowerCase","getSheetIndexFromId","getSheetIndexByName","info","updateSelectedRange","sheetNameCount","initSheet","rowCount","colCount","topLeftCell","activeCell","usedRange","ranges","columns","showHeaders","showGridLines","state","maxHgts","protectSettings","selectCells","formatCells","formatRows","formatColumns","insertLink","isProtected","initRow","getSheetName","setRow","hidden","getRowHeight","height","setRowHeight","getRowsHeight","startRow","endRow","getColumn","setColumn","curColumn","getColumnWidth","skipHidden","width","customWidth","getColumnsWidth","startCol","endCol","getRequiredModules","showRibbon","showFormulaBar","showSheetTabs","enableContextMenu","selectionSettings","mode","enableKeyboardNavigation","enableKeyboardShortcut","enableClipboard","allowResizing","allowUndoRedo","allowWrap","allowConditionalFormat","pushBasicModules","getUpdateUsingRaf","fn","requestAnimationFrame","removeAllChildren","parent","firstChild","removeChild","getColGroupWidth","getScrollBarWidth","scrollAreaWidth","htmlDivNode","document","createElement","result","cssText","body","appendChild","offsetWidth","clientWidth","getSiblingsHeight","element","classList","classes","getHeightFromDirection","direction","sibling","some","contains","offsetHeight","inView","isModify","scrollSettings","enableVirtualization","topIdx","viewport","topIndex","leftIdx","leftIndex","bottomIdx","getThreshold","rightIdx","inView_1","getCellPosition","offset","left","size","top","locateElem","ele","isRtl","swapRange","cellPosition","startIndex","skipHiddenIdx","attrs","setStyleAttribute","styles","setBaseStyleAttribute","getStartEvent","Browser","isPointer","getMoveEvent","getEndEvent","isTouchStart","e","pointerType","isTouchMove","isTouchEnd","getClientX","changedTouches","clientX","getClientY","clientY","setAriaOptions","target","options","setAttribute","config","destroyComponent","component","compObj","getComponent","destroy","setResize","isCol","curEle","curEleH","curEleC","preEle","preEleH","preEleC","nxtEle","nxtEleH","nxtEleC","getActiveSheet","getElementsByClassName","getElementsByTagName","hdrFntSize","hdrRow","getRowHeaderContent","hdrClone","cloneNode","findMaxValue","getRowHeaderTable","contentRow","getMainContent","contentClone","cntFntSize","getContentTable","fntSize","add","lineHeight","removeProperty","remove","previousElementSibling","nextElementSibling","setWidthAndHeight","nxtIndex","getAttribute","getColHeaderTable","trgt","table","prevData","isWrap","myTableDiv","className","myTable","myTr","tr","offsetWidthValue","offsetHeightValue","getBoundingClientRect","ceil","updateAction","spreadsheet","isRedo","action","sortArgs","sortOptions","cancel","initiateSort","serviceLocator","getService","refreshRange","cellEvtArgs","cellValue","updateCell","requestType","cellFormat","numberFormat","copiedInfo","isCut","cut","copiedRange","copy","paste","pastedRange","isShow","hide","setColWidth","hideColumn","hideRow","removeSheetTab","isAction","count","sheetCount","clicked","endIndex","compareVal","initiateFilterUI","predicates","delete","modelType","insertModel","end","checkCount","deletedModel","columnCellsModel","deletedCellsModel","rules","operator","value1","value2","ignoreBlank","inCellDropDown","setValidation","removeValidation","setMerge","clearViewer","isPublic","conditionalFormat","cFColor","setCFRule","clearCFRule","clearCells","conditionalFormats","cFormats","oldRange","createImageElement","src","imageData","imageHeight","imageWidth","imageId","isUndoRedo","deleteImage","getElementById","refreshImgCellObj","prevTop","currentTop","prevLeft","currentLeft","currentHeight","prevHeight","currentWidth","prevWidth","chartOptions","theme","isSeriesInRows","setChart","chart","isInitCell","posRange","deleteChart","chartOpts","chartElement","refreshChartSize","overlayEle","hasTemplate","workbook","template","startCell","setRowEleHeight","hRow","notifyRowHgtChange","prevHgt","edit","querySelector","innerHTML","actCell","splitVal","valLength","lines","getLines","getExcludedColumnWidth","cellStyle","getTextHeight","rowHeightChanged","threshold","fontSizePx","getTextWidth","parentStyle","getContext","font","measureText","colwidth","textArr","spaceWidth","txt","lWidth","cWidth","getBorderHeight","bottomSideCell","startColIdx","endColIdx","rightSideCell","getBorderWidth","setMaxHgt","rIdx","cIdx","hgt","getMaxHgt","maxHgt","rowHgt","increase","layout","focus","isIE","scrollX_1","window","scrollX","scrollY_1","scrollY","scrollTo","preventScroll","task","defaultListener","taskData","this","workerTask","workerData","initWorker","terminate","worker","URL","revokeObjectURL","workerUrl","taskBlob","Blob","getFnCode","createObjectURL","Worker","onmessage","messageFromWorker","bind","onerror","onError","postMessage","apply","message","workerCode","workerFunction","isHaveFunction","getMessageFn","getCallbackMessageFn","workbookDestroyed","dataSourceChanged","dataChanged","workbookOpen","beginSave","getFilteredCollection","saveCompleted","applyNumberFormatting","getFormattedCellObject","refreshCellElement","setCellFormat","findAllValues","textDecorationUpdate","applyCellFormat","updateUsedRange","workbookFormulaOperation","workbookEditOperation","getFormattedBarText","activeCellChanged","openSuccess","openFailure","sheetCreated","sheetsDestroyed","aggregateComputation","sortComplete","beforeHyperlinkCreate","afterHyperlinkCreate","beforeHyperlinkClick","afterHyperlinkClick","setLinkModel","initiateFilter","filterComplete","filterRangeAlert","clearAllFilter","onSave","insert","deleteAction","deleteModel","isValidation","addHighlight","findNext","findPrevious","goto","replaceHandler","replaceAllHandler","showDialog","findUndoRedo","findKeyUp","removeHighlight","protectSheetWorkBook","updateToggle","protectsheetHandler","replaceAllDialog","unprotectsheetHandler","setLockCells","applyLockCells","applyMerge","mergedRange","activeCellMergedRange","insertMerge","pasteMerge","cFInitialCheck","cFRender","clear","clearCF","setImage","initiateChart","refreshRibbonIcons","refreshChart","updateChart","deleteChartColl","focusChartBorder","saveError","WorkbookNumberFormat","localeObj","getNumericObject","locale","decimalSep","decimal","groupSep","group","addEventListener","numberFormatting","getFormattedCell","fResult","rightAlign","currencySymbol","getNumberDependable","dateEventArgs","updatedVal","processFormats","isRightAlign","curSymbol","onLoad","setUsedRange","formattedText","Internationalization","autoDetectGeneralFormat","curCode","applyNumberFormat","currencyFormat","percentageFormat","accountingFormat","shortDateFormat","longDateFormat","timeFormat","fractionFormat","scientificFormat","res","trim","isEdit","findSuffix","zeros","resultSuffix","suffixLen","substr","isCustomFormat","formatArr","formatNumber","currency","shortDate","formatDate","longDate","prefix","findDecimalPlaces","toExponential","fractionResult","suffix","eIndex","decIndex","checkedDate","checkCustomDateFormat","dateArr","months","formattedBarText","beforeText","on","removeEventListener","isDestroyed","off","getModuleName","DataBind","requestedInfo","updateSheetFromDataSourceHandler","dataSourceChangedHandler","dataChangedHandler","flds","sCellIdx","remoteUrl","dataManager","sRowIdx","sColIdx","loadedInfo","_this","requestedRange","sRanges","deferred","Deferred","sRange","eRange","dataSource","DataManager","url","isLocalData","showFieldAsHeader","isEndReached","insertRowCount","this_1","initRangeInfo","getMaxCount","getLoadedInfo","unloadedRange","insertRowRange","isNotLoaded","query","Query","clone","executeQuery","requiresCount","fldLen","insertColumnRange","insertCount_1","insertRange","field","includes","item","getCellDataFromProp","checkDataForFormat","loadedRange","rangeSettingCount","unloadedArgs","pop","checkResolve","resolved","isSameRng","JSON","stringify","isLoaded","prop","hyperlink","queries","min","nos","rangeIdx","checkRangeHasChanges","showFieldAsHeader_1","indexes_1","refreshRange_1","bottomIndex","rightIndex","args_1","isAngular","changedRangeIdx","dataRange","deleteRowDetails","cellIndices","changedData","isNewRow","concat","insertType","_loop_2","fld","rangeIndex","ribbon","formulaBar","sheetTabs","refreshSheetTabs","isFormulaBarEdit","dataRefresh","initialLoad","contentLoaded","mouseDown","spreadsheetDestroyed","editOperation","formulaOperation","formulaBarOperation","click","keyUp","keyDown","onVerticalScroll","onHorizontalScroll","beforeContentLoaded","beforeVirtualContentLoaded","virtualContentLoaded","cellNavigate","mouseUpAfterSelection","selectionComplete","cMenuBeforeOpen","insertSheetTab","renameSheetTab","ribbonClick","enableToolbarItems","tabSwitch","selectRange","clearCopy","beforeDataBound","addContextMenuItems","removeContextMenuItems","enableContextMenuItems","enableFileMenuItems","hideFileMenuItems","addFileMenuItems","hideRibbonTabs","enableRibbonTabs","addRibbonTabs","addToolbarItems","hideToolbarItems","beforeRibbonCreate","colWidthChanged","beforeHeaderLoaded","onContentScroll","deInitProperties","activeSheetChanged","renameSheet","initiateCustomSort","applySort","collaborativeUpdate","hideShow","autoFit","updateToggleItem","initiateHyperlink","editHyperlink","openHyperlink","removeHyperlink","createHyperlinkElement","sheetNameUpdate","hideSheet","performUndoRedo","updateUndoRedoCollection","setActionData","getBeforeActionData","clearUndoRedoCollection","renderFilterCell","reapplyFilter","filterByCellValue","clearFilter","getFilteredColumn","completeAction","beginAction","filterCellKeyDown","getFilterRange","setAutoFit","refreshFormulaDatasource","setScrollEvent","initiateDataValidation","invalidData","protectSheet","applyProtect","protectCellFormat","gotoDlg","findDlg","findHandler","created","editAlert","setUndoRedo","enableFormulaInput","protectSelection","hiddenMerge","checkPrevMerge","checkMerge","removeDataValidation","showAggregate","initiateConditionalFormat","checkConditionalFormat","setCF","initiateFormulaReference","initiateCur","clearCellRef","editValue","addressHandle","initiateEdit","forRefSelRender","blankWorkbook","insertImage","refreshImgElem","getRowIdxFromClientY","getColIdxFromClientX","refreshChartCellObj","refreshImagePosition","updateTableWidth","focusBorder","clearChartBorder","insertChart","chartRangeSelection","isReact","renderReactTemplates","clearTemplate","WorkbookOpen","open","jsonObject","fetchSuccess","formData","FormData","file","append","requestData","method","fetch","openUrl","response","ok","json","status","statusText","catch","error","fetchFailure","isOpen","impData","parse","Workbook","updateModel","workbookModel","setSelectAllRange","definedNames","isImport","selectedIndex","SaveWorker","processSheet","Array","isArray","processSave","saveJSON","saveSettings","customParams","blob","reader","FileReader","onload","str","atob","dialog","readAsDataURL","__extends","extendStatics","d","setPrototypeOf","__proto__","p","hasOwnProperty","__","constructor","create","WorkbookSave","_super","isProcessCompleted","isFullPost","needBlobData","events.beginSave","initiateSave","saveType","fileName","updateBasicSettings","processSheets","jsonStr","getStringifyObject","basicSettings","updateSheet","getSheetLength","save","events.onSave","initiateFullPostSave","updateSaveResult","blobData","events.saveError","content","ClientFileDownload","events.saveCompleted","anchor","download","getFileNameWithExtension","href","formElem","inputElem","submit","detach","skipProp","filename","fileExt","getFileExtension","lastIndexOf","CalculateCommon","ModuleLoader","loadedModules","inject","requiredModules","moduleList","reqLengthVal","clearUnusedModule","modl","moduleList_1","module","modName","isModuleLoaded","moduleObject","createInstance","memberName","getMemberName","isProperty","loadedModule","clean","classFunction","params","arrayParam","unshift","Function","moduleListName","usedModule","map","arg","removeModule_1","filter","moduleName","deleteObject","CommonErrors","FormulasErrorsStrings","BasicFormulas","formulas","formulaName","category","description","isConcat","init","addFormulaCollection","functionName","formulaCategory","libraryFormulas","fName","handler","ComputeSUM","arguments","formulaErrorStrings","invalid_arguments","orgValue","sum","argArr","argValue","cellCollection","getCellCollection","tic","getValueFromArg","getErrorStrings","trueValue","falseValue","ComputeINT","num","ComputeTODAY","dt","now","calculateDate","ComputeSUMPRODUCT","mulValues","startsWith","s1","col1","col2","cellRef","convertAlpha","ComputeROUNDUP","arg1","arg2","toFixed","digits","ComputeCOUNT","wrong_number_arguments","argVal","cellColl","ComputeDATE","year","month","day","days","getSerialDateFromDate","fromOADate","ComputeFLOOR","fnum","significance","argCount","splitArg","divzero","ComputeCEILING","cnum","ComputeDAY","serialNumber","dateVal","ComputeIF","condition","requires_3_args","ComputeIFERROR","arithMarker","ComputePRODUCT","parseVal","product","argsHit","rangevalue","ComputeDAYS","argsArr","endDate","toDateString","d1","d2","round","ComputeCHOOSE","cond","indexNum","ComputeSUMIF","improper_formula","computeSumIfAndAvgIf","ComputeABS","absValue","absVal","cellvalue","ComputeAVERAGE","calculateAvg","ComputeAVERAGEIF","argList","resultVal","ComputeCONCATENATE","argsList","tempStr","i_1","ComputeCONCAT","ComputeMAX","computeMinMax","ComputeMIN","ComputeRAND","random","ComputeAND","computeAndOr","ComputeOR","ComputeFIND","findText","removeTics","withinText","loc","startNum","ComputeINDEX","ref","rangeValue","rangeArr","i_2","ComputeIFS","na","ComputeCOUNTA","ComputeAVERAGEA","cellCol","parseValue","argArrs","ComputeCOUNTIF","stack","op","findWildCardValue","processLogical","ComputeSUMIFS","computeIfsFormulas","ComputeTEXT","checkArgs","argsLength","splitIndex","frtArg","scndArg","checkScndArg","s2","dTime","checkString","parseDouble","toOADate","formatChar","isH","isMFound","lastCharIndex","totalCharforM","c","getSkeleton","getDateFormat","dFormatter","ComputeCOUNTIFS","ComputeAVERAGEIFS","ComputeMATCH","lookupVal","matchType","indexVal","ComputeLOOKUP","computeLookup","ComputeVLOOKUP","computeVLookup","ComputeSUBTOTAL","ComputeRADIANS","radVal","PI","ComputeRANDBETWEEN","ComputeSLOPE","yPoints","xPoints","xPointsRange","yPointsRange","getDataCollection","sumXY","sumX2","sumX","sumY","ComputeINTERCEPT","xValues","yValues","yValuesRange","xValuesRange","ComputeLN","logValue","logVal","log","ComputeISNUMBER","ComputeROUND","numStr","digStr","mult","ComputePOWER","orgNumValue","orgPowValue","logNumValue","logPowValue","ComputeLOG","orgBaseValue","logBaseValue","LN10","ComputeTRUNC","normalizer","orgDigitValue","ComputeEXP","exp","ComputeGEOMEAN","dev","r","s","cellVal","cellsData","NaN","Parser","emptyStr","storedStringText","sheetToken","tokenAdd","tokenSubtract","tokenMultiply","tokenDivide","tokenLess","charEm","charEp","tokenGreater","tokenEqual","tokenLessEq","tokenGreaterEq","tokenNotEqual","tokenAnd","tokenEm","tokenEp","tokenOr","charAnd","charLess","charGreater","charEqual","charLessEq","charGreaterEq","charNoEqual","stringGreaterEq","stringLessEq","stringNoEqual","stringAnd","stringOr","charOr","charAdd","charSubtract","charMultiply","charDivide","fixedReference","spaceString","ignoreBracet","isError","isFormulaParsed","findNamedRange","stringsColl","tokens","charNOTop","specialSym","isFailureTriggered","fkey","isTextEmpty","getFormulaCharacter","namedRanges","storedData","checkForNamedRangeAndKeyValue","formulaString","storeStrings","indexOfAny","family","getSheetFamilyItem","grid","sheetNameToParentObject","setTokensForSheets","getSheetToken","scopedRange","checkScopedRange","markLibraryFormulas","formulaAutoCorrection","ex","exception","isForceCalculable","formulaCorrection","computeForceCalculate","invalid_expression","get","formulaText","FormulaError","mismatched_parentheses","empty_expression","parseSimple","exceptionArgs","errorMessage","getErrorLine","setStrings","arithemeticArr","logicalSym","form","firstOp","secondprevOp","secondnextOp","firstDigit","secondDigit","countDigit","isDigit","rightBracket","has","leftBracket","isUpperChar","getParseArgumentSeparator","getSheetID","v","token","sheetNameToToken","s_1","parentObject","getNamedRanges","tempString","storedString","mismatched_tics","expTokenArray","mulTokenArray","addTokenArray","mulCharArray","addCharArray","compareTokenArray","compareCharArray","expCharArray","andTokenArray","andCharArray","orCharArray","orTokenArray","parseSimpleOperators","markers","operators","right","findLeftMarker","cannot_parse","bracketCount","l","period","getParseDecimalSeparator","number_contains_2_decimal_points","getCellFrom","updateDependentCell","expression_cannot_end_with_an_operator","uFound","findRightMarker","jTemp","inbracket","noCellReference","arithMarker2","isCharacter","checkLetter","oneTokenFound","textLen","ret","bracketLevel","parseFormula","fKey","bracCount","rightParens","markNamedRanges","parenCount","leftParens","libFormula","getFunction","swapInnerParens","addParensToArgs","fSubstr","rightSides","lastIndexOfAny","oneTimeOnly","getTableRange","namerangeValue","findNextEndIndex","found","__decorate","decorators","desc","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","Calculate","lFormulas","keyToRowsMap","rowsToKeyMap","emptyString","leftBrace","rightBrace","cellPrefix","treatEmptyStringAsZero","singleTic","parseDecimalSeparator","dependentCells","dependentFormulaCells","minValue","MIN_SAFE_INTEGER","maxValue","MAX_SAFE_INTEGER","categoryCollection","dependencyLevel","refreshedCells","computedValues","randomValues","isRandomVal","randCollection","errorStrings","parseArgumentSeparator","dateTime1900","isParseDecimalSeparatorChanged","isArgumentSeparatorChanged","sheetFamilyID","defaultFamilyItem","sheetFamiliesList","modelToSheetID","tokenCount","sortedSheetNames","tempSheetPlaceHolder","formulaInfoTable","oaDate","millisecondsOfaDay","parseDateTimeSeparator","moduleLoader","Calculate_1","Inject","injectedModules","parser","formulaColl","enumerable","configurable","setParseArgumentSeparator","getParseDateTimeSeparator","setTreatEmptyStringAsZero","getTreatEmptyStringAsZero","setParseDateTimeSeparator","getInjectedModules","onPropertyChanged","newProp","oldProp","charCode","resetKeys","parentObjectToToken","getDependentCells","formulaCells","addToFormulaDependentCells","cell1","getDependentFormulaCells","isSheetMember","sheetDependentCells","sheetDependentFormulaCells","getLibraryFormulas","getFormulaInfoTable","sheetFormulaInfotable","getFormula","getFormulaText","setParseDecimalSeparator","temp","bad_index","grd","isLetter","CalcSheetFamilyItem","setKeyValue","FormulaInfo","fInfo","clearFormulaDependentCells","setFormulaText","getFormulaValue","setParsedFormula","setFormulaValue","dependentFormula","dependent","arrayRemove","array","getKeyValue","fText","computeFormula","getParsedFormula","addNamedRange","sheetScopeName","removeNamedRange","arrCol","aCharValue","arr","cellRange","sheetTokenIndex","row1","row2","parsedText","lastIndexOfq","formulatResult","fNested","nestedFormula","findLastIndexOfq","sFormula","customArgs","processNestedFormula","q","computeValue","splitArray","spreadSheetUsedRange","criteria","opt","checkCriteria","criteriaRangeArray","sumRange","criteriaRange","getComputeSumIfValue","checkCrte","findMaxVal","criterias","lookupRangeArray","lookupRange","maxVal","sort","minVal","lookupValue","firstCol","secCol","lookupCol","lookupCell","lookVal","finalText","checStr1","checStr2","newIndex","compRight","compLeft","leftVal","rightVal","sumRangeVal","tempdate","last","r1","c1","c2","r2","pFormula","textName","getParentObjectCellValue","stackValue","errIndex","getValArithmetic","countValue","num1","num2","val1","val2","localeCompare","computeStoreCells","sCell","cellRanges","argArray","isCriteria","storeCell","storedCells","isCountIfs","isCountIfS","countVal","rangeLength","tempStoredCell","newCell","newCount","cellAlpha","newCellAlpha","isAvgIfs","storedCell","pText","doubleNumber","setTime","isValidMonth","tempDay","dateTime","fString","pObjCVal","f","circular_reference","dateval","cellTxt","sheetToken1","containsBoth","isAlpha","isNum","charArray","sortedSheetNamesCollection","getSortedSheetNames","textSplit","tokenToParentObject","saveCell","cValue","getParentCellValue","getValueRowCol","defineFunction","valueChanged","changeArgs","isCalculate","usedRangeCol","pgrid","isComputedValueChanged","isCompute","calcFamily","getRowIndex","randStrVal","setValueRowCol","getComputedValue","refresh","formulaValue","arr_1","errorStack","createSheetFamilyID","operation","countStrVal","sumCell","avgVal","countNum","registerGridAsSheet","refName","tempRef","unregisterGridAsSheet","refName1","computeExpression","parsedFormula","dispose","refreshRandValues","tokenRef","stringCollection","dCell","formulaInfo","Property","Event","NotifyPropertyChanges","Base","calcID","MIN_VALUE","calcID1","ValueChangedArgs","setRowIndex","setColIndex","WorkbookFormula","uniqueOBracket","uniqueCBracket","uniqueCSeparator","uniqueCOperator","uniquePOperator","uniqueSOperator","uniqueMOperator","uniqueDOperator","uniqueModOperator","uniqueConcateOperator","uniqueEqualOperator","uniqueExpOperator","uniqueGTOperator","uniqueLTOperator","sheetInfo","initCalculate","registerSheet","calculateInstance","performFormulaOperation","from","values","formulaCollection","collection","selectCategory","selectedList","updateSheetInfo","unRegisterSheet","autoCorrectFormula","refreshCalculate","isFormula","argumentSeparator","isAdded","addDefinedName","definedName","isRemoved","removeDefinedName","scope","initiateDefinedNames","renameUpdation","sheetId","visibleName","sheetName","length_1","sheetDeletion","refError","referenceError","addCustomFunction","functionHandler","calcValue","sheetID","refreshInsDelFormula","insertArgs","refreshNamedRange","getSheetInfo","delSheetName","rowId","colId","formulaVal","removeSheetTokenIndex","dependentCellRef","updateDataContainer","visible","savedTokens","isSheetRenamed","sheetNames","name_1","sheetData","rowData","colObj","parseSheetRef","regx","escapeRegx","RegExp","cellArgs","referenceCollection","refValue","tempArgs","isEqual","lessEq","greaterEq","equal","lessOp","greaterOp","equalOp","definedname","refersTo","isLink","isValidate","visibleRefersTo","comment","checkIsNameExist","getIndexFromNameColl","calcName","formatedValues","actCellModel","actCellfrmt","countOnly","Count","Sum","Avg","Min","Max","clearFormula","startIdx","refreshFormula","diff1","nAlpha","fArg","ridx","pVal","actSheet","deleteIdxs","splitFormula","updatedFormulaVal","sheetLen","markSpecialChar","isUniqueChar","getUniqueCharVal","newRange","isChanged","modelDefinedNames","definedNameCnt","WorkbookSort","initiateSortHandler","sortDescriptors","containsHeader","workbookLocale","getConstant","getSortDataRange","isSameStyle","header","jsonData","comparerFn","sortComparer","caseSensitive","sortBy","colName","firstCellStyle","secondCellStyle","sameStyle","prevleftIdx","prevrightIdx","topReached","btmReached","leftReached","rightReached","btmIdx","sortDescriptor","order","comparer","DataUtil","fnSort","caseOptions","sensitivity","collator","Intl","Collator","compare","WorkbookFilter","filterRange","initiateFilterHandler","clearAllFilterHandler","filterOptions","datasource","setFilter","filterEventArgs","address_1","where","Predicate","and","result_1","executeLocal","WorkbookImage","oldImgData","imgRange","imgData","image","WorkbookChart","setChartHandler","refreshChartData","isPaste","chartCount","isIdAvailabe","idAvailable","option","dataSheetIdx","chartColl","charts","isInRange","rangeSheetIdx","chartCnt","sheetCnt","chartObj","excelFilter","chartEle","closest","isRefresh","overlayElement","WorkbookCellFormat","triggerEvent","onActionUpdate","borderType","setTypedBorder","checkAdjustantBorder","checkFullBorder","setCellBorder","setBottomBorderPriority","isFullBorder","setFullBorder","setCellStyle","lastCell","isHeightCheckNeeded","manualUpdate","refreshRibbon","pIdx","skipHiddenRows","getCellStyleValue","bottomPriority","actionUpdate","style_1","textDecorationActionUpdate","changedStyle","changedValue","activeCellIndexes","removeProp","prevBorder","first","clearCellObj","eColIdx","clrRange","eRowIdx","WorkbookEdit","performEditOperation","updateCellValue","isValueOnly","checkDecimalPoint","WorkbookHyperlink","setLinkHandler","cellIdx","cellAddr","WorkbookInsert","mergeCollection","isModel","curIdx","insertCount","cellModel","mergeArgs","sheetModel","id_1","skipHiddenSheets","updateRangeModel","setInsertInfo","totalKey","WorkbookDelete","sheetLength","modelName","deletedCells","prevCell","mergeArgsCollection","update","preventRefresh","merge","skipChecking","prevCell_1","setDeleteInfo","total","WorkbookDataValidation","addValidationHandler","removeValidationHandler","addHighlightHandler","removeHighlightHandler","ValidationHandler","isRemoveValidation","validation","InvalidDataHandler","isRemoveHighlightedData","lastRowIdx","lastColIdx","range_1","isCell","isValid","WorkbookFindAndReplace","replaceAll","totalCount","cidx","valueOfCell","activecell","endColumn","stringValue","startColumn","lcValueOfCell","ivalueOfCell","lowerCaseIndex","searchBy","findNextArgs","loopCount","findNxtRow","findNxtCol","sheetsLen","noCellfound","nextCommon","noFound","rowCol","cellType","cellval","isCSen","isEMatch","lcValue","ivalue","findPrevArgs","findPreRow","findPreCol","usedRan","sheetsLength","noValueBoolean","commonCondition","prevCommon","isTrue","currentCell","findOpt","activecel","replaceAddress","replaceAllCollection","undoRedoOpt","caseInSensitive","replaceValue","replaceAllCollection_1","newValue","replaceAllCollection_2","updateValue","replaceAllCollection_3","startSheet","addressCollection","lowerCaseValue","regExepression","Collection","countNumber","columnIndex","requiredCount","findCount","argsVal","lowerCaseVal","findAllArguments","initialSheet","findCollection","WorkbookProtectSheet","props","lockCells","WorkbookMerge","mergeHorizontally","mergeVertically","mergeAll","curCell","getCellValue","mergeCount","activeCellRange","forward","forwardReverse","reverseForward","endRowIdx","isActiveCell","startRowIdx","startRowIndex","colnIdx","cellIndex","rIndex","cIndex","insertHandler","pasteHandler","nextCell","prevSheet","WorkbookConditionalFormat","setCFrulHandler","clearRules","cfrCount","frontColIdx","backColIdx","topRowIdx","bottomRowIdx","isFirst","cFRules","rangeIndexes","cFRulesIdx","isPresent","cFRule","cFRanges","cFRangeIdx","isFull","cFRangeIndexes","cFRRowIdx","cFRColIdx","rRowIdx","rColIdx","WorkbookBasicModule","WorkbookAllModule","CellStyle","ChildProperty","FilterCollection","DefineName","ProtectSettings","Hyperlink","Validation","Format","Complex","ConditionalFormat","Chart","Image","localeData","SortOutOfRangeError","Cell","Range","muteOnChange","parentObj","currRangeIdx","controlParent","isComplexArraySetter","setTimeout","tagObjects","instance","hasChanges","isInitChanges","rangeIdx_1","list","UsedRange","Sheet","ServiceLocator","services","register","__assign","t","Workbook_1","commonCellStyle","initWorkbookServices","dataBind","initEmptySheet","preRender","refreshing","L10n","render","getPersistData","addOnPersist","cssProps","cssProp","events.applyNumberFormatting","events.workbookFormulaOperation","removeSheet","events.workbookDestroyed","appendTo","selector","setBorder","insertRow","getSheetModel","insertColumn","insertSheet","endSheet","initIdx","hiddenCount","errArgs","events.workbookEditOperation","events.workbookOpen","openFromJson","saveOptions","saveUrl","saveAsJson","addHyperlink","cellAddress","events.findNext","events.findPrevious","replaceBy","events.replaceHandler","events.replaceAllHandler","events.protectsheetHandler","unprotectSheet","events.unprotectsheetHandler","events.initiateSort","addDataValidation","events.setValidation","events.removeValidation","addInvalidHighlight","events.addHighlight","removeInvalidHighlight","events.removeHighlight","events.setCFRule","clearConditionalFormat","events.clearCFRule","wrapText","images","filterArgs","events.initiateFilter","events.clearAllFilter","events.clear","events.getFormattedCellObject","isProtectedOnChange","Component","Row","Column","role","selected","multiselectable","busy","colcount","Clipboard","externalMerge","contenteditable","getClipboardEle","clearCopiedInfo","tabSwitchHandler","cMenuBeforeOpenHandler","ribbonClickHandler","initCopyIndicator","EventHandler","parentId","activeTab","copiedShapeInfo","hidePaste","l10n","delRowItems","hideRowItems","delColItems","hideColItems","actCellIndex","isCellLocked","setCopiedInfo","copiedSheet","rfshRange","isExternal","clipboardData","copiedIdx","getCopiedIdx","copyInfo","isInternal","cSIdx","curSheet","selIdx","getExternalCells","internal","cellLength","isRepeative","beginEventArgs","pictureElem","chartInfo","backgroundImage","pastedCell","imgLen","pasteSheetIndex","pastedPictureElement","pasteType","cRows","inRange_1","copiedCell","isFinite","colInd","externalMergeRow","newFormula","sId","cellElem","oldValue","displayText","cutInfo","updateFilter","select","isFilterCut","filterCollection","fRange","asc","filterCol","filteredCell","cRng","pRng","cIdxValue","difIndex","formulaOperators","newAddress","pictureElements","pictureLen","showSpinner","imgRowIdx","offsetTop","isImage","imgColIdx","offsetLeft","getChartElemInfo","execCommand","hideSpinner","setExternalCells","chartId","copyIndicator","show","isModal","showCloseIcon","beforeOpen","dlgArgs","dialogName","items","enable","regex","setData","preventDefault","html","querySelectorAll","td","getStyle","textContent","cSpan","rSpan","whiteSpace","children","child","tdStyle","char","charAt","Edit","editorElem","editCellData","isCellEdit","isNewValueEdit","isAltEnter","validCharacters","keyCodes","BACKSPACE","SPACE","TAB","DELETE","ESC","ENTER","FIRSTALPHABET","LASTALPHABET","FIRSTNUMBER","LASTNUMBER","FIRSTNUMPAD","LASTNUMPAD","SYMBOLSETONESTART","SYMBOLSETONEEND","SYMBOLSETTWOSTART","SYMBOLSETTWOEND","FIREFOXEQUALPLUS","FIREFOXMINUS","F2","dblClickHandler","mouseDownHandler","keyUpHandler","keyDownHandler","initiateCurPosition","updateFormulaBarValue","addressHandler","initiateRefSelection","refSelectionRender","renderEditor","refreshEditor","refreshFormulaBar","refreshEditorElem","isAppend","trigEvent","refreshCurPos","setCursorPosition","startEdit","endEdit","cancelEdit","editedValue","refreshDependentCellValue","position","altKey","keyCode","altEnter","formulaRefIndicator","parentElement","editValue_1","formulaSheetIdx","trgtElem","shiftKey","ctrlKey","metaKey","isFormulaEdit","isWindows","goTo","fullAddr","hasFormulaSuggSelected","isAlphabet","isNumeric","isNumpadKeys","isSymbolkeys","isFirefoxExceptionkeys","isF2Edit","isBackSpace","isLockCellDelete","editingHandler","hasLockCell","editor","contentEditable","spellcheck","preventFormulaReference","cellEle","isDelTemplate","value_1","updateEditCellDetail","initiateEditor","positionEditor","elem","selection","getSelection","createRange","setStart","collapse","removeAllRanges","addRange","suggDdlElem","visibility","editText","curPos","focusOffset","actCellIdx","selectionEnd","curPos_1","addr","tdElem","minHeight","minWidth","editWidth","inlineStyles","enableRtl","updateEditedValue","tdRefresh","oldCellValue","innerText","sheet_1","cellIndex_1","getRefreshNodeArgs","refreshNode","fCode","event","fSize","resetEditState","focusElement","removeAttribute","eventName","originalEvent","textBefore","textAfter","node","anchorNode","nodeType","anchorOffset","setEnd","elemRefresh","editorEle","isSelect","setFormulaBarCurPosition","input","selectionStart","setSelectionRange","el","childNodes","valueLength","Selection","invalidOperators","formulaRange","tableRangesFormula","mouseMoveEvt","mouseMoveHandler","virtualContentLoadedHandler","cellNavigateHandler","protectHandler","initiateFormulaSelection","clearBorder","chartBorderHandler","getActiveCell","getSelectionElement","rowStart","rowEnd","colStart","colEnd","selectRangeByIdx","actRange","createSelectionElement","cont","overlayElem","getSheetElement","activeIdx","isRowSelected","isColSelected","getColumnHeaderContent","which","isSelected","passive","mouseUpHandler","touchEvt","isMobileView","renderModule","setSheetPanelSize","getScrollContent","clientRect","prevIndex","isScrollDown","isScrollUp","isScrollRight","isScrollLeft","clearInterval","scrollInterval","setInterval","scrollTop","scrollLeft","highlightHdr","getScrollLeft","scrollModule","prevScroll","cliRect","initFormulaReferenceIndicator","forRefIndicator","isScrollRefresh","isActCellChanged","isInit","isMergeRange","getOffset","eArgs","UpdateRowColSelected","updateActiveCell","topLeftIdx","isRowRefresh","isColRefresh","rowHdr","colHdr","getHdrIndexes","selectAll","removeClass","addClass","hiddenRowCount","hiddenColCount","processFormulaEditRange","formulaStartSheetIdx","actSheetIdx","parsedVal","ctrlKeyCount","formulaBorder","splitStr","updateFormulaEditRange","dStartCell","dEndCell","startcell","endcell","isChart","minr","minc","maxr","maxc","getEleFromRange","rowCells","startRIndex","startCIndex","endRIndex","endCIndex","tempCells","getRowCells","tdCol","second","borderEleColl","classArr","idx_1","formulaStr","Scroll","initProps","scrollArgs","prevSize","initScrollValue","scrollRight","getColOffset","cur","prev","updateTopLeftCell","updateNonVirtualCols","scrollDown","getRowOffset","updateNonVirtualRows","refreshUI","Infinity","onScroll","setPadding","allowScrolling","colHeader","rowHeader","scrollWidth","padding","marginBottom","VirtualScroll","scroll","createVirtualElement","container","colVTrack","rowVTrack","vTrack","initScroll","domCount","setScrollCount","translateX","translateY","transform","activeSheetIdx","getRowAddress","getColAddress","updateScrollCount","usedRangeCount","prevIdx","idxDiff","lastIdx","prevTopIdx","skippedHiddenIdx","skipUpdateOnFirst","getThresholdHeight","checkLastIdx","endIdx","prevLeftIdx","getThresholdWidth","translate","updateColumnWidth","getVTrackHeight","updateVTrack","createHeaderElement","heightArr","updateVTrackHeight","updateVTrackWidth","hdrVTrack","cntVTrack","hdrColumn","cntColumn","sizeStr","deInitProps","updateScrollProps","sliceScrollProps","KeyboardNavigation","activeElement","isNavigate","isFilterCell","actIdxes","scrollNavigation","stopPropagation","isScroll","topLeftIdxes","getBottomIdx","getRightIdx","contWidth","KeyboardShortcut","isUndo","toolBarElem","applyFilter","CellFormat","checkHeight","curStyle_1","setLeftBorder","setTopBorder","pRow","pHRow","setThickBorderHeight","customHeight","updateRowHeight","isLastCell","borderSize","firstElementChild","display","getBorderSize","calculateHeight","clearObj","Resize","wireEvents","setAutoFitHandler","isRow","trgtEle","setAutofit","wireResizeCursorEvent","setTarget","unWireResizeCursorEvent","unwireEvents","sheetPanel","colResizeHandler","rowResizeHandler","isMouseMoved","offsetSize","offsetY","updateTarget","createResizeHandler","resizeOn","resizeHandler","updateCursor","colIndx","showHiddenColumns","rowIndx","newTrgt","tOffsetV","eOffsetV","tClass","offsetX","resEle","mainContent","contentTable","rowLength","colLength","contentFit","getFloatingElementWidth","autofitValue","resizeStart","getViewportIndex","threshold_1","oldWidth","threshold_2","oldHeight","clientHeight","viewportIdx","curWidth","colgroup","eleHeight","rowHeight","isCustomHgt","actualIdx","skipAppend","rTbody","tBodies","tbody","insertBefore","insertIdx","isFit","floatingWidth","hasFilter","CollaborativeEditing","refreshClients","ShowHide","hideCol","nextIdx","hFrag","frag","rowRenderer","rTBody","tBody","newStartRow","createDocumentFragment","lastElementChild","scrollable","hiddenIndex","beforeViewportIdx","removeCell","scrollWidth_1","appendCell","hColgrp","colgrp","hTable","modelLen","isEnd","cellRenderer","refCell","sheetModule","updateCol","renderColHeader","lastChild","tHead","checkNextBorder","previousSibling","SpreadsheetHyperlink","initiateHyperlinkHandler","editHyperlinkHandler","removeHyperlinkHandler","openHyperlinkHandler","hyperlinkClickHandler","createHyperlinkElementHandler","hyperlinkText","hyperlinkSpan","insertBut","dialogInst_1","cssClass","dialogInstance","hyperlinkContent","buttons","buttonModel","isPrimary","disabled","dlgClickHandler","dialogInst","spreadsheetInst","insertHyperlink","dlgContent","hyperEditContent","cellIndexes","hlOpenHandler","isEmpty","rangeAddr","befArgs","aftArgs","definedNameCheck","sheetIdx_1","isDefinedNamed","rangeAddr_1","addArr","dlgEle","docEle","webEle","webEleText","docEleText","actEle","hasAttribute","hyperEle","isWeb","webContElem","docContElem","listEle","isDefinedName","isCellRef","isEnable","hl","dialogElem","Tab","selectedItem","textCont","urlCont","textH","urlH","textInput","urlInput","nodeId","nodeText","expanded","nodeChild","treeObj","TreeView","fields","cellrefCont","cellrefH","cellrefInput","textCont1","textH1","textInput1","sheetCont","sheetH","refCont","UndoRedo","undoCollection","redoCollection","undoRedoStep","cutCellDetails","getCellDetails","beforeActionData","cellDetails","beforeDetails","undoRedoArgs","performOperation","undoForClipboard","undoForResize","updateUndoRedoIcons","completeArgs","actionList","beforeActionDetails","tab","actionData","checkRefreshNeeded","updateCellDetails","sheetIndex_1","pRange","argsEventArgs","WrapText","wrapTextHandler","rowHeightChangedHandler","initial","WRAPTEXT","outerHTML","editElem","defaultStyle","Insert","preventUpdate","refreshSheet","refreshImgElement","Delete","activeSheetDeleted","DataValidation","dataValPopup","listOpen","initiateDataValidationHandler","invalidDataHandler","checkDataValidation","listHandler","parEle","valuesCont","errorEle","primaryBut","listObj","showPopup","isRemoveHighlight","tdEle_1","ddlCont","ddlEle","DropDownList","popupWidth","popupHeight","updateDataSource","change","listValueChange","popup","getIndexes","listValues","isNew","dataValidationContent","cellRangeCont","allowDataCont","ignoreBlankCont","cellRangeText","cellRangeEle","allowCont","dataCont","allowText","typeData","operatorData","allowSelectEle","allowIdx","dataIdx","dataText","dataSelectEle","FormattedValue","dataList","userInput","ignoreBlankEle_1","CheckBox","label","checked","minimumCont","maximumCont","minimumText","maximumText","minimumInp","maximumInp","NumericTextBox","valueText","valueEle","isChecked","ignoreBlankEle","listObj1","dlgCont","placeholder","errorMsg","isValidList","dlgFooter","dlgContEle","allowData","allowEle","dataEle","rangeAdd","valArr","isSheetNameValid","isSingleCol","isSingleRow","validDlg","isDialogValidator","tdEle","formValidation","formatValidation","isValidationHandler","enterValue","validationErrorHandler","formEle","inputEle","customPlacement","inputElement","number","FormValidator","validate","erroDialogInst_1","dlgModel","errorDlgHandler","errorDialogInst","buttonName","ProtectSheet","protect","protectSheetHandler","editProtectedAlert","lockCellsHandler","isActive","createDialogue","listData","optionList","ListView","showCheckBox","dialogOpen","protectHeaderCntent","checkbox","listViewElement","headerContent","checkBoxElement","okBtnFocus","beforeClose","checkboxElement","checkBoxClickHandler","selectOption","selectMultipleItems","selectedItems","getSelectedItems","disableHomeBtnId","enableHomeBtnId","enableFrmlaBtnId","enableInsertBtnId","imageBtnId","findBtnId","dataValidationBtnId","chartBtnId","sheetElement","closeOnEscape","close","FindAndReplace","shortValue","renderFindDlg","renderGotoDlg","gotoHandler","eventArgs_1","eventArgs_2","eventArgs_3","dlg","allowDragging","findandreplaceContent","dialogMessage","findDlgClick","prevButton","GotoContent","textFocus","findDlgArgs","findOption","findInput","gotoAlert","checkCase","checkmatch","searchitem","modeitem","find","countArgs","countOpt","replaceWith","caseCheckbox","eMatchCheckbox","searchDDL","modeDDL","replaceMode","gotoaddress","splitAddress","gotoSpan","findSpan","replaceSpan","findValue_1","findValue","findElem","findCheck","findTextE","findTextH","findTextIp","findTextBox","TextBox","replaceTextE","replaceTextH","replaceTextIp","replaceTextBox","withinData","Id","Within","withInDDL","withIn","withinTextH","searchData","Search","searchIn","searchTextH","caaseCheckbox","entirematchCheckbox","gotoElem","gotoTextE","gotoTextH","gotoTextBox","gotoTextIp","Merge","hideHandler","ConditionalFormatting","cFInitialRender","cFInitialCheckHandler","checkConditionalFormatHandler","initiateCFHandler","setCFHandler","cFDeleteHandler","clearCFHandler","addClearCFHandler","clearCFormats","cCFIdx","isApply","cFIdx","sRangeIdx","newRangeIdxs","cFRowIdx","cFColIdx","sRRowIdx","sRColIdx","cFDlgContent","mainCont","inpEle","getCFColor","cFType","getType","dlgText","getDlgText","mainDiv","subDiv","value1Text","value1Inp","duplicateSelectEle","subDivText","colorSelectEle","dupData","value2Text","value2Inp","colorData","checkCellHandler","cFrange","cFRIdx","formatStyle","cFColors","cFRCheck","setFormat","setProperty","cFRuleIdx","setColor","isActiveCF","rgb","hexToRgb","g","hex","exec","isInitial","cFRuleValue1","cFRuleValue2","valueArr","valueStr","isGreaterThanLessThan","isBetWeen","isEqualTo","isContainsText","isDuplicateUnique","isTopBottomTenValue","isTopBottomTenPercentage","isAboveBelowAverage","isDataBarColorScalesIconSets","applyDataBars","applyColorScale","applyIconSet","selIndexes","rIdx_1","cIdx_1","iconList","getIconList","rIdx_2","getNumericArray","n1","n2","currentSymbol","minPercent","percent1","percent2","percent3","cfIcon","applyIconSetIcon","activeObj","activeEle","iconName","colors","getColor","rIdx_3","hexcode","getGradient","posColor","negColor","topVal","posArr","negArr","leftStandardWidth","rIdx_4","databar","leftSpan","rightSpan","dataSpan","iconSetSpan","cfColor","colorCodeArr","colorArr","middle","large","getLinear","center","byteLinear","isGrearThan","txtRegx","input1","input2","dateEventArgs1","dateEventArgs2","dateTimeArgs","inp","isTop","dataArray","cFRuleIndexes","dataArr","considerCount","isAbove","rangeColl","average","RibbonHeader","RibbonItem","Item","Ribbon","getUniqueID","renderRibbon","expandCollapseElem","ribbonExpandCollapse","menuItems","fileMenu","toolbarObj","tabObj","getTabItems","tabItems","initMenu","menu","menuObj","Menu","showItemOnClick","parentItem","beforeItemRender","tabElement","tBarElement","Toolbar","selectedTab","getIndex","animation","next","duration","previous","selecting","selectingIndex","updateToolbar","refreshOverflow","collapseBtn","decrement","enableMenuItems","isUniqueId","enableItems","hideMenuItems","menuInstance","hideItems","showItems","addMenuItems","insertAfter","hideTabs","tabs","stateChanged","isAllHidden","getTabIndex","allHidden","enableTabs","enableTab","addTabs","addTab","headerText","tabIdx","disable","MenuItem","ColorPicker","fontColorPicker","ColorPickerComponent","showButtons","presetColors","fontColor","enableOpacity","beforeCloseHandler","openHandler","beforeModeSwitch","currentValue","rgba","previousValue","updateSelectedColor","wireFocusEvent","filColorPicker","fillColor","borderBottomColor","title","inst","modeSwitcher","fontNameIndex","numPopupWidth","RibbonColorPicker","initRibbon","createMobileView","createRibbon","getRibbonMenuItems","iconCss","getRibbonItems","prefixIcon","tooltipText","getPasteBtn","getNumFormatDDB","getFontNameDDB","getFontSizeDDB","getBtn","getBordersDBB","getMergeSplitBtn","getTextAlignDDB","getVerticalAlignDDB","getHyperlinkDlg","datavalidationDDB","getLocaleText","getCFDBB","getChartDBB","getClearDDB","getSortFilterDDB","getFindDDb","btn","pasteSplitBtn","SplitButton","setClass","getLocaleProtectText","ribbonElement","RibbonComponent","fileMenuItemSelect","fileMenuBeforeOpen","fileMenuBeforeClose","toolbarClicked","ribbonCreated","tabSelecting","expandCollapse","expandCollapseHandler","beforeFileMenuItemRender","beforeRenderHandler","uiUpdate","refEle","refreshRibbonContent","numFormatBtn","numFormatDDB","DropDownButton","getNumFormatDdbItems","numDDBSelect","numDDBOpen","previewNumFormat","tBarDdbBeforeOpen","fontSizeDdb","refreshSelected","chartMenu","orientation","bar","area","line","pie","radar","scatter","chartSelected","column1Text","column1Cont","column2Cont","clusteredColumn","stackedColumn","stackedColumn100","clusteredColumn3D","stackedColumn3D","stackedColumn1003D","bar1Text","bar1Cont","bar2Cont","clusteredBar","stackedBar","stackedBar100","clusteredBar3D","stackedBar3D","stackedBar1003D","areaText","areaCont","defArea","stackedArea","stackedArea100","lineText","lineCont","defLine","stackedLine","stackedLine100","pieText","pieCont","defPie","doughnut","radarText","radarCont","defradar","radarMarkers","scatterText","scatterCont","defscatter","ul","chartDdb","chartBtn","cFMenu","dataBars","colorScales","iconSets","cFSelected","db1","db2","bBar","gBar","rBar","oBar","lBBar","pBar","cs1","cs2","cs3","gyr","ryg","gwr","rwg","bwr","rwb","wr","rw","gw","wg","gy","yg","is1","is2","is3","is4","is5","is6","is7","is8","directional1","directional2","directional3","directional4","directional5","directional6","directional7","shapes1","shapes2","shapes3","shapes4","shapes5","indicators1","indicators2","indicators3","ratings1","ratings2","ratings3","ratings4","ratings5","cFDdb","tag","cPickerWrapper","bordersMenu","separator","colorPicker","cPickerEle","onOpen","overflow","borderSelected","inline","bordersDdb","eleId","prevStyleId_1","toggle","fontNameBtn","fontNameDdb","getFontFamilyItems","refreshFontNameSelection","bindEvent","btnObj","Button","isToggle","toggleBtnClicked","datavalidationDdb","textAlignDdb","alignItemRender","verticalAlignDdb","mergeSplitBtn","mergeSelectHandler","toggleActiveState","unMerge","itemId","isDataPresent","performMerge","sortingDdb","isFiltered","isClearAll","findToolbtn","findDdb","onclick","findToolDlg","toolbarObj_1","findTextElement","findTextInput","findSpan_1","onkeyup","nextElement","prevElement","onkeydown","findOnKeyDown","toolItemModel","findDialog","toolbarElement_1","dialogDiv","FindDialog","closeDialog","getComputedStyle","calculate","dialogWidth","rightValue","topValue","X","Y","elements","clearDdb","defaultModel","activeModel","property","refreshToggleBtn","itemKey","setPanelSize","actionArgs","refreshNumFormatSelection","separatorCount","viewportHeight","actualHeight","paddingTop","separatorStyle","borderBottomWidth","marginTop","overflowY","elemList","popWidth","numElem","previewElem","refreshHomeTabContent","refreshDataTabContent","refreshViewTabContent","active","fontProps","selectArgs","evtHArgs","showHideHeaders","toggleRibbonItems","evtglArgs","viewtabHeader","datatabHeader","updateToggleText","len_2","updateActiveBorder","updated","updateViewTabContent","updateShowHideBtn","showHideText","updateDataTabContent","updateProtectBtn","protectText","toobar","align","renderMobileToolbar","toolbarPanel","toolbar","ddb","ddbObj","calculatePosition","wrapper","contents","li","updateMergeItem","parentElem","ribbonEle","FormulaBar","isGoto","createFormulaBar","insertFnRipple","fBarWrapper","nameBox","comboBoxInstance","ComboBox","noRecordsTemplate","nameBoxBeforeOpen","blur","nameBoxBlur","nameBoxSelect","rippleEffect","textarea","textAreaFocusIn","textAreaFocusOut","formulaPanel","tickBtn","validity","eventArg","UpdateValueAfterMouseUp","isInteracted","itemData","formulaBarUpdateHandler","indexes1","indexes2","intDate","formulaInp","addressRange","updateComboBoxValue","disabletextarea","getFormulaBar","formulaBarScrollEdit","viewportIndexes","formulaBarClickHandler","toggleFormulaBar","names","offsetParent","formulaDescription","categoryContent","dropDownElement","descriptionContent","categoryArgs","categoryList","dropDownSelect","listArgs","formulaList","actionComplete","updateFormulaList","listSelected","dialogBeforeClose","dialogClose","selectFormula","formulaClickHandler","focusOkButton","dialogContentEle","parentNode","storeActiveElement","formulaBarObj","updateFormulaDescription","activeListFormula","firstElement","selectItem","descriptionArea","selectedFormula","descriptionArgs","editOperationHandler","Formula","isFormulaBar","isPopupOpened","isPreventClose","isSubFormula","UP","DOWN","LEFT","RIGHT","autocompleteInstance","formulaClick","renderAutoComplete","getNames","getNameFromRange","acElem","autoCompleteOptions","filterType","sortOrder","onSuggestionOpen","onSuggestionClose","onSelect","onSuggestionComplete","AutoComplete","getPopupPosition","refreshPosition","maxHeight","triggerKeyDownEvent","updatedFormulaValue","getEditingValue","parseIndex","getArgumentSeparator","hidePopUp","getSuggestionKeyFromFormula","refreshFormulaSuggestion","autoCompleteElem","isSuggestionAlreadyOpened","isNavigationKey","dispatchEvent","suggPopupElem","hidePopup","suggestValue","bracketIndex","fSplit","isAlphaNumeric","singleRange","SheetTabs","aggregateContent","isSelectCancel","selaggregateCnt","createSheetTabs","tabInstance","panel","addBtn","addSheetTab","addBtnRipple","getSheetTabItems","dropDownInstance","ddbItems","updateSheetTab","beforeOpenHandler","sheetTab","overflowMode","scrollStep","currentSheetIndex","previousSheetIndex","previousIndex","updateDropDownItems","completeEventArgs","tBarItems","spaceKeyDown","positionX","isCollide","refreshSheetTab","switchSheetTab","required","maxlength","renameInputFocusOut","updateWidth","spaceLen","removeRenameInput","showRenameDialog","updateSheetName","textEle","sheetItems","focusRenameInput","forceDelete","sheetArgs","destroySheet","removeTab","activeIndex","btnClass","aggregateDropDown","updateAggregateContent","aggregateEle","getAggregateItems","removeAggregate","Open","renderFileUpload","openFailed","uploadID","accept","uploadBox","onchange","fileSelect","filesData","files","impArgs","Save","showErrorDialog","ContextMenu","initContextMenu","contextMenuInstance","ContextMenuComponent","selectHandler","getInsertModel","getTarget","getDataSource","childElementCount","insertEle","deleteEle","setClipboardData","setFilterItems","setSortItems","setHyperLink","setInsertDeleteItems","setHideShowItems","setProtectSheetItems","clearFilterText","subItems","addItemsHandler","removeItemsHandler","enableItemsHandler","removeItems","NumberFormat","Sort","applySortHandler","sortCompleteHandler","initiateCustomSortHandler","isValidSortRange","sortRangeAlertHandler","customSortContent","clearError","errorElem","validateError","headercheck","headerCheckbox","hasHeader","dropDown","hasError","Set","duplicateField","errorField","count_1","dropDownList","getFields","listId","listviewObj","getCustomListview","setHeaderTab","contentElem","listview","renderListItem","fieldName","headerTabElement","addButton","footer","addItem","checkHeaderObj","fieldsMap","dropDownListObj","checkCaseObj","enableRipple","deleteHandler","removeItem","lvObj","orderRadio","isAscending","toLocaleLowerCase","radiobutton","RadioButton","setRadioBtnValue","radio","radiobutton2","radio2","beforeArgs","Filter","filterClassList","filterRangeAlertHandler","initiateFilterUIHandler","filterMouseDownHandler","renderFilterCellHandler","beforeFltrcMenuOpen","beforeFilterMenuOpenHandler","beforeCustomFilterOpen","beforeCustomFilterOpenHandler","reapplyFilterHandler","filterByCellValueHandler","clearFilterHandler","getFilteredColumnHandler","filterCboxValue","filterCboxValueHandler","getFilterRangeHandler","filterCellKeyDownHandler","isInValidFilterRange","addMenuItem","removeFilter","processRange","filterSuccessHandler","predicate","refreshFilterRange","isFilterRange","getColumnType","matchCase","filterBtnObj","filterButton","hasChildNodes","headerCell","filterPopup","pos","openDialog","selectSortItemHandler","xPos","yPos","parentsUntil","filterCell","displayName","checkBoxData","hideSearchbox","filteredColumns","ExcelFilterBase","getLocalizedCustomOperators","sameIndex","filterIndex","getPredicates","predicateList","excelPredicate","CheckBoxFilterBase","getPredicate","numOptr","stringOperator","numberOperator","dateOperator","datetimeOperator","booleanOperator","fil","colCollection","dataType","SpreadsheetImage","pictureCount","renderImageUpload","refreshInsDelImagePosition","imageSelect","binaryStringVal","overlayObj","overlay","insertOverlayElement","currCell","currCellObj","imageLen","prevRowIdx","currRowIdx","prevColIdx","currColIdx","prevImgObj","currImgObj","prevCellObj","prevCellImg","prevCellImgLen","currentRowIdx","currentColIdx","imgLength","imgTop","imgleft","rangeVal","ColumnSeries","LineSeries","BarSeries","AreaSeries","StackingColumnSeries","StackingLineSeries","StackingBarSeries","ScatterSeries","StackingAreaSeries","Category","Legend","Tooltip","AccumulationChart","PieSeries","AccumulationTooltip","AccumulationDataLabel","AccumulationLegend","SpreadsheetChart","initiateChartHandler","updateChartHandler","insertChartHandler","chartRangeHandler","chartType","chartCollLen","getPropertyValue","formatObj","series","prevChartObj","currChartObj","prevCellChart","chartEleClassName","processChartRange","xRange","yRange","lRange","trVal","blVal","tlVal","isStringSeries","toIntrnlRange","getRangeData","pushRowData","isYvalue","isDataSrcEnsured","minCol","forArgs","toArrayData","getVirtualXValues","limit","processChartSeries","xValue","yValue","lValue","pArr","inc","dtVal","seriesName","pObj","yInc","sArr","skipFormula","rDiff","cDiff","xName","yName","marker","shape","dataLabel","radius","startAngle","endAngle","innerRadius","explode","explodeOffset","explodeIndex","retVal","primaryYAxisFormat","focusChartRange","borderIdx","eleColl","tdIdx","argsOpt","isRangeSelect","isRowLesser","reqType","shapeType","chartRange","primaryYAxis","lineStyle","majorTickLines","majorGridLines","minorGridLines","minorTickLines","labelFormat","eleRange","chartContent","primaryXAxis","valueType","chartArea","tooltip","load","selectedTheme","beforeResize","cancelResizedEvent","enableSmartLabels","enableAnimation","legendSettings","location","hash","accumulation","chartElements","chartLength","isRemoveEle","BasicModule","Spreadsheet","AllModule","ScrollSettings","SelectionSettings","Custom","defaultLocale","FindValue","ReplaceValue","FindReplaceTooltip","InsertingEmptyValue","ReplaceAllEnd","ByRow","ByColumn","MatchCase","MatchExactCellElements","Replace","Find","Goto","EntercellAddress","GotoSpecial","FindNextBtn","FindPreviousBtn","ReplaceBtn","ReplaceAllBtn","GotoHeader","GotoSpecialHeader","NoElements","FindWhat","ReplaceWith","Cut","Copy","Paste","PasteSpecial","Link","EditHyperlink","OpenHyperlink","RemoveHyperlink","InsertLink","EditLink","All","Values","Formats","Bold","Font","FontSize","Italic","Underline","Strikethrough","TextColor","FillColor","HorizontalAlignment","AlignLeft","AlignCenter","AlignRight","VerticalAlignment","AlignTop","AlignMiddle","AlignBottom","MergeCells","MergeAll","MergeHorizontally","MergeVertically","Unmerge","UnmergeCells","SelectMergeType","MergeCellsAlert","PasteMergeAlert","Borders","TopBorders","LeftBorders","RightBorders","BottomBorders","AllBorders","HorizontalBorders","VerticalBorders","OutsideBorders","InsideBorders","NoBorders","BorderColor","BorderStyle","InsertFunction","Rename","Hide","Unhide","NameBox","ShowHeaders","HideHeaders","ShowGridLines","HideGridLines","AddSheet","ListAllSheets","FullScreen","CollapseToolbar","ExpandToolbar","CollapseFormulaBar","ExpandFormulaBar","File","Home","Formulas","View","New","SaveAs","Update","ExcelXlsx","ExcelXls","CSV","SortAscending","SortDescending","CustomSort","AddColumn","ContainsHeader","CaseSensitive","SortBy","ThenBy","SelectAColumn","SortEmptyFieldError","SortDuplicateFieldError","SortAndFilter","ClearAllFilter","ClearFilterFrom","ReapplyFilter","FilterCellValue","FilterOutOfRangeError","HideRow","HideRows","UnHideRows","HideColumn","HideColumns","UnHideColumns","InsertRow","InsertRows","Above","Below","InsertColumn","InsertColumns","Before","After","DeleteRow","DeleteRows","DeleteColumn","DeleteColumns","Ok","Close","Cancel","Apply","MoreColors","StandardColors","General","Currency","Accounting","ShortDate","LongDate","Time","Percentage","Fraction","Scientific","Text","MobileFormulaBarPlaceHolder","PasteAlert","DestroyAlert","SheetRenameInvalidAlert","SheetRenameEmptyAlert","SheetRenameAlreadyExistsAlert","DeleteSheetAlert","DeleteSingleLastSheetAlert","PickACategory","Description","UnsupportedFile","InvalidUrl","SUM","SUMIF","SUMIFS","ABS","RAND","RANDBETWEEN","FLOOR","CEILING","PRODUCT","INT","ROUNDUP","SUMPRODUCT","TODAY","AVERAGE","AVERAGEIF","AVERAGEIFS","AVERAGEA","COUNT","COUNTIF","COUNTIFS","COUNTA","MIN","MAX","DATE","DAY","DAYS","IF","IFS","CalculateAND","CalculateOR","IFERROR","CHOOSE","INDEX","FIND","CONCATENATE","CONCAT","SUBTOTAL","RADIANS","MATCH","LN","INTERCEPT","SLOPE","DefineNameExists","DefineNameInValid","CircularReference","ShowRowsWhere","OR","AND","CustomFilterDatePlaceHolder","CustomFilterPlaceHolder","CustomFilter","Between","DateTimeFilter","Undo","Redo","DateFilter","TextFilter","NumberFilter","ClearFilter","NoResult","FilterFalse","FilterTrue","Blanks","SelectAll","GreaterThanOrEqual","GreaterThan","LessThanOrEqual","LessThan","NotEqual","Equal","Contains","EndsWith","StartsWith","ClearButton","FilterButton","CancelButton","OKButton","UnprotectSheet","LockCells","SelectCells","FormatCells","FormatRows","FormatColumns","InsertLinks","ProtectContent","ProtectAllowUser","EditAlert","SearchWithin","SearchBy","Reference","CLEARALL","APPLY","CellRange","Allow","Data","Minimum","Maximum","IgnoreBlank","WholeNumber","Decimal","TextLength","List","NotBetween","EqualTo","NotEqualTo","Greaterthan","Lessthan","GreaterThanOrEqualTo","LessThanOrEqualTo","InCellDropDown","Sources","Value","Retry","EnterValue","DialogError","ListLengthError","ValidationError","EmptyError","ClearHighlight","HighlightInvalidData","ClearValidation","HighlightCellsRules","CFEqualTo","TextThatContains","ADateOccuring","DuplicateValues","TopBottomRules","Top10Items","Top10","Bottom10Items","Bottom10","AboveAverage","BelowAverage","FormatCellsGreaterThan","FormatCellsLessThan","FormatCellsBetween","FormatCellsEqualTo","FormatCellsThatContainTheText","FormatCellsThatContainADateOccurring","FormatCellsDuplicate","FormatCellsTop","FormatCellsBottom","FormatCellsAbove","FormatCellsBelow","With","DataBars","ColorScales","IconSets","ClearRules","SelectedCells","EntireSheet","ISNUMBER","ROUND","GEOMEAN","POWER","LOG","TRUNC","EXP","Clear","ClearContents","ClearAll","ClearFormats","ClearHyperlinks","LightRedFillWithDarkRedText","YellowFillWithDarkYellowText","GreenFillWithDarkGreenText","RedFill","RedText","Duplicate","Unique","And","WebPage","ThisDocument","DisplayText","Url","CellReference","DefinedNames","EnterTheTextToDisplay","EnterTheUrl","BlueDataBar","GreenDataBar","RedDataBar","OrangeDataBar","LightblueDataBar","PurpleDataBar","GYRColorScale","RYGColorScale","GWRColorScale","RWGColorScale","BWRColorScale","RWBColorScale","WRColorScale","RWColorScale","GWColorScale","WGColorScale","GYColorScale","YGColorScale","ThreeArrowsColor","ThreeArrowsGray","ThreeTriangles","FourArrowsColor","FourArrowsGray","FiveArrowsColor","FiveArrowsGray","ThreeTrafficLights1","ThreeTrafficLights2","ThreeSigns","FourTrafficLights","RedToBlack","ThreeSymbols1","ThreeSymbols2","ThreeFlags","ThreeStars","FourRatings","FiveQuarters","FiveRatings","FiveBoxes","Bar","Area","Pie","Doughnut","PieAndDoughnut","Line","Radar","Scatter","ChartDesign","ClusteredColumn","StackedColumn","StackedColumn100","ClusteredBar","StackedBar","StackedBar100","StackedArea","StackedArea100","StackedLine","StackedLine100","SheetRender","freezePane","colGroupWidth","refreshSelectALLContent","getSelectAllTable","headerPanel","updateLeftColGroup","getRowHeaderPanel","detachColGroup","colGrp","colGrpWidth","getSelectAllContent","getColHeaderPanel","getContentPanel","renderPanel","contentPanel","initHeaderPanel","updateHideHeaders","createTable","createHeaderTable","updateTable","rowHdrEle","tagName","renderTable","rHdrTBody","cHdrTHead","cHdrRow","cTBody","attributes","aria-rowcount","aria-colcount","renderRowHeader","initLoad","triggerCreatedEvent","createdHandler","observers","refreshColumnContent","checkColMerge","refreshRowContent","hTBody","checkRowMerge","formatUnit","updateColContent","refChild","hRefChild","skipRender","colRefChild","updateRowContent","rFrag","cKey","firstcell","refreshPrevMerge","currTopIdx","renderHeaders","rowIndexes","colIndexes","cFrag","cTHead","cRow","RowRenderer","isRowHeader","aria-rowindex","CellRenderer","th","tableRow","updateView","aria-colindex","tabindex","checkMerged","compiledTemplate","processTemplates","evtArgs","formatArgs","removeStyle","compileCellTemplate","templateString","compile","compiledStr","clonedCell","previouseHeight","getRowHeightOnInit","tTable","rightBorder_1","bottomBorder_1","prevRowCell","prevColCell","cRange","Render","renderSheet","checkTopLeftCell","lastRow","lastCol","roundValue","roundedValue","instantiateRenderer","Dialog","dialogModel","cancelBtn","btnContent","closeHandler","div","DialogComponent","ActionEvents","initializeActionBegin","beforeCellFormat","actionEventHandler","evtFunc","actionType","eventType","beforeSave","beforeSort","initializeActionComplete","cellSave","actionBeginHandler","actionCompleteHandler","Overlay","isOverlayClicked","isResizerClicked","currenHeight","class","renderResizeHandles","originalWidth","originalHeight","overlayClickHandler","overlayMouseMoveHandler","overlayMouseUpHandler","resizer","height1","originalMouseY","originalResizeTop","resizedReorderTop","width1","pageX","originalMouseX","height2","pageY","width2","originalResizeLeft","resizedReorderLeft","posX","posY","aX","diffX","aY","diffY","isMouseUp","overlaElems","originalReorderTop","originalReorderLeft","actOverlayElem","handleElem","handles","needsID","Spreadsheet_1","initServices","renderSpreadsheet","setHeight","setWidth","createSpinner","findAll","addrArr","insideDomCount","cVTrack","rVTrack","vWidth","vHeight","scrollableSize","resize","colThreshold","mIndex","colWidth","eleWidth","oldIdx","edited","maximumColInx","startIsCol","endIsCol","starttoend","startValues","getAddress","endValues","cellMod","eleRowIdx","eleColIdx","isMethod","addrRange","mCell","isDevice","circularArgs","spanElem","alignClass","createTextNode","nodeValue","borderWidth","nextTab","indicator","undo","redo","mouseClickHandler","closeEdit","newRangeIdx_1","ranges_1","isLastRange"],"mappings":"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"}